/**
 * @preserve
 * kinvey-html5-sdk v3.9.0
 * Kinvey JavaScript SDK for HTML5 applications.
 * http://www.kinvey.com
 *
 * Copyright (c) 2016, Kinvey.
 * All rights reserved.
 *
 * Released under the Apache-2.0 license.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Kinvey=t():e.Kinvey=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),o=n(324),i=n(358),u=n(367),a=n(387),s=function(e){return e&&e.__esModule?e:{default:e}}(a);r.CacheRack.useCacheMiddleware(new u.CacheMiddleware),r.NetworkRack.useHttpMiddleware(new u.HttpMiddleware),o.MobileIdentityConnect.usePopupClass(s.default),e.exports=i.Kinvey},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.User=t.SyncOperation=t.Storage=t.StatusCode=t.SocialIdentity=t.SerializeMiddleware=t.Response=t.RequestMethod=t.Request=t.Rack=t.Query=t.Properties=t.ParseMiddleware=t.NetworkRequest=t.NetworkRack=t.Middleware=t.Metadata=t.MemoryAdapter=t.KinveyResponse=t.KinveyRequest=t.Kinvey=t.HttpMiddleware=t.Headers=t.Files=t.DeltaFetchRequest=t.DataStoreType=t.DataStore=t.CustomEndpoint=t.Client=t.CacheRequest=t.CacheRack=t.CacheMiddleware=t.AuthType=t.AuthorizationGrant=t.Group=t.Aggregation=t.Acl=void 0;var o=n(2);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(40);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(139),a=r(u),s=n(331),c=n(324),l=n(244),f=r(l),h=n(286),d=r(h),p=n(288),v=r(p),y=n(356),b=r(y),g=n(357),m=n(275),_=r(m),w=new u.FileStore;t.Acl=s.Acl,t.Aggregation=d.default,t.Group=d.default,t.AuthorizationGrant=c.AuthorizationGrant,t.AuthType=l.AuthType,t.CacheMiddleware=l.CacheMiddleware,t.CacheRack=l.CacheRack,t.CacheRequest=l.CacheRequest,t.Client=v.default,t.CustomEndpoint=b.default,t.DataStore=a.default,t.DataStoreType=u.DataStoreType,t.DeltaFetchRequest=l.DeltaFetchRequest,t.Files=w,t.Headers=l.Headers,t.HttpMiddleware=l.HttpMiddleware,t.Kinvey=g.Kinvey,t.KinveyRequest=l.KinveyRequest,t.KinveyResponse=l.KinveyResponse,t.MemoryAdapter=l.MemoryAdapter,t.Metadata=s.Metadata,t.Middleware=l.Middleware,t.NetworkRack=l.NetworkRack,t.NetworkRequest=l.NetworkRequest,t.ParseMiddleware=l.ParseMiddleware,t.Properties=l.Properties,t.Query=_.default,t.Rack=l.Rack,t.Request=f.default,t.RequestMethod=l.RequestMethod,t.Response=l.Response,t.SerializeMiddleware=l.SerializeMiddleware,t.SocialIdentity=c.SocialIdentity,t.StatusCode=l.StatusCode,t.Storage=l.Storage,t.SyncOperation=u.SyncOperation,t.User=s.User,t.default=g.Kinvey},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WritesToCollectionDisallowedError=t.UserAlreadyExistsError=t.TimeoutError=t.SyncError=t.StaleRequestError=t.ServerError=t.QueryError=t.PopupError=t.ParameterValueOutOfRangeError=t.NotFoundError=t.NoResponseError=t.NoActiveUserError=t.NetworkConnectionError=t.MobileIdentityConnectError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.KinveyError=t.KinveyInternalErrorStop=t.KinveyInternalErrorRetry=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IndirectCollectionAccessDisallowedError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.DuplicateEndUsersError=t.CORSDisabledError=t.BLError=t.BaseError=t.BadRequestError=t.AppProblemError=t.APIVersionNotImplementedError=t.APIVersionNotAvailableError=t.ActiveUserError=void 0;var o=n(3),i=r(o),u=n(5),a=r(u),s=n(6),c=r(s),l=n(7),f=r(l),h=n(8),d=r(h),p=n(4),v=r(p),y=n(9),b=r(y),g=n(10),m=r(g),_=n(11),w=r(_),k=n(12),E=r(k),O=n(13),S=r(O),P=n(14),j=r(P),x=n(15),T=r(x),C=n(16),A=r(C),M=n(17),R=r(M),I=n(18),q=r(I),D=n(19),U=r(D),N=n(20),L=r(N),K=n(21),B=r(K),F=n(22),H=r(F),z=n(23),G=r(z),V=n(24),$=r(V),Q=n(25),W=r(Q),Y=n(26),X=r(Y),J=n(27),Z=r(J),ee=n(28),te=r(ee),ne=n(29),re=r(ne),oe=n(30),ie=r(oe),ue=n(31),ae=r(ue),se=n(32),ce=r(se),le=n(33),fe=r(le),he=n(34),de=r(he),pe=n(35),ve=r(pe),ye=n(36),be=r(ye),ge=n(37),me=r(ge),_e=n(38),we=r(_e),ke=n(39),Ee=r(ke);t.ActiveUserError=i.default,t.APIVersionNotAvailableError=a.default,t.APIVersionNotImplementedError=c.default,t.AppProblemError=f.default,t.BadRequestError=d.default,t.BaseError=v.default,t.BLError=b.default,t.CORSDisabledError=m.default,t.DuplicateEndUsersError=w.default,t.FeatureUnavailableError=E.default,t.IncompleteRequestBodyError=S.default,t.IndirectCollectionAccessDisallowedError=j.default,t.InsufficientCredentialsError=T.default,t.InvalidCredentialsError=A.default,t.InvalidIdentifierError=R.default,t.InvalidQuerySyntaxError=q.default,t.JSONParseError=U.default,t.KinveyInternalErrorRetry=L.default,t.KinveyInternalErrorStop=B.default,t.KinveyError=H.default,t.MissingQueryError=G.default,t.MissingRequestHeaderError=$.default,t.MissingRequestParameterError=W.default,t.MobileIdentityConnectError=X.default,t.NetworkConnectionError=Z.default,t.NoActiveUserError=te.default,t.NoResponseError=re.default,t.NotFoundError=ie.default,t.ParameterValueOutOfRangeError=ae.default,t.PopupError=ce.default,t.QueryError=fe.default,t.ServerError=de.default,t.StaleRequestError=ve.default,t.SyncError=be.default,t.TimeoutError=me.default,t.UserAlreadyExistsError=we.default,t.WritesToCollectionDisallowedError=Ee.default,t.default=H.default},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ActiveUserError",this.message=e||"An active user already exists.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t){"use strict";function n(e,t,n,r){this.name="BaseError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.default=n},function(e,t,n){"use strict";function r(e,t,n,r){this.name="APIVersionNotAvailableError",this.message=e||"This API version is not available for your app.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="APIVersionNotImplementedError",this.message=e||"This API version is not implemented.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="AppProblemError",this.message=e||"There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="BadRequestError",this.message=e||"Unable to understand request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="BLError",this.message=e||"The Business Logic script did not complete.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="CORSDisabledError",this.message=e||"Cross Origin Support is disabled for this application.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="DuplicateEndUsersError",this.message=e||"More than one user registered with this username for this application.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="FeatureUnavailableError",this.message=e||"Requested functionality is unavailable in this API version.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="IncompleteRequestBodyError",this.message=e||"The request body is either missing or incomplete.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="IndirectCollectionAccessDisallowedError",this.message=e||"Please use the appropriate API to access this collection for this app backend.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InsufficientCredentialsError",this.message=e||"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidCredentialsError",this.message=e||"Invalid credentials. Please retry your request with correct credentials.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidIdentifierError",this.message=e||"One of more identifier names in the request has an invalid format.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidQuerySyntaxError",this.message=e||"The query string in the request has an invalid syntax.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="JSONParseError",this.message=e||"Unable to parse the JSON in the request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyInternalErrorRetry",this.message=e||"The Kinvey server encountered an unexpected error. Please retry your request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyInternalErrorStop",this.message=e||"The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingQueryError",this.message=e||"The request is missing a query string.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingRequestHeaderError",this.message=e||"The request is missing a required header.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingRequestParameterError",this.message=e||"A required parameter is missing from the request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MobileIdentityConnectError",this.message=e||"An error has occurred with Mobile Identity Connect.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NetworkConnectionError",this.message=e||"There was an error connecting to the network.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NoActiveUserError",this.message=e||"There is not an active user.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NoResponseError",this.message=e||"No response was provided.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NotFoundError",this.message=e||"The entity was not found.",this.debug=t||void 0,this.code=n||404,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ParameterValueOutOfRangeError",this.message=e||"The value specified for one of the request parameters is out of range.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="PopupError",this.message=e||"Unable to open a popup on this platform.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="QueryError",this.message=e||"An error occurred with the query.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ServerError",this.message=e||"An error occurred on the server.",this.debug=t||void 0,this.code=n||500,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="StaleRequestError",this.message=e||"The time window for this request has expired.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="SyncError",this.message=e||"An error occurred during sync.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="TimeoutError",this.message=e||"The request timed out.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="UserAlreadyExistsError",this.message=e||"This username is already taken. Please retry your request with a different username.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="WritesToCollectionDisallowedError",this.message=e||"This collection is configured to disallow any modifications to an existing entity or creation of new entities.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.prototype=Object.create(i.default.prototype),r.prototype.constructor=r,t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.appendQuery=t.nested=t.isDefined=t.Queue=t.Log=t.KinveyObservable=void 0;var o=n(41);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(42),u=r(i),a=n(44),s=n(47),c=r(s),l=n(73),f=n(74);t.KinveyObservable=c.default,t.Log=u.default,t.Queue=l.Queue,t.isDefined=a.isDefined,t.nested=a.nested,t.appendQuery=f.appendQuery},function(e,t){"use strict";function n(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r+=1)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return""+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")+n(e)}function o(e){return"string"==typeof e&&""!==e}Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=r,t.isNonemptyString=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=function(e){return e&&e.__esModule?e:{default:e}}(r);o.default.setDefaultLevel(o.default.levels.SILENT);var i=o.default.methodFactory;o.default.methodFactory=function(e,t,n){var r=i(e,t,n);return function(e){e="Kinvey: "+e;for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];n.length>0?r(e,n):r(e)}},t.default=o.default},function(e,t,n){var r,o;!function(i,u){"use strict";r=u,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o)}(0,function(){"use strict";function e(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function t(t){return"debug"===t&&(t="log"),typeof console!==a&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):u)}function n(e,t){for(var n=0;n<s.length;n++){var r=s[n];this[r]=n<e?u:this.methodFactory(r,e,t)}this.log=this.debug}function r(e,t,r){return function(){typeof console!==a&&(n.call(this,t,r),this[e].apply(this,arguments))}}function o(e,n,o){return t(e)||r.apply(this,arguments)}function i(e,t,r){function i(e){var t=(s[e]||"silent").toUpperCase();if(typeof window!==a){try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}}function u(){var e;if(typeof window!==a){try{e=window.localStorage[f]}catch(e){}if(typeof e===a)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(f)+"=");n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}}var c,l=this,f="loglevel";e&&(f+=":"+e),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=r||o,l.getLevel=function(){return c},l.setLevel=function(t,r){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(c=t,r!==!1&&i(t),n.call(l,t,e),typeof console===a&&t<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){u()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var h=u();null==h&&(h=null==t?"WARN":t),l.setLevel(h,!1)}var u=function(){},a="undefined",s=["trace","debug","info","warn","error"],c=new i,l={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==a?window.log:void 0;return c.noConflict=function(){return typeof window!==a&&window.log===c&&(window.log=f),c},c})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return(0,c.default)(e)===!1&&(0,a.default)(e)===!1}function i(e,t,n){if(o(t)===!1)return e=n||e;for(var r=t.split("."),i=r.shift();i&&e;)e=e[i],i=r.shift();return n||e}Object.defineProperty(t,"__esModule",{value:!0}),t.isDefined=o,t.nested=i;var u=n(45),a=r(u),s=n(46),c=r(s)},function(e,t){function n(e){return null===e}e.exports=n},function(e,t){function n(e){return void 0===e}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r,o){if(e){if(e instanceof _)return e;if(e[p.rxSubscriber])return e[p.rxSubscriber]()}return e||t||n||r||o?new _(e,t,n,r,o):new _(g)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(48),f=r(l),h=n(51),d=n(54),p=n(63),v=n(65),y=r(v),b=n(40),g={closed:!0,next:function(){},error:function(e){throw e},complete:function(){},status:function(){},presence:function(){}},m=function(e){function t(e,n,r,u,a,s){o(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),l=void 0,f=c;return c._parentSubscriber=e,(0,y.default)(n)?l=n:n&&(l=n.next,r=n.error,u=n.complete,n!==g&&(f=Object.create(n),(0,y.default)(f.unsubscribe)&&c.add(f.unsubscribe.bind(f)),f.unsubscribe=c.unsubscribe.bind(c))),c._context=f,c._next=l,c._error=r,c._complete=u,c._status=a,c._presence=s,c}return u(t,e),c(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"status",value:function(e){if(!this.isStopped&&this._status){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._status,e)&&this.unsubscribe():this.__tryOrUnsub(this._status,e)}}},{key:"presence",value:function(e){if(!this.isStopped&&this._presence){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._presence,e)&&this.unsubscribe():this.__tryOrUnsub(this._presence,e)}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}}},{key:"__tryOrSetError",value:function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(d.Subscriber),_=function(e){function t(e,n,r,u,a){o(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));switch(arguments.length){case 0:c.destination=g;break;case 1:if((0,b.isDefined)(e)===!1){c.destination=g;break}if("object"===(void 0===e?"undefined":s(e))){e instanceof d.Subscriber?(c.destination=e,c.destination.add(c)):(c.syncErrorThrowable=!0,c.destination=new m(c,e));break}default:c.syncErrorThrowable=!0,c.destination=new m(c,e,n,r,u,a)}return c}return u(t,e),c(t,[{key:"status",value:function(e){this.isStopped||this._status(e)}},{key:"presence",value:function(e){this.isStopped||this._presence(e)}},{key:"_status",value:function(e){this.destination.status(e)}},{key:"_presence",value:function(e){this.destination.presence(e)}}]),t}(d.Subscriber),w=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"subscribe",value:function(e,t,n,r,o){var i=this.operator,u=a(e,t,n,r,o);if(i?i.call(u,this.source):u.add(this._trySubscribe(u)),u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u}},{key:"toPromise",value:function(){var e=this;return new f.default(function(t,n){var r=void 0;e.subscribe(function(e){r=e},n,function(){t(r)})})}}],[{key:"create",value:function(e){return new t(e)}}]),t}(h.Observable);t.default=w},function(e,t,n){(function(t,r){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.1.1
	 */
!function(t,n){e.exports=n()}(0,function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function o(e){return"function"==typeof e}function i(e){G=e}function u(e){V=e}function a(){return void 0!==z?function(){z(c)}:s()}function s(){var e=setTimeout;return function(){return e(c,1)}}function c(){for(var e=0;e<H;e+=2){(0,J[e])(J[e+1]),J[e]=void 0,J[e+1]=void 0}H=0}function l(e,t){var n=arguments,r=this,o=new this.constructor(h);void 0===o[ee]&&A(o);var i=r._state;return i?function(){var e=n[i-1];V(function(){return x(i,o,e,r._result)})}():O(r,o,e,t),o}function f(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(h);return _(n,e),n}function h(){}function d(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function v(e){try{return e.then}catch(e){return oe.error=e,oe}}function y(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function b(e,t,n){V(function(e){var r=!1,o=y(n,t,function(n){r||(r=!0,t!==n?_(e,n):k(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,E(e,o))},e)}function g(e,t){t._state===ne?k(e,t._result):t._state===re?E(e,t._result):O(t,void 0,function(t){return _(e,t)},function(t){return E(e,t)})}function m(e,t,n){t.constructor===e.constructor&&n===l&&t.constructor.resolve===f?g(e,t):n===oe?(E(e,oe.error),oe.error=null):void 0===n?k(e,t):o(n)?b(e,t,n):k(e,t)}function _(t,n){t===n?E(t,d()):e(n)?m(t,n,v(n)):k(t,n)}function w(e){e._onerror&&e._onerror(e._result),S(e)}function k(e,t){e._state===te&&(e._result=t,e._state=ne,0!==e._subscribers.length&&V(S,e))}function E(e,t){e._state===te&&(e._state=re,e._result=t,V(w,e))}function O(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ne]=n,o[i+re]=r,0===i&&e._state&&V(S,e)}function S(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,u=0;u<t.length;u+=3)r=t[u],o=t[u+n],r?x(n,r,o,i):o(i);e._subscribers.length=0}}function P(){this.error=null}function j(e,t){try{return e(t)}catch(e){return ie.error=e,ie}}function x(e,t,n,r){var i=o(n),u=void 0,a=void 0,s=void 0,c=void 0;if(i){if(u=j(n,r),u===ie?(c=!0,a=u.error,u.error=null):s=!0,t===u)return void E(t,p())}else u=r,s=!0;t._state!==te||(i&&s?_(t,u):c?E(t,a):e===ne?k(t,u):e===re&&E(t,u))}function T(e,t){try{t(function(t){_(e,t)},function(t){E(e,t)})}catch(t){E(e,t)}}function C(){return ue++}function A(e){e[ee]=ue++,e._state=void 0,e._result=void 0,e._subscribers=[]}function M(e,t){this._instanceConstructor=e,this.promise=new e(h),this.promise[ee]||A(this.promise),F(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&k(this.promise,this._result))):E(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function I(e){return new M(this,e).promise}function q(e){var t=this;return new t(F(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function D(e){var t=this,n=new t(h);return E(n,e),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(e){this[ee]=C(),this._result=this._state=void 0,this._subscribers=[],h!==e&&("function"!=typeof e&&U(),this instanceof L?T(this,e):N())}function K(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=L}var B=void 0;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var F=B,H=0,z=void 0,G=void 0,V=function(e,t){J[H]=e,J[H+1]=t,2===(H+=2)&&(G?G(c):Z())},$="undefined"!=typeof window?window:void 0,Q=$||{},W=Q.MutationObserver||Q.WebKitMutationObserver,Y="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),X="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3),Z=void 0;Z=Y?function(){return function(){return t.nextTick(c)}}():W?function(){var e=0,t=new W(c),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():X?function(){var e=new MessageChannel;return e.port1.onmessage=c,function(){return e.port2.postMessage(0)}}():void 0===$?function(){try{var e=n(50);return z=e.runOnLoop||e.runOnContext,a()}catch(e){return s()}}():s();var ee=Math.random().toString(36).substring(16),te=void 0,ne=1,re=2,oe=new P,ie=new P,ue=0;return M.prototype._enumerate=function(e){for(var t=0;this._state===te&&t<e.length;t++)this._eachEntry(e[t],t)},M.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===f){var o=v(e);if(o===l&&e._state!==te)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===L){var i=new n(h);m(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},M.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===te&&(this._remaining--,e===re?E(r,n):this._result[t]=n),0===this._remaining&&k(r,this._result)},M.prototype._willSettleAt=function(e,t){var n=this;O(e,void 0,function(e){return n._settledAt(ne,t,e)},function(e){return n._settledAt(re,t,e)})},L.all=I,L.race=q,L.resolve=f,L.reject=D,L._setScheduler=i,L._setAsap=u,L._asap=V,L.prototype={constructor:L,then:l,catch:function(e){return this.then(null,e)}},L.polyfill=K,L.Promise=L,L})}).call(t,n(49),function(){return this}())},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function u(){v&&d&&(v=!1,d.length?p=d.concat(p):y=-1,p.length&&a())}function a(){if(!v){var e=o(u);v=!0;for(var t=p.length;t;){for(d=p,p=[];++y<t;)d&&d[y].run();y=-1,t=p.length}d=null,v=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var l,f,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,p=[],v=!1,y=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||v||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){},function(e,t,n){"use strict";var r=n(52),o=n(53),i=n(64),u=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=o.toSubscriber(e,t,n);if(r?r.call(i,this.source):i.add(this.source?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var n=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var o;o=n.subscribe(function(t){if(o)try{e(t)}catch(e){r(e),o.unsubscribe()}else e(t)},r,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[i.observable]=function(){return this},e.create=function(t){return new e(t)},e}();t.Observable=u},function(e,t){(function(e){"use strict";var n="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=void 0!==e&&e,i=n||o||r;t.root=i,function(){if(!i)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t,n){if(e){if(e instanceof o.Subscriber)return e;if(e[i.rxSubscriber])return e[i.rxSubscriber]()}return e||t||n?new o.Subscriber(e,t,n):new o.Subscriber(u.empty)}var o=n(54),i=n(63),u=n(62);t.toSubscriber=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(55),i=n(56),u=n(62),a=n(63),s=function(e){function t(n,r,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=u.empty;break;case 1:if(!n){this.destination=u.empty;break}if("object"==typeof n){n instanceof t?(this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,n,r,o)}}return r(t,e),t.prototype[a.rxSubscriber]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,n=e._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=n,this},t}(i.Subscription);t.Subscriber=s;var c=function(e){function t(t,n,r,i){e.call(this),this._parentSubscriber=t;var a,s=this;o.isFunction(n)?a=n:n&&(a=n.next,r=n.error,i=n.complete,n!==u.empty&&(s=Object.create(n),o.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=a,this._error=r,this._complete=i}return r(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(s)},function(e,t){"use strict";function n(e){return"function"==typeof e}t.isFunction=n},function(e,t,n){"use strict";function r(e){return e.reduce(function(e,t){return e.concat(t instanceof c.UnsubscriptionError?t.errors:t)},[])}var o=n(57),i=n(58),u=n(55),a=n(59),s=n(60),c=n(61),l=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var n=this,l=n._parent,f=n._parents,h=n._unsubscribe,d=n._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,v=f?f.length:0;l;)l.remove(this),l=++p<v&&f[p]||null;if(u.isFunction(h)){var y=a.tryCatch(h).call(this);y===s.errorObject&&(t=!0,e=e||(s.errorObject.e instanceof c.UnsubscriptionError?r(s.errorObject.e.errors):[s.errorObject.e]))}if(o.isArray(d))for(p=-1,v=d.length;++p<v;){var b=d[p];if(i.isObject(b)){var y=a.tryCatch(b.unsubscribe).call(b);if(y===s.errorObject){t=!0,e=e||[];var g=s.errorObject.e;g instanceof c.UnsubscriptionError?e=e.concat(r(g.errors)):e.push(g)}}}if(t)throw new c.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;n=new e,n._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);n!==-1&&t.splice(n,1)}},e.prototype._addParent=function(e){var t=this,n=t._parent,r=t._parents;n&&n!==e?r?r.indexOf(e)===-1&&r.push(e):this._parents=[e]:this._parent=e},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();t.Subscription=l},function(e,t){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t){"use strict";function n(e){return null!=e&&"object"==typeof e}t.isObject=n},function(e,t,n){"use strict";function r(){try{return i.apply(this,arguments)}catch(e){return u.errorObject.e=e,u.errorObject}}function o(e){return i=e,r}var i,u=n(60);t.tryCatch=o},function(e,t){"use strict";t.errorObject={e:{}}},function(e,t){"use strict";var n=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=function(e){function t(t){e.call(this),this.errors=t;var n=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return n(t,e),t}(Error);t.UnsubscriptionError=r},function(e,t){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,n){"use strict";var r=n(52),o=r.root.Symbol;t.rxSubscriber="function"==typeof o&&"function"==typeof o.for?o.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber},function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}var o=n(52);t.getSymbolObservable=r,t.observable=r(o.root),t.$$observable=t.observable},function(e,t,n){function r(e){if(!i(e))return!1;var t=o(e);return t==a||t==s||t==u||t==c}var o=n(66),i=n(72),u="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";e.exports=r},function(e,t,n){function r(e){return null==e?void 0===e?s:a:c&&c in Object(e)?i(e):u(e)}var o=n(67),i=n(70),u=n(71),a="[object Null]",s="[object Undefined]",c=o?o.toStringTag:void 0;e.exports=r},function(e,t,n){var r=n(68),o=r.Symbol;e.exports=o},function(e,t,n){var r=n(69),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=u.call(e,s),n=e[s];try{e[s]=void 0}catch(e){}var r=a.call(e);return t?e[s]=n:delete e[s],r}var o=n(67),i=Object.prototype,u=i.hasOwnProperty,a=i.toString,s=o?o.toStringTag:void 0;e.exports=r},function(e,t){function n(e){return o.call(e)}var r=Object.prototype,o=r.toString;e.exports=n},function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e&&"function"==typeof e.then?e:a.default.resolve(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=function(e){return e&&e.__esModule?e:{default:e}}(u),s=function(){};t.Queue=function(){function e(t,n){r(this,e),this.pendingPromises=0,this.maxPendingPromises=void 0!==t?t:1/0,this.maxQueuedPromises=void 0!==n?n:1/0,this.queue=[]}return i(e,[{key:"add",value:function(e){var t=this;return new a.default(function(n,r,o){if(t.queue.length>=t.maxQueuedPromises)return void r(new Error("Queue limit reached"));t.queue.push({promiseGenerator:e,resolve:n,reject:r,notify:o||s}),t._dequeue()})}},{key:"getPendingLength",value:function(){return this.pendingPromises}},{key:"getQueueLength",value:function(){return this.queue.length}},{key:"_dequeue",value:function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var t=this.queue.shift();if(!t)return!1;try{this.pendingPromises+=1,o(t.promiseGenerator()).then(function(n){e.pendingPromises-=1,t.resolve(n),e._dequeue()},function(n){e.pendingPromises-=1,t.reject(n),e._dequeue()},function(e){t.notify(e)})}catch(e){this.pendingPromises-=1,t.reject(e),this._dequeue()}return!0}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=[],i=!1;return(0,d.default)(e)&&(0,_.isDefined)(n)&&(i=!0),Object.keys(e).forEach(function(u){var a=void 0,s=e[u],c=n?n+"["+(i?"":u)+"]":u;if((0,_.isDefined)(s)===!1){if(t.removeNull===!0)return;a=t.encodeComponents===!0?encodeURIComponent(c):c}else a=(0,v.default)(s)?o(s,t,c):t.encodeComponents?encodeURIComponent(c)+"="+encodeURIComponent(s):c+"="+s;r.push(a)}),r.join("&")}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.default.parse(e,!0),i=(0,b.default)(t)?c.default.parse(t):t,u=(0,f.default)({},r.query,i);n=(0,f.default)({encodeComponents:!0,removeNull:!1},n),r.query=null;var s=o(u,n);return r.search=(0,_.isDefined)(s)&&(0,m.default)(s)===!1?"?"+s:null,a.default.format(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.appendQuery=i;var u=n(75),a=r(u),s=n(82),c=r(s),l=n(87),f=r(l),h=n(119),d=r(h),p=n(129),v=r(p),y=n(131),b=r(y),g=n(132),m=r(g),_=n(44)},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&c.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}function i(e){return c.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)}function u(e,t){return o(e,!1,!0).resolve(t)}function a(e,t){return e?o(e,!1,!0).resolveObject(t):t}var s=n(76),c=n(78);t.parse=o,t.resolve=u,t.resolveObject=a,t.format=i,t.Url=r;var l=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["<",">",'"',"`"," ","\r","\n","\t"],p=["{","}","|","\\","^","`"].concat(d),v=["'"].concat(p),y=["%","/","?",";","#"].concat(v),b=["/","?","#"],g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=n(79);r.prototype.parse=function(e,t,n){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=r!==-1&&r<e.indexOf("#")?"?":"#",i=e.split(o);i[0]=i[0].replace(/\\/g,"/"),e=i.join(o);var u=e;if(u=u.trim(),!n&&1===e.split("#").length){var a=h.exec(u);if(a)return this.path=u,this.href=u,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?w.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=l.exec(u);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,u=u.substr(f.length)}if(n||f||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===u.substr(0,2);!p||f&&m[f]||(u=u.substr(2),this.slashes=!0)}if(!m[f]&&(p||f&&!_[f])){for(var k=-1,E=0;E<b.length;E++){var O=u.indexOf(b[E]);O!==-1&&(k===-1||O<k)&&(k=O)}var S,P;P=k===-1?u.lastIndexOf("@"):u.lastIndexOf("@",k),P!==-1&&(S=u.slice(0,P),u=u.slice(P+1),this.auth=decodeURIComponent(S)),k=-1;for(var E=0;E<y.length;E++){var O=u.indexOf(y[E]);O!==-1&&(k===-1||O<k)&&(k=O)}k===-1&&(k=u.length),this.host=u.slice(0,k),u=u.slice(k),this.parseHost(),this.hostname=this.hostname||"";var j="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!j)for(var x=this.hostname.split(/\./),E=0,T=x.length;E<T;E++){var C=x[E];if(C&&!C.match(/^[+a-z0-9A-Z_-]{0,63}$/)){for(var A="",M=0,R=C.length;M<R;M++)A+=C.charCodeAt(M)>127?"x":C[M];if(!A.match(/^[+a-z0-9A-Z_-]{0,63}$/)){var I=x.slice(0,E),q=x.slice(E+1),D=C.match(/^([+a-z0-9A-Z_-]{0,63})(.*)$/);D&&(I.push(D[1]),q.unshift(D[2])),q.length&&(u="/"+q.join(".")+u),this.hostname=I.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),j||(this.hostname=s.toASCII(this.hostname));var U=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+U,this.href+=this.host,j&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!g[d])for(var E=0,T=v.length;E<T;E++){var L=v[E];if(u.indexOf(L)!==-1){var K=encodeURIComponent(L);K===L&&(K=escape(L)),u=u.split(L).join(K)}}var B=u.indexOf("#");B!==-1&&(this.hash=u.substr(B),u=u.slice(0,B));var F=u.indexOf("?");if(F!==-1?(this.search=u.substr(F),this.query=u.substr(F+1),t&&(this.query=w.parse(this.query)),u=u.slice(0,F)):t&&(this.search="",this.query={}),u&&(this.pathname=u),_[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",H=this.search||"";this.path=U+H}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=w.stringify(this.query));var u=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||_[t])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),u&&"?"!==u.charAt(0)&&(u="?"+u),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),u=u.replace("#","%23"),t+o+n+u+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(c.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var u=o[i];n[u]=this[u]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),s=0;s<a.length;s++){var l=a[s];"protocol"!==l&&(n[l]=e[l])}return _[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!_[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var d=f[h];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||m[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var v=n.pathname||"",y=n.search||"";n.path=v+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=g||b||n.host&&e.pathname,k=w,E=n.pathname&&n.pathname.split("/")||[],p=e.pathname&&e.pathname.split("/")||[],O=n.protocol&&!_[n.protocol];if(O&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),w=w&&(""===p[0]||""===E[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,E=p;else if(p.length)E||(E=[]),E.pop(),E=E.concat(p),n.search=e.search,n.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(O){n.hostname=n.host=E.shift();var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return n.search=e.search,n.query=e.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=E.slice(-1)[0],j=(n.host||e.host||E.length>1)&&("."===P||".."===P)||""===P,x=0,T=E.length;T>=0;T--)P=E[T],"."===P?E.splice(T,1):".."===P?(E.splice(T,1),x++):x&&(E.splice(T,1),x--);if(!w&&!k)for(;x--;x)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),j&&"/"!==E.join("/").substr(-1)&&E.push("");var C=""===E[0]||E[0]&&"/"===E[0].charAt(0);if(O){n.hostname=n.host=C?"":E.length?E.shift():"";var S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");S&&(n.auth=S.shift(),n.host=n.hostname=S.shift())}return w=w||n.host&&E.length,w&&!C&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){var r;(function(e,o){!function(i){function u(e){throw RangeError(M[e])}function a(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function s(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(A,"."),r+a(e.split("."),t).join(".")}function c(e){for(var t,n,r=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function l(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=q(e>>>10&1023|55296),e=56320|1023&e),t+=q(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:w}function h(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function d(e,t,n){var r=0;for(e=n?I(e/S):e>>1,e+=I(e/t);e>R*E>>1;r+=w)e=I(e/R);return I(r+(R+1)*e/(e+O))}function p(e){var t,n,r,o,i,a,s,c,h,p,v=[],y=e.length,b=0,g=j,m=P;for(n=e.lastIndexOf(x),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&u("not-basic"),v.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=b,a=1,s=w;o>=y&&u("invalid-input"),c=f(e.charCodeAt(o++)),(c>=w||c>I((_-b)/a))&&u("overflow"),b+=c*a,h=s<=m?k:s>=m+E?E:s-m,!(c<h);s+=w)p=w-h,a>I(_/p)&&u("overflow"),a*=p;t=v.length+1,m=d(b-i,t,0==i),I(b/t)>_-g&&u("overflow"),g+=I(b/t),b%=t,v.splice(b++,0,g)}return l(v)}function v(e){var t,n,r,o,i,a,s,l,f,p,v,y,b,g,m,O=[];for(e=c(e),y=e.length,t=j,n=0,i=P,a=0;a<y;++a)(v=e[a])<128&&O.push(q(v));for(r=o=O.length,o&&O.push(x);r<y;){for(s=_,a=0;a<y;++a)(v=e[a])>=t&&v<s&&(s=v);for(b=r+1,s-t>I((_-n)/b)&&u("overflow"),n+=(s-t)*b,t=s,a=0;a<y;++a)if(v=e[a],v<t&&++n>_&&u("overflow"),v==t){for(l=n,f=w;p=f<=i?k:f>=i+E?E:f-i,!(l<p);f+=w)m=l-p,g=w-p,O.push(q(h(p+m%g,0))),l=I(m/g);O.push(q(h(l,0))),i=d(n,b,r==o),n=0,++r}++n,++t}return O.join("")}function y(e){return s(e,function(e){return T.test(e)?p(e.slice(4).toLowerCase()):e})}function b(e){return s(e,function(e){return C.test(e)?"xn--"+v(e):e})}var g=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof o&&o);g.global!==g&&g.window!==g&&g.self;var m,_=2147483647,w=36,k=1,E=26,O=38,S=700,P=72,j=128,x="-",T=/^xn--/,C=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=w-k,I=Math.floor,q=String.fromCharCode;m={version:"1.3.2",ucs2:{decode:c,encode:l},decode:p,encode:v,toASCII:b,toUnicode:y},void 0!==(r=function(){return m}.call(t,n,t,e))&&(e.exports=r)}()}).call(t,n(77)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(80),t.encode=t.stringify=n(81)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var a=e.length;u>0&&a>u&&(a=u);for(var s=0;s<a;++s){var c,l,f,h,d=e[s].replace(/\+/g,"%20"),p=d.indexOf(r);p>=0?(c=d.substr(0,p),l=d.substr(p+1)):(c=d,l=""),f=decodeURIComponent(c),h=decodeURIComponent(l),n(i,f)?Array.isArray(i[f])?i[f].push(h):i[f]=[i[f],h]:i[f]=h}return i}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(n(o))+r;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(n(e))}).join(t):i+encodeURIComponent(n(e[o]))}).join(t):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(e)):""}},function(e,t,n){"use strict";var r=n(83),o=n(86),i=n(85);e.exports={formats:i,parse:o,stringify:r}},function(e,t,n){"use strict";var r=n(84),o=n(85),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}
},u=Date.prototype.toISOString,a={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},s=function e(t,n,o,i,u,s,c,l,f,h,d,p){var v=t;if("function"==typeof c)v=c(n,v);else if(v instanceof Date)v=h(v);else if(null===v){if(i)return s&&!p?s(n,a.encoder):n;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||r.isBuffer(v)){if(s){return[d(p?n:s(n,a.encoder))+"="+d(s(v,a.encoder))]}return[d(n)+"="+d(String(v))]}var y=[];if(void 0===v)return y;var b;if(Array.isArray(c))b=c;else{var g=Object.keys(v);b=l?g.sort(l):g}for(var m=0;m<b.length;++m){var _=b[m];u&&null===v[_]||(y=Array.isArray(v)?y.concat(e(v[_],o(n,_),o,i,u,s,c,l,f,h,d,p)):y.concat(e(v[_],n+(f?"."+_:"["+_+"]"),o,i,u,s,c,l,f,h,d,p)))}return y};e.exports=function(e,t){var n=e,u=t?r.assign({},t):{};if(null!==u.encoder&&void 0!==u.encoder&&"function"!=typeof u.encoder)throw new TypeError("Encoder has to be a function.");var c=void 0===u.delimiter?a.delimiter:u.delimiter,l="boolean"==typeof u.strictNullHandling?u.strictNullHandling:a.strictNullHandling,f="boolean"==typeof u.skipNulls?u.skipNulls:a.skipNulls,h="boolean"==typeof u.encode?u.encode:a.encode,d="function"==typeof u.encoder?u.encoder:a.encoder,p="function"==typeof u.sort?u.sort:null,v=void 0!==u.allowDots&&u.allowDots,y="function"==typeof u.serializeDate?u.serializeDate:a.serializeDate,b="boolean"==typeof u.encodeValuesOnly?u.encodeValuesOnly:a.encodeValuesOnly;if(void 0===u.format)u.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,u.format))throw new TypeError("Unknown format option provided.");var g,m,_=o.formatters[u.format];"function"==typeof u.filter?(m=u.filter,n=m("",n)):Array.isArray(u.filter)&&(m=u.filter,g=m);var w=[];if("object"!=typeof n||null===n)return"";var k;k=u.arrayFormat in i?u.arrayFormat:"indices"in u?u.indices?"indices":"repeat":"indices";var E=i[k];g||(g=Object.keys(n)),p&&g.sort(p);for(var O=0;O<g.length;++O){var S=g[O];f&&null===n[S]||(w=w.concat(s(n[S],S,E,l,f,h?d:null,m,p,v,y,_,b)))}var P=w.join(c),j=u.addQueryPrefix===!0?"?":"";return P.length>0?j+P:""}},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,r=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),o=function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var r=[],o=0;o<t.length;++o)void 0!==t[o]&&r.push(t[o]);n.obj[n.prop]=r}}return t};t.arrayToObject=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},t.merge=function(e,r,o){if(!r)return e;if("object"!=typeof r){if(Array.isArray(e))e.push(r);else{if("object"!=typeof e)return[e,r];(o.plainObjects||o.allowPrototypes||!n.call(Object.prototype,r))&&(e[r]=!0)}return e}if("object"!=typeof e)return[e].concat(r);var i=e;return Array.isArray(e)&&!Array.isArray(r)&&(i=t.arrayToObject(e,o)),Array.isArray(e)&&Array.isArray(r)?(r.forEach(function(r,i){n.call(e,i)?e[i]&&"object"==typeof e[i]?e[i]=t.merge(e[i],r,o):e.push(r):e[i]=r}),e):Object.keys(r).reduce(function(e,i){var u=r[i];return n.call(e,i)?e[i]=t.merge(e[i],u,o):e[i]=u,e},i)},t.assign=function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",o=0;o<t.length;++o){var i=t.charCodeAt(o);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(o):i<128?n+=r[i]:i<2048?n+=r[192|i>>6]+r[128|63&i]:i<55296||i>=57344?n+=r[224|i>>12]+r[128|i>>6&63]+r[128|63&i]:(o+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(o)),n+=r[240|i>>18]+r[128|i>>12&63]+r[128|i>>6&63]+r[128|63&i])}return n},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var i=t[r],u=i.obj[i.prop],a=Object.keys(u),s=0;s<a.length;++s){var c=a[s],l=u[c];"object"==typeof l&&null!==l&&n.indexOf(l)===-1&&(t.push({obj:u,prop:c}),n.push(l))}return o(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t){"use strict";var n=String.prototype.replace;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,/%20/g,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){"use strict";var r=n(84),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},u=function(e,t){for(var n={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=t.parameterLimit===1/0?void 0:t.parameterLimit,a=r.split(t.delimiter,u),s=0;s<a.length;++s){var c,l,f=a[s],h=f.indexOf("]="),d=h===-1?f.indexOf("="):h+1;d===-1?(c=t.decoder(f,i.decoder),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,d),i.decoder),l=t.decoder(f.slice(d+1),i.decoder)),o.call(n,c)?n[c]=[].concat(n[c]).concat(l):n[c]=l}return n},a=function(e,t,n){for(var r=t,o=e.length-1;o>=0;--o){var i,u=e[o];if("[]"===u)i=[],i=i.concat(r);else{i=n.plainObjects?Object.create(null):{};var a="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,s=parseInt(a,10);!isNaN(s)&&u!==a&&String(s)===a&&s>=0&&n.parseArrays&&s<=n.arrayLimit?(i=[],i[s]=r):i[a]=r}r=i}return r},s=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/,u=/(\[[^[\]]*])/g,s=i.exec(r),c=s?r.slice(0,s.index):r,l=[];if(c){if(!n.plainObjects&&o.call(Object.prototype,c)&&!n.allowPrototypes)return;l.push(c)}for(var f=0;null!==(s=u.exec(r))&&f<n.depth;){if(f+=1,!n.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+r.slice(s.index)+"]"),a(l,t,n)}};e.exports=function(e,t){var n=t?r.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=n.ignoreQueryPrefix===!0,n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:i.delimiter,n.depth="number"==typeof n.depth?n.depth:i.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:i.arrayLimit,n.parseArrays=n.parseArrays!==!1,n.decoder="function"==typeof n.decoder?n.decoder:i.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:i.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:i.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:i.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:i.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:i.strictNullHandling,""===e||null===e||void 0===e)return n.plainObjects?Object.create(null):{};for(var o="string"==typeof e?u(e,n):e,a=n.plainObjects?Object.create(null):{},c=Object.keys(o),l=0;l<c.length;++l){var f=c[l],h=s(f,o[f],n);a=r.merge(a,h,n)}return r.compact(a)}},function(e,t,n){var r=n(88),o=n(98),i=n(99),u=n(109),a=n(112),s=n(113),c=Object.prototype,l=c.hasOwnProperty,f=i(function(e,t){if(a(t)||u(t))return void o(t,s(t),e);for(var n in t)l.call(t,n)&&r(e,n,t[n])});e.exports=f},function(e,t,n){function r(e,t,n){var r=e[t];a.call(e,t)&&i(r,n)&&(void 0!==n||t in e)||o(e,t,n)}var o=n(89),i=n(97),u=Object.prototype,a=u.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t,n){"__proto__"==t&&o?o(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var o=n(90);e.exports=r},function(e,t,n){var r=n(91),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){function r(e,t){var n=i(e,t);return o(n)?n:void 0}var o=n(92),i=n(96);e.exports=r},function(e,t,n){function r(e){return!(!u(e)||i(e))&&(o(e)?d:s).test(a(e))}var o=n(65),i=n(93),u=n(72),a=n(95),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,f=c.toString,h=l.hasOwnProperty,d=RegExp("^"+f.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t,n){function r(e){return!!i&&i in e}var o=n(94),i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,n){var r=n(68),o=r["__core-js_shared__"];e.exports=o},function(e,t){function n(e){if(null!=e){try{return o.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var r=Function.prototype,o=r.toString;e.exports=n},function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},function(e,t){function n(e,t){return e===t||e!==e&&t!==t}e.exports=n},function(e,t,n){function r(e,t,n,r){var u=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],l=r?r(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),u?i(n,c,l):o(n,c,l)}return n}var o=n(88),i=n(89);e.exports=r},function(e,t,n){function r(e){return o(function(t,n){var r=-1,o=n.length,u=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(u=e.length>3&&"function"==typeof u?(o--,u):void 0,a&&i(n[0],n[1],a)&&(u=o<3?void 0:u,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,u)}return t})}var o=n(100),i=n(108);e.exports=r},function(e,t,n){function r(e,t){return u(i(e,t,o),e+"")}var o=n(101),i=n(102),u=n(104);e.exports=r},function(e,t){function n(e){return e}e.exports=n},function(e,t,n){function r(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var r=arguments,u=-1,a=i(r.length-t,0),s=Array(a);++u<a;)s[u]=r[t+u];u=-1;for(var c=Array(t+1);++u<t;)c[u]=r[u];return c[t]=n(s),o(e,this,c)}}var o=n(103),i=Math.max;e.exports=r},function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}e.exports=n},function(e,t,n){var r=n(105),o=n(107),i=o(r);e.exports=i},function(e,t,n){var r=n(106),o=n(90),i=n(101),u=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=u},function(e,t){function n(e){return function(){return e}}e.exports=n},function(e,t){function n(e){var t=0,n=0;return function(){var u=i(),a=o-(u-n);if(n=u,a>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var r=800,o=16,i=Date.now;e.exports=n},function(e,t,n){function r(e,t,n){if(!a(n))return!1;var r=typeof t;return!!("number"==r?i(n)&&u(t,n.length):"string"==r&&t in n)&&o(n[t],e)}var o=n(97),i=n(109),u=n(111),a=n(72);e.exports=r},function(e,t,n){function r(e){return null!=e&&i(e.length)&&!o(e)}var o=n(65),i=n(110);e.exports=r},function(e,t){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}var r=9007199254740991;e.exports=n},function(e,t){function n(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=n},function(e,t){function n(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}var r=Object.prototype;e.exports=n},function(e,t,n){function r(e){return u(e)?o(e):i(e)}var o=n(114),i=n(126),u=n(109);e.exports=r},function(e,t,n){function r(e,t){var n=u(e),r=!n&&i(e),l=!n&&!r&&a(e),h=!n&&!r&&!l&&c(e),d=n||r||l||h,p=d?o(e.length,String):[],v=p.length;for(var y in e)!t&&!f.call(e,y)||d&&("length"==y||l&&("offset"==y||"parent"==y)||h&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,v))||p.push(y);return p}var o=n(115),i=n(116),u=n(119),a=n(120),s=n(111),c=n(122),l=Object.prototype,f=l.hasOwnProperty;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){var r=n(117),o=n(118),i=Object.prototype,u=i.hasOwnProperty,a=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return o(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t,n){function r(e){return i(e)&&o(e)==u}var o=n(66),i=n(118),u="[object Arguments]";e.exports=r},function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){(function(e){var r=n(68),o=n(121),i="object"==typeof t&&t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=u&&u.exports===i,s=a?r.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||o;e.exports=l}).call(t,n(77)(e))},function(e,t){function n(){return!1}e.exports=n},function(e,t,n){var r=n(123),o=n(124),i=n(125),u=i&&i.isTypedArray,a=u?o(u):r;e.exports=a},function(e,t,n){function r(e){return u(e)&&i(e.length)&&!!a[o(e)]}var o=n(66),i=n(110),u=n(118),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=r},function(e,t){function n(e){return function(t){return e(t)}}e.exports=n},function(e,t,n){(function(e){var r=n(69),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o,a=u&&r.process,s=function(){try{return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(t,n(77)(e))},function(e,t,n){function r(e){if(!o(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}var o=n(112),i=n(127),u=Object.prototype,a=u.hasOwnProperty;e.exports=r},function(e,t,n){var r=n(128),o=r(Object.keys,Object);e.exports=o},function(e,t){function n(e,t){return function(n){return e(t(n))}}e.exports=n},function(e,t,n){function r(e){if(!u(e)||o(e)!=a)return!1;var t=i(e);if(null===t)return!0;var n=f.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==h}var o=n(66),i=n(130),u=n(118),a="[object Object]",s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,h=l.call(Object);e.exports=r},function(e,t,n){var r=n(128),o=r(Object.getPrototypeOf,Object);e.exports=o},function(e,t,n){function r(e){return"string"==typeof e||!i(e)&&u(e)&&o(e)==a}var o=n(66),i=n(119),u=n(118),a="[object String]";e.exports=r},function(e,t,n){function r(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||f(e)||u(e)))return!e.length;var t=i(e);if(t==h||t==d)return!e.size;if(l(e))return!o(e).length;for(var n in e)if(v.call(e,n))return!1;return!0}var o=n(126),i=n(133),u=n(116),a=n(119),s=n(109),c=n(120),l=n(112),f=n(122),h="[object Map]",d="[object Set]",p=Object.prototype,v=p.hasOwnProperty;e.exports=r},function(e,t,n){var r=n(134),o=n(135),i=n(136),u=n(137),a=n(138),s=n(66),c=n(95),l=c(r),f=c(o),h=c(i),d=c(u),p=c(a),v=s;(r&&"[object DataView]"!=v(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=v(new o)||i&&"[object Promise]"!=v(i.resolve())||u&&"[object Set]"!=v(new u)||a&&"[object WeakMap]"!=v(new a))&&(v=function(e){var t=s(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case d:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=v},function(e,t,n){var r=n(91),o=n(68),i=r(o,"DataView");e.exports=i},function(e,t,n){var r=n(91),o=n(68),i=r(o,"Map");e.exports=i},function(e,t,n){var r=n(91),o=n(68),i=r(o,"Promise");e.exports=i},function(e,t,n){var r=n(91),o=n(68),i=r(o,"Set");e.exports=i},function(e,t,n){var r=n(91),o=n(68),i=r(o,"WeakMap");e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=t.SyncStore=t.SyncOperation=t.NetworkStore=t.FileStore=t.DataStoreType=t.CacheStore=void 0;var o=n(140),i=r(o),u=n(352),a=r(u),s=n(354),c=r(s),l=n(350),f=r(l),h=n(353),d=r(h),p=n(355),v=r(p),y=n(351);t.CacheStore=i.default,t.DataStoreType=u.DataStoreType,t.FileStore=c.default,t.NetworkStore=f.default,t.SyncOperation=y.SyncOperation,t.SyncStore=d.default,t.UserStore=v.default,t.default=a.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},c=n(48),l=r(c),f=n(141),h=r(f),d=n(87),p=r(d),v=n(225),y=r(v),b=n(234),g=r(b),m=n(119),_=r(m),w=n(65),k=(r(w),n(239)),E=r(k),O=n(242),S=r(O),P=n(75),j=r(P),x=n(244),T=n(2),C=n(275),A=r(C),M=n(286),R=r(M),I=n(331),q=n(40),D=n(350),U=r(D),N=n(351),L=r(N),K=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.ttl=n.ttl||void 0,r.syncManager=new L.default(r.collection,n),r}return u(t,e),a(t,[{key:"find",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=(0,p.default)({syncAutomatically:this.syncAutomatically},r);var o=r.syncAutomatically===!0;return q.KinveyObservable.create(function(i){return!e||e instanceof A.default?new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,query:e,timeout:r.timeout}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.next(u),o===!0?n.pendingSyncCount(e,r).then(function(t){return t>0?n.push(e,r).then(function(){return n.pendingSyncCount(e,r)}):t}).then(function(o){if(o>0)throw new T.KinveyError("Unable to fetch the entities on the backend. There are "+o+" entities that need to be synced.");return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",n).call(n,e,r).toPromise()}).then(function(e){var t=(0,h.default)(u,e,"_id"),o=Object.keys((0,y.default)(t,"_id")),i=(new A.default).contains("_id",o);return n.clear(i,r).then(function(){return e})}).then(function(e){return new x.CacheRequest({method:x.RequestMethod.PUT,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,body:e,timeout:r.timeout}).execute().then(function(e){return e.data})}):u}).then(function(e){i.next(e)}).then(function(){i.complete()}).catch(function(e){return i.error(e)}):i.error(new T.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"findById",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=(0,p.default)({syncAutomatically:this.syncAutomatically},r);var o=r.syncAutomatically===!0;return q.KinveyObservable.create(function(i){return(0,q.isDefined)(e)===!1?(i.next(void 0),i.complete()):new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/"+e}),properties:r.properties,timeout:r.timeout}).execute().then(function(e){return e.data}).catch(function(){}).then(function(u){if(i.next(u),o===!0){var a=new A.default;return a.equalTo("_id",e),n.pendingSyncCount(a,r).then(function(e){return e>0?n.push(a,r).then(function(){return n.pendingSyncCount(a,r)}):e}).then(function(e){if(e>0)throw new T.KinveyError("Unable to find the entity on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",n).call(n,e,r).toPromise()}).then(function(e){return new x.CacheRequest({method:x.RequestMethod.PUT,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,body:e,timeout:r.timeout}).execute().then(function(e){return e.data})})}return u}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)})})}},{key:"group",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=(0,p.default)({syncAutomatically:this.syncAutomatically},r);var o=r.syncAutomatically===!0;return q.KinveyObservable.create(function(i){return e instanceof R.default?new x.CacheRequest({method:x.RequestMethod.POST,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/_group"}),properties:r.properties,aggregation:e,timeout:r.timeout}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.next(u),o===!0?n.pendingSyncCount(null,r).then(function(e){return e>0?n.push(null,r).then(function(){return n.pendingSyncCount(null,r)}):e}).then(function(o){if(o>0)throw new T.KinveyError("Unable to group entities on the backend. There are "+o+" entities that need to be synced.");return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"group",n).call(n,e,r).toPromise()}):u}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)}):i.error(new T.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=(0,p.default)({syncAutomatically:this.syncAutomatically},r);var o=r.syncAutomatically===!0;return q.KinveyObservable.create(function(i){return!e||e instanceof A.default?new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,query:e,timeout:r.timeout}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).length}).then(function(u){return i.next(u),o===!0?n.pendingSyncCount(e,r).then(function(t){return t>0?n.push(e,r).then(function(){return n.pendingSyncCount(e,r)}):t}).then(function(e){if(e>0)throw new T.KinveyError("Unable to count entities on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"count",n).call(n,e,r).toPromise()}):u}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)}):i.error(new T.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"create",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q.KinveyObservable.create(function(r){return(0,q.isDefined)(e)===!1?(r.next(null),r.complete()):(0,_.default)(e)?r.error(new T.KinveyError("Unable to create an array of entities.","Please create entities one by one.")):new x.CacheRequest({method:x.RequestMethod.POST,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,body:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addCreateOperation(e,n).then(function(){return e})}).then(function(e){if(t.syncAutomatically===!0){var r=(new A.default).equalTo("_id",e._id);return t.push(r,n).then(function(e){var t=e[0];if((0,q.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q.KinveyObservable.create(function(r){return(0,q.isDefined)(e)===!1?(r.next(null),r.complete()):(0,_.default)(e)?r.error(new T.KinveyError("Unable to update an array of entities.","Please update entities one by one.")):(0,q.isDefined)(e._id)===!1?r.error(new T.KinveyError("The entity provided does not contain an _id. An _id is required to update the entity.",e)):new x.CacheRequest({method:x.RequestMethod.PUT,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,body:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addUpdateOperation(e,n).then(function(){return e})}).then(function(e){if(t.syncAutomatically===!0){var r=(new A.default).equalTo("_id",e._id);return t.push(r,n).then(function(e){var t=e[0];if((0,q.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q.KinveyObservable.create(function(r){return!e||e instanceof A.default?new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length>0?l.default.all((0,S.default)(e,function(e){if(new I.Metadata(e).isLocal()){var r=new A.default;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return t.syncManager.addDeleteOperation(e,n).then(function(){return e})})).then(function(){return e}):e}).then(function(e){if(e.length>0&&t.syncAutomatically===!0){var r=(0,g.default)(e,function(e){return new I.Metadata(e).isLocal()}),o=Object.keys((0,y.default)(e,"_id")),i=(new A.default).contains("_id",o);return t.push(i,n).then(function(e){return e.concat(r)})}return e}).then(function(e){return l.default.all((0,S.default)(e,function(e){return(0,q.isDefined)(e.error)===!1?new x.CacheRequest({method:x.RequestMethod.DELETE,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:x.AuthType.Default,timeout:n.timeout}).execute().then(function(e){return e.data}):{count:0}}))}).then(function(e){return(0,E.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then().then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new T.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise()}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q.KinveyObservable.create(function(r){return(0,q.isDefined)(e)===!1?(r.next({count:0}),r.complete()):new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,authType:x.AuthType.Default,timeout:n.timeout}).execute().then(function(e){return e.data}).catch(function(e){if(e instanceof T.NotFoundError)return null;throw e}).then(function(e){if((0,q.isDefined)(e)){if(new I.Metadata(e).isLocal()){var r=new A.default;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return t.syncManager.addDeleteOperation(e,n).then(function(){return e})}return e}).then(function(e){if(t.syncAutomatically===!0){var r=(new A.default).equalTo("_id",e._id);return t.push(r,n).then(function(){return e})}return e}).then(function(e){return new x.CacheRequest({method:x.RequestMethod.DELETE,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:x.AuthType.Default,timeout:n.timeout}).execute().then(function(e){return e.data})}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"clear",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q.KinveyObservable.create(function(r){return!e||e instanceof A.default?new x.CacheRequest({method:x.RequestMethod.GET,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l.default.all((0,S.default)(e,function(e){return l.default.resolve(e).then(function(e){if(new I.Metadata(e).isLocal()){var r=new A.default;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return e}).then(function(e){return new x.CacheRequest({method:x.RequestMethod.DELETE,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:x.AuthType.Default,timeout:n.timeout}).execute().then(function(e){return e.data})})}))}).then(function(e){return(0,E.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new T.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise()}},{key:"pendingSyncCount",value:function(e,t){return this.syncManager.count(e,t)}},{key:"pendingSyncEntities",value:function(e,t){return this.syncManager.find(e,t)}},{key:"push",value:function(e,t){return this.syncManager.push(e,t)}},{key:"pull",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=(0,p.default)({useDeltaFetch:this.useDeltaFetch},n),this.syncManager.pull(e,n).then(function(r){return t.clear(e,n).then(function(){return new x.CacheRequest({method:x.RequestMethod.PUT,url:j.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,body:r,timeout:n.timeout}).execute()}).then(function(){return r})})}},{key:"sync",value:function(e,t){var n=this;return t=(0,p.default)({useDeltaFetch:this.useDeltaFetch},t),this.push(e,t).then(function(r){return n.pull(e,t).then(function(e){return{push:r,pull:e}})})}},{key:"clearSync",value:function(e,t){return this.syncManager.clear(e,t)}},{key:"syncAutomatically",get:function(){return!0}}]),t}(U.default);t.default=K},function(e,t,n){var r=n(142),o=n(176),i=n(179),u=n(100),a=n(223),s=n(224),c=u(function(e,t){var n=s(t);return a(n)&&(n=void 0),a(e)?r(e,o(t,1,a,!0),i(n,2)):[]});e.exports=c},function(e,t,n){function r(e,t,n,r){var f=-1,h=i,d=!0,p=e.length,v=[],y=t.length;if(!p)return v;n&&(t=a(t,s(n))),r?(h=u,d=!1):t.length>=l&&(h=c,d=!1,t=new o(t));e:for(;++f<p;){var b=e[f],g=null==n?b:n(b);if(b=r||0!==b?b:0,d&&g===g){for(var m=y;m--;)if(t[m]===g)continue e;v.push(b)}else h(t,g,r)||v.push(b)}return v}var o=n(143),i=n(168),u=n(173),a=n(174),s=n(124),c=n(175),l=200;e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o;++t<n;)this.add(e[t])}
var o=n(144),i=n(166),u=n(167);r.prototype.add=r.prototype.push=i,r.prototype.has=u,e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(145),i=n(160),u=n(163),a=n(164),s=n(165);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t,n){function r(){this.size=0,this.__data__={hash:new o,map:new(u||i),string:new o}}var o=n(146),i=n(153),u=n(135);e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(147),i=n(149),u=n(150),a=n(151),s=n(152);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t,n){function r(){this.__data__=o?o(null):{},this.size=0}var o=n(148);e.exports=r},function(e,t,n){var r=n(91),o=r(Object,"create");e.exports=o},function(e,t){function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}e.exports=n},function(e,t,n){function r(e){var t=this.__data__;if(o){var n=t[e];return n===i?void 0:n}return a.call(t,e)?t[e]:void 0}var o=n(148),i="__lodash_hash_undefined__",u=Object.prototype,a=u.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){var t=this.__data__;return o?void 0!==t[e]:u.call(t,e)}var o=n(148),i=Object.prototype,u=i.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o&&void 0===t?i:t,this}var o=n(148),i="__lodash_hash_undefined__";e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(154),i=n(155),u=n(157),a=n(158),s=n(159);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t){function n(){this.__data__=[],this.size=0}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);return!(n<0)&&(n==t.length-1?t.pop():u.call(t,n,1),--this.size,!0)}var o=n(156),i=Array.prototype,u=i.splice;e.exports=r},function(e,t,n){function r(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1}var o=n(97);e.exports=r},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]}var o=n(156);e.exports=r},function(e,t,n){function r(e){return o(this.__data__,e)>-1}var o=n(156);e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var o=n(156);e.exports=r},function(e,t,n){function r(e){var t=o(this,e).delete(e);return this.size-=t?1:0,t}var o=n(161);e.exports=r},function(e,t,n){function r(e,t){var n=e.__data__;return o(t)?n["string"==typeof t?"string":"hash"]:n.map}var o=n(162);e.exports=r},function(e,t){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=n},function(e,t,n){function r(e){return o(this,e).get(e)}var o=n(161);e.exports=r},function(e,t,n){function r(e){return o(this,e).has(e)}var o=n(161);e.exports=r},function(e,t,n){function r(e,t){var n=o(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var o=n(161);e.exports=r},function(e,t){function n(e){return this.__data__.set(e,r),this}var r="__lodash_hash_undefined__";e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t,n){function r(e,t){return!!(null==e?0:e.length)&&o(e,t,0)>-1}var o=n(169);e.exports=r},function(e,t,n){function r(e,t,n){return t===t?u(e,t,n):o(e,i,n)}var o=n(170),i=n(171),u=n(172);e.exports=r},function(e,t){function n(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}e.exports=n},function(e,t){function n(e){return e!==e}e.exports=n},function(e,t){function n(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}e.exports=n},function(e,t){function n(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}e.exports=n},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}e.exports=n},function(e,t){function n(e,t){return e.has(t)}e.exports=n},function(e,t,n){function r(e,t,n,u,a){var s=-1,c=e.length;for(n||(n=i),a||(a=[]);++s<c;){var l=e[s];t>0&&n(l)?t>1?r(l,t-1,n,u,a):o(a,l):u||(a[a.length]=l)}return a}var o=n(177),i=n(178);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}e.exports=n},function(e,t,n){function r(e){return u(e)||i(e)||!!(a&&e&&e[a])}var o=n(67),i=n(116),u=n(119),a=o?o.isConcatSpreadable:void 0;e.exports=r},function(e,t,n){function r(e){return"function"==typeof e?e:null==e?u:"object"==typeof e?a(e)?i(e[0],e[1]):o(e):s(e)}var o=n(180),i=n(205),u=n(101),a=n(119),s=n(220);e.exports=r},function(e,t,n){function r(e){var t=i(e);return 1==t.length&&t[0][2]?u(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}var o=n(181),i=n(202),u=n(204);e.exports=r},function(e,t,n){function r(e,t,n,r){var s=n.length,c=s,l=!r;if(null==e)return!c;for(e=Object(e);s--;){var f=n[s];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++s<c;){f=n[s];var h=f[0],d=e[h],p=f[1];if(l&&f[2]){if(void 0===d&&!(h in e))return!1}else{var v=new o;if(r)var y=r(d,p,h,e,t,v);if(!(void 0===y?i(p,d,u|a,r,v):y))return!1}}return!0}var o=n(182),i=n(188),u=1,a=2;e.exports=r},function(e,t,n){function r(e){var t=this.__data__=new o(e);this.size=t.size}var o=n(153),i=n(183),u=n(184),a=n(185),s=n(186),c=n(187);r.prototype.clear=i,r.prototype.delete=u,r.prototype.get=a,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,n){function r(){this.__data__=new o,this.size=0}var o=n(153);e.exports=r},function(e,t){function n(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}e.exports=n},function(e,t){function n(e){return this.__data__.get(e)}e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t,n){function r(e,t){var n=this.__data__;if(n instanceof o){var r=n.__data__;if(!i||r.length<a-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new u(r)}return n.set(e,t),this.size=n.size,this}var o=n(153),i=n(135),u=n(144),a=200;e.exports=r},function(e,t,n){function r(e,t,n,u,a){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!==e&&t!==t:o(e,t,n,u,r,a))}var o=n(189),i=n(118);e.exports=r},function(e,t,n){function r(e,t,n,r,y,g){var m=c(e),_=c(t),w=m?p:s(e),k=_?p:s(t);w=w==d?v:w,k=k==d?v:k;var E=w==v,O=k==v,S=w==k;if(S&&l(e)){if(!l(t))return!1;m=!0,E=!1}if(S&&!E)return g||(g=new o),m||f(e)?i(e,t,n,r,y,g):u(e,t,w,n,r,y,g);if(!(n&h)){var P=E&&b.call(e,"__wrapped__"),j=O&&b.call(t,"__wrapped__");if(P||j){var x=P?e.value():e,T=j?t.value():t;return g||(g=new o),y(x,T,n,r,g)}}return!!S&&(g||(g=new o),a(e,t,n,r,y,g))}var o=n(182),i=n(190),u=n(192),a=n(196),s=n(133),c=n(119),l=n(120),f=n(122),h=1,d="[object Arguments]",p="[object Array]",v="[object Object]",y=Object.prototype,b=y.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t,n,r,c,l){var f=n&a,h=e.length,d=t.length;if(h!=d&&!(f&&d>h))return!1;var p=l.get(e);if(p&&l.get(t))return p==t;var v=-1,y=!0,b=n&s?new o:void 0;for(l.set(e,t),l.set(t,e);++v<h;){var g=e[v],m=t[v];if(r)var _=f?r(m,g,v,t,e,l):r(g,m,v,e,t,l);if(void 0!==_){if(_)continue;y=!1;break}if(b){if(!i(t,function(e,t){if(!u(b,t)&&(g===e||c(g,e,n,r,l)))return b.push(t)})){y=!1;break}}else if(g!==m&&!c(g,m,n,r,l)){y=!1;break}}return l.delete(e),l.delete(t),y}var o=n(143),i=n(191),u=n(175),a=1,s=2;e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}e.exports=n},function(e,t,n){function r(e,t,n,r,o,E,S){switch(n){case k:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!E(new i(e),new i(t)));case h:case d:case y:return u(+e,+t);case p:return e.name==t.name&&e.message==t.message;case b:case m:return e==t+"";case v:var P=s;case g:var j=r&l;if(P||(P=c),e.size!=t.size&&!j)return!1;var x=S.get(e);if(x)return x==t;r|=f,S.set(e,t);var T=a(P(e),P(t),r,o,E,S);return S.delete(e),T;case _:if(O)return O.call(e)==O.call(t)}return!1}var o=n(67),i=n(193),u=n(97),a=n(190),s=n(194),c=n(195),l=1,f=2,h="[object Boolean]",d="[object Date]",p="[object Error]",v="[object Map]",y="[object Number]",b="[object RegExp]",g="[object Set]",m="[object String]",_="[object Symbol]",w="[object ArrayBuffer]",k="[object DataView]",E=o?o.prototype:void 0,O=E?E.valueOf:void 0;e.exports=r},function(e,t,n){var r=n(68),o=r.Uint8Array;e.exports=o},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}e.exports=n},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}e.exports=n},function(e,t,n){function r(e,t,n,r,u,s){var c=n&i,l=o(e),f=l.length;if(f!=o(t).length&&!c)return!1;for(var h=f;h--;){var d=l[h];if(!(c?d in t:a.call(t,d)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var v=!0;s.set(e,t),s.set(t,e);for(var y=c;++h<f;){d=l[h];var b=e[d],g=t[d];if(r)var m=c?r(g,b,d,t,e,s):r(b,g,d,e,t,s);if(!(void 0===m?b===g||u(b,g,n,r,s):m)){v=!1;break}y||(y="constructor"==d)}if(v&&!y){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w)&&(v=!1)}return s.delete(e),s.delete(t),v}var o=n(197),i=1,u=Object.prototype,a=u.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){return o(e,u,i)}var o=n(198),i=n(199),u=n(113);e.exports=r},function(e,t,n){function r(e,t,n){var r=t(e);return i(e)?r:o(r,n(e))}var o=n(177),i=n(119);e.exports=r},function(e,t,n){var r=n(200),o=n(201),i=Object.prototype,u=i.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),function(t){return u.call(e,t)}))}:o;e.exports=s},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var u=e[n];t(u,n,e)&&(i[o++]=u)}return i}e.exports=n},function(e,t){function n(){return[]}e.exports=n},function(e,t,n){function r(e){for(var t=i(e),n=t.length;n--;){var r=t[n],u=e[r];t[n]=[r,u,o(u)]}return t}var o=n(203),i=n(113);e.exports=r},function(e,t,n){function r(e){return e===e&&!o(e)}var o=n(72);e.exports=r},function(e,t){function n(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}e.exports=n},function(e,t,n){function r(e,t){return a(e)&&s(t)?c(l(e),t):function(n){var r=i(n,e);return void 0===r&&r===t?u(n,e):o(t,r,f|h)}}var o=n(188),i=n(206),u=n(217),a=n(209),s=n(203),c=n(204),l=n(216),f=1,h=2;e.exports=r},function(e,t,n){function r(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}var o=n(207);e.exports=r},function(e,t,n){function r(e,t){t=o(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[i(t[n++])];return n&&n==r?e:void 0}var o=n(208),i=n(216);e.exports=r},function(e,t,n){function r(e,t){return o(e)?e:i(e,t)?[e]:u(a(e))}var o=n(119),i=n(209),u=n(211),a=n(214);e.exports=r},function(e,t,n){function r(e,t){if(o(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(a.test(e)||!u.test(e)||null!=t&&e in Object(t))}var o=n(119),i=n(210),u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=r},function(e,t,n){function r(e){return"symbol"==typeof e||i(e)&&o(e)==u}var o=n(66),i=n(118),u="[object Symbol]";e.exports=r},function(e,t,n){var r=n(212),o=/^\./,i=r(function(e){var t=[];return o.test(e)&&t.push(""),e.replace(/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,function(e,n,r,o){t.push(r?o.replace(/\\(\\)?/g,"$1"):n||e)}),t});e.exports=i},function(e,t,n){function r(e){var t=o(e,function(e){return n.size===i&&n.clear(),e}),n=t.cache;return t}var o=n(213),i=500;e.exports=r},function(e,t,n){function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=e.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(r.Cache||o),n}var o=n(144),i="Expected a function";r.Cache=o,e.exports=r},function(e,t,n){function r(e){return null==e?"":o(e)}var o=n(215);e.exports=r},function(e,t,n){function r(e){if("string"==typeof e)return e;if(u(e))return i(e,r)+"";if(a(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}var o=n(67),i=n(174),u=n(119),a=n(210),s=1/0,c=o?o.prototype:void 0,l=c?c.toString:void 0;e.exports=r},function(e,t,n){function r(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}var o=n(210),i=1/0;e.exports=r},function(e,t,n){function r(e,t){return null!=e&&i(e,t,o)}var o=n(218),i=n(219);e.exports=r},function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},function(e,t,n){function r(e,t,n){t=o(t,e);for(var r=-1,l=t.length,f=!1;++r<l;){var h=c(t[r]);if(!(f=null!=e&&n(e,h)))break;e=e[h]}return f||++r!=l?f:!!(l=null==e?0:e.length)&&s(l)&&a(h,l)&&(u(e)||i(e))}var o=n(208),i=n(116),u=n(119),a=n(111),s=n(110),c=n(216);e.exports=r},function(e,t,n){function r(e){return u(e)?o(a(e)):i(e)}var o=n(221),i=n(222),u=n(209),a=n(216);e.exports=r},function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},function(e,t,n){function r(e){return function(t){return o(t,e)}}var o=n(207);e.exports=r},function(e,t,n){function r(e){return i(e)&&o(e)}var o=n(109),i=n(118);e.exports=r},function(e,t){function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}e.exports=n},function(e,t,n){var r=n(89),o=n(226),i=o(function(e,t,n){r(e,n,t)});e.exports=i},function(e,t,n){function r(e,t){return function(n,r){var s=a(n)?o:i,c=t?t():{};return s(n,e,u(r,2),c)}}var o=n(227),i=n(228),u=n(179),a=n(119);e.exports=r},function(e,t){function n(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var u=e[o];t(r,u,n(u),e)}return r}e.exports=n},function(e,t,n){function r(e,t,n,r){return o(e,function(e,o,i){t(r,e,n(e),i)}),r}var o=n(229);e.exports=r},function(e,t,n){var r=n(230),o=n(233),i=o(r);e.exports=i},function(e,t,n){function r(e,t){return e&&o(e,t,i)}var o=n(231),i=n(113);e.exports=r},function(e,t,n){var r=n(232),o=r();e.exports=o},function(e,t){function n(e){return function(t,n,r){for(var o=-1,i=Object(t),u=r(t),a=u.length;a--;){var s=u[e?a:++o];if(n(i[s],s,i)===!1)break}return t}}e.exports=n},function(e,t,n){function r(e,t){return function(n,r){if(null==n)return n;if(!o(n))return e(n,r);for(var i=n.length,u=t?i:-1,a=Object(n);(t?u--:++u<i)&&r(a[u],u,a)!==!1;);return n}}var o=n(109);e.exports=r},function(e,t,n){function r(e,t){var n=[];if(!e||!e.length)return n;var r=-1,u=[],a=e.length;for(t=o(t,3);++r<a;){var s=e[r];t(s,r,e)&&(n.push(s),u.push(r))}return i(e,u),n}var o=n(179),i=n(235);e.exports=r},function(e,t,n){function r(e,t){for(var n=e?t.length:0,r=n-1;n--;){var u=t[n];if(n==r||u!==s){var s=u;i(u)?a.call(e,u,1):o(e,u)}}return e}var o=n(236),i=n(111),u=Array.prototype,a=u.splice;e.exports=r},function(e,t,n){function r(e,t){return t=o(t,e),null==(e=u(e,t))||delete e[a(i(t))]}var o=n(208),i=n(224),u=n(237),a=n(216);e.exports=r},function(e,t,n){function r(e,t){return t.length<2?e:o(e,i(t,0,-1))}var o=n(207),i=n(238);e.exports=r},function(e,t){function n(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}e.exports=n},function(e,t,n){function r(e,t,n){var r=s(e)?o:a,c=arguments.length<3;return r(e,u(t,4),n,c,i)}var o=n(240),i=n(229),u=n(179),a=n(241),s=n(119);e.exports=r},function(e,t){function n(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}e.exports=n},function(e,t){function n(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}e.exports=n},function(e,t,n){function r(e,t){return(a(e)?o:u)(e,i(t,3))}var o=n(174),i=n(179),u=n(243),a=n(119);e.exports=r},function(e,t,n){function r(e,t){var n=-1,r=i(e)?Array(e.length):[];return o(e,function(e,o,i){r[++n]=t(e,o,i)}),r}var o=n(229),i=n(109);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.StatusCode=t.SerializeMiddleware=t.Response=t.RequestMethod=t.Rack=t.Properties=t.ParseMiddleware=t.NetworkRequest=t.NetworkRack=t.Middleware=t.MemoryAdapter=t.KinveyResponse=t.KinveyRequest=t.HttpMiddleware=t.Headers=t.DeltaFetchRequest=t.CacheRequest=t.CacheRack=t.CacheMiddleware=t.AuthType=void 0;var o=n(245),i=r(o),u=n(313),a=r(u),s=n(294),c=r(s),l=n(315),f=r(l),h=n(287),d=r(h),p=n(293),v=r(p),y=n(295),b=r(y),g=n(298),m=r(g);t.AuthType=l.AuthType,t.CacheMiddleware=g.CacheMiddleware,t.CacheRack=y.CacheRack,t.CacheRequest=i.default,t.DeltaFetchRequest=a.default,t.Headers=c.default,t.HttpMiddleware=g.HttpMiddleware,t.KinveyRequest=l.KinveyRequest,t.KinveyResponse=p.KinveyResponse,t.MemoryAdapter=g.MemoryAdapter,t.Middleware=m.default,t.NetworkRack=y.NetworkRack,t.NetworkRequest=f.default,t.ParseMiddleware=g.ParseMiddleware,t.Properties=l.Properties,t.Rack=b.default,t.RequestMethod=h.RequestMethod,t.Response=v.default,t.SerializeMiddleware=g.SerializeMiddleware,t.StatusCode=p.StatusCode,t.Storage=g.Storage,t.default=d.default},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r},c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},l=n(246),f=(r(l),n(75)),h=r(f),d=n(248),p=r(d),v=n(2),y=n(275),b=r(y),g=n(286),m=r(g),_=n(40),w=n(287),k=r(w),E=n(293),O=n(295),S=function(t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,n);var t=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.aggregation=e.aggregation,t.query=e.query,t.rack=O.CacheRack,t}return u(n,t),a(n,[{key:"execute",value:function(){var e=this;return c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"execute",this).call(this).then(function(t){if(t instanceof E.KinveyResponse||(t=new E.KinveyResponse({statusCode:t.statusCode,headers:t.headers,data:t.data})),!t.isSuccess())throw t.error;return(0,_.isDefined)(e.query)&&(0,_.isDefined)(t.data)&&(t.data=e.query.process(t.data)),(0,_.isDefined)(e.aggregation)&&(0,_.isDefined)(t.data)&&(t.data=e.aggregation.process(t.data)),t})}},{key:"toPlainObject",value:function(){var e=c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toPlainObject",this).call(this);return e.appKey=this.appKey,e.collection=this.collection,e.entityId=this.entityId,e.encryptionKey=this.client?this.client.encryptionKey:void 0,e}},{key:"body",get:function(){return this._body},set:function(e){this._body=(0,p.default)(e)}},{key:"query",get:function(){return this._query},set:function(e){if((0,_.isDefined)(e)&&!(e instanceof b.default))throw new v.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,_.isDefined)(e)&&!(e instanceof m.default))throw new v.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");this._aggregation=e}},{key:"url",get:function(){return c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"url",this)},set:function(t){s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"url",t,this);var r=e.decodeURIComponent(h.default.parse(t).pathname),o=r.replace(/^\//,"").split("/");this.appKey=o[1],this.collection=o[2],this.entityId=o[3]}}]),n}(k.default);t.default=S}).call(t,function(){return this}())},function(e,t,n){var r,o,i,u=[].slice;!function(u,a){null!=n(247)?(o=[],r=a,!(void 0!==(i="function"==typeof r?r.apply(t,o):r)&&(e.exports=i))):void 0!==t&&null!==t?e.exports=a():u.UrlPattern=a()}(this,function(){var e,t,n,r,o,i,a,s,c,l,f,h,d,p,v;return c=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},a=function(e,t){var n,r,o;for(o=[],n=-1,r=e.length;++n<r;)o=o.concat(t(e[n]));return o},p=function(e,t){var n,r,o;for(o="",n=-1,r=e.length;++n<r;)o+=t(e[n]);return o},d=function(e){return new RegExp(e.toString()+"|").exec("").length-1},f=function(e,t){var n,r,o,i,u;for(i={},n=-1,o=e.length;++n<o;)r=e[n],null!=(u=t[n])&&(null!=i[r]?(Array.isArray(i[r])||(i[r]=[i[r]]),i[r].push(u)):i[r]=u);return i},e={},e.Result=function(e,t){this.value=e,this.rest=t},e.Tagged=function(e,t){this.tag=e,this.value=t},e.tag=function(t,n){return function(r){var o,i;if(null!=(o=n(r)))return i=new e.Tagged(t,o.value),new e.Result(i,o.rest)}},e.regex=function(t){return function(n){var r,o;if(null!=(r=t.exec(n)))return o=r[0],new e.Result(o,n.slice(o.length))}},e.sequence=function(){var t;return t=1<=arguments.length?u.call(arguments,0):[],function(n){var r,o,i,u,a,s;for(r=-1,o=t.length,s=[],u=n;++r<o;){if(i=t[r],null==(a=i(u)))return;s.push(a.value),u=a.rest}return new e.Result(s,u)}},e.pick=function(){var t,n;return t=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],function(r){var o,i;if(null!=(i=e.sequence.apply(e,n)(r)))return o=i.value,i.value=o[t],i}},e.string=function(t){var n;return n=t.length,function(r){if(r.slice(0,n)===t)return new e.Result(t,r.slice(n))}},e.lazy=function(e){var t;return t=null,function(n){return null==t&&(t=e()),t(n)}},e.baseMany=function(t,n,r,o,i){var u,a,s;for(a=i,s=r?"":[];;){if(null!=n&&null!=n(a))break;if(null==(u=t(a)))break;r?s+=u.value:s.push(u.value),a=u.rest}if(!o||0!==s.length)return new e.Result(s,a)},e.many1=function(t){return function(n){return e.baseMany(t,null,!1,!0,n)}},e.concatMany1Till=function(t,n){return function(r){return e.baseMany(t,n,!0,!0,r)}},e.firstChoice=function(){var e;return e=1<=arguments.length?u.call(arguments,0):[],function(t){var n,r,o,i;for(n=-1,r=e.length;++n<r;)if(o=e[n],null!=(i=o(t)))return i}},h=function(t){var n;return n={},n.wildcard=e.tag("wildcard",e.string(t.wildcardChar)),n.optional=e.tag("optional",e.pick(1,e.string(t.optionalSegmentStartChar),e.lazy(function(){return n.pattern}),e.string(t.optionalSegmentEndChar))),n.name=e.regex(new RegExp("^["+t.segmentNameCharset+"]+")),n.named=e.tag("named",e.pick(1,e.string(t.segmentNameStartChar),e.lazy(function(){return n.name}))),n.escapedChar=e.pick(1,e.string(t.escapeChar),e.regex(/^./)),n.static=e.tag("static",e.concatMany1Till(e.firstChoice(e.lazy(function(){return n.escapedChar}),e.regex(/^./)),e.firstChoice(e.string(t.segmentNameStartChar),e.string(t.optionalSegmentStartChar),e.string(t.optionalSegmentEndChar),n.wildcard))),n.token=e.lazy(function(){return e.firstChoice(n.wildcard,n.optional,n.named,n.static)}),n.pattern=e.many1(e.lazy(function(){return n.token})),n},s={escapeChar:"\\",segmentNameStartChar:":",segmentValueCharset:"a-zA-Z0-9-_~ %",segmentNameCharset:"a-zA-Z0-9",optionalSegmentStartChar:"(",optionalSegmentEndChar:")",wildcardChar:"*"},i=function(e,t){if(Array.isArray(e))return p(e,function(e){return i(e,t)});switch(e.tag){case"wildcard":return"(.*?)";case"named":return"(["+t+"]+)";case"static":return c(e.value);case"optional":return"(?:"+i(e.value,t)+")?"}},o=function(e,t){return null==t&&(t=s.segmentValueCharset),"^"+i(e,t)+"$"},r=function(e){if(Array.isArray(e))return a(e,r);switch(e.tag){case"wildcard":return["_"];case"named":return[e.value];case"static":return[];case"optional":return r(e.value)}},l=function(e,t,n,r){var o,i,u,a;if(null==r&&(r=!1),null!=(a=e[t])){if(o=n[t]||0,i=Array.isArray(a)?a.length-1:0,!(o>i))return u=Array.isArray(a)?a[o]:a,r&&(n[t]=o+1),u;if(r)throw new Error("too few values provided for key `"+t+"`")}else if(r)throw new Error("no values provided for key `"+t+"`")},n=function(e,t,r){var o,i;if(Array.isArray(e)){for(o=-1,i=e.length;++o<i;)if(n(e[o],t,r))return!0;return!1}switch(e.tag){case"wildcard":return null!=l(t,"_",r,!1);case"named":return null!=l(t,e.value,r,!1);case"static":return!1;case"optional":return n(e.value,t,r)}},v=function(e,t,r){if(Array.isArray(e))return p(e,function(e){return v(e,t,r)});switch(e.tag){case"wildcard":return l(t,"_",r,!0);case"named":return l(t,e.value,r,!0);case"static":return e.value;case"optional":return n(e.value,t,r)?v(e.value,t,r):""}},t=function(e,n){var i,u,a,c;if(e instanceof t)return this.isRegex=e.isRegex,this.regex=e.regex,this.ast=e.ast,void(this.names=e.names);if(this.isRegex=e instanceof RegExp,"string"!=typeof e&&!this.isRegex)throw new TypeError("argument must be a regex or a string");if(this.isRegex){if(this.regex=e,null!=n){if(!Array.isArray(n))throw new Error("if first argument is a regex the second argument may be an array of group names but you provided something else");if(i=d(this.regex),n.length!==i)throw new Error("regex contains "+i+" groups but array of group names contains "+n.length);this.names=n}}else{if(""===e)throw new Error("argument must not be the empty string");if(e.replace(/\s+/g,"")!==e)throw new Error("argument must not contain whitespace");if(u={escapeChar:(null!=n?n.escapeChar:void 0)||s.escapeChar,segmentNameStartChar:(null!=n?n.segmentNameStartChar:void 0)||s.segmentNameStartChar,segmentNameCharset:(null!=n?n.segmentNameCharset:void 0)||s.segmentNameCharset,segmentValueCharset:(null!=n?n.segmentValueCharset:void 0)||s.segmentValueCharset,optionalSegmentStartChar:(null!=n?n.optionalSegmentStartChar:void 0)||s.optionalSegmentStartChar,optionalSegmentEndChar:(null!=n?n.optionalSegmentEndChar:void 0)||s.optionalSegmentEndChar,wildcardChar:(null!=n?n.wildcardChar:void 0)||s.wildcardChar},c=h(u),null==(a=c.pattern(e)))throw new Error("couldn't parse pattern");if(""!==a.rest)throw new Error("could only partially parse pattern");this.ast=a.value,this.regex=new RegExp(o(this.ast,u.segmentValueCharset)),this.names=r(this.ast)}},t.prototype.match=function(e){var t,n;return null==(n=this.regex.exec(e))?null:(t=n.slice(1),this.names?f(this.names,t):t)},t.prototype.stringify=function(e){if(null==e&&(e={}),this.isRegex)throw new Error("can't stringify patterns generated from a regex");if(e!==Object(e))throw new Error("argument must be an object or undefined");return v(this.ast,e,{})},t.escapeForRegex=c,t.concatMap=a,t.stringConcatMap=p,t.regexGroupCount=d,t.keysAndValuesToObject=f,t.P=e,t.newParser=h,t.defaultOptions=s,t.astNodeToRegexString=o,t.astNodeToNames=r,t.getParam=l,t.astNodeContainsSegmentsForProvidedParams=n,t.stringify=v,t})},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){function r(e){return o(e,i|u)}var o=n(249),i=1,u=4;e.exports=r},function(e,t,n){function r(e,t,n,A,M,R){var I,q=t&E,D=t&O,U=t&S;if(n&&(I=M?n(e,A,M,R):n(e)),void 0!==I)return I;if(!w(e))return e;var N=m(e);if(N){if(I=y(e),!q)return l(e,I)}else{var L=v(e),K=L==j||L==x;if(_(e))return c(e,q);if(L==T||L==P||K&&!M){if(I=D||K?{}:g(e),!q)return D?h(e,s(I,e)):f(e,a(I,e))}else{if(!C[L])return M?e:{};I=b(e,L,r,q)}}R||(R=new o);var B=R.get(e);if(B)return B;R.set(e,I);var F=U?D?p:d:D?keysIn:k,H=N?void 0:F(e);return i(H||e,function(o,i){H&&(i=o,o=e[i]),u(I,i,r(o,t,n,i,e,R))}),I}var o=n(182),i=n(250),u=n(88),a=n(251),s=n(252),c=n(256),l=n(257),f=n(258),h=n(259),d=n(197),p=n(261),v=n(133),y=n(262),b=n(263),g=n(273),m=n(119),_=n(120),w=n(72),k=n(113),E=1,O=2,S=4,P="[object Arguments]",j="[object Function]",x="[object GeneratorFunction]",T="[object Object]",C={};C[P]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[T]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[j]=C["[object WeakMap]"]=!1,e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}e.exports=n},function(e,t,n){function r(e,t){return e&&o(t,i(t),e)}var o=n(98),i=n(113);e.exports=r},function(e,t,n){function r(e,t){return e&&o(t,i(t),e)}var o=n(98),i=n(253);e.exports=r},function(e,t,n){function r(e){return u(e)?o(e,!0):i(e)}var o=n(114),i=n(254),u=n(109);e.exports=r},function(e,t,n){function r(e){if(!o(e))return u(e);var t=i(e),n=[];for(var r in e)("constructor"!=r||!t&&s.call(e,r))&&n.push(r);return n}var o=n(72),i=n(112),u=n(255),a=Object.prototype,s=a.hasOwnProperty;e.exports=r},function(e,t){function n(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}e.exports=n},function(e,t,n){(function(e){function r(e,t){if(t)return e.slice();var n=e.length,r=c?c(n):new e.constructor(n);return e.copy(r),r}var o=n(68),i="object"==typeof t&&t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=u&&u.exports===i,s=a?o.Buffer:void 0,c=s?s.allocUnsafe:void 0;e.exports=r}).call(t,n(77)(e))},function(e,t){function n(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}e.exports=n},function(e,t,n){function r(e,t){return o(e,i(e),t)}var o=n(98),i=n(199);e.exports=r},function(e,t,n){function r(e,t){return o(e,i(e),t)}var o=n(98),i=n(260);e.exports=r},function(e,t,n){var r=n(177),o=n(130),i=n(199),u=n(201),a=Object.getOwnPropertySymbols,s=a?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:u;e.exports=s},function(e,t,n){function r(e){return o(e,u,i)}var o=n(198),i=n(260),u=n(253);e.exports=r},function(e,t){function n(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var r=Object.prototype,o=r.hasOwnProperty;e.exports=n},function(e,t,n){function r(e,t,n,r){var C=e.constructor;switch(t){case m:return o(e);case f:case h:return new C(+e);case _:return i(e,r);case w:case k:case E:case O:case S:case P:case j:case x:case T:return l(e,r);case d:return u(e,r,n);case p:case b:return new C(e);case v:return a(e);case y:return s(e,r,n);case g:return c(e)}}var o=n(264),i=n(265),u=n(266),a=n(268),s=n(269),c=n(271),l=n(272),f="[object Boolean]",h="[object Date]",d="[object Map]",p="[object Number]",v="[object RegExp]",y="[object Set]",b="[object String]",g="[object Symbol]",m="[object ArrayBuffer]",_="[object DataView]",w="[object Float32Array]",k="[object Float64Array]",E="[object Int8Array]",O="[object Int16Array]",S="[object Int32Array]",P="[object Uint8Array]",j="[object Uint8ClampedArray]",x="[object Uint16Array]",T="[object Uint32Array]";e.exports=r},function(e,t,n){function r(e){var t=new e.constructor(e.byteLength);return new o(t).set(new o(e)),t}var o=n(193);e.exports=r},function(e,t,n){function r(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var o=n(264);e.exports=r},function(e,t,n){function r(e,t,n){return i(t?n(u(e),a):u(e),o,new e.constructor)}var o=n(267),i=n(240),u=n(194),a=1;e.exports=r},function(e,t){function n(e,t){
return e.set(t[0],t[1]),e}e.exports=n},function(e,t){function n(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}var r=/\w*$/;e.exports=n},function(e,t,n){function r(e,t,n){return i(t?n(u(e),a):u(e),o,new e.constructor)}var o=n(270),i=n(240),u=n(195),a=1;e.exports=r},function(e,t){function n(e,t){return e.add(t),e}e.exports=n},function(e,t,n){function r(e){return u?Object(u.call(e)):{}}var o=n(67),i=o?o.prototype:void 0,u=i?i.valueOf:void 0;e.exports=r},function(e,t,n){function r(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var o=n(264);e.exports=r},function(e,t,n){function r(e){return"function"!=typeof e.constructor||u(e)?{}:o(i(e))}var o=n(274),i=n(130),u=n(112);e.exports=r},function(e,t,n){var r=n(72),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(276),a=r(u),s=n(87),c=r(s),l=n(119),f=r(l),h=n(277),d=r(h),p=n(131),v=r(p),y=n(72),b=r(y),g=n(278),m=r(g),_=n(132),w=r(_),k=n(280),E=r(k),O=n(282),S=r(O),P=n(284),j=r(P),x=n(2),T=n(40),C=["$nearSphere"],A=function(){function e(t){o(this,e),t=(0,c.default)({fields:[],filter:{},sort:null,limit:null,skip:0},t),this.fields=t.fields,this.filter=t.filter,this.sort=t.sort,this.limit=t.limit,this.skip=t.skip,this._parent=null}return i(e,[{key:"isSupportedOffline",value:function(){var e=this,t=!0;return(0,E.default)(C,function(n){return t=!(0,S.default)(e.filter,n)}),t}},{key:"equalTo",value:function(e,t){return this.addFilter(e,t)}},{key:"contains",value:function(e,t){if((0,T.isDefined)(t)===!1)throw new x.QueryError("You must supply a value.");return(0,f.default)(t)===!1&&(t=[t]),this.addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){if((0,T.isDefined)(t)===!1)throw new x.QueryError("You must supply a value.");return(0,f.default)(t)===!1&&(t=[t]),this.addFilter(e,"$all",t)}},{key:"greaterThan",value:function(e,t){if((0,d.default)(t)===!1&&(0,v.default)(t)===!1)throw new x.QueryError("You must supply a number or string.");return this.addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){if((0,d.default)(t)===!1&&(0,v.default)(t)===!1)throw new x.QueryError("You must supply a number or string.");return this.addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){if((0,d.default)(t)===!1&&(0,v.default)(t)===!1)throw new x.QueryError("You must supply a number or string.");return this.addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){if((0,d.default)(t)===!1&&(0,v.default)(t)===!1)throw new x.QueryError("You must supply a number or string.");return this.addFilter(e,"$lte",t)}},{key:"notEqualTo",value:function(e,t){return this.addFilter(e,"$ne",t)}},{key:"notContainedIn",value:function(e,t){return(0,f.default)(t)===!1&&(t=[t]),this.addFilter(e,"$nin",t)}},{key:"and",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.join("$and",t)}},{key:"nor",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if((0,T.isDefined)(this._parent)&&(0,j.default)(this._parent.filter,"$and")){var r;return(r=this._parent).nor.apply(r,t)}return this.join("$nor",t)}},{key:"or",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if((0,T.isDefined)(this._parent)){var r;return(r=this._parent).or.apply(r,t)}return this.join("$or",t)}},{key:"exists",value:function(e,t){return t=void 0===t||(t||!1),this.addFilter(e,"$exists",t)}},{key:"mod",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,v.default)(t)&&(t=parseFloat(t)),(0,v.default)(n)&&(n=parseFloat(n)),!(0,d.default)(t))throw new x.QueryError("divisor must be a number");if(!(0,d.default)(n))throw new x.QueryError("remainder must be a number");return this.addFilter(e,"$mod",[t,n])}},{key:"matches",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];if((0,m.default)(t)||(t=new RegExp(t)),0!==t.source.indexOf("^"))throw new x.QueryError("regExp must have '^' at the beginning of the expression to make it an anchored expression.");if((t.ignoreCase||n.ignoreCase)&&n.ignoreCase!==!1)throw new x.QueryError("ignoreCase flag is not supported");return(t.multiline||n.multiline)&&n.multiline!==!1&&r.push("m"),n.extended===!0&&r.push("x"),n.dotMatchesAll===!0&&r.push("s"),r.length>0&&this.addFilter(e,"$options",r.join("")),this.addFilter(e,"$regex",t.source)}},{key:"near",value:function(e,t,n){if(!(0,f.default)(t)||!(0,d.default)(t[0])||!(0,d.default)(t[1]))throw new x.QueryError("coord must be a [number, number]");var r=this.addFilter(e,"$nearSphere",[t[0],t[1]]);return(0,d.default)(n)&&this.addFilter(e,"$maxDistance",n),r}},{key:"withinBox",value:function(e,t,n){if(!(0,f.default)(t)||!(0,d.default)(t[0])||!(0,d.default)(t[1]))throw new x.QueryError("bottomLeftCoord must be a [number, number]");if(!(0,f.default)(n)||!(0,d.default)(n[0])||!(0,d.default)(n[1]))throw new x.QueryError("upperRightCoord must be a [number, number]");t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),n[0]=parseFloat(n[0]),n[1]=parseFloat(n[1]);var r=[[t[0],t[1]],[n[0],n[1]]];return this.addFilter(e,"$within",{$box:r})}},{key:"withinPolygon",value:function(e,t){if((0,f.default)(t)===!1||0===t.length||t.length>3)throw new x.QueryError("coords must be a [[number, number]]");return t=t.map(function(e){if((0,d.default)(e[0])===!1||(0,d.default)(e[1])===!1)throw new x.QueryError("coords argument must be a [number, number]");return[parseFloat(e[0]),parseFloat(e[1])]}),this.addFilter(e,"$within",{$polygon:t})}},{key:"size",value:function(e,t){if((0,v.default)(t)&&(t=parseFloat(t)),!(0,d.default)(t))throw new x.QueryError("size must be a number");return this.addFilter(e,"$size",t)}},{key:"ascending",value:function(e){return(0,T.isDefined)(this._parent)?this._parent.ascending(e):this.sort[e]=1,this}},{key:"descending",value:function(e){return(0,T.isDefined)(this._parent)?this._parent.descending(e):this.sort[e]=-1,this}},{key:"addFilter",value:function(e,t,n){return(0,b.default)(this.filter[e])||(this.filter[e]={}),(0,T.isDefined)(t)&&(0,T.isDefined)(n)?this.filter[e][t]=n:this.filter[e]=t,this}},{key:"join",value:function(t,n){var r=this,o=this,i={};n=n.map(function(t){if(!(t instanceof e)){if(!(0,b.default)(t))throw new x.QueryError("query argument must be of type: Kinvey.Query[] or Object[].");t=new e(t)}return t.toPlainObject().filter}),0===n.length&&(o=new e,n=[o.toPlainObject().filter],o._parent=this);var u=Object.keys(this.filter);return(0,E.default)(u,function(e){i[e]=r.filter[e],delete r.filter[e]}),this.filter[t]=[i].concat(n),o}},{key:"process",value:function(e){if(this.isSupportedOffline()===!1){var t="This query is not able to run locally. The following filters are not supported locally:";throw(0,E.default)(C,function(e){t=t+" "+e}),T.Log.error(t),new x.QueryError(t)}if(!(0,f.default)(e))throw new x.QueryError("data argument must be of type: Array.");T.Log.debug("Data length before processiong query",e.length);var n=this.toPlainObject();return e=(0,a.default)(n.filter,e),T.Log.debug("Data length after applying query filter",n.filter,e.length),(0,f.default)(n.fields)&&n.fields.length>0&&(T.Log.debug("Removing fields from data",n.fields),e=e.map(function(e){var t=Object.keys(e);return(0,E.default)(t,function(t){n.fields.indexOf(t)===-1&&delete e[t]}),e})),(0,T.isDefined)(n.sort)&&(T.Log.debug("Sorting data",n.sort),e.sort(function(e,t){for(var r in n.sort)if(n.sort.hasOwnProperty(r)){var o=(0,T.nested)(e,r),i=(0,T.nested)(t,r);if((0,T.isDefined)(o)&&(0,T.isDefined)(i)===!1)return-1;if((0,T.isDefined)(i)&&(0,T.isDefined)(o)===!1)return 1;if(o!==i){var u=n.sort[r];return(o<i?-1:1)*u}}return 0})),(0,d.default)(n.skip)?(0,d.default)(n.limit)&&n.limit>0?(T.Log.debug("Skipping and limiting data",n.skip,n.limit),e.slice(n.skip,n.skip+n.limit)):(T.Log.debug("Skipping data",n.skip),e.slice(n.skip)):e}},{key:"toPlainObject",value:function(){return(0,T.isDefined)(this._parent)?this._parent.toPlainObject():{fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit}}},{key:"toQueryString",value:function(){var e={};(0,w.default)(this.filter)||(e.query=this.filter),(0,w.default)(this.fields)||(e.fields=this.fields.join(",")),(0,d.default)(this.limit)&&(e.limit=this.limit),(0,d.default)(this.skip)&&this.skip>0&&(e.skip=this.skip),(0,w.default)(this.sort)||(e.sort=this.sort);var t=Object.keys(e);return(0,E.default)(t,function(t){e[t]=(0,v.default)(e[t])?e[t]:JSON.stringify(e[t])}),e}},{key:"toString",value:function(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function(){return this._fields},set:function(e){if(e=e||[],!(0,f.default)(e))throw new x.QueryError("fields must be an Array");(0,T.isDefined)(this._parent)?this._parent.fields=e:this._fields=e}},{key:"filter",get:function(){return this._filter},set:function(e){this._filter=e}},{key:"sort",get:function(){return this._sort},set:function(e){if(e&&(0,b.default)(e)===!1)throw new x.QueryError("sort must an Object");(0,T.isDefined)(this._parent)?this._parent.sort=e:this._sort=e||{}}},{key:"limit",get:function(){return this._limit},set:function(e){if((0,v.default)(e)&&(e=parseFloat(e)),(0,T.isDefined)(e)&&(0,d.default)(e)===!1)throw new x.QueryError("limit must be a number");this._parent?this._parent.limit=e:this._limit=e}},{key:"skip",get:function(){return this._skip},set:function(e){if((0,v.default)(e)&&(e=parseFloat(e)),(0,d.default)(e)===!1)throw new x.QueryError("skip must be a number");(0,T.isDefined)(this._parent)?this._parent.skip=e:this._skip=e}}]),e}();t.default=A},function(e,t){!function(){"use strict";function n(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return e instanceof Date?e.getTime():e instanceof Array?e.map(o):e}function i(e,t){return e.get?e.get(t):e[t]}function u(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var o=0,u=n.length;o<u;o++)if(e(t,i(n,o)))return!0;return!1}}function a(e,t){return e.v(e.a,t)}function s(e,t){for(var n=0;n<e.length;n++)if(a(t,i(e,n)))return n;return-1}function c(e,t){return{a:e,v:t}}function l(e,t){var n=[];return f(t,e.k,0,n),1===n.length?a(e.nv,n[0]):!!~s(n,e.nv)}function f(e,t,n,o){if(n===t.length||void 0==e)return void o.push(e);var u=i(t,n);if(r(e)&&isNaN(Number(u)))for(var a=0,s=e.length;a<s;a++)f(i(e,a),t,n,o);else f(i(e,u),t,n+1,o)}function h(e,t){return{a:{k:e,nv:t},v:l}}function d(e){return"Object"===String(e.constructor)||"functionObject(){[nativecode]}"===String(e.constructor).replace(/[\r\n\s\t]/g,"")}function p(e){(e=o(e))&&d(e)||(e={$eq:e});var t=[];for(var n in e){var r=e[n];if("$options"!==n)if(b[n])g[n]&&(r=g[n](r,e)),t.push(c(o(r),b[n]));else{if(36===n.charCodeAt(0))throw new Error("Unknown operation "+n);t.push(h(n.split("."),p(r)))}}return 1===t.length?t[0]:c(t,b.$and)}function v(e,t){var n=p(e);return t&&(n={a:n,v:function(e,n){return a(e,t(n))}}),n}function y(e,t,r){function o(e){return a(i,e)}n(t)&&(r=t,t=void 0);var i=v(e,r);return t?t.filter(o):o}var b={$eq:u(function(e,t){return e(t)}),$ne:function(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var o=0,u=n.length;o<u;o++)if(!e(t,i(n,o)))return!1;return!0}}(function(e,t){return!e(t)}),$or:function(e,t){for(var n=0,r=e.length;n<r;n++)if(a(i(e,n),t))return!0;return!1},$gt:u(function(e,t){return y.compare(o(t),e)>0}),$gte:u(function(e,t){return y.compare(o(t),e)>=0}),$lt:u(function(e,t){return y.compare(o(t),e)<0}),$lte:u(function(e,t){return y.compare(o(t),e)<=0}),$mod:u(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(!(t instanceof Array)){var n=o(t);if(n===t&&"object"==typeof t)for(var r=e.length;r--;)if(String(e[r])===String(t)&&"[object Object]"!==String(t))return!0;if(void 0===n)for(var r=e.length;r--;)if(null==e[r])return!0;for(var r=e.length;r--;){var u=v(i(e,r),void 0),s=a(u,t);if(s&&"[object Object]"!==String(s)&&"[object Object]"!==String(t))return!0}return Boolean(!!~e.indexOf(o(t)))}for(var r=t.length;r--;)if(~e.indexOf(o(i(t,r))))return!0;return!1},$nin:function(e,t){return!b.$in(e,t)},$not:function(e,t){return!a(e,t)},$type:function(e,t){return void 0!=t&&(t instanceof e||t.constructor==e)},$all:function(e,t){return b.$and(e,t)},$size:function(e,t){return!!t&&e===t.length},$nor:function(e,t){for(var n=0,r=e.length;n<r;n++)if(a(i(e,n),t))return!1;return!0},$and:function(e,t){t||(t=[]);for(var n=0,r=e.length;n<r;n++)if(!a(i(e,n),t))return!1;return!0},$regex:u(function(e,t){return"string"==typeof t&&e.test(t)}),$where:function(e,t){return e.call(t,t)},$elemMatch:function(e,t){return r(t)?!!~s(t,e):a(e,t)},$exists:function(e,t){return void 0!=t===e}},g={$eq:function(e){return e instanceof RegExp?function(t){return"string"==typeof t&&e.test(t)}:e instanceof Function?e:r(e)&&!e.length?function(e){return r(e)&&!e.length}:null===e?function(e){return null==e}:function(t){return 0===y.compare(o(t),e)}},$ne:function(e){return g.$eq(e)},$and:function(e){return e.map(p)},$all:function(e){return g.$and(e)},$or:function(e){return e.map(p)},$nor:function(e){return e.map(p)},$not:function(e){return p(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return"string"==typeof e?new Function("obj","return "+e):e},$elemMatch:function(e){return p(e)},$exists:function(e){return!!e}};y.use=function(e){if(n(e))return e(y);for(var t in e)36===t.charCodeAt(0)&&(b[t]=e[t])},y.indexOf=function(e,t,n){return s(t,v(e,n))},y.compare=function(e,t){if(e===t)return 0;if(typeof e==typeof t){if(e>t)return 1;if(e<t)return-1}},void 0!==e&&void 0!==e.exports&&(Object.defineProperty(t,"__esModule",{value:!0}),e.exports=y,t.default=e.exports.default=y),"undefined"!=typeof window&&(window.sift=y)}()},function(e,t,n){function r(e){return"number"==typeof e||i(e)&&o(e)==u}var o=n(66),i=n(118),u="[object Number]";e.exports=r},function(e,t,n){var r=n(279),o=n(124),i=n(125),u=i&&i.isRegExp,a=u?o(u):r;e.exports=a},function(e,t,n){function r(e){return i(e)&&o(e)==u}var o=n(66),i=n(118),u="[object RegExp]";e.exports=r},function(e,t,n){function r(e,t){return(a(e)?o:i)(e,u(t))}var o=n(250),i=n(229),u=n(281),a=n(119);e.exports=r},function(e,t,n){function r(e){return"function"==typeof e?e:o}var o=n(101);e.exports=r},function(e,t,n){function r(e,t){return o(e,u(t,3),i)}var o=n(283),i=n(230),u=n(179);e.exports=r},function(e,t){function n(e,t,n){var r;return n(e,function(e,n,o){if(t(e,n,o))return r=n,!1}),r}e.exports=n},function(e,t,n){function r(e,t){return null!=e&&i(e,t,o)}var o=n(285),i=n(219);e.exports=r},function(e,t){function n(e,t){return null!=e&&o.call(e,t)}var r=Object.prototype,o=r.hasOwnProperty;e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(87),a=r(u),s=n(280),c=r(s),l=n(131),f=r(l),h=n(72),d=r(h),p=n(65),v=r(p),y=n(248),b=r(y),g=n(2),m=n(40),_=n(275),w=r(_),k=function(){function e(t){o(this,e),t=(0,a.default)({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t),this.query=t.query,this.initial=t.initial,this.key=t.key,this.reduceFn=t.reduceFn}return i(e,[{key:"by",value:function(e){return this.key[e]=!0,this}},{key:"process",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.toPlainObject(),n=Object.keys(t.key),r=t.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");if(t.reduce=new Function(["doc","out"],r),this.query&&(e=this.query.process(e)),n.length>0){var o=[];return n.forEach(function(n){var r={};e.forEach(function(e){var o=e[n],i=(0,m.isDefined)(r[o])?r[o]:(0,b.default)(t.initial),u=t.reduce(e,i);(0,m.isDefined)(u)&&(i=u),r[o]=i}),Object.keys(r).forEach(function(e){var t={};t[n]=e,t=(0,a.default)({},t,r[e]),o.push(t)})}),o}var i=(0,b.default)(t.initial);return(0,c.default)(e,function(e){var n=t.reduce(e,i);(0,m.isDefined)(n)&&(i=n)}),[i]}},{key:"toPlainObject",value:function(){return{key:this.key,initial:this.initial,reduce:this.reduceFn,reduceFn:this.reduceFn,condition:this.query?this.query.toPlainObject().filter:{},query:this.query?this.query.toPlainObject():null}}},{key:"initial",get:function(){return(0,b.default)(this._initial)},set:function(e){if(!(0,d.default)(e))throw new g.KinveyError("initial must be an Object.");this._initial=e}},{key:"query",get:function(){return this._query},set:function(e){if((0,m.isDefined)(e)&&!(e instanceof w.default))throw new g.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"reduceFn",get:function(){return this._reduceFn},set:function(e){if((0,v.default)(e)&&(e=e.toString()),!(0,f.default)(e))throw new g.KinveyError("fn argument must be of type function or string.");this._reduceFn=e}}],[{key:"count",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.by(t),n.initial={count:0},n.reduceFn="function(doc, out) {  out.count += 1;  return out;}",n}},{key:"sum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={sum:0},n.reduceFn='function(doc, out) {  out.sum += doc["'+t+'"];  return out;}',n}},{key:"min",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={min:1/0},n.reduceFn='function(doc, out) {  out.min = Math.min(out.min, doc["'+t+'"]);  return out;}',n}},{key:"max",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={max:-(1/0)},n.reduceFn='function(doc, out) {  out.max = Math.max(out.max, doc["'+t+'"]);  return out;}',n}},{key:"average",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={count:0,average:0},n.reduceFn='function(doc, out) {  out.average = (out.average * out.count + doc["'+t+'"]) / (out.count + 1);  out.count += 1;  return out;}',n}}]),e}();t.default=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.RequestMethod=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(82),c=r(s),l=n(87),f=r(l),h=n(131),d=r(h),p=n(277),v=r(p),y=n(288),b=r(y),g=n(2),m=n(40),_=n(293),w=r(_),k=n(294),E=r(k),O={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(O),t.RequestMethod=O;var S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),t=(0,f.default)({followRedirect:!0},t),this.id=(0,m.randomString)(),this.client=t.client,this.method=t.method||O.GET,this.headers=t.headers||new E.default,this.url=t.url||"",this.body=t.body||t.data,this.timeout=(0,m.isDefined)(t.timeout)?t.timeout:this.client.defaultTimeout,this.followRedirect=t.followRedirect===!0,this.cache=t.cache===!0}return i(e,[{key:"execute",value:function(){return(0,m.isDefined)(this.rack)===!1?(m.Log.error("Unable to execute the request. Please provide a rack to execute the request."),a.default.reject(new g.KinveyError("Unable to execute the request. Please provide a rack to execute the request."))):this.rack.execute(this.toPlainObject()).then(function(e){if((0,m.isDefined)(e)===!1)throw new g.NoResponseError;return e instanceof w.default==!1&&(e=new w.default({statusCode:e.statusCode,headers:e.headers,data:e.data})),e})}},{key:"cancel",value:function(){return this.rack.cancel()}},{key:"toPlainObject",value:function(){return{id:this.id,method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect}}},{key:"client",get:function(){return this._client||b.default.sharedInstance()},set:function(e){if(e&&e instanceof b.default==!1)throw new g.KinveyError("client must be an instance of the Client class.");this._client=e}},{key:"method",get:function(){return this._method},set:function(e){switch((0,d.default)(e)||(e=String(e)),e=e.toUpperCase()){case O.GET:case O.POST:case O.PATCH:case O.PUT:case O.DELETE:this._method=e;break;default:throw new g.KinveyError("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof E.default||(e=new E.default(e)),this._headers=e}},{key:"url",get:function(){return this.cache===!0?(0,m.appendQuery)(this._url,c.default.stringify({_:Math.random().toString(36).substr(2)})):this._url},set:function(e){this._url=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}},{key:"timeout",get:function(){return this._timeout},set:function(e){if(e=parseInt(e,10),(0,v.default)(e)===!1||isNaN(e))throw new g.KinveyError("Invalid timeout. Timeout must be a number.");this._timeout=e}},{key:"followRedirect",get:function(){return this._followRedirect},set:function(e){this._followRedirect=!!e}},{key:"cache",get:function(){return this._cache},set:function(e){this._cache=!!e}}]),e}();t.default=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(289),a=r(u),s=n(75),c=r(s),l=n(87),f=(r(l),n(131)),h=r(f),d=n(277),p=r(d),v=n(290),y=r(v),b=n(2),g=n(40),m=6e4,_=null,w=function(){function e(){o(this,e),this.memory=new a.default}return i(e,[{key:"get",value:function(e){if(!(0,h.default)(e))throw new b.KinveyError("ActiveUserStorage key must be a string.");try{return JSON.parse(this.memory.get(e))}catch(e){return null}}},{key:"set",value:function(e,t){if(!(0,h.default)(e))throw new b.KinveyError("ActiveUserStorage key must be a string.");return(0,g.isDefined)(t)?this.memory.set(e,JSON.stringify(t)):this.memory.delete(e),t}}]),e}(),k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=(0,h.default)(t.apiHostname)?t.apiHostname:"https://baas.kinvey.com";/^https?:\/\//i.test(n)===!1&&(n="https://"+n);var r=c.default.parse(n);this.deviceId=(0,y.default)(),this.apiProtocol=r.protocol,this.apiHost=r.host;var i=(0,h.default)(t.micHostname)?t.micHostname:"https://auth.kinvey.com";/^https?:\/\//i.test(i)===!1&&(i="https://"+i);var u=c.default.parse(i);this.micProtocol=u.protocol,this.micHost=u.host,this.appKey=t.appKey,this.appSecret=t.appSecret,this.masterSecret=t.masterSecret,this.encryptionKey=t.encryptionKey,this.appVersion=t.appVersion,this.defaultTimeout=(0,p.default)(t.defaultTimeout)&&t.defaultTimeout>=0?t.defaultTimeout:m,this.activeUserStorage=new w}return i(e,[{key:"getActiveUser",value:function(){return this.activeUserStorage.get(this.appKey+".active_user")}},{key:"setActiveUser",value:function(e){return this.activeUserStorage.set(this.appKey+".active_user",e)}},{key:"toPlainObject",value:function(){return{deviceId:this.deviceId,apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion}}},{key:"apiHostname",get:function(){return c.default.format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"micHostname",get:function(){return c.default.format({protocol:this.micProtocol,host:this.micHost})}},{key:"appVersion",get:function(){return this._appVersion},set:function(e){e&&!(0,h.default)(e)&&(e=String(e)),this._appVersion=e}},{key:"defaultTimeout",get:function(){return this._defaultTimeout},set:function(e){if(e=parseInt(e,10),(0,p.default)(e)===!1||isNaN(e))throw new b.KinveyError("Invalid timeout. Timeout must be a number.");e<0&&(g.Log.info("Default timeout is less than 0. Setting default timeout to "+defaultTimeout+"ms."),e=defaultTimeout),this._defaultTimeout=e}}],[{key:"initialize",value:function(){throw new b.KinveyError("Please use Client.init().")}},{key:"init",value:function(t){return _=new e(t)}},{key:"sharedInstance",value:function(){if((0,g.isDefined)(_)===!1)throw new b.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return _}}]),e}();t.default=k},function(e,t){"use strict";function n(){this._cache=r(),this._timeouts=r()}function r(){return Object.create(null)}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t,n){this.delete(e),this._cache[e]=t,n&&(this._timeouts[e]=setTimeout(this.delete.bind(this,e),1e3*n))},n.prototype.delete=function(e){delete this._cache[e],e in this._timeouts&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},n.prototype.clear=function(){this._cache=r();for(var e in this._timeouts)clearTimeout(this._timeouts[e]);this._timeouts=r()},e.exports=n},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var u=e.random||(e.rng||o)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,t)for(var a=0;a<16;++a)t[r+a]=u[a];return t||i(u)}var o=n(291),i=n(292);e.exports=r},function(e,t){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var i=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}e.exports=n}).call(t,function(){return this}())},function(e,t){function n(e,t){var n=t||0,o=r;return o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]}for(var r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyResponse=t.StatusCode=void 0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(87),l=r(c),f=n(2),h=n(294),d=r(h),p={Ok:200,Created:201,Empty:204,MovedPermanently:301,Found:302,NotModified:304,TemporaryRedirect:307,PermanentRedirect:308,Unauthorized:401,Forbidden:403,NotFound:404,ServerError:500};Object.freeze(p),t.StatusCode=p;var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),t=(0,l.default)({statusCode:p.Empty,headers:new d.default,data:null},t),this.statusCode=t.statusCode,this.headers=t.headers,this.data=t.data}return s(e,[{key:"isSuccess",value:function(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===p.MovedPermanently||this.statusCode===p.Found||this.statusCode===p.NotModified||this.statusCode===p.TemporaryRedirect||this.statusCode===p.PermanentRedirect}},{key:"isServerError",value:function(){return this.statusCode>=500&&this.statusCode<600}},{key:"isClientError",value:function(){return this.statusCode>=400&&this.statusCode<500}},{key:"toPlainObject",value:function(){return{statusCode:this.statusCode,headers:this.headers.toPlainObject(),data:this.data}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof d.default||(e=new d.default(e)),this._headers=e}},{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},t=e.message||e.description,n=e.debug,r=this.statusCode,o=this.headers.get("X-Kinvey-Request-ID");return r===p.Unauthorized?new f.InsufficientCredentialsError(t,n,r,o):r===p.NotFound?new f.NotFoundError(t,n,r,o):r===p.ServerError?new f.ServerError(t,n,r,o):new f.KinveyError(t,n,r,o)}}]),e}();t.default=v;t.KinveyResponse=function(e){function t(){return u(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},n=e.name||e.error,r=e.message||e.description,o=e.debug,i=this.statusCode,u=this.headers.get("X-Kinvey-Request-ID"),s=void 0
;if("APIVersionNotAvailable"===n)s=new f.APIVersionNotAvailableError(r,o,i,u);else if("APIVersionNotImplemented"===n)s=new f.APIVersionNotImplementedError(r,o,i,u);else if("AppProblem"===n)s=new f.AppProblemError(r,o,i,u);else if("AppProblem"===n)s=new f.AppProblemError(r,o,i,u);else if("BadRequest"===n)s=new f.BadRequestError(r,o,i,u);else if("BLInternalError"===n||"BLRuntimeError"===n||"BLSyntaxError"===n||"BLTimeoutError"===n||"BLViolationError"===n)s=new f.BLError(r,o,i,u);else if("CORSDisabled"===n)s=new f.CORSDisabledError(r,o,i,u);else if("DuplicateEndUsers"===n)s=new f.DuplicateEndUsersError(r,o,i,u);else if("FeatureUnavailable"===n)s=new f.FeatureUnavailableError(r,o,i,u);else if("IncompleteRequestBody"===n)s=new f.IncompleteRequestBodyError(r,o,i,u);else if("IndirectCollectionAccessDisallowed"===n)s=new f.IndirectCollectionAccessDisallowedError(r,o,i,u);else if("InsufficientCredentials"===n)s=new f.InsufficientCredentialsError(r,o,i,u);else if("InvalidCredentials"===n)s=new f.InvalidCredentialsError(r,o,i,u);else if("InvalidIdentifier"===n)s=new f.InvalidIdentifierError(r,o,i,u);else if("InvalidQuerySyntax"===n)s=new f.InvalidQuerySyntaxError(r,o,i,u);else if("JSONParseError"===n)s=new f.JSONParseError(r,o,i,u);else if("KinveyInternalErrorRetry"===n)s=new f.KinveyInternalErrorRetry(r,o,i,u);else if("KinveyInternalErrorStop"===n)s=new f.KinveyInternalErrorStop(r,o,i,u);else if("MissingQuery"===n)s=new f.MissingQueryError(r,o,i,u);else if("MissingRequestHeader"===n)s=new f.MissingRequestHeaderError(r,o,i,u);else if("MissingRequestParameter"===n)s=new f.MissingRequestParameterError(r,o,i,u);else if("EntityNotFound"===n||"CollectionNotFound"===n||"AppNotFound"===n||"UserNotFound"===n||"BlobNotFound"===n||"DocumentNotFound"===n)s=new f.NotFoundError(r,o,i,u);else if("ParameterValueOutOfRange"===n)s=new f.ParameterValueOutOfRangeError(r,o,i,u);else if("ServerError"===n)s=new f.ServerError(r,o,i,u);else if("StaleRequest"===n)s=new f.StaleRequestError(r,o,i,u);else if("UserAlreadyExists"===n)s=new f.UserAlreadyExistsError(r,o,i,u);else{if("WritesToCollectionDisallowed"!==n)return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this);s=new f.WritesToCollectionDisallowedError(r,o,i,u)}return s}}]),t}(v)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(280),a=r(u),s=n(131),c=r(s),l=n(129),f=r(l),h=n(40),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.headers={},this.addAll(t)}return i(e,[{key:"get",value:function(e){if(e){(0,c.default)(e)===!1&&(e=String(e));return this.headers[e.toLowerCase()]}}},{key:"set",value:function(e,t){if((0,h.isDefined)(e)===!1||(0,h.isDefined)(t)===!1)throw new Error("A name and value must be provided to set a header.");(0,c.default)(e)===!1&&(e=String(e));var n=this.headers;return e=e.toLowerCase(),(0,c.default)(t)===!1?n[e]=JSON.stringify(t):n[e]=t,this.headers=n,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.set(e.name,e.value)}},{key:"addAll",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof e&&(n=n.toPlainObject()),(0,f.default)(n)===!1)throw new Error("Headers argument must be an object.");var r=Object.keys(n);return(0,a.default)(r,function(e){try{t.set(e,n[e])}catch(e){}}),this}},{key:"remove",value:function(e){if(e){(0,c.default)(e)===!1&&(e=String(e));var t=this.headers;delete t[e.toLowerCase()],this.headers=t}return this}},{key:"clear",value:function(){return this.headers={},this}},{key:"toPlainObject",value:function(){return this.headers}},{key:"toString",value:function(){return JSON.stringify(this.toPlainObject())}}]),e}();t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRack=t.CacheRack=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},c=n(48),l=r(c),f=n(239),h=r(f),d=n(65),p=r(d),v=n(40),y=n(296),b=r(y),g=n(298),m=r(g),_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.middlewares=[],n.canceled=!1,n.activeMiddleware=void 0,n}return u(t,e),a(t,[{key:"use",value:function(e){if((0,v.isDefined)(e)){if(e instanceof m.default)return void this.middlewares.push(e);throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"reset",value:function(){this.middlewares=[]}},{key:"execute",value:function(e){var t=this;return(0,v.isDefined)(e)===!1?l.default.reject(new Error("Request is undefined. Please provide a valid request.")):(0,h.default)((0,b.default)(this.middlewares),function(n,r){return n.then(function(n){var o=n.request,i=n.response;return t.canceled?l.default.reject(new Error("Cancelled")):(t.activeMiddleware=r,r.handle(o||e,i))})},l.default.resolve({request:e})).then(function(e){var n=e.response;return t.canceled===!0?l.default.reject(new Error("Cancelled")):(t.canceled=!1,t.activeMiddleware=void 0,n)}).catch(function(e){throw t.canceled=!1,t.activeMiddleware=void 0,e})}},{key:"cancel",value:function(){return this.canceled=!0,(0,v.isDefined)(this.activeMiddleware)&&(0,p.default)(this.activeMiddleware.cancel)?this.activeMiddleware.cancel():l.default.resolve()}},{key:"handle",value:function(e){return this.execute(e)}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,e);return(0,b.default)(this.middlewares).forEach(function(t){n.nodes.push(t.generateTree(e+1))}),n}}]),t}(m.default);t.default=_;var w=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.use(new g.CacheMiddleware),n}return u(t,e),a(t,[{key:"useCacheMiddleware",value:function(e){this.reset(),this.use(e)}},{key:"execute",value:function(e){return v.Log.debug("Executing cache request",e),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return v.Log.debug("Received response for cache request id: "+e.id,t),t}).catch(function(t){throw v.Log.error("Received error for cache request id: "+e.id,t),t})}}]),t}(_),k=new w;t.CacheRack=k;var E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Network Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.use(new g.SerializeMiddleware),n.use(new g.HttpMiddleware),n.use(new g.ParseMiddleware),n}return u(t,e),a(t,[{key:"useHttpMiddleware",value:function(e){this.reset(),this.use(new g.SerializeMiddleware),this.use(e),this.use(new g.ParseMiddleware)}},{key:"execute",value:function(e){return v.Log.debug("Executing network request",e),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return v.Log.debug("Received response for network request: "+e.id,t),t}).catch(function(t){throw v.Log.error("Received error for network request id: "+e.id,t),t})}}]),t}(_),O=new E;t.NetworkRack=O},function(e,t,n){function r(e){return null==e?[]:o(e,i(e))}var o=n(297),i=n(113);e.exports=r},function(e,t,n){function r(e,t){return o(t,function(t){return e[t]})}var o=n(174);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.SerializeMiddleware=t.ParseMiddleware=t.MemoryAdapter=t.HttpMiddleware=t.CacheMiddleware=void 0;var o=n(299),i=r(o),u=n(310),a=r(u),s=n(300),c=r(s),l=n(311),f=r(l),h=n(312),d=r(h),p=n(302),v=r(p);t.CacheMiddleware=i.default,t.HttpMiddleware=a.default,t.MemoryAdapter=p.MemoryAdapter,t.ParseMiddleware=f.default,t.SerializeMiddleware=d.default,t.Storage=v.default,t.default=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(132),c=r(s),l=n(40),f=n(300),h=r(f),d=n(302),p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Middleware";return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),a(t,[{key:"loadStorage",value:function(e){return new d.Storage(e)}},{key:"handle",value:function(e){var t=e.method,n=e.body,r=e.appKey,o=e.collection,i=e.entityId,u=this.loadStorage(r),a=void 0;return"GET"===t?a=(0,l.isDefined)(i)?u.findById(o,i):u.find(o):"POST"===t||"PUT"===t?a="_group"===i?u.find(o):u.save(o,n):"DELETE"===t&&(a=(0,l.isDefined)(o)===!1?u.clear():u.removeById(o,i)),a.then(function(e){var n={statusCode:"POST"===t?201:200,data:e};return"POST"===t&&"_group"===i&&(n.statusCode=200),((0,l.isDefined)(e)===!1||(0,c.default)(e))&&(n.statusCode=204),n}).catch(function(e){return{statusCode:e.code}}).then(function(e){return{response:e}})}}]),t}(h.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(301),c=r(s),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Middleware";o(this,e),this.name=t}return i(e,[{key:"handle",value:function(){return a.default.reject(new Error("A subclass middleware must override the handle function."))}},{key:"cancel",value:function(){return a.default.resolve()}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{value:this.name,level:e,nodes:[]}}},{key:"toString",value:function(){var e=this.generateTree();return c.default.generate(e)}}]),e}();t.default=l},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(0===e.level)return e.value;for(var n="\r\n",r=t?s:u,o=1;o<e.level;o+=1)n=""+n+(i[o]?" ":c),n+="  ";return""+n+r+a+" "+e.value}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=[],u=String.fromCharCode(9500),a=String.fromCharCode(9472),s=String.fromCharCode(9492),c=String.fromCharCode(9474),l=function(){function e(){n(this,e)}return o(e,null,[{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],o=r(t,n);if(t.nodes.length>0){var u=t.nodes.length-1;t.nodes.forEach(function(t,n){i[t.level]=n===u,o+=e.generate(t,n===u)})}return o}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.MemoryAdapter=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(131),c=r(s),l=n(119),f=r(l),h=n(40),d=n(2),p=n(303),v=new h.Queue(1,1/0);t.MemoryAdapter=p.MemoryAdapter;t.Storage=function(){function e(t){if(o(this,e),!t)throw new d.KinveyError("Unable to create a Storage instance without a name.");if(!(0,c.default)(t))throw new d.KinveyError("The name is not a string. A name must be a string to create a Storage instance.");this.name=t}return i(e,[{key:"loadAdapter",value:function(){var e=this;return a.default.resolve().then(function(){return p.MemoryAdapter.load(e.name)}).then(function(e){return(0,h.isDefined)(e)?e:a.default.reject(new d.KinveyError("Unable to load a storage adapter."))})}},{key:"generateObjectId",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t="abcdef0123456789",n="",r=0,o=t.length;r<e;r+=1){var i=Math.floor(Math.random()*o);n+=t.substring(i,i+1)}return n}},{key:"find",value:function(e){return this.loadAdapter().then(function(t){return h.Log.debug("Find all the entities stored in the "+e+" collection.",t),t.find(e)}).catch(function(t){return h.Log.error("Unable to find all the entities stored in the "+e+" collection.",t),t instanceof d.NotFoundError||404===t.code?[]:a.default.reject(t)}).then(function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]})}},{key:"findById",value:function(e,t){if(!(0,c.default)(t)){var n=new d.KinveyError("id must be a string",t);return h.Log.error("Unable to find an entity with id "+t+" stored in the "+e+" collection.",n.message),a.default.reject(n)}return this.loadAdapter().then(function(n){return h.Log.debug("Find an entity with id "+t+" stored in the "+e+" collection.",n),n.findById(e,t)})}},{key:"save",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return v.add(function(){var r=!1;return(0,h.isDefined)(n)===!1?a.default.resolve(null):((0,f.default)(n)||(r=!0,n=[n]),n=n.map(function(e){if(!(0,h.isDefined)(e._id)){var n=e._kmd||{};n.local=!0,e._kmd=n,e._id=t.generateObjectId()}return e}),t.loadAdapter().then(function(t){return t.save(e,n)}).then(function(e){return r&&e.length>0?e[0]:e}))})}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.default.all(n.map(function(n){return(0,h.isDefined)(n._id)?t.removeById(e,n._id):a.default.reject(new d.KinveyError("Unable to remove this entity because it does not have _id."))})).then(function(e){return e.reduce(function(e,t){return e.count+=t.count,e},{count:0})})}},{key:"removeById",value:function(e,t){var n=this;return v.add(function(){return(0,c.default)(t)?n.loadAdapter().then(function(n){return n.removeById(e,t)}):a.default.reject(new d.KinveyError("id must be a string",t))})}},{key:"clear",value:function(){var e=this;return v.add(function(){return e.loadAdapter().then(function(e){return e.clear()})})}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryAdapter=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(289),c=r(s),l=n(225),f=r(l),h=n(280),d=r(h),p=n(296),v=r(p),y=n(304),b=r(y),g=n(131),m=r(g),_=n(119),w=r(_),k=n(40),E=n(2),O={},S=function(){function e(t){if(o(this,e),!(0,k.isDefined)(t))throw new Error("A name for the collection is required to use the memory persistence adapter.",t);if(!(0,m.default)(t))throw new Error("The name of the collection must be a string to use the memory persistence adapter",t);this.name=t,this.cache=O[t],(0,k.isDefined)(this.cache)||(this.cache=new c.default,O[t]=this.cache)}return i(e,[{key:"find",value:function(e){try{var t=this.cache.get(e);return t?a.default.resolve(JSON.parse(t)):a.default.resolve([])}catch(e){return a.default.reject(e)}}},{key:"findById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(0,b.default)(r,function(e){return e._id===t});return o?o:a.default.reject(new E.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database."))})}},{key:"save",value:function(e,t){var n=this,r=!1;return(0,w.default)(t)||(t=[t],r=!0),0===t.length?a.default.resolve(t):this.find(e).then(function(o){o=(0,f.default)(o,"_id"),t=(0,f.default)(t,"_id");var i=Object.keys(t);return(0,d.default)(i,function(e){o[e]=t[e]}),n.cache.set(e,JSON.stringify((0,v.default)(o))),t=(0,v.default)(t),r?t[0]:t})}},{key:"removeById",value:function(e,t){var n=this;return this.find(e).then(function(r){r=(0,f.default)(r,"_id");var o=r[t];return(0,k.isDefined)(o)?(delete r[t],n.cache.set(e,JSON.stringify((0,v.default)(r))),{count:1}):a.default.reject(new E.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database."))})}},{key:"clear",value:function(){return this.cache.clear(),a.default.resolve(null)}}]),e}(),P={load:function(e){return new S(e)}};t.MemoryAdapter=P},function(e,t,n){var r=n(305),o=n(306),i=r(o);e.exports=i},function(e,t,n){function r(e){return function(t,n,r){var a=Object(t);if(!i(t)){var s=o(n,3);t=u(t),n=function(e){return s(a[e],e,a)}}var c=e(t,n,r);return c>-1?a[s?t[c]:c]:void 0}}var o=n(179),i=n(109),u=n(113);e.exports=r},function(e,t,n){function r(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=null==n?0:u(n);return s<0&&(s=a(r+s,0)),o(e,i(t,3),s)}var o=n(170),i=n(179),u=n(307),a=Math.max;e.exports=r},function(e,t,n){function r(e){var t=o(e),n=t%1;return t===t?n?t-n:t:0}var o=n(308);e.exports=r},function(e,t,n){function r(e){if(!e)return 0===e?e:0;if((e=o(e))===i||e===-i){return(e<0?-1:1)*u}return e===e?e:0}var o=n(309),i=1/0,u=1.7976931348623157e308;e.exports=r},function(e,t,n){function r(e){if("number"==typeof e)return e;if(i(e))return u;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=c.test(e);return n||l.test(e)?f(e.slice(2),n?2:8):s.test(e)?u:+e}var o=n(72),i=n(210),u=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(48),c=r(s),l=n(2),f=n(300),h=r(f),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Http Middleware";return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),a(t,[{key:"handle",value:function(){return c.default.reject(new l.KinveyError("Unable to send network request.","Please override the core HttpMiddleware."))}},{key:"cancel",value:function(){return c.default.resolve()}}]),t}(h.default);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(48),c=r(s),l=n(40),f=n(300),h=r(f),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Parse Middleware";return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),a(t,[{key:"handle",value:function(e,t){if((0,l.isDefined)(t)&&(0,l.isDefined)(t.data)){var n=t.headers["content-type"]||t.headers["Content-Type"];if(n&&0===n.indexOf("application/json"))try{t.data=JSON.parse(t.data)}catch(e){}}return c.default.resolve({response:t})}}]),t}(h.default);t.default=d},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(48),c=r(s),l=n(40),f=n(300),h=r(f),d=function(t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Serialize Middleware";return o(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return u(n,t),a(n,[{key:"handle",value:function(t){if((0,l.isDefined)(t)&&(0,l.isDefined)(t.body)){var n=t.headers["content-type"]||t.headers["Content-Type"];if((0,l.isDefined)(n))if(0===n.indexOf("application/json"))t.body=JSON.stringify(t.body);else if(0===n.indexOf("application/x-www-form-urlencoded")){var r=t.body,o=[];Object.keys(r).forEach(function(t){o.push(e.encodeURIComponent(t)+"="+e.encodeURIComponent(r[t]))}),t.body=o.join("&")}}return c.default.resolve({request:t})}}]),n}(h.default);t.default=d}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r},c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},l=n(48),f=r(l),h=n(225),d=r(h),p=n(239),v=r(p),y=n(314),b=r(y),g=n(296),m=r(g),_=n(280),w=r(_),k=n(119),E=r(k),O=n(131),S=r(O),P=n(2),j=n(40),x=n(275),T=r(x),C=n(287),A=n(315),M=n(245),R=r(M),I=n(293),q=r(I),D=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),a(t,[{key:"execute",value:function(){var e=this;return new R.default({method:C.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client}).execute().then(function(e){return e.data}).catch(function(e){if(!(e instanceof P.NotFoundError))throw e;return[]}).then(function(t){if((0,E.default)(t)&&t.length>0){var n=(0,d.default)(t,"_id"),r=new T.default((0,b.default)(e.query,"toJSON",e.query));return r.fields=["_id","_kmd.lmt"],new A.KinveyRequest({method:C.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:r,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute().then(function(e){return e.data}).then(function(t){var r=(0,d.default)(t,"_id"),o=r,i=Object.keys(n);(0,w.default)(i,function(e){var t=n[e],i=r[e];i&&(0,j.isDefined)(i._kmd)&&(0,j.isDefined)(t._kmd)&&i._kmd.lmt===t._kmd.lmt?delete o[e]:delete n[e]});for(var u=Object.keys(o),a=[],s=0;s<u.length;){var c=new T.default((0,b.default)(e.query,"toJSON",e.query)),l=u.slice(s,u.length>200+s?200:u.length);c.contains("_id",l);var h=new A.KinveyRequest({method:C.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:c,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}),p=h.execute();a.push(p),s+=200}return f.default.all(a)}).then(function(t){var r=(0,v.default)(t,function(e,t){if(t.isSuccess()){var n=e.headers;n.addAll(t.headers),e.headers=n,e.data=e.data.concat(t.data)}return e},new q.default({statusCode:I.StatusCode.Ok,data:[]}));if(r.data=r.data.concat((0,m.default)(n)),e.query){var o=new T.default((0,b.default)(e.query,"toJSON",e.query));o.skip=0,o.limit=0,r.data=o.process(r.data)}return r})}return new A.KinveyRequest({method:C.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:e.query,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute()})}},{key:"method",get:function(){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",this)},set:function(e){switch((0,S.default)(e)||(e=String(e)),e=e.toUpperCase()){case C.RequestMethod.GET:s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",e,this);break;case C.RequestMethod.POST:case C.RequestMethod.PATCH:case C.RequestMethod.PUT:case C.RequestMethod.DELETE:default:throw new P.KinveyError("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]),t}(A.KinveyRequest);t.default=D},function(e,t,n){function r(e,t,n){t=o(t,e);var r=-1,a=t.length;for(a||(a=1,e=void 0);++r<a;){var s=null==e?void 0:e[u(t[r])];void 0===s&&(r=a,s=n),e=i(s)?s.call(e):s}return e}var o=n(208),i=n(65),u=n(216);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(e){var t=0,n=e.length;e=String(e||"");for(var r=0;r<n;r+=1){var o=encodeURI(e[r]).split("%").length;t+=1===o?1:o-1}return t}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyRequest=t.Properties=t.AuthType=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r},l=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},f=n(48),h=r(f),d=n(316),p=n(82),v=r(p),y=n(87),b=r(y),g=n(321),m=r(g),_=n(132),w=r(_),k=n(75),E=r(k),O=n(131),S=r(O),P=n(288),j=r(P),x=n(275),T=r(x),C=n(286),A=r(C),M=n(40),R=n(2),I=(n(324),n(287)),q=r(I),D=n(294),U=r(D),N=n(293),L=n(295),K=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.rack=L.NetworkRack,n}return u(t,e),t}(q.default);t.default=K;var B={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(B),t.AuthType=B;var F={all:function(e){return F.session(e).catch(function(){return F.basic(e)})},app:function(e){return e.appKey&&e.appSecret?h.default.resolve({scheme:"Basic",username:e.appKey,password:e.appSecret
}):h.default.reject(new Error("Missing client appKey and/or appSecret. Use Kinvey.initialize() to set the appKey and appSecret for the client."))},basic:function(e){return F.master(e).catch(function(){return F.app(e)})},master:function(e){return e.appKey&&e.masterSecret?h.default.resolve({scheme:"Basic",username:e.appKey,password:e.masterSecret}):h.default.reject(new Error("Missing client appKey and/or masterSecret. Use Kinvey.initialize() to set the appKey and masterSecret for the client."))},none:function(){return h.default.resolve(null)},session:function(e){var t=e.getActiveUser();return(0,M.isDefined)(t)?h.default.resolve({scheme:"Kinvey",credentials:t._kmd.authtoken}):h.default.reject(new R.NoActiveUserError("There is not an active user. Please login a user and retry the request."))}},H=t.Properties=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),t}(U.default);t.KinveyRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e=(0,b.default)({skipBL:!1,trace:!1},e),n.authType=e.authType||B.None,n.query=e.query,n.aggregation=e.aggregation,n.properties=e.properties||new H,n.skipBL=e.skipBL===!0,n.trace=e.trace===!0,n}return u(t,e),s(t,[{key:"getAuthorizationHeader",value:function(){var e=this,t=h.default.resolve(void 0);if(this.authType)switch(this.authType){case B.All:t=F.all(this.client);break;case B.App:t=F.app(this.client);break;case B.Basic:t=F.basic(this.client);break;case B.Master:t=F.master(this.client);break;case B.None:t=F.none(this.client);break;case B.Session:t=F.session(this.client);break;default:t=F.session(this.client).catch(function(t){return F.master(e.client).catch(function(){throw t})})}return t.then(function(e){if((0,M.isDefined)(e)){var t=e.credentials;return e.username&&(t=new d.Buffer(e.username+":"+e.password).toString("base64")),e.scheme+" "+t}})}},{key:"execute",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getAuthorizationHeader().then(function(t){(0,M.isDefined)(t)?e.headers.set("Authorization",t):e.headers.remove("Authorization")}).then(function(){return l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",e).call(e)}).then(function(e){if(e instanceof N.KinveyResponse==!1&&(e=new N.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})),n===!1&&e.isSuccess()===!1)throw e.error;return e}).catch(function(o){if(r&&o instanceof R.InvalidCredentialsError){var i=e.client.getActiveUser();if((0,M.isDefined)(i)){var u=(0,M.isDefined)(i._socialIdentity)?i._socialIdentity:{},a=Object.keys(u).find(function(e){return"kinveyAuth"===u[e].identity}),s=u[a];if((0,M.isDefined)(s)){return new t({method:I.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:B.App,url:E.default.format({protocol:e.client.micProtocol,host:e.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:s.client_id,redirect_uri:s.redirect_uri,refresh_token:s.refresh_token},properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data}).then(function(t){return t.identity=s.identity,t.client_id=s.client_id,t.redirect_uri=s.redirect_uri,t.protocol=e.client.micProtocol,t.host=e.client.micHost,t}).then(function(n){var r={};return u[n.identity]=n,r._socialIdentity=u,new t({method:I.RequestMethod.POST,authType:B.App,url:E.default.format({protocol:e.client.apiProtocol,host:e.client.apiHost,pathname:"/user/"+e.client.appKey+"/login"}),properties:e.properties,body:r,timeout:e.timeout,client:e.client}).execute().then(function(e){return e.data}).then(function(t){return t._socialIdentity[n.identity]=(0,m.default)(t._socialIdentity[n.identity],n),e.client.setActiveUser(t)})}).then(function(){return e.execute(n,!1)}).catch(function(){return h.default.reject(o)})}}}return h.default.reject(o)})}},{key:"appVersion",get:function(){return this.client.appVersion}},{key:"query",get:function(){return this._query},set:function(e){if((0,M.isDefined)(e)&&!(e instanceof T.default))throw new R.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,M.isDefined)(e)&&!(e instanceof A.default))throw new R.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");(0,M.isDefined)(e)&&(this.body=e.toPlainObject()),this._aggregation=e}},{key:"headers",get:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(e.has("Accept")||e.set("Accept","application/json; charset=utf-8"),e.has("Content-Type")||e.set("Content-Type","application/json; charset=utf-8"),e.has("X-Kinvey-Api-Version")||e.set("X-Kinvey-Api-Version",4),this.skipBL===!0?e.set("X-Kinvey-Skip-Business-Logic",!0):e.remove("X-Kinvey-Skip-Business-Logic"),this.trace===!0?(e.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id"),e.set("X-Kinvey-ResponseWrapper",!0)):(e.remove("X-Kinvey-Include-Headers-In-Response"),e.remove("X-Kinvey-ResponseWrapper")),this.appVersion?e.set("X-Kinvey-Client-App-Version",this.appVersion):e.remove("X-Kinvey-Client-App-Version"),this.properties){var n=this.properties.toString();if((0,w.default)(n))e.remove("X-Kinvey-Custom-Request-Properties");else{var r=a(n);if(r>=2e3)throw new Error("The custom properties are "+r+" bytes.It must be less then 2000 bytes.","Please remove some custom properties.");e.set("X-Kinvey-Custom-Request-Properties",n)}}else e.remove("X-Kinvey-Custom-Request-Properties");return e},set:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",e,this)}},{key:"url",get:function(){var e=l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this),n=this.query?this.query.toQueryString():{};return(0,w.default)(n)?e:(0,M.appendQuery)(e,v.default.stringify(n))},set:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",e,this)}},{key:"properties",get:function(){return this._properties},set:function(e){e&&e instanceof H==!1&&(e=new H(e)),this._properties=e}}],[{key:"executeShort",value:function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=(0,b.default)({method:I.RequestMethod.GET,authType:B.Session},e);n=n||j.default.sharedInstance(),!o.url&&(0,S.default)(o.pathname)&&n&&(o.url=E.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:o.pathname}));var i=t.execute(o);return r&&(i=i.then(function(e){return e.data})),i}},{key:"execute",value:function(e){return new t(e).execute()}}]),t}(K)},function(e,t,n){(function(e){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function r(t){if(t>W)throw new RangeError("Invalid typed array length");var n=new Uint8Array(t);return n.__proto__=e.prototype,n}function e(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return a(e)}return o(e,t,n)}function o(e,t,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return z(e)?l(e,t,n):"string"==typeof e?s(e,t):f(e)}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,n){return i(e),e<=0?r(e):void 0!==t?"string"==typeof n?r(e).fill(t,n):r(e).fill(t):r(e)}function a(e){return i(e),r(e<0?0:0|h(e))}function s(t,n){if("string"==typeof n&&""!==n||(n="utf8"),!e.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|p(t,n),i=r(o),u=i.write(t,n);return u!==o&&(i=i.slice(0,u)),i}function c(e){for(var t=e.length<0?0:0|h(e.length),n=r(t),o=0;o<t;o+=1)n[o]=255&e[o];return n}function l(t,n,r){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");var o;return o=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.__proto__=e.prototype,o}function f(t){if(e.isBuffer(t)){var n=0|h(t.length),o=r(n);return 0===o.length?o:(t.copy(o,0,0,n),o)}if(t){if(G(t)||"length"in t)return"number"!=typeof t.length||V(t.length)?r(0):c(t);if("Buffer"===t.type&&Array.isArray(t.data))return c(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=W)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+W.toString(16)+" bytes");return 0|e}function d(t){return+t!=t&&(t=0),e.alloc(+t)}function p(t,n){if(e.isBuffer(t))return t.length;if(G(t)||z(t))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var o=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(t).length;default:if(o)return L(t).length;n=(""+n).toLowerCase(),o=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(t,n,r,o,i){if(0===t.length)return-1;if("string"==typeof r?(o=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,V(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof n&&(n=e.from(n,o)),e.isBuffer(n))return 0===n.length?-1:g(t,n,r,o,i);if("number"==typeof n)return n&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,n,r):Uint8Array.prototype.lastIndexOf.call(t,n,r):g(t,[n],r,o,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,o){function i(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}var u=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;u=2,a/=2,s/=2,n/=2}var c;if(o){var l=-1;for(c=n;c<a;c++)if(i(e,c)===i(t,l===-1?0:c-l)){if(l===-1&&(l=c),c-l+1===s)return l*u}else l!==-1&&(c-=c-l),l=-1}else for(n+s>a&&(n=a-s),c=n;c>=0;c--){for(var f=!0,h=0;h<s;h++)if(i(e,c+h)!==i(t,h)){f=!1;break}if(f)return c}return-1}function m(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var u=0;u<r;++u){var a=parseInt(t.substr(2*u,2),16);if(V(a))return u;e[n+u]=a}return u}function _(e,t,n,r){return H(L(t,e.length-n),e,n,r)}function w(e,t,n,r){return H(K(t),e,n,r)}function k(e,t,n,r){return w(e,t,n,r)}function E(e,t,n,r){return H(F(t),e,n,r)}function O(e,t,n,r){return H(B(t,e.length-n),e,n,r)}function S(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function P(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],u=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var s,c,l,f;switch(a){case 1:i<128&&(u=i);break;case 2:s=e[o+1],128==(192&s)&&(f=(31&i)<<6|63&s)>127&&(u=f);break;case 3:s=e[o+1],c=e[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(u=f);break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(u=f)}}null===u?(u=65533,a=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=a}return j(r)}function j(e){var t=e.length;if(t<=Y)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Y));return n}function x(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function C(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=N(e[i]);return o}function A(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,n,r,o,i,u){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>i||n<u)throw new RangeError('"value" argument is out of bounds');if(r+o>t.length)throw new RangeError("Index out of range")}function I(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,n,r,o){return t=+t,n>>>=0,o||I(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,o){return t=+t,n>>>=0,o||I(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(e,t,n,r,52,8),n+8}function U(e){if(e=e.trim().replace(X,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function L(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],u=0;u<r;++u){if((n=e.charCodeAt(u))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(u+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function K(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function B(e,t){for(var n,r,o,i=[],u=0;u<e.length&&!((t-=2)<0);++u)n=e.charCodeAt(u),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function F(e){return $.toByteArray(U(e))}function H(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function z(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function G(e){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(e)}function V(e){return e!==e}var $=n(318),Q=n(319);t.Buffer=e,t.SlowBuffer=d,t.INSPECT_MAX_BYTES=50;var W=2147483647;t.kMaxLength=W,e.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(e,t,n){return o(e,t,n)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(e,t,n){return u(e,t,n)},e.allocUnsafe=function(e){return a(e)},e.allocUnsafeSlow=function(e){return a(e)},e.isBuffer=function(e){return null!=e&&e._isBuffer===!0},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,o=n.length,i=0,u=Math.min(r,o);i<u;++i)if(t[i]!==n[i]){r=t[i],o=n[i];break}return r<o?-1:o<r?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var o=e.allocUnsafe(n),i=0;for(r=0;r<t.length;++r){var u=t[r];if(!e.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(o,i),i+=u.length}return o},e.byteLength=p,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},e.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?P(this,0,e):v.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,n,r,o,i){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),n<0||r>t.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&n>=r)return 0;if(o>=i)return-1;if(n>=r)return 1;if(n>>>=0,r>>>=0,o>>>=0,i>>>=0,this===t)return 0;for(var u=i-o,a=r-n,s=Math.min(u,a),c=this.slice(o,i),l=t.slice(n,r),f=0;f<s;++f)if(c[f]!==l[f]){u=c[f],a=l[f];break}return u<a?-1:a<u?1:0},e.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},e.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},e.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return m(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),n<0?(n+=r)<0&&(n=0):n>r&&(n=r),n<t&&(n=t);var o=this.subarray(t,n);return o.__proto__=e.prototype,o},e.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},e.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},e.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),Q.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),Q.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),Q.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),Q.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){R(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){R(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},e.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},e.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},e.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=0,u=1,a=0;for(this[t]=255&e;++i<n&&(u*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=n-1,u=1,a=0;for(this[t+i]=255&e;--i>=0&&(u*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},e.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},e.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},e.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},e.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},e.prototype.fill=function(t,n,r,o){if("string"==typeof t){if("string"==typeof n?(o=n,n=0,r=this.length):"string"==typeof r&&(o=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!e.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var u;if("number"==typeof t)for(u=n;u<r;++u)this[u]=t;else{var a=e.isBuffer(t)?t:new e(t,o),s=a.length;for(u=0;u<r-n;++u)this[u+n]=a[u%s]}return this};var X=/[^+\/0-9A-Za-z-_]/g}).call(t,n(317).Buffer)},function(e,t,n){(function(e){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=i.prototype):(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,n,r):"string"==typeof t?l(e,t,n):d(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function s(e,t,n,r){return a(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function c(e,t){if(a(t),e=o(e,t<0?0:0|p(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function l(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|y(t,n);e=o(e,r);var u=e.write(t,n);return u!==r&&(e=e.slice(0,u)),e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),i.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=i.prototype):e=f(e,t),e}function d(e,t){if(i.isBuffer(t)){var n=0|p(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||W(t.length)?o(e,0):f(e,t);if("Buffer"===t.type&&J(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),i.alloc(+e)}function y(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return z(e).length;t=(""+t).toLowerCase(),r=!0}}function b(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return j(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:_(e,t,n,r,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,r,o){function i(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}var u=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;u=2,a/=2,s/=2,n/=2}var c;if(o){var l=-1;for(c=n;c<a;c++)if(i(e,c)===i(t,l===-1?0:c-l)){if(l===-1&&(l=c),c-l+1===s)return l*u}else l!==-1&&(c-=c-l),l=-1}else for(n+s>a&&(n=a-s),c=n;c>=0;c--){for(var f=!0,h=0;h<s;h++)if(i(e,c+h)!==i(t,h)){f=!1;break}if(f)return c}return-1}function w(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var u=0;u<r;++u){var a=parseInt(t.substr(2*u,2),16);if(isNaN(a))return u;e[n+u]=a}return u}function k(e,t,n,r){return Q(z(t,e.length-n),e,n,r)}function E(e,t,n,r){return Q(G(t),e,n,r)}function O(e,t,n,r){return E(e,t,n,r)}function S(e,t,n,r){return Q($(t),e,n,r)}function P(e,t,n,r){return Q(V(t,e.length-n),e,n,r)}function j(e,t,n){return 0===t&&n===e.length?Y.fromByteArray(e):Y.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],u=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var s,c,l,f;switch(a){case 1:i<128&&(u=i);break;case 2:s=e[o+1],128==(192&s)&&(f=(31&i)<<6|63&s)>127&&(u=f);break;case 3:s=e[o+1],c=e[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(u=f);break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(u=f)}}null===u?(u=65533,a=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=a}return T(r)}function T(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Z));return n}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=H(e[i]);return o}function R(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function q(e,t,n,r,o,u){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<u)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function U(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function N(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return o||N(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,n,r,23,4),n+4}function K(e,t,n,r,o){return o||N(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,n,r,52,8),n+8}function B(e){if(e=F(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function F(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],u=0;u<r;++u){if((n=e.charCodeAt(u))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(u+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function G(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function V(e,t){for(var n,r,o,i=[],u=0;u<e.length&&!((t-=2)<0);++u)n=e.charCodeAt(u),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function $(e){return Y.toByteArray(B(e))}function Q(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function W(e){return e!==e}var Y=n(318),X=n(319),J=n(320);t.Buffer=i,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return u(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return s(null,e,t,n)},i.allocUnsafe=function(e){return c(null,e)},i.allocUnsafeSlow=function(e){return c(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,u=Math.min(n,r);o<u;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!J(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var u=e[n];if(!i.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(r,o),o+=u.length}return r},i.byteLength=y,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):b.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var u=o-r,a=n-t,s=Math.min(u,a),c=this.slice(r,o),l=e.slice(t,n),f=0;f<s;++f)if(c[f]!==l[f]){u=c[f],a=l[f];break}return u<a?-1:a<u?1:0},i.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},i.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return O(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=i.prototype;else{var o=t-e;r=new i(o,void 0);for(var u=0;u<o;++u)r[u]=this[u+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},i.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},i.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),X.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),X.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),X.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),X.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){q(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){q(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var i=0,u=1,a=0;for(this[t]=255&e;++i<n&&(u*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);q(this,e,t,n,o-1,-o)}var i=n-1,u=1,a=0;for(this[t+i]=255&e;--i>=0&&(u*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return K(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return K(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,u=r-n;if(this===e&&n<t&&t<r)for(o=u-1;o>=0;--o)e[o+t]=this[o+n];else if(u<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<u;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+u),t);return u},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var u;if("number"==typeof e)for(u=t;u<n;++u)this[u]=e;else{var a=i.isBuffer(e)?e:z(new i(e,r).toString()),s=a.length;for(u=0;u<n-t;++u)this[u+t]=a[u%s]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function r(e){return 3*e.length/4-n(e)}function o(e){var t,r,o,i,u,a=e.length;i=n(e),u=new l(3*a/4-i),r=i>0?a-4:a;var s=0;for(t=0;t<r;t+=4)o=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],u[s++]=o>>16&255,u[s++]=o>>8&255,u[s++]=255&o;return 2===i?(o=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,u[s++]=255&o):1===i&&(o=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,u[s++]=o>>8&255,u[s++]=255&o),u}function i(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function u(e,t,n){for(var r,o=[],u=t;u<n;u+=3)r=(e[u]<<16)+(e[u+1]<<8)+e[u+2],o.push(i(r));return o.join("")}function a(e){for(var t,n=e.length,r=n%3,o="",i=[],a=0,c=n-r;a<c;a+=16383)i.push(u(e,a,a+16383>c?c:a+16383));return 1===r?(t=e[n-1],o+=s[t>>2],o+=s[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=s[t>>10],o+=s[t>>4&63],o+=s[t<<2&63],o+="="),i.push(o),i.join("")}t.byteLength=r,t.toByteArray=o,t.fromByteArray=a;for(var s=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,d=f.length;h<d;++h)s[h]=f[h],c[f.charCodeAt(h)]=h;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,u,a=8*o-r-1,s=(1<<a)-1,c=s>>1,l=-7,f=n?o-1:0,h=n?-1:1,d=e[t+f];for(f+=h,i=d&(1<<-l)-1,d>>=-l,l+=a;l>0;i=256*i+e[t+f],f+=h,l-=8);for(u=i&(1<<-l)-1,i>>=-l,l+=r;l>0;u=256*u+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===s)return u?NaN:1/0*(d?-1:1);u+=Math.pow(2,r),i-=c}return(d?-1:1)*u*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var u,a,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=l):(u=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-u))<1&&(u--,s*=2),t+=u+f>=1?h/s:h*Math.pow(2,1-f),t*s>=2&&(u++,s/=2),u+f>=l?(a=0,u=l):u+f>=1?(a=(t*s-1)*Math.pow(2,o),u+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),u=0));o>=8;e[n+d]=255&a,d+=p,a/=256,o-=8);for(u=u<<o|a,c+=o;c>0;e[n+d]=255&u,d+=p,u/=256,c-=8);e[n+d-p]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(103),o=n(322),i=n(100),u=n(323),a=i(function(e){return e.push(void 0,u),r(o,void 0,e)});e.exports=a},function(e,t,n){var r=n(98),o=n(99),i=n(253),u=o(function(e,t,n,o){r(t,i(t),e,o)});e.exports=u},function(e,t,n){function r(e,t,n,r){return void 0===e||o(e,i[n])&&!u.call(r,n)?t:e}var o=n(97),i=Object.prototype,u=i.hasOwnProperty;e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SocialIdentity=t.MobileIdentityConnect=t.AuthorizationGrant=void 0;var r=n(325),o=n(326);t.AuthorizationGrant=o.AuthorizationGrant,t.MobileIdentityConnect=o.MobileIdentityConnect,t.SocialIdentity=r.SocialIdentity},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={Kinvey:"kinvey",MobileIdentityConnect:"kinveyAuth"};Object.freeze(n),t.SocialIdentity=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnect=t.AuthorizationGrant=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(48),c=r(s),l=n(131),f=r(l),h=n(75),d=r(h),p=n(327),v=r(p),y=n(244),b=n(2),g=n(40),m=n(328),_=r(m),w=n(330),k=r(w),E=n(325),O=_.default,S={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(S),t.AuthorizationGrant=S;t.MobileIdentityConnect=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),a(t,[{key:"isSupported",value:function(){return!0}},{key:"login",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.AuthorizationCodeLoginPage,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.client.appKey;return(0,f.default)(o.micId)&&(i=i+"."+o.micId),c.default.resolve().then(function(){if(r===S.AuthorizationCodeLoginPage)return n.requestCodeWithPopup(i,e,o);if(r===S.AuthorizationCodeAPI)return n.requestTempLoginUrl(i,e,o).then(function(t){return n.requestCodeWithUrl(t,i,e,o)});throw new b.KinveyError("The authorization grant "+r+" is unsupported. Please use a supported authorization grant.")}).then(function(t){return n.requestToken(t,i,e,o)}).then(function(r){return r.identity=t.identity,r.client_id=i,r.redirect_uri=e,r.protocol=n.client.micProtocol,r.host=n.client.micHost,r})}},{key:"refresh",value:function(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return c.default.resolve().then(function(){return o.refreshToken(e,n,r,i)}).then(function(e){return e.identity=t.identity,e.client_id=n,e.redirect_uri=r,e.protocol=o.client.micProtocol,e.host=o.client.micHost,e})}},{key:"requestTempLoginUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="/oauth/auth";if(n.version){var o=n.version;(0,f.default)(o)===!1&&(o=String(o)),r=(0,v.default)(0===o.indexOf("v")?o:"v"+o,r)}return new y.KinveyRequest({method:y.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:d.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:r}),properties:n.properties,body:{client_id:e,redirect_uri:t,response_type:"code"}}).execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.default.resolve().then(function(){var o="/oauth/auth",i=new O;if(r.version){var u=r.version;(0,f.default)(u)||(u=String(u)),o=(0,v.default)(0===u.indexOf("v")?u:"v"+u,o)}return i.open(d.default.format({protocol:n.client.micProtocol,host:n.client.micHost,pathname:o,query:{client_id:e,redirect_uri:t,response_type:"code"}}))}).then(function(e){return new c.default(function(n,r){function o(r){try{r.url&&0===r.url.indexOf(t)&&a===!1&&(a=!0,e.removeAllListeners(),e.close(),n(d.default.parse(r.url,!0).query.code))}catch(e){}}function i(o){try{o.url&&0===o.url.indexOf(t)&&a===!1?(a=!0,e.removeAllListeners(),e.close(),n(d.default.parse(o.url,!0).query.code)):a===!1&&(e.removeAllListeners(),e.close(),r(new b.KinveyError(o.message,"",o.code)))}catch(e){}}function u(){a===!1&&(e.removeAllListeners(),r(new b.KinveyError("Login has been cancelled.")))}var a=!1;e.on("loadstart",o),e.on("loadstop",o),e.on("error",i),e.on("exit",u)})})}},{key:"requestCodeWithUrl",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return c.default.resolve().then(function(){return new y.KinveyRequest({method:y.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:e,properties:r.properties,body:{client_id:t,redirect_uri:n,response_type:"code",username:r.username,password:r.password},followRedirect:!1}).execute()}).then(function(e){var t=e.headers.get("location");if(t)return d.default.parse(t,!0).query.code;throw new b.MobileIdentityConnectError("Unable to authorize user with username "+r.username+".","A location header was not provided with a code to exchange for an auth token.")})}},{key:"requestToken",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new y.KinveyRequest({method:y.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:y.AuthType.App,url:d.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),properties:r.properties,body:{grant_type:"authorization_code",client_id:t,redirect_uri:n,code:e}}).execute().then(function(e){return e.data})}},{key:"refreshToken",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new y.KinveyRequest({method:y.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:y.AuthType.App,url:d.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:t,redirect_uri:n,refresh_token:e},properties:r.properties,timeout:r.timeout}).execute().then(function(e){return e.data})}},{key:"logout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new y.KinveyRequest({method:y.RequestMethod.GET,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:y.AuthType.App,url:d.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/invalidate",query:{user:e._id}}),properties:t.properties}).execute().then(function(e){return e.data})}},{key:"identity",get:function(){return E.SocialIdentity.MobileIdentityConnect}}],[{key:"isSupported",value:function(){return!0}},{key:"usePopupClass",value:function(e){(0,g.isDefined)(e)&&(O=e)}},{key:"identity",get:function(){return E.SocialIdentity.MobileIdentityConnect}}]),t}(k.default)},function(e,t,n){var r,o;!function(i,u,a){void 0!==e&&e.exports?e.exports=a():(r=a,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o))}(0,0,function(){function e(e,t){return e.substr(0,t.length)===t}function t(t,n){return e(t,"file://")?t=t.replace(/(\/{0,3})\/*/g,"$1"):(t=t.replace(/:\//g,"://"),t=t.replace(/([^:\s\%\3\A])\/+/g,"$1/")),t=t.replace(/\/(\?|&|#[^!])/g,"$1"),t=t.replace(/(\?.+)\?/g,"$1&")}return function(){var e=arguments,n={};return"object"==typeof arguments[0]&&(e=arguments[0],n=arguments[1]||{}),t([].slice.call(e,0).join("/"),n)}})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(329),s=n(2),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"open",value:function(){throw new s.PopupError("Unable to open a popup on this platform.")}},{key:"close",value:function(){return this}}],[{key:"isSupported",value:function(){return!1}}]),t}(a.EventEmitter);t.default=c},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,
n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,a,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],u(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),c=n.slice(),o=c.length,s=0;s<o;s++)c[s].apply(this,a);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=u(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,u,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],u=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=u;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(288),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(2),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.client=t.client||u.default.sharedInstance()}return o(e,[{key:"isSupported",value:function(){return!1}},{key:"isOnline",value:function(e){var t=(new Date).getTime()/1e3;return e&&e.access_token&&e.expires>t}},{key:"identity",get:function(){throw new a.KinveyError("A subclass must override this property.")}}],[{key:"isSupported",value:function(){return!1}},{key:"identity",get:function(){throw new a.KinveyError("A subclass must override this property.")}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.User=t.Metadata=t.Acl=void 0;var o=n(332),i=r(o),u=n(333),a=r(u),s=n(334),c=r(s);t.Acl=i.default,t.Metadata=a.default,t.User=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(129),a=r(u),s=n(119),c=r(s),l=n(87),f=r(l),h=n(2),d=n(40),p=function(){function e(t){if(o(this,e),(0,a.default)(t)===!1)throw new h.KinveyError("entity argument must be an object");t._acl=t._acl||{},this.entity=t}return i(e,[{key:"addReader",value:function(e){var t=this.readers;return t.indexOf(e)===-1&&t.push(e),this.entity._acl.r=t,this}},{key:"addReaderGroup",value:function(e){var t=this.readerGroups;return t.indexOf(e)===-1&&t.push(e),this.entity._acl.groups=(0,f.default)({},this.entity._acl.groups,{r:t}),this}},{key:"addWriter",value:function(e){var t=this.writers;return t.indexOf(e)===-1&&t.push(e),this.entity._acl.w=t,this}},{key:"addWriterGroup",value:function(e){var t=this.writerGroups;return t.indexOf(e)===-1&&t.push(e),this.entity._acl.groups=(0,f.default)({},this.entity._acl.groups,{w:t}),this}},{key:"isGloballyReadable",value:function(){return this.entity._acl.gr===!0&&this.entity._acl.gr}},{key:"isGloballyWritable",value:function(){return this.entity._acl.gw===!0&&this.entity._acl.gw}},{key:"removeReader",value:function(e){var t=this.readers,n=t.indexOf(e);return n!==-1&&t.splice(n,1),this.entity._acl.r=t,this}},{key:"removeReaderGroup",value:function(e){var t=this.readerGroups,n=t.indexOf(e);return n!==-1&&t.splice(n,1),this.entity._acl.groups=(0,f.default)({},this.entity._acl.groups,{r:t}),this}},{key:"removeWriter",value:function(e){var t=this.writers,n=t.indexOf(e);return n!==-1&&t.splice(n,1),this.entity._acl.w=t,this}},{key:"removeWriterGroup",value:function(e){var t=this.writerGroups,n=t.indexOf(e);return n!==-1&&t.splice(n,1),this.entity._acl.groups=(0,f.default)({},this.entity._acl.groups,{w:t}),this}},{key:"toPlainObject",value:function(){return this.entity._acl}},{key:"creator",get:function(){return this.entity._acl.creator}},{key:"readers",get:function(){return(0,c.default)(this.entity._acl.r)?this.entity._acl.r:[]}},{key:"writers",get:function(){return(0,c.default)(this.entity._acl.w)?this.entity._acl.w:[]}},{key:"readerGroups",get:function(){return(0,d.isDefined)(this.entity._acl.groups)&&(0,c.default)(this.entity._acl.groups.r)?this.entity._acl.groups.r:[]}},{key:"writerGroups",get:function(){return(0,d.isDefined)(this.entity._acl.groups)&&(0,c.default)(this.entity._acl.groups.w)?this.entity._acl.groups.w:[]}},{key:"globallyReadable",set:function(e){this.entity._acl.gr=e===!0&&e}},{key:"globallyWritable",set:function(e){this.entity._acl.gw=e===!0&&e}}]),e}();t.default=p},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(129),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(2),s=n(40),c=function(){function e(t){if(r(this,e),(0,u.default)(t)===!1)throw new a.KinveyError("entity argument must be an object");t._kmd=t._kmd||{},this.entity=t}return o(e,[{key:"isLocal",value:function(){return this.entity._kmd.local===!0}},{key:"toPlainObject",value:function(){return this.entity._kmd}},{key:"createdAt",get:function(){if((0,s.isDefined)(this.entity._kmd.ect))return new Date(this.entity._kmd.ect)}},{key:"ect",get:function(){return this.createdAt}},{key:"emailVerification",get:function(){if((0,s.isDefined)(this.entity._kmd.emailVerification))return this.entity._kmd.emailVerification.status}},{key:"lastModified",get:function(){if((0,s.isDefined)(this.entity._kmd.lmt))return new Date(this.entity._kmd.lmt)}},{key:"lmt",get:function(){return this.lastModified}},{key:"authtoken",get:function(){return this.entity._kmd.authtoken}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(87),c=r(s),l=n(131),f=r(l),h=n(72),d=r(h),p=n(132),v=r(p),y=n(75),b=r(y),g=n(288),m=r(g),_=n(244),w=n(2),k=n(139),E=r(k),O=n(324),S=n(40),P=n(332),j=r(P),x=n(333),T=r(x),C=n(335),A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.data=t,this.client=n.client||m.default.sharedInstance()}return i(e,[{key:"isActive",value:function(){var t=e.getActiveUser(this.client);return!(!(0,S.isDefined)(t)||t._id!==this._id)}},{key:"isEmailVerified",value:function(){return"confirmed"===this.metadata.emailVerification}},{key:"login",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t,u=this.isActive(),s=e.getActiveUser(this.client);return u===!0?a.default.reject(new w.ActiveUserError("This user is already the active user.")):(0,S.isDefined)(s)?a.default.reject(new w.ActiveUserError("An active user already exists. Please logout the active user before you login.")):((0,d.default)(i)?o=n||{}:i={username:t,password:n},(0,S.isDefined)(i.username)&&(i.username=String(i.username).trim()),(0,S.isDefined)(i.password)&&(i.password=String(i.password).trim()),(0,S.isDefined)(i.username)&&""!==i.username&&(0,S.isDefined)(i.password)&&""!==i.password||(0,S.isDefined)(i._socialIdentity)?new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.App,url:b.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:i,properties:o.properties,timeout:o.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){return(0,S.isDefined)(i._socialIdentity)&&(0,S.isDefined)(e._socialIdentity)&&(Object.keys(e._socialIdentity).forEach(function(t){e._socialIdentity[t]=(0,c.default)({},i._socialIdentity[t],e._socialIdentity[t])}),e._socialIdentity=(0,c.default)({},i._socialIdentity,e._socialIdentity)),delete e.password,r.client.setActiveUser(e)}).then(function(e){return r.data=e,r}):a.default.reject(new w.KinveyError("Username and/or password missing. Please provide both a username and password to login.")))}},{key:"loginWithMIC",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.isActive(),u=e.getActiveUser(this.client);return i?a.default.reject(new w.ActiveUserError("This user is already the active user.")):(0,S.isDefined)(u)?a.default.reject(new w.ActiveUserError("An active user already exists. Please logout the active user before you login.")):new O.MobileIdentityConnect({client:this.client}).login(t,n,o).then(function(e){return r.connectIdentity(O.MobileIdentityConnect.identity,e,o)})}},{key:"connectIdentity",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.isActive(),i={},u=i._socialIdentity||{};return u[e]=t,i._socialIdentity=u,o?this.update(i,r):this.login(i,r).catch(function(o){if(o instanceof w.NotFoundError)return n.signup(i,r).then(function(){return n.connectIdentity(e,t,r)});throw o})}},{key:"disconnectIdentity",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.default.resolve();return e===O.MobileIdentityConnect.identity&&(r=O.MobileIdentityConnect.logout(this,n)),r.catch(function(e){S.Log.error(e)}).then(function(){var r=t.data,o=r._socialIdentity||{};return delete o[e],r._socialIdentity=o,t.data=r,t._id?t.update(r,n):t}).then(function(){return t})}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.Session,url:b.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:t.properties,timeout:t.timeout,client:this.client});return this.unregisterFromLiveService().then(function(){return n.execute()}).catch(function(e){return S.Log.error(e),null}).then(function(){return e.client.setActiveUser(null)}).catch(function(e){return S.Log.error(e),null}).then(function(){return E.default.clearCache({client:e.client})}).catch(function(e){return S.Log.error(e),null}).then(function(){return e})}},{key:"signup",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.getActiveUser(this.client);if(r=(0,c.default)({state:!0},r),r.state===!0&&(0,S.isDefined)(o))throw new w.ActiveUserError("An active user already exists. Please logout the active user before you login.");return t instanceof e&&(t=t.data),t=(0,c.default)(this.data,t),new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.App,url:b.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname}),body:(0,v.default)(t)?null:t,properties:r.properties,timeout:r.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){return r.state===!0?n.client.setActiveUser(e):e}).then(function(e){return n.data=e,n})}},{key:"signupWithIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return r._socialIdentity={},r._socialIdentity[e]=t,this.signup(r,n)}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=(0,c.default)(this.data,e),(new k.UserStore).update(e,n).then(function(e){return t.isActive()?t.client.setActiveUser(e):e}).then(function(e){return t.data=e,t})}},{key:"me",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new _.KinveyRequest({method:_.RequestMethod.GET,authType:_.AuthType.Session,url:b.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_me"}),properties:t.properties,timeout:t.timeout}).execute().then(function(e){return e.data}).then(function(t){return t=(0,c.default)(e.data,t),delete t.password,e.isActive()?e.client.setActiveUser(t):t}).then(function(t){return e.data=t,e})}},{key:"registerForLiveService",value:function(){var e=(0,C.getLiveService)(this.client),t=a.default.resolve();return e.isInitialized()||(t=e.fullInitialization(this)),t}},{key:"unregisterFromLiveService",value:function(){var e=(0,C.getLiveService)(this.client),t=a.default.resolve();return e.isInitialized()&&(t=e.fullUninitialization()),t}},{key:"_id",get:function(){return this.data._id}},{key:"_acl",get:function(){return new j.default(this.data)}},{key:"metadata",get:function(){return new T.default(this.data)}},{key:"_kmd",get:function(){return this.metadata}},{key:"_socialIdentity",get:function(){return this.data._socialIdentity}},{key:"authtoken",get:function(){return this.metadata.authtoken}},{key:"username",get:function(){return this.data.username}},{key:"email",get:function(){return this.data.email}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}],[{key:"login",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).login(e,t,n)}},{key:"loginWithMIC",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).loginWithMIC(e,t,n)}},{key:"connectIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).connectIdentity(e,t,n)}},{key:"logout",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getActiveUser(t.client);return(0,S.isDefined)(n)?n.logout(t):a.default.resolve(null)}},{key:"signup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this({},t).signup(e,t)}},{key:"signupWithIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).signupWithIdentity(e,t,n)}},{key:"update",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.getActiveUser(n.client);return(0,S.isDefined)(r)?r.update(t,n):a.default.resolve(null)}},{key:"registerForLiveService",value:function(){var t=e.getActiveUser();return t?t.registerForLiveService():a.default.reject(new w.ActiveUserError("There is no active user"))}},{key:"unregisterFromLiveService",value:function(){var t=e.getActiveUser();return t?t.unregisterFromLiveService():a.default.reject(new w.ActiveUserError("There is no active user"))}},{key:"me",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getActiveUser(t.client);return n?n.me(t):a.default.resolve(null)}},{key:"getActiveUser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.default.sharedInstance(),t=e.getActiveUser();return(0,S.isDefined)(t)?new this(t,{client:e}):null}},{key:"verifyEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return a.default.reject(new w.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,f.default)(e))return a.default.reject(new w.KinveyError("The provided username is not a string."));var n=t.client||m.default.sharedInstance();return new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.App,url:b.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+e+"/user-email-verification-initiate"}),properties:t.properties,timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"forgotUsername",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return a.default.reject(new w.KinveyError("An email was not provided.","Please provide an email for the user that you would like to retrieve their username."));if(!(0,f.default)(e))return a.default.reject(new w.KinveyError("The provided email is not a string."));var n=t.client||m.default.sharedInstance();return new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.App,url:b.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/user-forgot-username"}),properties:t.properties,data:{email:e},timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"resetPassword",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return a.default.reject(new w.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,f.default)(e))return a.default.reject(new w.KinveyError("The provided username is not a string."));var n=t.client||m.default.sharedInstance();return new _.KinveyRequest({method:_.RequestMethod.POST,authType:_.AuthType.App,url:b.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+e+"/user-password-reset-initiate"}),properties:t.properties,timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"lookup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new k.UserStore).lookup(e,t)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new k.UserStore).exists(e,t)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new k.UserStore).removeById(e,t)}},{key:"restore",value:function(){return a.default.reject(new w.KinveyError("This function requires a master secret to be provided for your application. We strongly advise not to do this."))}}]),e}();t.default=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(336);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(343);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(338);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(342);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(349);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(337);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return h||(h=new f(e)),h}Object.defineProperty(t,"__esModule",{value:!0}),t.LiveCollectionManager=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getLiveCollectionManager=o;var u=n(288),a=function(e){return e&&e.__esModule?e:{default:e}}(u),s=n(2),c=n(244),l=n(338),f=t.LiveCollectionManager=function(){function e(t){r(this,e),this._client=t||a.default.sharedInstance()}return i(e,[{key:"subscribeCollection",value:function(e,t){var n=this;return(0,l.isValidChannelName)(e)?(0,l.isValidReceiver)(t)?this._makeSubscriptionRequest(e,"_subscribe").then(function(){var r=n._buildChannelName(e);(0,l.getLiveService)().subscribeToChannel(r,t)}):Promise.reject(new s.KinveyError("Invalid or missing receiver")):Promise.reject(new s.KinveyError("Invalid or missing collection name"))}},{key:"unsubscribeCollection",value:function(e){var t=this;return(0,l.isValidChannelName)(e)?this._makeSubscriptionRequest(e,"_unsubscribe").then(function(){var n=t._buildChannelName(e);(0,l.getLiveService)().unsubscribeFromChannel(n)}):Promise.reject(new s.KinveyError("Invalid or missing collection name"))}},{key:"_buildChannelName",value:function(e){return this._client.appKey+".c-"+e}},{key:"_makeSubscriptionRequest",value:function(e,t){return c.KinveyRequest.executeShort({method:c.RequestMethod.POST,pathname:"/appdata/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}})}}]),e}(),h=void 0},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(!e)return!1;var t=e.onMessage,n=e.onError,r=e.onStatus;return(0,h.default)(t)||(0,h.default)(n)||(0,h.default)(r)}function u(e){return(0,m.isNonemptyString)(e)}function a(e){return k||(k=new w(e)),k}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidReceiver=t.isValidChannelName=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getLiveService=a;var c=n(339),l=r(c),f=n(65),h=r(f),d=n(340),p=r(d),v=n(288),y=r(v),b=n(244),g=n(2),m=n(40),_=n(342),w=function(){function e(t){o(this,e),this._client=t||y.default.sharedInstance()}return s(e,[{key:"fullInitialization",value:function(e){var t=this;return this.registerUser(e).then(function(e){var n=new l.default(e),r=new _.PubNubListener;t.initialize(n,r)})}},{key:"fullUninitialization",value:function(){var e=this;return this.unregisterUser().then(function(t){return e.uninitialize(),t})}},{key:"isInitialized",value:function(){return!!this.__pubnubClient&&!!this.__pubnubListener&&!!this._registeredUser}},{key:"registerUser",value:function(e){var t=this;return e&&e.isActive()?this.isInitialized()?Promise.reject(new g.KinveyError("Live service already initialized")):this._makeRegisterRequest(e._id).then(function(n){return t._registeredUser=e,t._userChannelGroup=n.userChannelGroup,(0,p.default)({ssl:!0,authKey:t._registeredUser._kmd.authtoken},n)}):Promise.reject(new g.ActiveUserError("Missing or invalid active user"))}},{key:"initialize",value:function(e,t){if(this.isInitialized())throw new g.KinveyError("Live service already initialized");this._pubnubListener=t,this._pubnubClient=e,this._pubnubClient.addListener(this._pubnubListener),this._subscribeToUserChannelGroup()}},{key:"uninitialize",value:function(){this._unsubscribeFromAll(),this._pubnubClient=null,this._pubnubListener=null}},{key:"onConnectionStatusUpdates",value:function(e){this._pubnubListener.on(_.PubNubListener.unclassifiedEvents,e),this._pubnubListener.on(this._userChannelGroup,e)}},{key:"offConnectionStatusUpdates",value:function(e){e?(this._pubnubListener.removeListener(_.PubNubListener.unclassifiedEvents,e),this._pubnubListener.removeListener(this._userChannelGroup,e)):(this._pubnubListener.removeAllListeners(_.PubNubListener.unclassifiedEvents),this._pubnubListener.removeAllListeners(this._userChannelGroup))}},{key:"publishToChannel",value:function(e,t){if(!this.isInitialized())return Promise.reject(new g.KinveyError("Live service is not initialized"));var n=this._validatePublishData(e,t);return n?Promise.reject(n):this._pubnubClient.publish({message:t,channel:e}).catch(function(e){e=e.status&&e.status.errorData;var t=new b.Response({data:e,statusCode:e.status,headers:e.response&&e.response.headers});return Promise.reject(t)})}},{key:"subscribeToChannel",value:function(e,t){var n=this._validateSubscribeData(e,t);if(n)throw n;this._subscribeToListener(e,t)}},{key:"unsubscribeFromChannel",value:function(e){this._unsubscribeFromListener(e)}},{key:"unregisterUser",value:function(){var e=this;if(!this._registeredUser){return Promise.reject(new g.KinveyError("Cannot unregister when no user has been registered for live service"))}var t=this._registeredUser._id;return this._makeUnregisterRequst(t).then(function(t){return e._registeredUser=null,t})}},{key:"_unsubscribeFromAll",value:function(){this._pubnubClient.unsubscribeAll(),this._pubnubListener.removeAllListeners()}},{key:"_validatePublishData",value:function(e,t){var n=null;return u(e)||(n=new g.KinveyError("Invalid channel name")),void 0===t&&(n=new g.KinveyError("Missing or invalid message")),n}},{key:"_validateSubscribeData",value:function(e,t){var n=null;return u(e)||(n=new g.KinveyError("Invalid channel name")),t&&i(t)||(n=new g.KinveyError("Missing or invalid receiver")),n}},{key:"_subscribeToUserChannelGroup",value:function(){this._pubnubClient.subscribe({channelGroups:[this._userChannelGroup]})}},{key:"_subscribeToListener",value:function(e,t){(0,h.default)(t.onMessage)&&this._pubnubListener.on(e,t.onMessage),((0,h.default)(t.onError)||(0,h.default)(t.onStatus))&&this._pubnubListener.on(""+_.PubNubListener.statusPrefix+e,function(e){var n=e.error?t.onError:t.onStatus;(0,h.default)(n)&&n.call(t,e)})}},{key:"_unsubscribeFromListener",value:function(e){this._pubnubListener.removeAllListeners(e),this._pubnubListener.removeAllListeners(""+_.PubNubListener.statusPrefix+e)}},{key:"_makeRegisterRequest",value:function(e){return this._makeUserManagementRequest(e,"register-realtime")}},{key:"_makeUnregisterRequst",value:function(e){return this._makeUserManagementRequest(e,"unregister-realtime")}},{key:"_makeUserManagementRequest",value:function(e,t){return b.KinveyRequest.executeShort({method:b.RequestMethod.POST,pathname:"/user/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}},this._client)}},{key:"_throwNotInitializedError",value:function(){throw new g.KinveyError("Live service has not been initialized")}},{key:"_pubnubClient",get:function(){return this.__pubnubClient||this._throwNotInitializedError(),this.__pubnubClient},set:function(e){this.__pubnubClient=e}},{key:"_pubnubListener",set:function(e){this.__pubnubListener=e},get:function(){return this.__pubnubListener||this._throwNotInitializedError(),this.__pubnubListener}}]),e}(),k=void 0;t.isValidChannelName=u,t.isValidReceiver=i},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),c=r(s),l=n(41),f=r(l),h=n(42),d=r(h),p=n(43),v=(n(8),function(e){function t(e){o(this,t);var n=e.listenToBrowserNetworkEvents,r=void 0===n||n;e.db=d.default,e.sdkFamily="Web",e.networking=new f.default({get:p.get,post:p.post,sendBeacon:a});var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r&&(window.addEventListener("offline",function(){u.networkDownDetected()}),window.addEventListener("online",function(){u.networkUpDetected()})),u}return u(t,e),t}(c.default));t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=o(a),c=n(7),l=o(c),f=n(9),h=o(f),d=n(11),p=o(d),v=n(12),y=o(v),b=n(19),g=o(b),m=n(20),_=r(m),w=n(21),k=r(w),E=n(22),O=r(E),S=n(23),P=r(S),j=n(24),x=r(j),T=n(25),C=r(T),A=n(26),M=r(A),R=n(27),I=r(R),q=n(28),D=r(q),U=n(29),N=r(U),L=n(30),K=r(L),B=n(31),F=r(B),H=n(32),z=r(H),G=n(33),V=r(G),$=n(34),Q=r($),W=n(35),Y=r(W),X=n(36),J=r(X),Z=n(37),ee=r(Z),te=n(38),ne=r(te),re=n(39),oe=r(re),ie=n(15),ue=r(ie),ae=n(40),se=r(ae),ce=n(16),le=o(ce),fe=n(13),he=o(fe),de=(n(8),function(){function e(t){var n=this;i(this,e)
;var r=t.db,o=t.networking,u=this._config=new l.default({setup:t,db:r}),a=new h.default({config:u});o.init(u);var s={config:u,networking:o,crypto:a},c=g.default.bind(this,s,ue),f=g.default.bind(this,s,N),d=g.default.bind(this,s,F),v=g.default.bind(this,s,V),b=g.default.bind(this,s,se),m=this._listenerManager=new y.default,w=new p.default({timeEndpoint:c,leaveEndpoint:f,heartbeatEndpoint:d,setStateEndpoint:v,subscribeEndpoint:b,crypto:s.crypto,config:s.config,listenerManager:m});this.addListener=m.addListener.bind(m),this.removeListener=m.removeListener.bind(m),this.removeAllListeners=m.removeAllListeners.bind(m),this.channelGroups={listGroups:g.default.bind(this,s,P),listChannels:g.default.bind(this,s,x),addChannels:g.default.bind(this,s,_),removeChannels:g.default.bind(this,s,k),deleteGroup:g.default.bind(this,s,O)},this.push={addChannels:g.default.bind(this,s,C),removeChannels:g.default.bind(this,s,M),deleteDevice:g.default.bind(this,s,D),listChannels:g.default.bind(this,s,I)},this.hereNow=g.default.bind(this,s,Q),this.whereNow=g.default.bind(this,s,K),this.getState=g.default.bind(this,s,z),this.setState=w.adaptStateChange.bind(w),this.grant=g.default.bind(this,s,J),this.audit=g.default.bind(this,s,Y),this.publish=g.default.bind(this,s,ee),this.fire=function(e,t){return e.replicate=!1,e.storeInHistory=!1,n.publish(e,t)},this.history=g.default.bind(this,s,ne),this.fetchMessages=g.default.bind(this,s,oe),this.time=c,this.subscribe=w.adaptSubscribeChange.bind(w),this.unsubscribe=w.adaptUnsubscribeChange.bind(w),this.disconnect=w.disconnect.bind(w),this.reconnect=w.reconnect.bind(w),this.destroy=function(e){w.unsubscribeAll(e),w.disconnect()},this.stop=this.destroy,this.unsubscribeAll=w.unsubscribeAll.bind(w),this.getSubscribedChannels=w.getSubscribedChannels.bind(w),this.getSubscribedChannelGroups=w.getSubscribedChannelGroups.bind(w),this.encrypt=a.encrypt.bind(a),this.decrypt=a.decrypt.bind(a),this.getAuthKey=s.config.getAuthKey.bind(s.config),this.setAuthKey=s.config.setAuthKey.bind(s.config),this.setCipherKey=s.config.setCipherKey.bind(s.config),this.getUUID=s.config.getUUID.bind(s.config),this.setUUID=s.config.setUUID.bind(s.config),this.getFilterExpression=s.config.getFilterExpression.bind(s.config),this.setFilterExpression=s.config.setFilterExpression.bind(s.config),this.setHeartbeatInterval=s.config.setHeartbeatInterval.bind(s.config)}return u(e,[{key:"getVersion",value:function(){return this._config.getVersion()}},{key:"networkDownDetected",value:function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)}},{key:"networkUpDetected",value:function(){this._listenerManager.announceNetworkUp(),this.reconnect()}}],[{key:"generateUUID",value:function(){return s.default.v4()}}]),e}());de.OPERATIONS=le.default,de.CATEGORIES=he.default,t.default=de,e.exports=t.default},function(e,t,n){var r=n(3),o=n(6),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){function r(e,t,n){var r=t&&n||0,o=t||[];e=e||{};var u=void 0!==e.clockseq?e.clockseq:s,f=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:l+1,d=f-c+(h-l)/1e4;if(d<0&&void 0===e.clockseq&&(u=u+1&16383),(d<0||f>c)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,l=h,s=u,f+=122192928e5;var p=(1e4*(268435455&f)+h)%4294967296;o[r++]=p>>>24&255,o[r++]=p>>>16&255,o[r++]=p>>>8&255,o[r++]=255&p;var v=f/4294967296*1e4&268435455;o[r++]=v>>>8&255,o[r++]=255&v,o[r++]=v>>>24&15|16,o[r++]=v>>>16&255,o[r++]=u>>>8|128,o[r++]=255&u;for(var y=e.node||a,b=0;b<6;++b)o[r+b]=y[b];return t||i(o)}var o=n(4),i=n(5),u=o(),a=[1|u[0],u[1],u[2],u[3],u[4],u[5]],s=16383&(u[6]<<8|u[7]),c=0,l=0;e.exports=r},function(e,t){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var i=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}e.exports=n}).call(t,function(){return this}())},function(e,t){function n(e,t){var n=t||0,o=r;return o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]}for(var r=[],o=0;o<256;++o)r[o]=(o+256).toString(16).substr(1);e.exports=n},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var u=e.random||(e.rng||o)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,t)for(var a=0;a<16;++a)t[r+a]=u[a];return t||i(u)}var o=n(4),i=n(5);e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=(n(8),function(){function e(t){var n=t.setup,o=t.db;r(this,e),this._db=o,this.instanceId="pn-"+u.default.v4(),this.secretKey=n.secretKey||n.secret_key,this.subscribeKey=n.subscribeKey||n.subscribe_key,this.publishKey=n.publishKey||n.publish_key,this.sdkFamily=n.sdkFamily,this.partnerId=n.partnerId,this.setAuthKey(n.authKey),this.setCipherKey(n.cipherKey),this.setFilterExpression(n.filterExpression),this.origin=n.origin||"pubsub.pndsn.com",this.secure=n.ssl||!1,this.restore=n.restore||!1,this.proxy=n.proxy,this.keepAlive=n.keepAlive,this.keepAliveSettings=n.keepAliveSettings,this.autoNetworkDetection=n.autoNetworkDetection||!1,this.dedupeOnSubscribe=n.dedupeOnSubscribe||!1,this.maximumCacheSize=n.maximumCacheSize||100,this.customEncrypt=n.customEncrypt,this.customDecrypt=n.customDecrypt,"undefined"!=typeof location&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=n.logVerbosity||!1,this.suppressLeaveEvents=n.suppressLeaveEvents||!1,this.announceFailedHeartbeats=n.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=n.announceSuccessfulHeartbeats||!1,this.useInstanceId=n.useInstanceId||!1,this.useRequestId=n.useRequestId||!1,this.requestMessageCountThreshold=n.requestMessageCountThreshold,this.setTransactionTimeout(n.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(n.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(n.useSendBeacon||!0),this.setPresenceTimeout(n.presenceTimeout||300),n.heartbeatInterval&&this.setHeartbeatInterval(n.heartbeatInterval),this.setUUID(this._decideUUID(n.uuid))}return o(e,[{key:"getAuthKey",value:function(){return this.authKey}},{key:"setAuthKey",value:function(e){return this.authKey=e,this}},{key:"setCipherKey",value:function(e){return this.cipherKey=e,this}},{key:"getUUID",value:function(){return this.UUID}},{key:"setUUID",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+"uuid",e),this.UUID=e,this}},{key:"getFilterExpression",value:function(){return this.filterExpression}},{key:"setFilterExpression",value:function(e){return this.filterExpression=e,this}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"getSubscribeTimeout",value:function(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:"getTransactionTimeout",value:function(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:"isSendBeaconEnabled",value:function(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function(e){return this._useSendBeacon=e,this}},{key:"getVersion",value:function(){return"4.15.1"}},{key:"_decideUUID",value:function(e){return e||(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")?this._db.get(this.subscribeKey+"uuid"):"pn-"+u.default.v4())}}]),e}());t.default=a,e.exports=t.default},function(e,t){"use strict";e.exports={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(7),a=(r(u),n(10)),s=r(a),c=function(){function e(t){var n=t.config;o(this,e),this._config=n,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return i(e,[{key:"HMACSHA256",value:function(e){return s.default.HmacSHA256(e,this._config.secretKey).toString(s.default.enc.Base64)}},{key:"SHA256",value:function(e){return s.default.SHA256(e).toString(s.default.enc.Hex)}},{key:"_parseOptions",value:function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t}},{key:"_decodeKey",value:function(e,t){return"base64"===t.keyEncoding?s.default.enc.Base64.parse(e):"hex"===t.keyEncoding?s.default.enc.Hex.parse(e):e}},{key:"_getPaddedKey",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?s.default.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:"_getMode",value:function(e){return"ecb"===e.mode?s.default.mode.ECB:s.default.mode.CBC}},{key:"_getIV",value:function(e){return"cbc"===e.mode?s.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)}},{key:"decrypt",value:function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)}},{key:"pnEncrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),o=this._getMode(n),i=this._getPaddedKey(t||this._config.cipherKey,n);return s.default.AES.encrypt(e,i,{iv:r,mode:o}).ciphertext.toString(s.default.enc.Base64)||e}},{key:"pnDecrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),o=this._getMode(n),i=this._getPaddedKey(t||this._config.cipherKey,n);try{var u=s.default.enc.Base64.parse(e),a=s.default.AES.decrypt({ciphertext:u},i,{iv:r,mode:o}).toString(s.default.enc.Utf8);return JSON.parse(a)}catch(e){return null}}}]),e}();t.default=c,e.exports=t.default},function(e,t){"use strict";var n=n||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new u.init(n,t)}}),a=n.enc={},s=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*i,o=e.min(4*t,o),t){for(var s=0;s<t;s+=i)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=o}return new u.init(s,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,r=t.algo,u=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var f;e:{f=c;for(var h=e.sqrt(f),d=2;d<=h;d++)if(!(f%d)){f=!1;break e}f=!0}f&&(8>l&&(u[l]=s(e.pow(c,.5))),a[l]=s(e.pow(c,1/3)),l++),c++}var p=[],r=r.SHA256=i.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],u=n[3],s=n[4],c=n[5],l=n[6],f=n[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var d=p[h-15],v=p[h-2];p[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+p[h-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+p[h-16]}d=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&l)+a[h]+p[h],v=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),f=l,l=c,c=s,s=u+d|0,u=i,i=o,o=r,r=d+v|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+u|0,n[4]=n[4]+s|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(r),t.HmacSHA256=i._createHmacHelper(r)}(Math),function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,o=4*r;n.sigBytes>o&&(n=e.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),u=this._iKey=n.clone(),a=i.words,s=u.words,c=0;c<r;c++)a[c]^=1549556828,s[c]^=909522486;i.sigBytes=u.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,u=0;4>u&&o+.75*u<n;u++)e.push(r.charAt(i>>>6*(3-u)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,o=r.charAt(64);o&&-1!=(o=e.indexOf(o))&&(n=o);for(var o=[],i=0,u=0;u<n;u++)if(u%4){var a=r.indexOf(e.charAt(u-1))<<u%4*2,s=r.indexOf(e.charAt(u))>>>6-u%4*2;o[i>>>2]|=(a|s)<<24-i%4*8,i++}return t.create(o,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,o,i,u){return((e=e+(t&n|~t&r)+o+u)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,u){return((e=e+(t&r|n&~r)+o+u)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,u){return((e=e+(t^n^r)+o+u)<<i|e>>>32-i)+t}function i(e,t,n,r,o,i,u){return((e=e+(n^(t|~r))+o+u)<<i|e>>>32-i)+t}for(var u=n,a=u.lib,s=a.WordArray,c=a.Hasher,a=u.algo,l=[],f=0;64>f;f++)l[f]=4294967296*e.abs(e.sin(f+1))|0;a=a.MD5=c.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,n){for(var u=0;16>u;u++){var a=n+u,s=e[a];e[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}var u=this._hash.words,a=e[n+0],s=e[n+1],c=e[n+2],f=e[n+3],h=e[n+4],d=e[n+5],p=e[n+6],v=e[n+7],y=e[n+8],b=e[n+9],g=e[n+10],m=e[n+11],_=e[n+12],w=e[n+13],k=e[n+14],E=e[n+15],O=u[0],S=u[1],P=u[2],j=u[3],O=t(O,S,P,j,a,7,l[0]),j=t(j,O,S,P,s,12,l[1]),P=t(P,j,O,S,c,17,l[2]),S=t(S,P,j,O,f,22,l[3]),O=t(O,S,P,j,h,7,l[4]),j=t(j,O,S,P,d,12,l[5]),P=t(P,j,O,S,p,17,l[6]),S=t(S,P,j,O,v,22,l[7]),O=t(O,S,P,j,y,7,l[8]),j=t(j,O,S,P,b,12,l[9]),P=t(P,j,O,S,g,17,l[10]),S=t(S,P,j,O,m,22,l[11]),O=t(O,S,P,j,_,7,l[12]),j=t(j,O,S,P,w,12,l[13]),P=t(P,j,O,S,k,17,l[14]),S=t(S,P,j,O,E,22,l[15]),O=r(O,S,P,j,s,5,l[16]),j=r(j,O,S,P,p,9,l[17]),P=r(P,j,O,S,m,14,l[18]),S=r(S,P,j,O,a,20,l[19]),O=r(O,S,P,j,d,5,l[20]),j=r(j,O,S,P,g,9,l[21]),P=r(P,j,O,S,E,14,l[22]),S=r(S,P,j,O,h,20,l[23]),O=r(O,S,P,j,b,5,l[24]),j=r(j,O,S,P,k,9,l[25]),P=r(P,j,O,S,f,14,l[26]),S=r(S,P,j,O,y,20,l[27]),O=r(O,S,P,j,w,5,l[28]),j=r(j,O,S,P,c,9,l[29]),P=r(P,j,O,S,v,14,l[30]),S=r(S,P,j,O,_,20,l[31]),O=o(O,S,P,j,d,4,l[32]),j=o(j,O,S,P,y,11,l[33]),P=o(P,j,O,S,m,16,l[34]),S=o(S,P,j,O,k,23,l[35]),O=o(O,S,P,j,s,4,l[36]),j=o(j,O,S,P,h,11,l[37]),P=o(P,j,O,S,v,16,l[38]),S=o(S,P,j,O,g,23,l[39]),O=o(O,S,P,j,w,4,l[40]),j=o(j,O,S,P,a,11,l[41]),P=o(P,j,O,S,f,16,l[42]),S=o(S,P,j,O,p,23,l[43]),O=o(O,S,P,j,b,4,l[44]),j=o(j,O,S,P,_,11,l[45]),P=o(P,j,O,S,E,16,l[46]),S=o(S,P,j,O,c,23,l[47]),O=i(O,S,P,j,a,6,l[48]),j=i(j,O,S,P,v,10,l[49]),P=i(P,j,O,S,k,15,l[50]),S=i(S,P,j,O,d,21,l[51]),O=i(O,S,P,j,_,6,l[52]),j=i(j,O,S,P,f,10,l[53]),P=i(P,j,O,S,g,15,l[54]),S=i(S,P,j,O,s,21,l[55]),O=i(O,S,P,j,y,6,l[56]),j=i(j,O,S,P,E,10,l[57]),P=i(P,j,O,S,p,15,l[58]),S=i(S,P,j,O,w,21,l[59]),O=i(O,S,P,j,h,6,l[60]),j=i(j,O,S,P,m,10,l[61]),P=i(P,j,O,S,c,15,l[62]),S=i(S,P,j,O,b,21,l[63]);u[0]=u[0]+O|0,u[1]=u[1]+S|0,u[2]=u[2]+P|0,u[3]=u[3]+j|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),u.MD5=c._createHelper(a),u.HmacMD5=c._createHmacHelper(a)}(Math),function(){var e=n,t=e.lib,r=t.Base,o=t.WordArray,t=e.algo,i=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),i=o.create(),u=i.words,a=n.keySize,n=n.iterations;u.length<a;){s&&r.update(s);var s=r.update(e).finalize(t);r.reset();for(var c=1;c<n;c++)s=r.finalize(s),r.reset();i.concat(s)}return i.sigBytes=4*a,i}});e.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),n.lib.Cipher||function(e){var t=n,r=t.lib,o=r.Base,i=r.WordArray,u=r.BufferedBlockAlgorithm,a=t.enc.Base64,s=t.algo.EvpKDF,c=r.Cipher=u.extend({cfg:o.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?v:p).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?v:p).decrypt(e,t,n,r)}}}});r.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=t.mode={},f=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},h=(r.BlockCipherMode=o.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();h.Encryptor=h.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;f.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),h.Decryptor=h.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),f.call(this,e,t,r),this._prevBlock=o}}),l=l.CBC=h,h=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,o=[],u=0;u<n;u+=4)o.push(r);n=i.create(o,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:l,padding:h}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var d=r.CipherParams=o.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),l=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(a)},parse:function(e){e=a.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:n})}},p=r.SerializableCipher=o.extend({cfg:o.extend({format:l}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,d.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=i.random(8)),e=s.create({keySize:t+n}).compute(e,r),n=i.create(e.words.slice(t),4*n),e.sigBytes=4*t,d.create({key:e,iv:n,salt:r})}},v=r.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=p.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,p.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,o=[],i=[],u=[],a=[],s=[],c=[],l=[],f=[],h=[],d=[],p=[],v=0;256>v;v++)p[v]=128>v?v<<1:v<<1^283;for(var y=0,b=0,v=0;256>v;v++){var g=b^b<<1^b<<2^b<<3^b<<4,g=g>>>8^255&g^99;o[y]=g,i[g]=y;var m=p[y],_=p[m],w=p[_],k=257*p[g]^16843008*g;u[y]=k<<24|k>>>8,a[y]=k<<16|k>>>16,s[y]=k<<8|k>>>24,c[y]=k,k=16843009*w^65537*_^257*m^16843008*y,l[g]=k<<24|k>>>8,f[g]=k<<16|k>>>16,h[g]=k<<8|k>>>24,d[g]=k,y?(y=m^p[p[p[w^m]]],b^=p[p[b]]):y=b=1}var E=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],i=0;i<e;i++)if(i<n)r[i]=t[i];else{var u=r[i-1];i%n?6<n&&4==i%n&&(u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u]):(u=u<<8|u>>>24,u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u],u^=E[i/n|0]<<24),r[i]=r[i-n]^u}for(t=this._invKeySchedule=[],n=0;n<e;n++)i=e-n,u=n%4?r[i]:r[i-4],t[n]=4>n||4>=i?u:l[o[u>>>24]]^f[o[u>>>16&255]]^h[o[u>>>8&255]]^d[o[255&u]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,u,a,s,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,f,h,d,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,u,a){for(var s=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],f=e[t+2]^n[2],h=e[t+3]^n[3],d=4,p=1;p<s;p++)var v=r[c>>>24]^o[l>>>16&255]^i[f>>>8&255]^u[255&h]^n[d++],y=r[l>>>24]^o[f>>>16&255]^i[h>>>8&255]^u[255&c]^n[d++],b=r[f>>>24]^o[h>>>16&255]^i[c>>>8&255]^u[255&l]^n[d++],h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^u[255&f]^n[d++],c=v,l=y,f=b;v=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[f>>>8&255]<<8|a[255&h])^n[d++],y=(a[l>>>24]<<24|a[f>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[d++],b=(a[f>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[d++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&f])^n[d++],e[t]=v,e[t+1]=y,e[t+2]=b,e[t+3]=h},keySize:8});e.AES=t._createHelper(r)}(),n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(9),a=(r(u),n(7)),s=(r(a),n(12)),c=(r(s),n(14)),l=r(c),f=n(17),h=r(f),d=n(18),p=r(d),v=(n(8),n(13)),y=r(v),b=function(){function e(t){var n=t.subscribeEndpoint,r=t.leaveEndpoint,i=t.heartbeatEndpoint,u=t.setStateEndpoint,a=t.timeEndpoint,s=t.config,c=t.crypto,f=t.listenerManager;o(this,e),this._listenerManager=f,this._config=s,this._leaveEndpoint=r,this._heartbeatEndpoint=i,this._setStateEndpoint=u,this._subscribeEndpoint=n,this._crypto=c,this._channels={},this._presenceChannels={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new l.default({timeEndpoint:a}),this._dedupingManager=new h.default({config:s})}return i(e,[{key:"adaptStateChange",value:function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,u=e.channelGroups,a=void 0===u?[]:u;return i.forEach(function(e){e in n._channels&&(n._channels[e].state=r)}),a.forEach(function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)}),this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)}},{key:"adaptSubscribeChange",value:function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,u=void 0===i?[]:i,a=e.withPresence,s=void 0!==a&&a;if(!this._config.subscribeKey||""===this._config.subscribeKey)return void(console&&console.log&&console.log("subscribe key missing; aborting subscribe"));n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),"0"!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach(function(e){t._channels[e]={state:{}},s&&(t._presenceChannels[e]={}),t._pendingChannelSubscriptions.push(e)}),u.forEach(function(e){t._channelGroups[e]={state:{}},s&&(t._presenceChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)}),this._subscriptionStatusAnnounced=!1,this.reconnect()}},{key:"adaptUnsubscribeChange",value:function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,u=void 0===i?[]:i,a=[],s=[];o.forEach(function(e){e in n._channels&&(delete n._channels[e],a.push(e)),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))}),u.forEach(function(e){e in n._channelGroups&&(delete n._channelGroups[e],s.push(e)),e in n._presenceChannelGroups&&(delete n._channelGroups[e],s.push(e))}),0===a.length&&0===s.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:s},function(e){e.affectedChannels=a,e.affectedChannelGroups=s,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())}},{key:"unsubscribeAll",value:function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)}},{key:"getSubscribedChannels",value:function(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:"disconnect",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))}},{key:"_stopHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_performHeartbeatLoop",value:function(){var e=this,t=Object.keys(this._channels),n=Object.keys(this._channelGroups),r={};if(0!==t.length||0!==n.length){t.forEach(function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)}),n.forEach(function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)});var o=function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}
;this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},o.bind(this))}}},{key:"_startSubscribeLoop",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+"-pnpres")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+"-pnpres")}),0!==e.length||0!==t.length){var n={channels:e,channelGroups:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}}},{key:"_processSubscribeResponse",value:function(e,t){var n=this;if(e.error)return void(e.category===y.default.PNTimeoutCategory?this._startSubscribeLoop():e.category===y.default.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:y.default.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===y.default.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e));if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=y.default.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,u=i.requestMessageCountThreshold,a=i.dedupeOnSubscribe;if(u&&o.length>=u){var s={};s.category=y.default.PNRequestMessageCountExceededCategory,s.operation=e.operation,this._listenerManager.announceStatus(s)}o.forEach(function(e){var t=e.channel,r=e.subscriptionMatch,o=e.publishMetaData;if(t===r&&(r=null),a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}if(p.default.endsWith(e.channel,"-pnpres")){var i={};i.channel=null,i.subscription=null,i.actualChannel=null!=r?t:null,i.subscribedChannel=null!=r?r:t,t&&(i.channel=t.substring(0,t.lastIndexOf("-pnpres"))),r&&(i.subscription=r.substring(0,r.lastIndexOf("-pnpres"))),i.action=e.payload.action,i.state=e.payload.data,i.timetoken=o.publishTimetoken,i.occupancy=e.payload.occupancy,i.uuid=e.payload.uuid,i.timestamp=e.payload.timestamp,e.payload.join&&(i.join=e.payload.join),e.payload.leave&&(i.leave=e.payload.leave),e.payload.timeout&&(i.timeout=e.payload.timeout),n._listenerManager.announcePresence(i)}else{var u={};u.channel=null,u.subscription=null,u.actualChannel=null!=r?t:null,u.subscribedChannel=null!=r?r:t,u.channel=t,u.subscription=r,u.timetoken=o.publishTimetoken,u.publisher=e.issuingClientId,e.userMetadata&&(u.userMetadata=e.userMetadata),n._config.cipherKey?u.message=n._crypto.decrypt(e.payload):u.message=e.payload,n._listenerManager.announceMessage(u)}}),this._region=t.metadata.region,this._startSubscribeLoop()}},{key:"_stopSubscribeLoop",value:function(){this._subscribeCall&&(this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}();t.default=b,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(n(8),n(13)),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(){r(this,e),this._listeners=[]}return o(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"removeListener",value:function(e){var t=[];this._listeners.forEach(function(n){n!==e&&t.push(n)}),this._listeners=t}},{key:"removeAllListeners",value:function(){this._listeners=[]}},{key:"announcePresence",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:"announceStatus",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:"announceMessage",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}},{key:"announceNetworkUp",value:function(){var e={};e.category=u.default.PNNetworkUpCategory,this.announceStatus(e)}},{key:"announceNetworkDown",value:function(){var e={};e.category=u.default.PNNetworkDownCategory,this.announceStatus(e)}}]),e}();t.default=a,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(15),u=(function(e){e&&e.__esModule}(i),n(8),function(){function e(t){var n=t.timeEndpoint;r(this,e),this._timeEndpoint=n}return o(e,[{key:"onReconnection",value:function(e){this._reconnectionCallback=e}},{key:"startPolling",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}());t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(){return f.default.PNTimeOperation}function o(){return"/time/0"}function i(e){return e.config.getTransactionTimeout()}function u(){return{}}function a(){return!1}function s(e,t){return{timetoken:t[0]}}function c(){}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.getURL=o,t.getRequestTimeout=i,t.prepareParams=u,t.isAuthSupported=a,t.handleResponse=s,t.validateParams=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),u=(function(e){e&&e.__esModule}(i),function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}),a=function(){function e(t){var n=t.config;r(this,e),this.hashHistory=[],this._config=n}return o(e,[{key:"getKey",value:function(e){var t=u(JSON.stringify(e.payload)).toString();return e.publishMetaData.publishTimetoken+"-"+t}},{key:"isDuplicate",value:function(e){return this.hashHistory.includes(this.getKey(e))}},{key:"addEntry",value:function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))}},{key:"clearHistory",value:function(){this.hashHistory=[]}}]),e}();t.default=a,e.exports=t.default},function(e,t){"use strict";function n(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}function r(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(e){return n(e).sort()}function i(e){return o(e).map(function(t){return t+"="+r(e[t])}).join("&")}function u(e,t){return-1!==e.indexOf(t,this.length-t.length)}function a(){var e=void 0,t=void 0;return{promise:new Promise(function(n,r){e=n,t=r}),reject:t,fulfill:e}}e.exports={signPamFromParams:i,endsWith:u,createPromise:a,encodeString:r}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return e.type=t,e.error=!0,e}function s(e){return a({message:e},"validationError")}function c(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.getURL(t,n)}function l(e){var t="PubNub-JS-"+e.sdkFamily;return e.partnerId&&(t+="-"+e.partnerId),t+="/"+e.getVersion()}function f(e,t,n){var r=e.config,o=e.crypto;n.timestamp=Math.floor((new Date).getTime()/1e3);var i=r.subscribeKey+"\n"+r.publishKey+"\n"+t+"\n";i+=v.default.signPamFromParams(n);var u=o.HMACSHA256(i);u=u.replace(/\+/g,"-"),u=u.replace(/\//g,"_"),n.signature=u}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.networking,r=e.config,o=null,i=null,u={};t.getOperation()===g.default.PNTimeOperation||t.getOperation()===g.default.PNChannelGroupsOperation?o=arguments.length<=2?void 0:arguments[2]:(u=arguments.length<=2?void 0:arguments[2],o=arguments.length<=3?void 0:arguments[3]),"undefined"==typeof Promise||o||(i=v.default.createPromise());var a=t.validateParams(e,u);if(!a){var h=t.prepareParams(e,u),p=c(t,e,u),y=void 0,b={url:p,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};h.uuid=r.UUID,h.pnsdk=l(r),r.useInstanceId&&(h.instanceid=r.instanceId),r.useRequestId&&(h.requestid=d.default.v4()),t.isAuthSupported()&&r.getAuthKey()&&(h.auth=r.getAuthKey()),r.secretKey&&f(e,p,h);var _=function(n,r){if(n.error)return void(o?o(n):i&&i.reject(new m("PubNub call failed, check status for details",n)));var a=t.handleResponse(e,r,u);o?o(n,a):i&&i.fulfill(a)};if(t.usePost&&t.usePost(e,u)){var w=t.postPayload(e,u);y=n.POST(h,w,b,_)}else y=n.GET(h,b,_);return t.getOperation()===g.default.PNSubscribeOperation?y:i?i.promise:void 0}return o?o(s(a)):i?(i.reject(new m("Validation failed, check status for details",s(a))),i.promise):void 0};var h=n(2),d=r(h),p=(n(8),n(18)),v=r(p),y=n(7),b=(r(y),n(16)),g=r(b),m=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.name=r.constructor.name,r.status=n,r.message=e,r}return u(t,e),t}(Error);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNAddChannelsToGroupOperation}function i(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function u(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+p.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(",")}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNRemoveChannelsFromGroupOperation}function i(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function u(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+p.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(",")}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNRemoveGroupOperation}function i(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function u(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+p.default.encodeString(n)+"/remove"}function a(){return!0}function s(e){return e.config.getTransactionTimeout()}function c(){return{}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.isAuthSupported=a,t.getRequestTimeout=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(){return f.default.PNChannelGroupsOperation}function o(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function i(e){return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group"}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(){return{}}function c(e,t){return{groups:t.payload.groups}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNChannelsForGroupOperation}function i(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function u(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+p.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(){return{}}function l(e,t){return{channels:t.payload.channels}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(){return f.default.PNPushNotificationEnabledChannelsOperation}function o(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=e.config;return n?r?o&&0!==o.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function i(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(e,t){var n=t.pushGateway,r=t.channels;return{type:n,add:(void 0===r?[]:r).join(",")}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return f.default.PNPushNotificationEnabledChannelsOperation}function o(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=e.config;return n?r?o&&0!==o.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function i(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(e,t){var n=t.pushGateway,r=t.channels;return{type:n,remove:(void 0===r?[]:r).join(",")}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return f.default.PNPushNotificationEnabledChannelsOperation}function o(e,t){var n=t.device,r=t.pushGateway,o=e.config;return n?r?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function i(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(e,t){return{type:t.pushGateway}}function c(e,t){return{channels:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return f.default.PNRemoveAllPushNotificationsOperation}function o(e,t){var n=t.device,r=t.pushGateway,o=e.config;return n?r?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function i(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n+"/remove"}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(e,t){return{type:t.pushGateway}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNUnsubscribeOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function u(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+p.default.encodeString(i)+"/leave"}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o["channel-group"]=r.join(",")),o}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(){return f.default.PNWhereNowOperation}function o(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function i(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return"/v2/presence/sub-key/"+n.subscribeKey+"/uuid/"+o}function u(e){return e.config.getTransactionTimeout()}function a(){return!0}function s(){return{}}function c(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNHeartbeatOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function u(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+p.default.encodeString(i)+"/heartbeat"}function a(){return!0}function s(e){return e.config.getTransactionTimeout()}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,u=e.config,a={};return r.length>0&&(a["channel-group"]=r.join(",")),a.state=JSON.stringify(i),a.heartbeat=u.getPresenceTimeout(),a}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.isAuthSupported=a,t.getRequestTimeout=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNGetStateOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function u(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,u=void 0===i?[]:i,a=u.length>0?u.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+p.default.encodeString(a)+"/uuid/"+o}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o["channel-group"]=r.join(",")),o}function l(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,u=void 0===i?[]:i,a={};return 1===o.length&&0===u.length?a[o[0]]=t.payload:a=t.payload,{channels:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNSetStateOperation}function i(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,u=t.channelGroups,a=void 0===u?[]:u;return r?n.subscribeKey?0===i.length&&0===a.length?"Please provide a list of channels and/or channel-groups":void 0:"Missing Subscribe Key":"Missing State"}function u(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+p.default.encodeString(i)+"/uuid/"+n.UUID+"/data"}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i["channel-group"]=o.join(",")),i}function l(e,t){return{state:t.payload}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNHereNowOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function u(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,u=void 0===i?[]:i,a="/v2/presence/sub-key/"+n.subscribeKey;if(o.length>0||u.length>0){var s=o.length>0?o.join(","):",";a+="/channel/"+p.default.encodeString(s)}return a}function a(e){return e.config.getTransactionTimeout()}function s(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.includeUUIDs,i=void 0===o||o,u=t.includeState,a=void 0!==u&&u,s={};return i||(s.disable_uuids=1),a&&(s.state=1),r.length>0&&(s["channel-group"]=r.join(",")),s}function l(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,u=void 0===i?[]:i,a=n.includeUUIDs,s=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||u.length>0||0===u.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach(function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},s&&r.uuids.forEach(function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})}),e}),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},s&&t.uuids&&t.uuids.forEach(function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})}),e}()}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(){return f.default.PNAccessManagerAudit}function o(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function i(e){return"/v2/auth/audit/sub-key/"+e.config.subscribeKey}function u(e){return e.config.getTransactionTimeout()}function a(){return!1}function s(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,u={};return n&&(u.channel=n),r&&(u["channel-group"]=r),i.length>0&&(u.auth=i.join(",")),u}function c(e,t){return t.payload}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return f.default.PNAccessManagerGrant}function o(e){var t=e.config;return t.subscribeKey?t.publishKey?t.secretKey?void 0:"Missing Secret Key":"Missing Publish Key":"Missing Subscribe Key"}function i(e){return"/v2/auth/grant/sub-key/"+e.config.subscribeKey}function u(e){return e.config.getTransactionTimeout()}function a(){return!1}function s(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,u=t.ttl,a=t.read,s=void 0!==a&&a,c=t.write,l=void 0!==c&&c,f=t.manage,h=void 0!==f&&f,d=t.authKeys,p=void 0===d?[]:d,v={};return v.r=s?"1":"0",v.w=l?"1":"0",v.m=h?"1":"0",r.length>0&&(v.channel=r.join(",")),i.length>0&&(v["channel-group"]=i.join(",")),p.length>0&&(v.auth=p.join(",")),(u||0===u)&&(v.ttl=u),v}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=o,t.getURL=i,t.getRequestTimeout=u,t.isAuthSupported=a,t.prepareParams=s,t.handleResponse=c;var l=(n(8),n(16)),f=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.crypto,r=e.config,o=JSON.stringify(t);return r.cipherKey&&(o=n.encrypt(o),o=JSON.stringify(o)),o}function i(){return b.default.PNPublishOperation}function u(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"}function a(e,t){var n=t.sendByPost;return void 0!==n&&n}function s(e,t){var n=e.config,r=t.channel,i=t.message,u=o(e,i);return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+m.default.encodeString(r)+"/0/"+m.default.encodeString(u)}function c(e,t){var n=e.config,r=t.channel;return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+m.default.encodeString(r)+"/0"}function l(e){return e.config.getTransactionTimeout()}function f(){return!0}function h(e,t){return o(e,t.message)}function d(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,u=t.ttl,a={};return null!=i&&(a.store=i?"1":"0"),u&&(a.ttl=u),!1===o&&(a.norep="true"),n&&"object"===(void 0===n?"undefined":v(n))&&(a.meta=JSON.stringify(n)),a}function p(e,t){return{timetoken:t[2]}}Object.defineProperty(t,"__esModule",{value:!0});var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=i,t.validateParams=u,t.usePost=a,t.getURL=s,t.postURL=c,t.getRequestTimeout=l,t.isAuthSupported=f,t.postPayload=h,t.prepareParams=d,t.handleResponse=p;var y=(n(8),n(16)),b=r(y),g=n(18),m=r(g)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}function i(){return d.default.PNHistoryOperation}function u(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"}function a(e,t){var n=t.channel;return"/v2/history/sub-key/"+e.config.subscribeKey+"/channel/"+v.default.encodeString(n)}function s(e){return e.config.getTransactionTimeout()}function c(){return!0}function l(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,u=void 0===i?100:i,a=t.stringifiedTimeToken,s=void 0!==a&&a,c={include_token:"true"};return c.count=u,n&&(c.start=n),r&&(c.end=r),s&&(c.string_message_token="true"),null!=o&&(c.reverse=o.toString()),c}function f(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return t[0].forEach(function(t){var r={timetoken:t.timetoken,entry:o(e,t.message)};n.messages.push(r)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=u,t.getURL=a,t.getRequestTimeout=s,t.isAuthSupported=c,t.prepareParams=l,t.handleResponse=f;var h=(n(8),n(16)),d=r(h),p=n(18),v=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}function i(){return d.default.PNFetchMessagesOperation}function u(e,t){var n=t.channels,r=e.config;return n&&0!==n.length?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channels"}function a(e,t){var n=t.channels,r=void 0===n?[]:n,o=e.config,i=r.length>0?r.join(","):",";return"/v3/history/sub-key/"+o.subscribeKey+"/channel/"+v.default.encodeString(i)}function s(e){return e.config.getTransactionTimeout()}function c(){return!0}function l(e,t){var n=t.start,r=t.end,o=t.count,i={};return o&&(i.max=o),n&&(i.start=n),r&&(i.end=r),i}function f(e,t){var n={channels:{}}
;return Object.keys(t.channels||{}).forEach(function(r){n.channels[r]=[],(t.channels[r]||[]).forEach(function(t){var i={};i.channel=r,i.subscription=null,i.timetoken=t.timetoken,i.message=o(e,t.message),n.channels[r].push(i)})}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=u,t.getURL=a,t.getRequestTimeout=s,t.isAuthSupported=c,t.prepareParams=l,t.handleResponse=f;var h=(n(8),n(16)),d=r(h),p=n(18),v=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return h.default.PNSubscribeOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function u(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(","):",";return"/v2/subscribe/"+n.subscribeKey+"/"+p.default.encodeString(i)+"/0"}function a(e){return e.config.getSubscribeTimeout()}function s(){return!0}function c(e,t){var n=e.config,r=t.channelGroups,o=void 0===r?[]:r,i=t.timetoken,u=t.filterExpression,a=t.region,s={heartbeat:n.getPresenceTimeout()};return o.length>0&&(s["channel-group"]=o.join(",")),u&&u.length>0&&(s["filter-expr"]=u),i&&(s.tt=i),a&&(s.tr=a),s}function l(e,t){var n=[];return t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}),{messages:n,metadata:{timetoken:t.t.t,region:t.t.r}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=o,t.validateParams=i,t.getURL=u,t.getRequestTimeout=a,t.isAuthSupported=s,t.prepareParams=c,t.handleResponse=l;var f=(n(8),n(16)),h=r(f),d=n(18),p=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(7),a=(r(u),n(13)),s=r(a),c=(n(8),function(){function e(t){var n=this;o(this,e),this._modules={},Object.keys(t).forEach(function(e){n._modules[e]=t[e].bind(n)})}return i(e,[{key:"init",value:function(e){this._config=e,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}},{key:"nextOrigin",value:function(){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var e=void 0;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace("pubsub","ps"+e)}},{key:"shiftStandardOrigin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"POST",value:function(e,t,n,r){return this._modules.post(e,t,n,r)}},{key:"GET",value:function(e,t,n){return this._modules.get(e,t,n)}},{key:"_detectErrorCategory",value:function(e){if("ENOTFOUND"===e.code)return s.default.PNNetworkIssuesCategory;if("ECONNREFUSED"===e.code)return s.default.PNNetworkIssuesCategory;if("ECONNRESET"===e.code)return s.default.PNNetworkIssuesCategory;if("EAI_AGAIN"===e.code)return s.default.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty("status")&&void 0===e.status)return s.default.PNNetworkIssuesCategory;if(e.timeout)return s.default.PNTimeoutCategory;if(e.response){if(e.response.badRequest)return s.default.PNBadRequestCategory;if(e.response.forbidden)return s.default.PNAccessDeniedCategory}return s.default.PNUnknownCategory}}]),e}());t.default=c,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){try{return localStorage.getItem(e)}catch(e){return null}},set:function(e,t){try{return localStorage.setItem(e,t)}catch(e){return null}}},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=function(){return console&&console.log?console:window&&window.console&&window.console.log?window.console:console}();r.log("<<<<<"),r.log("["+n+"]","\n",e.url,"\n",e.qs),r.log("-----"),e.on("response",function(n){var o=(new Date).getTime(),i=o-t,u=(new Date).toISOString();r.log(">>>>>>"),r.log("["+u+" / "+i+"]","\n",e.url,"\n",e.qs,"\n",n.text),r.log("-----")})}function o(e,t,n){var o=this;return this._config.logVerbosity&&(e=e.use(r)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e)),e.timeout(t.timeout).end(function(e,r){var i={};if(i.error=null!==e,i.operation=t.operation,r&&r.status&&(i.statusCode=r.status),e)return i.errorData=e,i.category=o._detectErrorCategory(e),n(i,null);var u=JSON.parse(r.text);return u.error&&1===u.error&&u.status&&u.message&&u.service?(i.errorData=u,i.statusCode=u.status,i.error=!0,i.category=o._detectErrorCategory(i),n(i,null)):n(i,u)})}function i(e,t,n){var r=s.default.get(this.getStandardOrigin()+t.url).query(e);return o.call(this,r,t,n)}function u(e,t,n,r){var i=s.default.post(this.getStandardOrigin()+n.url).query(e).send(t);return o.call(this,i,n,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.get=i,t.post=u;var a=n(44),s=function(e){return e&&e.__esModule?e:{default:e}}(a);n(8)},function(e,t,n){function r(){}function o(e){if(!b(e))return e;var t=[];for(var n in e)i(t,n,e[n]);return t.join("&")}function i(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){i(e,t,n)});else if(b(n))for(var r in n)i(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function u(e){for(var t,n,r={},o=e.split("&"),i=0,u=o.length;i<u;++i)t=o[i],n=t.indexOf("="),-1==n?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function a(e){var t,n,r,o,i=e.split(/\r?\n/),u={};i.pop();for(var a=0,s=i.length;a<s;++a)n=i[a],t=n.indexOf(":"),r=n.slice(0,t).toLowerCase(),o=m(n.slice(t+1)),u[r]=o;return u}function s(e){return/[\/+]json\b/.test(e)}function c(e){return e.split(/ *; */).shift()}function l(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(e[r]=o),e},{})}function f(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function h(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new f(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}n.emit("response",t);var r;try{(t.status<200||t.status>=300)&&(r=new Error(t.statusText||"Unsuccessful HTTP response"),r.original=e,r.response=t,r.status=t.status)}catch(e){r=e}r?n.callback(r,t):n.callback(null,t)})}function d(e,t){var n=g("DELETE",e);return t&&n.end(t),n}var p;"undefined"!=typeof window?p=window:"undefined"!=typeof self?p=self:(console.warn("Using browser-only version of superagent in non-browser environment"),p=this);var v=n(45),y=n(46),b=n(47),g=e.exports=n(48).bind(null,h);g.getXHR=function(){if(!(!p.XMLHttpRequest||p.location&&"file:"==p.location.protocol&&p.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only verison of superagent could not find XHR")};var m="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};g.serializeObject=o,g.parseString=u,g.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},g.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},g.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},f.prototype.get=function(e){return this.header[e.toLowerCase()]},f.prototype._setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=c(t);var n=l(t);for(var r in n)this[r]=n[r]},f.prototype._parseBody=function(e){var t=g.parse[this.type];return!t&&s(this.type)&&(t=g.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},f.prototype._setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},f.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},g.Response=f,v(h.prototype);for(var _ in y)h.prototype[_]=y[_];h.prototype.type=function(e){return this.set("Content-Type",g.types[e]||e),this},h.prototype.responseType=function(e){return this._responseType=e,this},h.prototype.accept=function(e){return this.set("Accept",g.types[e]||e),this},h.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(e+":"+t);this.set("Authorization","Basic "+r);break;case"auto":this.username=e,this.password=t}return this},h.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},h.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},h.prototype._getFormData=function(){return this._formData||(this._formData=new p.FormData),this._formData},h.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},h.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},h.prototype._timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},h.prototype._appendQueryString=function(){var e=this._query.join("&");e&&(this.url+=~this.url.indexOf("?")?"&"+e:"?"+e)},h.prototype.end=function(e){var t=this,n=this.xhr=g.getXHR(),o=this._timeout,i=this._formData||this._data;this._callback=e||r,n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(t){e=0}if(0==e){if(t.timedout)return t._timeoutError();if(t._aborted)return;return t.crossDomainError()}t.emit("end")}};var u=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{n.onprogress=u.bind(null,"download"),n.upload&&(n.upload.onprogress=u.bind(null,"upload"))}catch(e){}if(o&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},o)),this._appendQueryString(),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof i&&!this._isHost(i)){var a=this._header["content-type"],c=this._serializer||g.serialize[a?a.split(";")[0]:""];!c&&s(a)&&(c=g.serialize["application/json"]),c&&(i=c(i))}for(var l in this.header)null!=this.header[l]&&n.setRequestHeader(l,this.header[l]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send(void 0!==i?i:null),this},g.Request=h,g.get=function(e,t,n){var r=g("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},g.head=function(e,t,n){var r=g("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.options=function(e,t,n){var r=g("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.del=d,g.delete=d,g.patch=function(e,t,n){var r=g("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.post=function(e,t,n){var r=g("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},g.put=function(e,t,n){var r=g("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return o(e)}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(47);t.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},t.parse=function(e){return this._parser=e,this},t.serialize=function(e){return this._serializer=e,this},t.timeout=function(e){return this._timeout=e,this},t.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},t.catch=function(e){return this.then(void 0,e)},t.use=function(e){return e(this),this},t.get=function(e){return this._header[e.toLowerCase()]},t.getHeader=t.get,t.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},t.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},t.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(r(e)){for(var n in e)this.field(n,e[n]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return this._getFormData().append(e,t),this},t.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},t.withCredentials=function(){return this._withCredentials=!0,this},t.redirects=function(e){return this._maxRedirects=e,this},t.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},t._isHost=function(e){switch({}.toString.call(e)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},t.send=function(e){var t=r(e),n=this._header["content-type"];if(t&&r(this._data))for(var o in e)this._data[o]=e[o];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)}},function(e,t){function n(e){return null!==e&&"object"==typeof e}e.exports=n},function(e,t){function n(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}e.exports=n}])})},function(e,t,n){e.exports=n(341)},function(e,t,n){var r=n(98),o=n(99),i=n(253),u=o(function(e,t){r(t,i(t),e)});e.exports=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PubNubListener=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(329);t.PubNubListener=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"message",value:function(e){this.emit(e.channel,e.message)}},{key:"status",value:function(e){var n=this,r=this._getEventNamesFromStatus(e.affectedChannels,e.affectedChannelGroups);r.length?r.forEach(function(r){n.emit(""+t.statusPrefix+r,e)}):this.emit(t.unclassifiedEvents,e)}},{key:"_getEventNamesFromStatus",value:function(e,t){var n=e||[],r=t||[];return n.concat(r)}}],[{key:"statusPrefix",get:function(){return"status:"}},{key:"unclassifiedEvents",get:function(){return"pubNubEventsNotRouted"}}]),t}(a.EventEmitter)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(344);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(345);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),u=n(288),a=function(e){return e&&e.__esModule?e:{default:e}}(u),s=n(40),c=n(338),l=n(244),f=n(345);(t.Stream=function(){function e(t){r(this,e),this._client=a.default.sharedInstance(),this._liveService=(0,c.getLiveService)(this._client),this._subscribeChannels={},this._publishChannels={},this.name=t}return o(e,[{key:"getSubstreams",value:function(){return this._makeStreamRequest("_substreams",l.RequestMethod.GET)}},{key:"getACL",value:function(e){return(0,s.isNonemptyString)(e)?this._makeStreamRequest(e,l.RequestMethod.GET):Promise.reject(new i.KinveyError("Invalid or missing id"))}},{key:"setACL",value:function(e,t){return(0,s.isNonemptyString)(e)?f.StreamACL.isValidACLObject(t)?(t instanceof f.StreamACL||(t=new f.StreamACL(t)),this._makeStreamRequest(e,l.RequestMethod.PUT,t.toPlainObject())):Promise.reject(new i.KinveyError("Invalid or missing ACL object")):Promise.reject(new i.KinveyError("Invalid or missing id"))}},{key:"follow",value:function(e,t){return this._subscribe(e,t)}},{key:"unfollow",value:function(e){return this._unsubscribe(e)}},{key:"post",value:function(e){var t=this._client.getActiveUser()._id;return this._publish(t,e)}},{key:"listen",value:function(e){var t=this._client.getActiveUser()._id;return this._subscribe(t,e)}},{key:"stopListening",value:function(){var e=this._client.getActiveUser()._id;return this._unsubscribe(e)}},{key:"send",value:function(e,t){return this._publish(e,t)}},{key:"_unsubscribeFromSubstream",value:function(e){var t=e+"/unsubscribe";return this._makeStreamRequest(t,l.RequestMethod.POST,{deviceId:this._client.deviceId})}},{key:"_subscribe",value:function(e,t){var n=this;return this._requestSubscribeAccess(e).then(function(){var r=n._subscribeChannels[e];n._liveService.subscribeToChannel(r,t)})}},{key:"_unsubscribe",value:function(e){var t=this;return this._unsubscribeFromSubstream(e).then(function(){var n=t._subscribeChannels[e];t._liveService.unsubscribeFromChannel(n),delete t._subscribeChannels[e]})}},{key:"_publish",value:function(e,t){return this._publishChannels[e]?this._retriablePublish(e,t):this._publishWithAccessRequest(e,t)}},{key:"_publishWithAccessRequest",value:function(e,t){var n=this;return this._requestPublishAccess(e).then(function(){var r=n._publishChannels[e];return n._liveService.publishToChannel(r,t)})}},{key:"_retriablePublish",value:function(e,t){var n=this,r=this._publishChannels[e];return this._liveService.publishToChannel(r,t).catch(function(r){var o=Promise.reject(r);return r.statusCode===l.StatusCode.Forbidden&&(o=n._publishWithAccessRequest(e,t)),o})}},{key:"_requestPublishAccess",value:function(e){var t=this;return this._makeStreamRequest(e+"/publish",l.RequestMethod.POST).then(function(n){return n.substreamChannelName&&(t._publishChannels[e]=n.substreamChannelName),n})}},{key:"_requestSubscribeAccess",value:function(e){var t=this,n={deviceId:this._client.deviceId};return this._makeStreamRequest(e+"/subscribe",l.RequestMethod.POST,n).then(function(n){return t._subscribeChannels[e]=n.substreamChannelName,n})}},{key:"_makeStreamRequest",value:function(e,t,n){return l.KinveyRequest.executeShort({method:t,pathname:"/stream/"+this._client.appKey+"/"+this.name+"/"+e,body:n},this._client)}}]),e}()).StreamACL=f.StreamACL},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.StreamACL=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(119),a=r(u),s=n(131),c=r(s),l=n(346),f=r(l),h=n(2);t.StreamACL=function(){function e(t){o(this,e),this.publishers=[],this.subscribers=[],this.publisherGroups=[],this.subscriberGroups=[],t&&(t instanceof e&&(t=t.toPlainObject()),this._parsePlainObject(t))}return i(e,[{key:"addPublishers",value:function(e){return this._addToAcl(this.publishers,e),this}},{key:"addSubscribers",value:function(e){return this._addToAcl(this.subscribers,e),this}},{key:"addPublisherGroups",value:function(e){return this._addToAcl(this.publisherGroups,e),this}},{key:"addSubscriberGroups",value:function(e){return this._addToAcl(this.publisherGroups,e),this}},{key:"isNotEmpty",value:function(){return this.publishers.length||this.subscribers.length||this.publisherGroups.length||this.subscriberGroups.length}},{key:"toPlainObject",value:function(){var e={};return this.subscribers.length&&(e.subscribe=this.subscribers.slice(0)),this.publishers.length&&(e.publish=this.publishers.slice(0)),this.subscriberGroups.length&&(e.groups=e.groups||{},e.groups.subscribe=this.addSubscriberGroups.slice(0)),this.publisherGroups.length&&(e.groups=e.groups||{},e.groups.publish=this.publisherGroups.slice(0)),e}},{key:"_parsePlainObject",value:function(e){e.subscribe&&(this.subscribers=this._ensureValidIdArray(e.subscribe)),e.publish&&(this.publishers=this._ensureValidIdArray(e.publish)),e.groups&&(e.groups.publish&&(this.publisherGroups=this._ensureValidIdArray(e.groups.publish)),e.groups.subscribe&&(this.subscriberGroups=this._ensureValidIdArray(e.groups.subscribe)))}},{key:"_ensureValidIdArray",value:function(e){if(!this._isNonemptyStringArray(e))throw new h.KinveyError("Invalid ACL object value");return e}},{key:"_isNonemptyStringArray",value:function(e){return(0,a.default)(e)&&(0,f.default)(e,function(e){return(0,c.default)(e)&&""!==e})}},{key:"_addToAcl",value:function(e,t){var n=(0,a.default)(t)?t:[t];if(!this._isNonemptyStringArray(n))throw new h.KinveyError("Invalid ACL object value");n.forEach(function(t){var n=t._id?t._id:t;e.push(n)})}}],[{key:"isValidACLObject",value:function(t){try{return new e(t).isNotEmpty()}catch(e){return!1}}}]),e}()},function(e,t,n){function r(e,t,n){var r=a(e)?o:i;return n&&s(e,t,n)&&(t=void 0),r(e,u(t,3))}var o=n(347),i=n(348),u=n(179),a=n(119),s=n(108);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}e.exports=n},function(e,t,n){function r(e,t){var n=!0;return o(e,function(e,r,o){return n=!!t(e,r,o)}),n}var o=n(229);e.exports=r},function(e,t,n){"use strict";function r(){var e=s.default.sharedInstance();return(0,l.getLiveService)(e)}function o(e){r().onConnectionStatusUpdates(e)}function i(e){r().offConnectionStatusUpdates(e)}function u(){return r().isInitialized()}Object.defineProperty(t,"__esModule",{value:!0}),t.LiveServiceFacade=void 0;var a=n(288),s=function(e){return e&&e.__esModule?e:{default:e}}(a),c=n(343),l=n(338);t.LiveServiceFacade={Stream:c.Stream,onConnectionStatusUpdates:o,offConnectionStatusUpdates:i,isInitialized:u}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(131),a=r(u),s=n(119),c=r(s),l=n(75),f=r(l),h=n(244),d=n(2),p=n(275),v=r(p),y=n(288),b=r(y),g=n(40),m=n(286),_=r(m),w=n(335),k=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,e),t&&!(0,a.default)(t))throw new d.KinveyError("Collection must be a string.");this.collection=t,this.client=n.client,this.useDeltaFetch=n.useDeltaFetch===!0}return i(e,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.useDeltaFetch===!0||this.useDeltaFetch;return g.KinveyObservable.create(function(o){if((0,g.isDefined)(e)&&!(e instanceof v.default))return o.error(new d.KinveyError("Invalid query. It must be an instance of the Query class."));var i={method:h.RequestMethod.GET,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client},u=new h.KinveyRequest(i);return r===!0&&(u=new h.DeltaFetchRequest(i)),u.execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})})}},{key:"findById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.useDeltaFetch||this.useDeltaFetch;return g.KinveyObservable.create(function(o){if(!e)return o.next(void 0),o.complete();var i={method:h.RequestMethod.GET,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout,client:t.client},u=new h.KinveyRequest(i);return r===!0&&(u=new h.DeltaFetchRequest(i)),u.execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})})}},{key:"group",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){return e instanceof _.default?new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:n.properties,aggregation:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new d.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){try{if(e&&!(e instanceof v.default))throw new d.KinveyError("Invalid query. It must be an instance of the Query class.");return new h.KinveyRequest({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_count"}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e?e.count:0)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"create",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){return(0,g.isDefined)(e)===!1?(r.next(null),r.complete()):(0,c.default)(e)?r.error(new d.KinveyError("Unable to create an array of entities.","Please create entities one by one.")):new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){return(0,g.isDefined)(e)===!1?(r.next(null),r.complete()):(0,c.default)(e)?r.error(new d.KinveyError("Unable to update an array of entities.","Please update entities one by one.")):(0,g.isDefined)(e._id)===!1?r.error(new d.KinveyError("Unable to update entity.","Entity must contain an _id to be updated.")):new h.KinveyRequest({method:h.RequestMethod.PUT,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"save",value:function(e,t){return e._id?this.update(e,t):this.create(e,t)}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){try{if(e&&!(e instanceof v.default))throw new d.KinveyError("Invalid query. It must be an instance of the Query class.");return new h.KinveyRequest({method:h.RequestMethod.DELETE,
authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}}).toPromise()}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.KinveyObservable.create(function(r){try{if((0,g.isDefined)(e)===!1)return r.next(void 0),r.complete();return new h.KinveyRequest({method:h.RequestMethod.DELETE,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}}).toPromise()}},{key:"subscribe",value:function(e){return(0,w.getLiveCollectionManager)().subscribeCollection(this.collection,e)}},{key:"unsubscribe",value:function(){return(0,w.getLiveCollectionManager)().unsubscribeCollection(this.collection)}},{key:"client",get:function(){return(0,g.isDefined)(this._client)?this._client:b.default.sharedInstance()},set:function(e){e instanceof b.default?this._client=e:this._client=null}},{key:"pathname",get:function(){var e="/appdata/"+this.client.appKey;return this.collection&&(e=e+"/"+this.collection),e}}]),e}();t.default=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncOperation=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(242),c=r(s),l=n(314),f=r(l),h=n(119),d=r(h),p=n(131),v=r(p),y=n(75),b=r(y),g=n(244),m=n(2),_=n(40),w=n(288),k=r(w),E=n(275),O=r(E),S=new Map,P={Create:g.RequestMethod.POST,Update:g.RequestMethod.PUT,Delete:g.RequestMethod.DELETE};Object.freeze(P),t.SyncOperation=P;var j=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,e),!t)throw new m.SyncError("A collection is required.");if(!(0,v.default)(t))throw new m.SyncError("Collection must be a string.");this.collection=t,this.client=n.client||k.default.sharedInstance()}return i(e,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,_.isDefined)(e)&&e instanceof O.default==!1&&(e=new O.default((0,f.default)(e,"toJSON",e))),new g.CacheRequest({method:g.RequestMethod.GET,url:b.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.backendPathname}),query:e,properties:n.properties,timeout:n.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(r){var o=new O.default;return o.equalTo("collection",t.collection),(0,_.isDefined)(e)&&o.contains("entityId",(0,c.default)(r,function(e){return e._id})),new g.CacheRequest({method:g.RequestMethod.GET,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:o,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data})})}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,t).then(function(e){return e.length})}},{key:"addCreateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(P.Create,e,t)}},{key:"addUpdateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(P.Update,e,t)}},{key:"addDeleteOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(P.Delete,e,t)}},{key:"addOperation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.Create,t=this,n=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!1;return(0,d.default)(n)||(o=!0,n=[n]),a.default.all((0,c.default)(n,function(n){if(!n)return a.default.resolve(null);var o=n._id;if(!o)return a.default.reject(new m.SyncError("An entity is missing an _id. All entities must have an _id in order to be added to the sync table.",n));var i=(new O.default).equalTo("entityId",o);return new g.CacheRequest({method:g.RequestMethod.GET,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:i,timeout:r.timeout}).execute().then(function(e){return e.data}).then(function(n){var i=1===n.length?n[0]:{collection:t.collection,state:{},entityId:o};return i.state=i.state||{},i.state.operation=e,new g.CacheRequest({method:g.RequestMethod.PUT,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,body:i,timeout:r.timeout}).execute()})})).then(function(){return o===!0?n[0]:n})}},{key:"pull",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e||e instanceof O.default?this.count(e).then(function(n){return n>0?t.push(e).then(function(){return t.count(e)}):n}).then(function(r){if(r>0)throw new m.SyncError("Unable to pull data from the network. There are "+r+" entities that need to be synced before data is loaded from the network.");var o={method:g.RequestMethod.GET,authType:g.AuthType.Default,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client},i=new g.KinveyRequest(o);return n.useDeltaFetch===!0&&(i=new g.DeltaFetchRequest(o)),i.execute()}).then(function(e){return e.data}):a.default.reject(new m.SyncError("Invalid query. It must be an instance of the Query class."))}},{key:"push",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=0;return S.get(this.collection)===!0?a.default.reject(new m.SyncError("Data is already being pushed to the backend. Please wait for it to complete before pushing new data to the backend.")):(S.set(this.collection,!0),this.find(e).then(function(e){if(e.length>0){return function o(i){return new a.default(function(u){var s=e.slice(r,r+100);return r+=100,a.default.all((0,c.default)(s,function(e){var r=e.entityId,o=e.state,i=void 0===o?{}:o,u=i.operation||i.method;if(u===P.Delete){return new g.KinveyRequest({method:g.RequestMethod.DELETE,authType:g.AuthType.Default,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,client:t.client}).execute().then(function(){return new g.CacheRequest({method:g.RequestMethod.DELETE,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout}).execute()}).then(function(){return{_id:r,operation:u}}).catch(function(e){return{_id:r,operation:u,error:e}})}if(u===P.Create||u===P.Update){var a=!1;return new g.CacheRequest({method:g.RequestMethod.GET,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(o){var i=new g.KinveyRequest({method:g.RequestMethod.PUT,authType:g.AuthType.Default,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,body:o,client:t.client});return u===P.Create&&((0,_.isDefined)(o._kmd)&&o._kmd.local===!0&&(a=!0,delete o._id),i.method=g.RequestMethod.POST,i.url=b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname})),i.execute().then(function(e){return e.data}).then(function(o){return new g.CacheRequest({method:g.RequestMethod.DELETE,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout}).execute().then(function(){return new g.CacheRequest({method:g.RequestMethod.PUT,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+o._id}),properties:n.properties,timeout:n.timeout,body:o}).execute().then(function(e){return e.data})}).then(function(e){return a?new g.CacheRequest({method:g.RequestMethod.DELETE,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout}).execute().then(function(){return e}):e}).then(function(e){return{_id:r,operation:u,entity:e}})}).catch(function(e){return o._id=r,{_id:r,operation:u,entity:o,error:e}})}).catch(function(e){return{_id:r,operation:u,entity:void 0,error:e}})}return{_id:r,operation:u,entity:void 0,error:new m.SyncError("Unable to sync the entity since the operation was not recognized.",e)}})).then(function(t){return i=i.concat(t),u(r<e.length?o(i):i)})})}([])}return[]}).then(function(e){return S.set(t.collection,!1),e}).catch(function(e){throw S.set(t.collection,!1),e}))}},{key:"clear",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,n).then(function(e){return a.default.all((0,c.default)(e,function(e){return new g.CacheRequest({method:g.RequestMethod.DELETE,url:b.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data})}))})}},{key:"pathname",get:function(){return"/appdata/"+this.client.appKey+"/kinvey_sync"}},{key:"backendPathname",get:function(){return"/appdata/"+this.client.appKey+"/"+this.collection}}]),e}();t.default=j},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DataStoreType=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(131),a=r(u),s=n(75),c=r(s),l=n(244),f=n(2),h=n(40),d=n(288),p=r(d),v=n(350),y=r(v),b=n(140),g=r(b),m=n(353),_=r(m),w={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(w),t.DataStoreType=w;var k=function(){function e(){throw o(this,e),new f.KinveyError("Not allowed to construct a DataStore instance. Please use the collection() function to get an instance of a DataStore instance.")}return i(e,null,[{key:"collection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.Cache,n=arguments[2],r=void 0;if((0,h.isDefined)(e)===!1||(0,a.default)(e)===!1)throw new f.KinveyError("A collection is required and must be a string.");switch(t){case w.Network:r=new y.default(e,n);break;case w.Sync:r=new _.default(e,n);break;case w.Cache:default:r=new g.default(e,n)}return r}},{key:"getInstance",value:function(e,t,n){return this.collection(e,t,n)}},{key:"clearCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.client||p.default.sharedInstance(),n="/appdata/"+t.appKey;return new l.CacheRequest({method:l.RequestMethod.DELETE,url:c.default.format({protocol:t.apiProtocol,host:t.apiHost,pathname:n}),properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data})}}]),e}();t.default=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(75),c=r(s),l=n(244),f=n(2),h=n(275),d=r(h),p=n(286),v=r(p),y=n(40),b=n(140),g=r(b),m=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),a(t,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.KinveyObservable.create(function(r){return!e||e instanceof d.default?new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new f.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"findById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.KinveyObservable.create(function(r){try{if((0,y.isDefined)(e)===!1)return r.next(void 0),r.complete();return new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"group",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.KinveyObservable.create(function(r){return e instanceof v.default?new l.CacheRequest({method:l.RequestMethod.POST,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:n.properties,aggregation:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new f.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.KinveyObservable.create(function(r){try{if(e&&!(e instanceof d.default))throw new f.KinveyError("Invalid query. It must be an instance of the Query class.");return new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e?e.length:0)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"syncAutomatically",get:function(){return!1}}]),t}(g.default);t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return Math.floor(Math.random()*(t-e))+e}function s(e,t){var n=e?parseInt(e.split("-")[1],10)+1:0;return n>=t?t-1:n}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(48),f=r(l),h=n(242),d=r(h),p=n(87),v=r(p),y=n(65),b=r(y),g=n(277),m=r(g),_=n(75),w=r(_),k=n(244),E=n(2),O=n(40),S=n(275),P=r(S),j=n(350),x=r(j),T=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=(0,v.default)({tls:!0},n);var r={tls:n.tls===!0};return(0,m.default)(n.ttl)&&(r.ttl_in_seconds=parseInt(n.ttl,10)),O.KinveyObservable.create(function(o){return!(0,O.isDefined)(e)||e instanceof P.default?new k.KinveyRequest({method:k.RequestMethod.GET,authType:k.AuthType.Default,url:w.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname,query:r}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)}):o.error(new E.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise().then(function(e){return n.download===!0?f.default.all((0,d.default)(e,function(e){return t.downloadByUrl(e._downloadURL,n)})):e})}},{key:"findById",value:function(e,t){return this.download(e,t)}},{key:"download",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=(0,v.default)({tls:!0},n);var r={tls:n.tls===!0};return(0,m.default)(n.ttl)&&(r.ttl_in_seconds=parseInt(n.ttl,10)),O.KinveyObservable.create(function(o){return(0,O.isDefined)(e)===!1?(o.next(void 0),o.complete()):new k.KinveyRequest({method:k.RequestMethod.GET,authType:k.AuthType.Default,url:w.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:r}),properties:n.properties,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})}).toPromise().then(function(e){return n.stream===!0?e:(n.mimeType=e.mimeType,t.downloadByUrl(e._downloadURL,n))})}},{key:"downloadByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new k.NetworkRequest({method:k.RequestMethod.GET,url:e,timeout:t.timeout}).execute().then(function(e){return e.data})}},{key:"stream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.stream=!0,this.download(e,t)}},{key:"upload",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=this.transformMetadata(e,n);var o=null;return this.saveFileMetadata(r,n).then(function(e){return o=e.data,t.makeStatusCheckRequest(e.data._uploadURL,e.data._requiredHeaders,n,r.timeout)}).then(function(i){if(O.Log.debug("File upload status check response",i),!i.isSuccess())return f.default.reject(i.error);if(200===i.statusCode||201===i.statusCode)return i;if(308!==i.statusCode){var u=new E.KinveyError("Unexpected response for upload file status check request.",!1,i.statusCode,i.headers.get("X-Kinvey-Request-ID"));return f.default.reject(u)}var a={start:s(i.headers.get("range"),n.size),timeout:r.timeout,maxBackoff:r.maxBackoff,headers:o._requiredHeaders};return t.retriableUpload(o._uploadURL,e,n,a)}).then(function(){return delete o._expiresAt,delete o._requiredHeaders,delete o._uploadURL,o._data=e,o})}},{key:"transformMetadata",value:function(e,t){var n=(0,v.default)({filename:e._filename||e.name,public:!1,size:e.size||e.length,mimeType:e.mimeType||e.type||"application/octet-stream"},t);return n._filename=t.filename,delete n.filename,n._public=t.public,delete n.public,n}},{key:"saveFileMetadata",value:function(e,t){var n=(0,O.isDefined)(t._id);return new k.KinveyRequest({method:n?k.RequestMethod.PUT:k.RequestMethod.POST,authType:k.AuthType.Default,headers:{"X-Kinvey-Content-Type":t.mimeType},url:w.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:n?this.pathname+"/"+t._id:this.pathname}),properties:e.properties,timeout:e.timeout,body:t,client:this.client}).execute()}},{key:"makeStatusCheckRequest",value:function(e,t,n,r){var o=new k.Headers(t);return o.set("content-type",n.mimeType),o.set("content-range","bytes */"+n.size),new k.NetworkRequest({method:k.RequestMethod.PUT,url:e,timeout:r,headers:o}).execute()}},{key:"retriableUpload",value:function(e,t,n,r){var o=this;return r=(0,v.default)({count:0,start:0,maxBackoff:32e3},r),O.Log.debug("Start file upload"),O.Log.debug("File upload headers",r.headers),O.Log.debug("File upload upload url",w.default),O.Log.debug("File upload file",t),O.Log.debug("File upload metadata",n),O.Log.debug("File upload options",r),this.makeUploadRequest(e,t,n,r).then(function(e){if(O.Log.debug("File upload response",e),e.isClientError())return f.default.reject(e.error);if(!e.isSuccess()&&!e.isServerError()&&308!==e.statusCode){var t=new E.KinveyError("Unexpected response for upload file request.",!1,e.statusCode,e.headers.get("X-Kinvey-Request-ID"));return f.default.reject(t)}return e}).then(function(e){var t=0;return e.isServerError()?(O.Log.debug("File upload server error. Probably network congestion.",e.statusCode,e.data),(t=Math.pow(2,r.count)+a(1,1001))>=r.maxBackoff?f.default.reject(e.error):(O.Log.debug("File upload will try again in "+t+" seconds."),new f.default(function(e){setTimeout(function(){r.count+=1,e(!0)},t)}))):308===e.statusCode?(O.Log.debug("File upload was incomplete (statusCode 308). Trying to upload the remainder of file."),r.start=s(e.headers.get("range"),n.size),new f.default(function(e){setTimeout(function(){r.count=0,e(!0)},t)})):new f.default(function(e){setTimeout(function(){e(!1)},t)})}).then(function(i){return i?o.retriableUpload(e,t,n,r):null})}},{key:"makeUploadRequest",value:function(e,t,n,r){var o=new k.Headers(r.headers);return o.set("content-type",n.mimeType),o.set("content-range","bytes "+r.start+"-"+(n.size-1)+"/"+n.size),new k.NetworkRequest({method:k.RequestMethod.PUT,url:e,headers:o,body:(0,b.default)(t.slice)?t.slice(r.start):t,timeout:r.timeout}).execute()}},{key:"create",value:function(e,t,n){return this.upload(e,t,n)}},{key:"update",value:function(e,t,n){return this.upload(e,t,n)}},{key:"remove",value:function(){throw new E.KinveyError("Please use removeById() to remove files one by one.")}},{key:"pathname",get:function(){return"/blob/"+this.client.appKey}}]),t}(x.default);t.default=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},c=n(48),l=r(c),f=n(119),h=r(f),d=n(131),p=r(d),v=n(75),y=r(v),b=n(244),g=n(2),m=n(40),_=n(275),w=r(_),k=n(350),E=r(k),O=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null,e))}return u(t,e),a(t,[{key:"lookup",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.KinveyObservable.create(function(r){return!(0,m.isDefined)(e)||e instanceof w.default?new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.Default,url:y.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_lookup"}),properties:n.properties,body:(0,m.isDefined)(e)?e.toPlainObject().filter:null,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)}):r.error(new g.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"create",value:function(){return l.default.reject(new g.KinveyError("Please use `User.signup()` to create a user."))}},{key:"update",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?(0,h.default)(e)?l.default.reject(new g.KinveyError("Only one user can be updated at one time.",e)):e._id?s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,n):l.default.reject(new g.KinveyError("User must have an _id.")):l.default.reject(new g.KinveyError("No user was provided to be updated."))}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:y.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:"/rpc/"+this.client.appKey+"/check-username-exists"}),properties:t.properties,data:{username:e},timeout:t.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).usernameExists===!0})}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.KinveyObservable.create(function(r){return(0,m.isDefined)(e)===!1?r.error(new g.KinveyError("An id was not provided.","Please provide a valid id for a user that you would like to remove.")):(0,p.default)(e)===!1?r.error(new g.KinveyError("The id provided is not a string.","Please provide a valid id for a user that you would like to remove.")):new b.KinveyRequest({method:b.RequestMethod.DELETE,authType:b.AuthType.Default,url:y.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:n.hard===!0?{hard:!0}:void 0}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}]),t}(E.default);t.default=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(131),c=r(s),l=n(75),f=r(l),h=n(2),d=n(288),p=r(d),v=n(244),y=function(){function e(){throw o(this,e),new h.KinveyError("Not allowed to create an instance of the `CustomEndpoint` class.","Please use `CustomEndpoint.execute()` function.")}return i(e,null,[{key:"execute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.client||p.default.sharedInstance();return e?(0,c.default)(e)?new v.KinveyRequest({method:v.RequestMethod.POST,authType:v.AuthType.Default,url:f.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:"/rpc/"+r.appKey+"/custom/"+e}),properties:n.properties,body:t,timeout:n.timeout,client:r}).execute().then(function(e){return e.data}):a.default.reject(new h.KinveyError("The endpoint argument must be a string.")):a.default.reject(new h.KinveyError("An endpoint argument is required."))}}]),e}();t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Kinvey=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(48),a=r(u),s=n(2),c=n(40),l=n(288),f=r(l),h=n(356),d=r(h),p=n(275),v=r(p),y=n(286),b=r(y),g=n(139),m=r(g),_=n(331),w=n(324),k=n(244),E=n(335),O=function(){function e(){o(this,e)}return i(e,null,[{key:"initialize",value:function(t){var n=e.init(t);return a.default.resolve(_.User.getActiveUser(n))}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,c.isDefined)(e.appKey)===!1)throw new s.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if((0,c.isDefined)(e.appSecret)===!1&&(0,c.isDefined)(e.masterSecret)===!1)throw new s.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return f.default.init(e)}},{key:"ping",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.default.sharedInstance();return new k.KinveyRequest({method:k.RequestMethod.GET,authType:k.AuthType.All,url:this.client.apiHostname+"/appdata/"+e.appKey}).execute().then(function(e){return e.data})}},{key:"client",get:function(){return f.default.sharedInstance()}},{key:"appVersion",get:function(){return this.client.appVersion},set:function(e){this.client.appVersion=e}}]),e}();O.Acl=_.Acl,O.Aggregation=b.default,O.AuthorizationGrant=w.AuthorizationGrant,O.CustomEndpoint=d.default,O.DataStore=m.default,O.DataStoreType=g.DataStoreType,O.LiveService=E.LiveServiceFacade,O.Files=new g.FileStore,O.Group=b.default,O.Log=c.Log,O.Metadata=_.Metadata,O.Query=v.default,O.SyncOperation=g.SyncOperation,O.User=_.User,O.ActiveUserError=s.ActiveUserError,O.APIVersionNotAvailableError=s.APIVersionNotAvailableError,O.APIVersionNotImplementedError=s.APIVersionNotImplementedError,O.AppProblemError=s.AppProblemError,O.BadRequestError=s.BadRequestError,O.BLError=s.BLError,O.CORSDisabledError=s.CORSDisabledError,O.DuplicateEndUsersError=s.DuplicateEndUsersError,O.FeatureUnavailableError=s.FeatureUnavailableError,O.IncompleteRequestBodyError=s.IncompleteRequestBodyError,O.IndirectCollectionAccessDisallowedError=s.IndirectCollectionAccessDisallowedError,O.InsufficientCredentialsError=s.InsufficientCredentialsError,O.InvalidCredentialsError=s.InvalidCredentialsError,O.InvalidIdentifierError=s.InvalidIdentifierError,O.InvalidQuerySyntaxError=s.InvalidQuerySyntaxError,O.JSONParseError=s.JSONParseError,O.KinveyError=s.KinveyError,O.KinveyInternalErrorRetry=s.KinveyInternalErrorRetry,O.KinveyInternalErrorStop=s.KinveyInternalErrorStop,O.MissingQueryError=s.MissingQueryError,
O.MissingRequestHeaderError=s.MissingRequestHeaderError,O.MissingRequestParameterError=s.MissingRequestParameterError,O.MobileIdentityConnectError=s.MobileIdentityConnectError,O.NoActiveUserError=s.NoActiveUserError,O.NetworkConnectionError=s.NetworkConnectionError,O.NoResponseError=s.NoResponseError,O.NotFoundError=s.NotFoundError,O.ParameterValueOutOfRangeError=s.ParameterValueOutOfRangeError,O.PopupError=s.PopupError,O.QueryError=s.QueryError,O.ServerError=s.ServerError,O.StaleRequestError=s.StaleRequestError,O.SyncError=s.SyncError,O.TimeoutError=s.TimeoutError,O.UserAlreadyExistsError=s.UserAlreadyExistsError,O.WritesToCollectionDisallowedError=s.WritesToCollectionDisallowedError,O.CacheRack=k.CacheRack,O.NetworkRack=k.NetworkRack,O.Rack=k.Rack,t.Kinvey=O,t.default=O},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Kinvey=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(359),s=n(75),c=function(e){return e&&e.__esModule?e:{default:e}}(s),l=n(1),f=n(361);t.Kinvey=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,null,[{key:"initialize",value:function(e){var n=t.init(e),r=l.User.getActiveUser(n);return(0,l.isDefined)(r)?a.Promise.resolve(r):new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/user/"+n.appKey+"/kinvey_active_user"})}).execute().then(function(e){return e.data}).then(function(e){return e.length>0?e[0]:null}).then(function(e){return(0,l.isDefined)(e)?(0,l.isDefined)(e.data)?n.setActiveUser(e.data):n.setActiveUser(e):e}).then(function(){return l.User.getActiveUser(n)})}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(0,l.isDefined)(e.appKey))throw new l.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!(0,l.isDefined)(e.appSecret)&&!(0,l.isDefined)(e.masterSecret))throw new l.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return f.Client.init(e)}}]),t}(l.Kinvey)},function(e,t,n){(function(t,r){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.1.0
	 */
!function(t,n){e.exports=n()}(0,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function i(e){G=e}function u(e){V=e}function a(){return void 0!==z?function(){z(c)}:s()}function s(){var e=setTimeout;return function(){return e(c,1)}}function c(){for(var e=0;e<H;e+=2){(0,J[e])(J[e+1]),J[e]=void 0,J[e+1]=void 0}H=0}function l(e,t){var n=arguments,r=this,o=new this.constructor(h);void 0===o[ee]&&A(o);var i=r._state;return i?function(){var e=n[i-1];V(function(){return x(i,o,e,r._result)})}():O(r,o,e,t),o}function f(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(h);return _(n,e),n}function h(){}function d(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function v(e){try{return e.then}catch(e){return oe.error=e,oe}}function y(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function b(e,t,n){V(function(e){var r=!1,o=y(n,t,function(n){r||(r=!0,t!==n?_(e,n):k(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,E(e,o))},e)}function g(e,t){t._state===ne?k(e,t._result):t._state===re?E(e,t._result):O(t,void 0,function(t){return _(e,t)},function(t){return E(e,t)})}function m(e,t,n){t.constructor===e.constructor&&n===l&&t.constructor.resolve===f?g(e,t):n===oe?(E(e,oe.error),oe.error=null):void 0===n?k(e,t):o(n)?b(e,t,n):k(e,t)}function _(t,n){t===n?E(t,d()):e(n)?m(t,n,v(n)):k(t,n)}function w(e){e._onerror&&e._onerror(e._result),S(e)}function k(e,t){e._state===te&&(e._result=t,e._state=ne,0!==e._subscribers.length&&V(S,e))}function E(e,t){e._state===te&&(e._state=re,e._result=t,V(w,e))}function O(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ne]=n,o[i+re]=r,0===i&&e._state&&V(S,e)}function S(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,u=0;u<t.length;u+=3)r=t[u],o=t[u+n],r?x(n,r,o,i):o(i);e._subscribers.length=0}}function P(){this.error=null}function j(e,t){try{return e(t)}catch(e){return ie.error=e,ie}}function x(e,t,n,r){var i=o(n),u=void 0,a=void 0,s=void 0,c=void 0;if(i){if(u=j(n,r),u===ie?(c=!0,a=u.error,u.error=null):s=!0,t===u)return void E(t,p())}else u=r,s=!0;t._state!==te||(i&&s?_(t,u):c?E(t,a):e===ne?k(t,u):e===re&&E(t,u))}function T(e,t){try{t(function(t){_(e,t)},function(t){E(e,t)})}catch(t){E(e,t)}}function C(){return ue++}function A(e){e[ee]=ue++,e._state=void 0,e._result=void 0,e._subscribers=[]}function M(e,t){this._instanceConstructor=e,this.promise=new e(h),this.promise[ee]||A(this.promise),F(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&k(this.promise,this._result))):E(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function I(e){return new M(this,e).promise}function q(e){var t=this;return new t(F(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function D(e){var t=this,n=new t(h);return E(n,e),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(e){this[ee]=C(),this._result=this._state=void 0,this._subscribers=[],h!==e&&("function"!=typeof e&&U(),this instanceof L?T(this,e):N())}function K(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=L}var B=void 0;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var F=B,H=0,z=void 0,G=void 0,V=function(e,t){J[H]=e,J[H+1]=t,2===(H+=2)&&(G?G(c):Z())},$="undefined"!=typeof window?window:void 0,Q=$||{},W=Q.MutationObserver||Q.WebKitMutationObserver,Y="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),X="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3),Z=void 0;Z=Y?function(){return function(){return t.nextTick(c)}}():W?function(){var e=0,t=new W(c),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():X?function(){var e=new MessageChannel;return e.port1.onmessage=c,function(){return e.port2.postMessage(0)}}():void 0===$?function(){try{var e=n(360);return z=e.runOnLoop||e.runOnContext,a()}catch(e){return s()}}():s();var ee=Math.random().toString(36).substring(16),te=void 0,ne=1,re=2,oe=new P,ie=new P,ue=0;return M.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===te&&n<e;n++)this._eachEntry(t[n],n)},M.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===f){var o=v(e);if(o===l&&e._state!==te)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===L){var i=new n(h);m(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},M.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===te&&(this._remaining--,e===re?E(r,n):this._result[t]=n),0===this._remaining&&k(r,this._result)},M.prototype._willSettleAt=function(e,t){var n=this;O(e,void 0,function(e){return n._settledAt(ne,t,e)},function(e){return n._settledAt(re,t,e)})},L.all=I,L.race=q,L.resolve=f,L.reject=D,L._setScheduler=i,L._setAsap=u,L._asap=V,L.prototype={constructor:L,then:l,catch:function(e){return this.then(null,e)}},L.polyfill=K,L.Promise=L,L})}).call(t,n(49),function(){return this}())},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(131),c=r(s),l=n(1),f=n(40),h=n(362),d=r(h),p=function(){function e(){u(this,e)}return a(e,[{key:"get",value:function(e){if(!(0,c.default)(e))throw new l.KinveyError("ActiveUserStorage key must be a string.");try{return JSON.parse(d.default.getItem(e))}catch(e){return f.Log.debug("Unable to parse stored active user.",e),null}}},{key:"set",value:function(e,t){if(!(0,c.default)(e))throw new l.KinveyError("ActiveUserStorage key must be a string.");return(0,l.isDefined)(t)?d.default.setItem(e,JSON.stringify(t)):d.default.removeItem(e),t}}]),e}();t.Client=function(e){function t(){return u(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,null,[{key:"init",value:function(e){var t=l.Client.init(e);return t.activeUserStorage=new p,t}}]),t}(l.Client)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=t.CookieStorage=t.isSupported=t.storage=void 0;var o=n(363),i=r(o),u=n(364),a=r(u),s=n(366),c=r(s),l=null;(0,i.default)("localStorage")?t.storage=l=window.localStorage:(0,i.default)("sessionStorage")?t.storage=l=window.sessionStorage:(0,i.default)("cookieStorage")?t.storage=l=new a.default:t.storage=l=new c.default,t.default=l,t.storage=l,t.isSupported=i.default,t.CookieStorage=a.default,t.MemoryStorage=c.default},function(e,t,n){"use strict";function r(e){try{var t=window[e];return t.setItem(u,"1"),t.removeItem(u),!0}catch(e){return!1}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return r("localStorage");if("session"===t)return r("sessionStorage");if("cookie"===t)return(0,i.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(364),u="__test"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=new c;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.hasCookies=o;var u=n(365),a=function(e){return e&&e.__esModule?e:{default:e}}(u),s="lS_",c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.cookieOptions=Object.assign({path:"/"},t),s=t.prefix||s}return i(e,[{key:"getItem",value:function(e){var t=a.default.parse(document.cookie);return t&&t.hasOwnProperty(s+e)?t[s+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=a.default.serialize(s+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=Object.assign({},this.cookieOptions,{maxAge:-1});return document.cookie=a.default.serialize(s+e,"",t),null}},{key:"clear",value:function(){var e=a.default.parse(document.cookie);for(var t in e)0===t.indexOf(s)&&this.removeItem(t.substr(s.length));return null}}]),e}();t.default=c},function(e,t){"use strict";function n(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},r=t||{},u=e.split(a),s=r.decode||i,c=0;c<u.length;c++){var l=u[c],f=l.indexOf("=");if(!(f<0)){var h=l.substr(0,f).trim(),d=l.substr(++f,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==n[h]&&(n[h]=o(d,s))}}return n}function r(e,t,n){var r=n||{},o=r.encode||u;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!s.test(i))throw new TypeError("argument val is invalid");var a=e+"="+i;if(null!=r.maxAge){var c=r.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");a+="; Max-Age="+Math.floor(c)}if(r.domain){if(!s.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!s.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.sameSite){switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return a}function o(e,t){try{return t(e)}catch(t){return e}}t.parse=n,t.serialize=r;var i=decodeURIComponent,u=encodeURIComponent,a=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this._data={}}return r(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMiddleware=t.CacheMiddleware=void 0;var o=n(368),i=r(o),u=n(378),a=r(u);t.CacheMiddleware=i.default,t.HttpMiddleware=a.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(369),c=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"loadStorage",value:function(e){return new c.default(e)}}]),t}(a.CacheMiddleware);t.default=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},s=n(1),c=n(302),l=n(370),f=n(371),h=n(372),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"loadAdapter",value:function(){var e=this;return f.WebSQLAdapter.load(this.name).then(function(t){return(0,s.isDefined)(t)===!1?l.IndexedDBAdapter.load(e.name):t}).then(function(t){return(0,s.isDefined)(t)===!1?h.LocalStorageAdapter.load(e.name):t}).then(function(n){return(0,s.isDefined)(n)===!1?a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"loadAdapter",e).call(e):n})}}]),t}(c.Storage);t.default=d},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDBAdapter=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(359),a=r(u),s=n(1),c=n(280),l=r(c),f=n(131),h=r(f),d=n(119),p=r(d),v=n(65),y=r(v),b={},g=void 0,m={ReadWrite:"readwrite",ReadOnly:"readonly"};Object.freeze(m);t.IndexedDBAdapter=function(){function t(e){if(o(this,t),(0,s.isDefined)(e)===!1)throw new Error("A name is required to use the IndexedDB adapter.",e);if((0,h.default)(e)===!1)throw new Error("The name must be a string to use the IndexedDB adapter",e);this.name=e,this.inTransaction=!1,this.queue=[]}return i(t,[{key:"openTransaction",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2],o=this,i=arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,c=b[this.name];if((0,s.isDefined)(c)){if((0,y.default)(c.objectStoreNames.contains)?c.objectStoreNames.contains(t):c.objectStoreNames.indexOf(t)!==-1)try{var f=n?m.ReadWrite:m.ReadOnly,h=c.transaction(t,f);if((0,s.isDefined)(h))return r(h);throw new s.KinveyError("Unable to open a transaction for "+t+" collection on the "+this.name+" IndexedDB database.")}catch(e){return i(e)}else if(n===!1)return i(new s.NotFoundError("The "+t+" collection was not found on the "+this.name+" IndexedDB database."))}if(u===!1&&this.inTransaction)return this.queue.push(function(){o.openTransaction(t,n,r,i)});this.inTransaction=!0;var d=void 0;try{if((0,s.isDefined)(c)){var p=c.version+1;c.close(),d=a.open(this.name,p)}else d=a.open(this.name)}catch(e){i(e)}return d.onupgradeneeded=function(e){c=e.target.result,b[o.name]=c,n===!0&&c.createObjectStore(t,{keyPath:"_id"})},d.onsuccess=function(e){c=e.target.result,b[o.name]=c,c.onversionchange=function(){(0,s.isDefined)(c)&&(c.close(),c=null,b[o.name]=null)};var u=function(e){return function(t){if(e(t),o.inTransaction=!1,o.queue.length>0){var n=o.queue;o.queue=[],(0,l.default)(n,function(e){e.call(o)})}}};return o.openTransaction(t,n,u(r),u(i),!0)},d.onblocked=function(){},d.onerror=function(e){i(new Error("Unable to open the "+o.name+" IndexedDB database. "+e.target.error.message+"."))},d}},{key:"close",value:function(){var e=b[this.name];(0,s.isDefined)(e)&&e.close()}},{key:"find",value:function(e){var t=this;return new a.default(function(n,r){t.openTransaction(e,!1,function(t){var o=t.objectStore(e),i=o.openCursor(),u=[];i.onsuccess=function(e){var t=e.target.result;return(0,s.isDefined)(t)?(u.push(t.value),t.continue()):n(u)},i.onerror=function(e){r(e)}},r)})}},{key:"findById",value:function(e,t){var n=this;return new a.default(function(r,o){n.openTransaction(e,!1,function(i){var u=i.objectStore(e),a=u.get(t);a.onsuccess=function(i){var u=i.target.result;(0,s.isDefined)(u)?r(u):o(new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))},a.onerror=function(){o(new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))}},o)})}},{key:"save",value:function(e,t){var n=this,r=!1;return(0,p.default)(t)||(r=!0,t=[t]),0===t.length?a.default.resolve(null):new a.default(function(o,i){n.openTransaction(e,!0,function(u){var a=u.objectStore(e);(0,l.default)(t,function(e){a.put(e)}),u.oncomplete=function(){o(r?t[0]:t)},u.onerror=function(t){i(new s.KinveyError("An error occurred while saving the entities to the "+e+" collection on the "+n.name+" IndexedDB database. "+t.target.error.message+"."))}},i)})}},{key:"removeById",value:function(e,t){var n=this;return new a.default(function(r,o){n.openTransaction(e,!0,function(i){var u=i.objectStore(e),a=u.get(t);u.delete(t),i.oncomplete=function(){var i=a.result;(0,s.isDefined)(i)?r({count:1}):o(new s.NotFoundError("An entity with id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))},i.onerror=function(){o(new s.NotFoundError("An entity with id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))}},o)})}},{key:"clear",value:function(){var t=this;return this.close(),new a.default(function(n,r){var o=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,i=o.deleteDatabase(t.name);i.onsuccess=function(){b={},n()},i.onerror=function(e){r(new s.KinveyError("An error occurred while clearing the "+t.name+" IndexedDB database. "+e.target.error.message+"."))},i.onblocked=function(){r(new s.KinveyError("The "+t.name+" IndexedDB database could not be cleared due to the operation being blocked."))}})}}],[{key:"load",value:function(n){var r=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,o=new t(n);return(0,s.isDefined)(r)===!1?a.default.resolve(void 0):(0,s.isDefined)(g)?g?a.default.resolve(o):a.default.resolve(void 0):o.save("__testSupport",{_id:"1"}).then(function(){return g=!0,o}).catch(function(){g=!1})}}]),t}()}).call(t,function(){return this}())},function(e,t,n){(function(e,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.WebSQLAdapter=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(359),s=o(a),c=n(1),l=n(242),f=o(l),h=n(280),d=o(h),p=n(119),v=o(p),y=n(65),b=o(y),g=n(131),m=o(g),_=e&&e.env&&e.env.KINVEY_ID_ATTRIBUTE||"_id"||"_id",w={},k=void 0;t.WebSQLAdapter=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kinvey";if(i(this,e),(0,c.isDefined)(t)===!1)throw new c.KinveyError("A name is required to use the WebSQL adapter.",t);if((0,m.default)(t)===!1)throw new c.KinveyError("The name must be a string to use the WebSQL adapter",t);this.name=t}return u(e,[{key:"openTransaction",value:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=w[this.name],a='"'+e+'"',l="sqlite_master"===e,f=(0,v.default)(t);return t=f?t:[[t,n]],new s.default(function(n,s){try{(0,c.isDefined)(u)===!1&&(u=r.openDatabase(o.name,1,"Kinvey Cache",5e6),w[o.name]=u);u[i||(0,b.default)(u.readTransaction)===!1?"transaction":"readTransaction"](function(e){i&&l===!1&&e.executeSql("CREATE TABLE IF NOT EXISTS "+a+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)");var r=t.length,o=[];0===r?n(f?o:o.shift()):(0,d.default)(t,function(t){var i=t[0].replace("#{collection}",a);e.executeSql(i,t[1],function(e,t){var i={rowCount:t.rowsAffected,result:[]};if(t.rows.length>0)for(var u=0,a=t.rows.length;u<a;u+=1)try{var s=t.rows.item(u).value,c=l?s:JSON.parse(s);i.result.push(c)}catch(e){}o.push(i),0===(r-=1)&&n(f?o:o.shift())})})},function(t){if((t=(0,m.default)(t)?t:t.message)&&t.indexOf("no such table")===-1)return s(new c.NotFoundError("The "+e+" collection was not found on the "+o.name+" WebSQL database."));var n=["table",e];return o.openTransaction("sqlite_master","SELECT name AS value from #{collection} WHERE type = ? AND name = ?",n).then(function(t){return s(0===t.result.length?new c.NotFoundError("The "+e+" collection was not found on the "+o.name+" WebSQL database."):new c.KinveyError("Unable to open a transaction for the "+e+" collection on the "+o.name+" WebSQL database."))}).catch(function(e){s(e)})})}catch(e){s(e)}})}},{key:"find",value:function(e){return this.openTransaction(e,"SELECT value FROM #{collection}",[]).then(function(e){return e.result})}},{key:"findById",value:function(e,t){var n=this;return this.openTransaction(e,"SELECT value FROM #{collection} WHERE key = ?",[t]).then(function(e){return e.result}).then(function(r){if(0===r.length)throw new c.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" WebSQL database.");return r[0]})}},{key:"save",value:function(e,t){var n=[],r=!1;return(0,v.default)(t)||(r=!0,t=[t]),0===t.length?s.default.resolve(null):(t=(0,f.default)(t,function(e){return n.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e[_],JSON.stringify(e)]]),e}),this.openTransaction(e,n,null,!0).then(function(){return r?t[0]:t}))}},{key:"removeById",value:function(e,t){var n=this,r=[["SELECT value FROM #{collection} WHERE key = ?",[t]],["DELETE FROM #{collection} WHERE key = ?",[t]]];return this.openTransaction(e,r,null,!0).then(function(r){var o=r[0].result,i=r[1].rowCount;if(0===(i=i||o.length))throw new c.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" WebSQL database.");return{count:i}})}},{key:"clear",value:function(){var e=this;return this.openTransaction("sqlite_master","SELECT name AS value FROM #{collection} WHERE type = ?",["table"],!1).then(function(e){return e.result}).then(function(t){if(0===t.length)return null;var n=t.filter(function(e){return/^[a-zA-Z0-9-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]});return e.openTransaction("sqlite_master",n,null,!0)}).then(function(){return w={},null})}}],[{key:"load",value:function(t){var n=new e(t);return(0,c.isDefined)(r.openDatabase)===!1?s.default.resolve(void 0):(0,c.isDefined)(k)?k===!0?s.default.resolve(n):s.default.resolve(void 0):n.save("__testSupport",{_id:"1"}).then(function(){return k=!0,n}).catch(function(){k=!1})}}]),e}()}).call(t,n(49),function(){return this}())},function(e,t,n){(function(e,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CookieStorageAdapter=t.SessionStorageAdapter=t.LocalStorageAdapter=t.WebStorageAdapter=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(359),l=o(c),f=n(1),h=n(225),d=o(h),p=n(373),v=o(p),y=n(296),b=o(y),g=n(280),m=o(g),_=n(304),w=o(_),k=e&&e.env&&e.env.KINVEY_ID_ATTRIBUTE||"_id"||"_id",E=t.WebStorageAdapter=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kinvey";a(this,e),this.name=t}return s(e,[{key:"masterCollectionName",get:function(){return this.name+"master"}}]),e}();t.LocalStorageAdapter=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=r.localStorage.getItem(n.masterCollectionName);return(0,f.isDefined)(o)===!1&&r.localStorage.setItem(n.masterCollectionName,JSON.stringify([])),n}return u(t,e),s(t,[{key:"_find",value:function(e){try{var t=r.localStorage.getItem(e);return(0,f.isDefined)(t)?l.default.resolve(JSON.parse(t)):l.default.resolve(t||[])}catch(e){return l.default.reject(e)}}},{key:"find",value:function(e){return this._find(""+this.name+e)}},{key:"findById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(0,w.default)(r,function(e){return e[k]===t});if((0,f.isDefined)(o)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" localstorage database.");return o})}},{key:"save",value:function(e,t){var n=this;return this._find(this.masterCollectionName).then(function(t){return t.indexOf(e)===-1&&(t.push(e),r.localStorage.setItem(n.masterCollectionName,JSON.stringify(t))),n.find(e)}).then(function(o){var i=(0,d.default)(o,k),u=(0,d.default)(t,k),a=Object.keys(i);return(0,m.default)(a,function(e){var t=i[e],n=u[e];(0,f.isDefined)(n)?u[e]=(0,v.default)(t,n):u[e]=t}),r.localStorage.setItem(""+n.name+e,JSON.stringify((0,b.default)(u))),t})}},{key:"removeById",value:function(e,t){var n=this;return this.find(e).then(function(o){var i=(0,d.default)(o,k),u=i[t];if((0,f.isDefined)(u)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database.");return delete i[t],r.localStorage.setItem(""+n.name+e,JSON.stringify((0,b.default)(i))),{count:1}})}},{key:"clear",value:function(){var e=this;return this._find(this.masterCollectionName).then(function(t){return(0,m.default)(t,function(t){r.localStorage.removeItem(""+e.name+t)}),r.localStorage.removeItem(e.masterCollectionName),null})}}],[{key:"load",value:function(e){if((0,f.isDefined)(r.localStorage)){var n="__testSupport";try{return r.localStorage.setItem(n,n),r.localStorage.getItem(n),r.localStorage.removeItem(n),l.default.resolve(new t(e))}catch(e){return l.default.resolve(void 0)}}return l.default.resolve(void 0)}}]),t}(E),t.SessionStorageAdapter=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=r.sessionStorage.getItem(n.masterCollectionName);return(0,f.isDefined)(o)===!1&&r.sessionStorage.setItem(n.masterCollectionName,JSON.stringify([])),n}return u(t,e),s(t,[{key:"_find",value:function(e){try{var t=r.sessionStorage.getItem(e);return(0,f.isDefined)(t)?l.default.resolve(JSON.parse(t)):l.default.resolve(t||[])}catch(e){return l.default.reject(e)}}},{key:"find",value:function(e){return this._find(""+this.name+e)}},{key:"findById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(0,w.default)(r,function(e){return e[k]===t});if((0,f.isDefined)(o)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" localstorage database.");return o})}},{key:"save",value:function(e,t){var n=this;return this._find(this.masterCollectionName).then(function(t){return t.indexOf(e)===-1&&(t.push(e),r.sessionStorage.setItem(n.masterCollectionName,JSON.stringify(t))),n.find(e)}).then(function(o){var i=(0,d.default)(o,k),u=(0,d.default)(t,k),a=Object.keys(i);return(0,m.default)(a,function(e){var t=i[e],n=u[e];(0,f.isDefined)(n)?u[e]=(0,v.default)(t,n):u[e]=t}),r.sessionStorage.setItem(""+n.name+e,JSON.stringify((0,b.default)(u))),t})}},{key:"removeById",value:function(e,t){var n=this;return this.find(e).then(function(o){var i=(0,d.default)(o,k),u=i[t];if((0,f.isDefined)(u)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database.");return delete i[t],r.sessionStorage.setItem(""+n.name+e,JSON.stringify((0,b.default)(i))),{count:1}})}},{key:"clear",value:function(){var e=this;return this._find(this.masterCollectionName).then(function(t){return(0,m.default)(t,function(t){r.sessionStorage.removeItem(""+e.name+t)}),r.sessionStorage.removeItem(e.masterCollectionName),null})}}],[{key:"load",value:function(e){if(r.sessionStorage){var n="__testSupport";try{return r.sessionStorage.setItem(n,n),r.sessionStorage.getItem(n),r.sessionStorage.removeItem(n),l.default.resolve(new t(e))}catch(e){return l.default.resolve(void 0)}}return l.default.resolve(void 0)}}]),t}(E),t.CookieStorageAdapter=function(e){function t(e){a(this,t)
;for(var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=r.document.cookie.split(";"),u=0,s=o.length;u<s;u+=1){for(var c=o[u];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(n.masterCollectionName)){var l=decodeURIComponent(c.substring(n.masterCollectionName.length,c.length));if((0,f.isDefined)(l)===!1){var h=new Date;h.setTime(h.getTime()+31536e8),r.document.cookie=n.masterCollectionName+"="+encodeURIComponent(JSON.stringify([]))+"; expires="+h.toUTCString()+"; path=/"}}}return n}return u(t,e),s(t,[{key:"_find",value:function(e){for(var t=r.document.cookie.split(";"),n=0,o=t.length;n<o;n+=1){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return l.default.resolve(JSON.parse(decodeURIComponent(i.substring(e.length+1,i.length))))}return l.default.resolve([])}},{key:"find",value:function(e){return this._find(""+this.name+e)}},{key:"findById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(0,w.default)(r,function(e){return e[k]===t});if((0,f.isDefined)(o)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" localstorage database.");return o})}},{key:"save",value:function(e,t){var n=this;return this._find(this.masterCollectionName).then(function(t){if(t.indexOf(e)===-1){t.push(e);var o=new Date;o.setTime(o.getTime()+31536e8),r.document.cookie=n.masterCollectionName+"="+encodeURIComponent(JSON.stringify(t))+"; expires="+o.toUTCString()+"; path=/"}return n.find(e)}).then(function(o){var i=(0,d.default)(o,k),u=Object.keys(i),a=(0,d.default)(t,k);(0,m.default)(u,function(e){var t=i[e],n=a[e];(0,f.isDefined)(n)?a[e]=(0,v.default)(t,n):a[e]=t});var s=new Date;return s.setTime(s.getTime()+31536e8),r.document.cookie=""+n.name+e+"="+encodeURIComponent(JSON.stringify((0,b.default)(a)))+"; expires="+s.toUTCString()+"; path=/",t})}},{key:"removeById",value:function(e,t){var n=this;return this.find(e).then(function(o){var i=(0,d.default)(o,k),u=i[t];if((0,f.isDefined)(u)===!1)throw new f.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database.");delete i[t];var a=new Date;return a.setTime(a.getTime()+31536e8),r.document.cookie=""+n.name+e+"="+encodeURIComponent(JSON.stringify((0,b.default)(i)))+"; expires="+a.toUTCString()+"; path=/",{count:1}})}},{key:"clear",value:function(){var e=this;return this._find(this.masterCollectionName).then(function(t){(0,m.default)(t,function(t){var n=new Date;n.setTime(n.getTime()+31536e8),r.document.cookie=""+e.name+t+"="+encodeURIComponent(JSON.stringify([]))+"; expires="+n.toUTCString()+"; path=/"});var n=new Date;return n.setTime(n.getTime()+31536e8),r.document.cookie=e.masterCollectionName+"="+encodeURIComponent(JSON.stringify([]))+"; expires="+n.toUTCString()+"; path=/",null})}}],[{key:"load",value:function(e){return void 0===r.document.cookie?l.default.resolve(void 0):l.default.resolve(new t(e))}}]),t}(E)}).call(t,n(49),function(){return this}())},function(e,t,n){var r=n(374),o=n(99),i=o(function(e,t,n){r(e,t,n)});e.exports=i},function(e,t,n){function r(e,t,n,l,f){e!==t&&u(t,function(u,c){if(s(u))f||(f=new o),a(e,t,c,n,r,l,f);else{var h=l?l(e[c],u,c+"",e,t,f):void 0;void 0===h&&(h=u),i(e,c,h)}},c)}var o=n(182),i=n(375),u=n(231),a=n(376),s=n(72),c=n(253);e.exports=r},function(e,t,n){function r(e,t,n){(void 0===n||i(e[t],n))&&(void 0!==n||t in e)||o(e,t,n)}var o=n(89),i=n(97);e.exports=r},function(e,t,n){function r(e,t,n,r,g,m,_){var w=e[n],k=t[n],E=_.get(k);if(E)return void o(e,n,E);var O=m?m(w,k,n+"",e,t,_):void 0,S=void 0===O;if(S){var P=l(k),j=!P&&h(k),x=!P&&!j&&y(k);O=k,P||j||x?l(w)?O=w:f(w)?O=a(w):j?(S=!1,O=i(k,!0)):x?(S=!1,O=u(k,!0)):O=[]:v(k)||c(k)?(O=w,c(w)?O=b(w):(!p(w)||r&&d(w))&&(O=s(k))):S=!1}S&&(_.set(k,O),g(O,k,r,m,_),_.delete(k)),o(e,n,O)}var o=n(375),i=n(256),u=n(272),a=n(257),s=n(273),c=n(116),l=n(119),f=n(223),h=n(120),d=n(65),p=n(72),v=n(129),y=n(122),b=n(377);e.exports=r},function(e,t,n){function r(e){return o(e,i(e))}var o=n(98),i=n(253);e.exports=r},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){e=e.toLowerCase();var t=/(chrome)\/([\w]+)/,n=/(firefox)\/([\w.]+)/,r=/(msie) ([\w.]+)/i,o=/(opera)(?:.*version)?[ \/]([\w.]+)/,i=/(safari)\/([\w.]+)/;return t.exec(e)||n.exec(e)||r.exec(e)||o.exec(e)||i.exec(e)||[]}function s(){var t=[],n=void 0,r=void 0,o=void 0,i=void 0;null!==r&&void 0!==r||!e.navigator||(n=a(e.navigator.userAgent),r=n[1],o=n[2],i=e.navigator.platform),void 0!==e.angular&&t.push("angularjs/"+e.angular.version.full),void 0!==e.Backbone&&t.push("backbonejs/"+e.Backbone.VERSION),void 0!==e.Ember&&t.push("emberjs/"+e.Ember.VERSION),void 0!==e.jQuery&&t.push("jquery/"+e.jQuery.fn.jquery),void 0!==e.ko&&t.push("knockout/"+e.ko.version),void 0!==e.Zepto&&t.push("zeptojs");var u=["js-"+g.default.name+"/"+g.default.version];return 0!==t.length&&u.push("("+t.sort().join(", ")+")"),u.concat([r,o,i]).map(function(e){return e?e.toString().replace(/\s/g,"_").toLowerCase():"unknown"}).join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),f=n(379),h=r(f),d=n(359),p=r(d),v=n(65),y=r(v),b=n(386),g=r(b),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Http Middleware";return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),c(t,[{key:"handle",value:function(e){var t=this;return new p.default(function(n,r){var o=e.url,i=e.method,u=e.headers,a=e.body,s=e.timeout,c=e.followRedirect;u["X-Kinvey-Device-Information"]=t.deviceInformation,t.xhrRequest=(0,h.default)({method:i,url:o,headers:u,body:a,followRedirect:c,timeout:s},function(e,t,o){return(0,l.isDefined)(e)?r("ESOCKETTIMEDOUT"===e.code||"ETIMEDOUT"===e.code?new l.TimeoutError("The network request timed out."):new l.NetworkConnectionError("There was an error connecting to the network.",e)):n({response:{statusCode:t.statusCode,headers:t.headers,data:o}})})})}},{key:"cancel",value:function(){return(0,l.isDefined)(this.xhrRequest)&&(0,y.default)(this.xhrRequest.abort)&&this.xhrRequest.abort(),p.default.resolve()}},{key:"deviceInformation",get:function(){return s()}}]),t}(l.Middleware);t.default=m}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,n){var r=e;return l(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=h(t,{uri:e}),r.callback=n,r}function i(e,t,n){return t=o(e,t,n),u(t)}function u(e){function t(){4===l.readyState&&u()}function n(){var e=void 0;if(e=l.response?l.response:l.responseText||a(l),_)try{e=JSON.parse(e)}catch(e){}return e}function o(e){return clearTimeout(p),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,c(e,w)}function u(){if(!d){var t;clearTimeout(p),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=w,o=null;return 0!==t?(r={body:n(),statusCode:t,method:y,headers:{},url:v,rawRequest:l},l.getAllResponseHeaders&&(r.headers=f(l.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),c(o,r,r.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var s=!1,c=function(t,n,r){s||(s=!0,e.callback(t,n,r))},l=e.xhr||null;l||(l=e.cors||e.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var h,d,p,v=l.url=e.uri||e.url,y=l.method=e.method||"GET",b=e.body||e.data,g=l.headers=e.headers||{},m=!!e.sync,_=!1,w={body:void 0,headers:{},statusCode:0,method:y,url:v,rawRequest:l};if("json"in e&&e.json!==!1&&(_=!0,g.accept||g.Accept||(g.Accept="application/json"),"GET"!==y&&"HEAD"!==y&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),b=JSON.stringify(e.json===!0?b:e.json))),l.onreadystatechange=t,l.onload=u,l.onerror=o,l.onprogress=function(){},l.onabort=function(){d=!0},l.ontimeout=o,l.open(y,v,!m,e.username,e.password),m||(l.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(p=setTimeout(function(){if(!d){d=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",o(e)}},e.timeout)),l.setRequestHeader)for(h in g)g.hasOwnProperty(h)&&l.setRequestHeader(h,g[h]);else if(e.headers&&!r(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(b||null),l}function a(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function s(){}var c=n(380),l=n(381),f=n(382),h=n(385);e.exports=i,i.XMLHttpRequest=c.XMLHttpRequest||s,i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:c.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){i["delete"===e?"del":e]=function(t,n,r){return n=o(t,n,r),n.method=e.toUpperCase(),u(n)}})},function(e,t){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(t,function(){return this}())},function(e,t){function n(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=n;var r=Object.prototype.toString},function(e,t,n){var r=n(383),o=n(384),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return o(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),u=r(e.slice(n+1));void 0===t[o]?t[o]=u:i(t[o])?t[o].push(u):t[o]=[t[o],u]}),t}},function(e,t){function n(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=n,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){function r(e,t,n){if(!a(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===s.call(e)?o(e,t,n):"string"==typeof e?i(e,t,n):u(e,t,n)}function o(e,t,n){for(var r=0,o=e.length;r<o;r++)c.call(e,r)&&t.call(n,e[r],r,e)}function i(e,t,n){for(var r=0,o=e.length;r<o;r++)t.call(n,e.charAt(r),r,e)}function u(e,t,n){for(var r in e)c.call(e,r)&&t.call(n,e[r],r,e)}var a=n(381);e.exports=r;var s=Object.prototype.toString,c=Object.prototype.hasOwnProperty},function(e,t){function n(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e}e.exports=n;var r=Object.prototype.hasOwnProperty},function(e,t){e.exports={name:"kinvey-html5-sdk",version:"3.9.0",description:"Kinvey JavaScript SDK for HTML5 applications.",homepage:"http://www.kinvey.com",bugs:{url:"https://github.com/Kinvey/html5-sdk/issues"},license:"Apache-2.0",author:"Kinvey",contributors:["Thomas Conner <thomas@kinvey.com>"],main:"./dist/index.js",repository:{type:"git",url:"git@github.com:Kinvey/html5-sdk"},scripts:{build:"npm run clean && npm run transpile && npm run bundle && npm run minify",bundle:"webpack --config webpack.config.js",clean:"rm -rf dist && rm -rf coverage && rm -rf s3",minify:"uglifyjs --screw-ie8 --compress warnings=false --mangle --comments --output ./dist/kinvey-html5-sdk.min.js -- ./dist/kinvey-html5-sdk.js ",cover:"istanbul cover _mocha -- --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit",docs:"esdoc -c esdoc.json","e2e:server":"selenium-standalone install --version=3.0.1 && selenium-standalone start","e2e:app":"npm run build && shjs ./scripts/e2e.js && node ./test/e2e/app","e2e:test":"wdio ./test/e2e/wdio.conf","e2e:test:browserstack":"wdio ./test/e2e/browserstack.conf",lint:"npm run lint:src","lint:src":"eslint src/**","lint:test":"eslint test/unit/**",preversion:"rm -rf node_modules && npm install && npm test",version:"npm run build && git add dist/kinvey-html5-sdk.js && git add dist/kinvey-html5-sdk.min.js && git commit -m 'Update dist bundle.'",postversion:"git push && git push --tags && rm -rf dist && rm -rf coverage && rm -rf s3",s3:"npm run build && shjs ./scripts/s3.js",test:"mocha --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit","test:watch":"mocha -w --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit",transpile:"babel src --out-dir dist"},dependencies:{"core-js":"2.4.1","es6-promise":"4.1.0","kinvey-js-sdk":"3.9.0","local-storage-fallback":"4.0.0",lodash:"4.17.4",url:"0.11.0",xhr:"2.3.3"},peerDependencies:{"kinvey-js-sdk":"3.9.0"},devDependencies:{"babel-cli":"6.24.0","babel-core":"6.24.0","babel-eslint":"7.1.1","babel-plugin-inline-dotenv":"^1.1.1","babel-plugin-module-resolver":"2.5.0","babel-polyfill":"^6.9.0","babel-preset-es2015":"6.24.0","babel-preset-stage-2":"^6.0.15","babel-register":"6.24.0","browserstack-local":"^1.2.0",chai:"3.5.0","chai-as-promised":"6.0.0",eslint:"3.17.1","eslint-config-airbnb-base":"11.1.1","eslint-import-resolver-babel-module":"3.0.0","eslint-plugin-import":"2.2.0",expect:"^1.20.2","fs-extra":"2.1.1",istanbul:"1.1.0-alpha.1","json-loader":"^0.5.4",mocha:"3.2.0",nock:"9.0.9","regenerator-runtime":"0.10.3","selenium-standalone":"6.0.1",shelljs:"0.7.7","uglify-js":"2.8.12","wdio-mocha-framework":"0.5.9","wdio-spec-reporter":"0.1.0",webdriverio:"^4.4.0",webpack:"^1.13.0"},engines:{node:">=4.0"},keywords:["Kinvey","JavaScript","HTML5"]}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(329),c=n(388),l=r(c),f=n(65),h=r(f),d=function(t){function n(){return o(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,t),a(n,[{key:"open",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",r=void 0,o=void 0,i=void 0,u=function(e){t.emit("loadstart",e)},a=function(e){t.emit("loadstop",e)},s=function(e){t.emit("error",e)},c=function(){clearInterval(r),i.close(),t.popupWindow=null,i&&(0,h.default)(i.removeEventListener)&&(i.removeEventListener("loadstart",o.loadStopCallback),i.removeEventListener("loadstop",o.loadStopCallback),i.removeEventListener("loaderror",o.loadErrorCallback),i.removeEventListener("exit",o.exitCallback)),t.emit("exit")};if(o={loadStartCallback:(0,l.default)(u,this),loadStopCallback:(0,l.default)(a,this),loadErrorCallback:(0,l.default)(s,this),exitCallback:(0,l.default)(c,this)},!(i=e.open(n,"_blank","toolbar=no,location=no")))throw new Error("The popup was blocked.");return(0,h.default)(i.addEventListener)&&(i.addEventListener("loadstart",o.loadStartCallback),i.addEventListener("loadstop",o.loadStopCallback),i.addEventListener("loaderror",o.loadErrorCallback),i.addEventListener("exit",o.exitCallback)),r=setInterval(function(){if(i.closed)o.exitCallback();else try{o.loadStopCallback({url:i.location.href})}catch(e){}},100),this.popupWindow=i,this}},{key:"close",value:function(){return this.popupWindow&&this.popupWindow.close(),this}}]),n}(s.EventEmitter);t.default=d}).call(t,function(){return this}())},function(e,t,n){var r=n(100),o=n(389),i=n(415),u=n(417),a=r(function(e,t,n){var r=1;if(n.length){var s=u(n,i(a));r|=32}return o(e,r,t,n,s)});a.placeholder={},e.exports=a},function(e,t,n){function r(e,t,n,r,k,E,O,S){var P=t&y;if(!P&&"function"!=typeof e)throw new TypeError(p);var j=r?r.length:0;if(j||(t&=~(m|_),r=k=void 0),O=void 0===O?O:w(d(O),0),S=void 0===S?S:d(S),j-=k?k.length:0,t&_){var x=r,T=k;r=k=void 0}var C=P?void 0:c(e),A=[e,t,n,r,k,x,T,E,O,S];if(C&&l(A,C),e=A[0],t=A[1],n=A[2],r=A[3],k=A[4],S=A[9]=void 0===A[9]?P?0:e.length:w(A[9]-j,0),!S&&t&(b|g)&&(t&=~(b|g)),t&&t!=v)M=t==b||t==g?u(e,t,S):t!=m&&t!=(v|m)||k.length?a.apply(void 0,A):s(e,t,n,r);else var M=i(e,t,n);return h((C?o:f)(M,A),e,t)}var o=n(390),i=n(392),u=n(394),a=n(395),s=n(418),c=n(403),l=n(419),f=n(410),h=n(411),d=n(307),p="Expected a function",v=1,y=2,b=8,g=16,m=32,_=64,w=Math.max;e.exports=r},function(e,t,n){var r=n(101),o=n(391),i=o?function(e,t){return o.set(e,t),e}:r;e.exports=i},function(e,t,n){var r=n(138),o=r&&new r;e.exports=o},function(e,t,n){function r(e,t,n){function r(){return(this&&this!==i&&this instanceof r?s:e).apply(a?n:this,arguments)}var a=t&u,s=o(e);return r}var o=n(393),i=n(68),u=1;e.exports=r},function(e,t,n){function r(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=o(e.prototype),r=e.apply(n,t);return i(r)?r:n}}var o=n(274),i=n(72);e.exports=r},function(e,t,n){function r(e,t,n){function r(){for(var i=arguments.length,h=Array(i),d=i,p=s(r);d--;)h[d]=arguments[d];var v=i<3&&h[0]!==p&&h[i-1]!==p?[]:c(h,p);return(i-=v.length)<n?a(e,t,u,r.placeholder,void 0,h,v,void 0,void 0,n-i):o(this&&this!==l&&this instanceof r?f:e,this,h)}var f=i(e);return r}var o=n(103),i=n(393),u=n(395),a=n(399),s=n(415),c=n(417),l=n(68);e.exports=r},function(e,t,n){function r(e,t,n,m,_,w,k,E,O,S){function P(){for(var d=arguments.length,p=Array(d),v=d;v--;)p[v]=arguments[v];if(C)var y=c(P),b=u(p,y);if(m&&(p=o(p,m,_,C)),w&&(p=i(p,w,k,C)),d-=b,C&&d<S){var g=f(p,y);return s(e,t,r,P.placeholder,n,p,g,E,O,S-d)}var R=x?n:this,I=T?R[e]:e;return d=p.length,E?p=l(p,E):A&&d>1&&p.reverse(),j&&O<d&&(p.length=O),this&&this!==h&&this instanceof P&&(I=M||a(I)),I.apply(R,p)}var j=t&b,x=t&d,T=t&p,C=t&(v|y),A=t&g,M=T?void 0:a(e);return P}var o=n(396),i=n(397),u=n(398),a=n(393),s=n(399),c=n(415),l=n(416),f=n(417),h=n(68),d=1,p=2,v=8,y=16,b=128,g=512;e.exports=r},function(e,t){function n(e,t,n,o){for(var i=-1,u=e.length,a=n.length,s=-1,c=t.length,l=r(u-a,0),f=Array(c+l),h=!o;++s<c;)f[s]=t[s];for(;++i<a;)(h||i<u)&&(f[n[i]]=e[i]);for(;l--;)f[s++]=e[i++];return f}var r=Math.max;e.exports=n},function(e,t){function n(e,t,n,o){for(var i=-1,u=e.length,a=-1,s=n.length,c=-1,l=t.length,f=r(u-s,0),h=Array(f+l),d=!o;++i<f;)h[i]=e[i];for(var p=i;++c<l;)h[p+c]=t[c];for(;++a<s;)(d||i<u)&&(h[p+n[a]]=e[i++]);return h}var r=Math.max;e.exports=n},function(e,t){function n(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}e.exports=n},function(e,t,n){function r(e,t,n,r,d,p,v,y,b,g){var m=t&l,_=m?v:void 0,w=m?void 0:v,k=m?p:void 0,E=m?void 0:p;t|=m?f:h,(t&=~(m?h:f))&c||(t&=~(a|s));var O=[e,t,d,k,_,E,w,y,b,g],S=n.apply(void 0,O);return o(e)&&i(S,O),S.placeholder=r,u(S,e,t)}var o=n(400),i=n(410),u=n(411),a=1,s=2,c=4,l=8,f=32,h=64;e.exports=r},function(e,t,n){function r(e){var t=u(e),n=a[t];if("function"!=typeof n||!(t in o.prototype))return!1;if(e===n)return!0;var r=i(n);return!!r&&e===r[0]}var o=n(401),i=n(403),u=n(405),a=n(407);e.exports=r},function(e,t,n){function r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=u,this.__views__=[]}var o=n(274),i=n(402),u=4294967295;r.prototype=o(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t){function n(){}e.exports=n},function(e,t,n){var r=n(391),o=n(404),i=r?function(e){return r.get(e)}:o;e.exports=i},function(e,t){function n(){}e.exports=n},function(e,t,n){function r(e){for(var t=e.name+"",n=o[t],r=u.call(o,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}var o=n(406),i=Object.prototype,u=i.hasOwnProperty;e.exports=r},function(e,t){var n={};e.exports=n},function(e,t,n){function r(e){if(s(e)&&!a(e)&&!(e instanceof o)){if(e instanceof i)return e;if(f.call(e,"__wrapped__"))return c(e)}return new i(e)}var o=n(401),i=n(408),u=n(402),a=n(119),s=n(118),c=n(409),l=Object.prototype,f=l.hasOwnProperty;r.prototype=u.prototype,r.prototype.constructor=r,e.exports=r},function(e,t,n){function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}var o=n(274),i=n(402);r.prototype=o(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t,n){function r(e){if(e instanceof o)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=u(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var o=n(401),i=n(408),u=n(257);e.exports=r},function(e,t,n){var r=n(390),o=n(107),i=o(r);e.exports=i},function(e,t,n){function r(e,t,n){var r=t+"";return u(e,i(r,a(o(r),n)))}var o=n(412),i=n(413),u=n(104),a=n(414);e.exports=r},function(e,t){function n(e){var t=e.match(r);return t?t[1].split(o):[]}var r=/\{\n\/\* \[wrapped with (.+)\] \*/,o=/,? & /;e.exports=n},function(e,t){function n(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(r,"{\n/* [wrapped with "+t+"] */\n")}var r=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=n},function(e,t,n){function r(e,t){return o(u,function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)}),e.sort()}var o=n(250),i=n(168),u=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=r},function(e,t){function n(e){return e.placeholder}e.exports=n},function(e,t,n){function r(e,t){for(var n=e.length,r=u(t.length,n),a=o(e);r--;){var s=t[r];e[r]=i(s,n)?a[s]:void 0}return e}var o=n(257),i=n(111),u=Math.min;e.exports=r},function(e,t){function n(e,t){for(var n=-1,o=e.length,i=0,u=[];++n<o;){var a=e[n];a!==t&&a!==r||(e[n]=r,u[i++]=n)}return u}var r="__lodash_placeholder__";e.exports=n},function(e,t,n){function r(e,t,n,r){function s(){for(var t=-1,i=arguments.length,a=-1,f=r.length,h=Array(f+i),d=this&&this!==u&&this instanceof s?l:e;++a<f;)h[a]=r[a];for(;i--;)h[a++]=arguments[++t];return o(d,c?n:this,h)}var c=t&a,l=i(e);return s}var o=n(103),i=n(393),u=n(68),a=1;e.exports=r},function(e,t,n){function r(e,t){var n=e[1],r=t[1],v=n|r,y=v<(s|c|h),b=r==h&&n==f||r==h&&n==d&&e[7].length<=t[8]||r==(h|d)&&t[7].length<=t[8]&&n==f;if(!y&&!b)return e;r&s&&(e[2]=t[2],v|=n&s?0:l);var g=t[3];if(g){var m=e[3];e[3]=m?o(m,g,t[4]):g,e[4]=m?u(e[3],a):t[4]}return g=t[5],g&&(m=e[5],e[5]=m?i(m,g,t[6]):g,e[6]=m?u(e[5],a):t[6]),g=t[7],g&&(e[7]=g),r&h&&(e[8]=null==e[8]?t[8]:p(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=v,e}var o=n(396),i=n(397),u=n(417),a="__lodash_placeholder__",s=1,c=2,l=4,f=8,h=128,d=256,p=Math.min;e.exports=r}])});