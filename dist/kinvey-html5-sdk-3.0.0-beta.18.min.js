/**
 * kinvey-html5-sdk v3.0.0-beta.18
 * Kinvey JavaScript SDK for HTML5.
 * http://www.kinvey.com
 *
 * Copyright (c) 2016, Kinvey.
 * All rights reserved.
 *
 * Released under the Apache-2.0 license.
 */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){n(1),n(3),n(5),e.exports=n(7)},function(e,t,n){(function(t,n){!function(t){"use strict";function r(e,t,n,r){var o=Object.create((t||i).prototype),a=new d(r||[]);return o._invoke=f(e,n,a),o}function o(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function i(){}function a(){}function u(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(e){this.arg=e}function l(e){function t(t,n){var r=e[t](n),o=r.value;return o instanceof c?Promise.resolve(o.arg).then(i,a):Promise.resolve(o).then(function(e){return r.value=e,r})}function r(e,n){function r(){return t(e,n)}return o=o?o.then(r,r):new Promise(function(e){e(r())})}"object"==typeof n&&n.domain&&(t=n.domain.bind(t));var o,i=t.bind(e,"next"),a=t.bind(e,"throw");t.bind(e,"return");this._invoke=r}function f(e,t,n){var r=x;return function(i,a){if(r===k)throw new Error("Generator is already running");if(r===O){if("throw"===i)throw a;return y()}for(;;){var u=n.delegate;if(u){if("return"===i||"throw"===i&&u.iterator[i]===m){n.delegate=null;var s=u.iterator["return"];if(s){var c=o(s,u.iterator,a);if("throw"===c.type){i="throw",a=c.arg;continue}}if("return"===i)continue}var c=o(u.iterator[i],u.iterator,a);if("throw"===c.type){n.delegate=null,i="throw",a=c.arg;continue}i="next",a=m;var l=c.arg;if(!l.done)return r=E,l;n[u.resultName]=l.value,n.next=u.nextLoc,n.delegate=null}if("next"===i)n._sent=a,r===E?n.sent=a:n.sent=m;else if("throw"===i){if(r===x)throw r=O,a;n.dispatchException(a)&&(i="next",a=m)}else"return"===i&&n.abrupt("return",a);r=k;var c=o(e,t,n);if("normal"===c.type){r=n.done?O:E;var l={value:c.arg,done:n.done};if(c.arg!==j)return l;n.delegate&&"next"===i&&(a=m)}else"throw"===c.type&&(r=O,i="throw",a=c.arg)}}}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function h(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}function v(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function o(){for(;++n<e.length;)if(g.call(e,n))return o.value=e[n],o.done=!1,o;return o.value=m,o.done=!0,o};return r.next=r}}return{next:y}}function y(){return{value:m,done:!0}}var m,g=Object.prototype.hasOwnProperty,b="function"==typeof Symbol&&Symbol.iterator||"@@iterator",w="object"==typeof e,_=t.regeneratorRuntime;if(_)return void(w&&(e.exports=_));_=t.regeneratorRuntime=w?e.exports:{},_.wrap=r;var x="suspendedStart",E="suspendedYield",k="executing",O="completed",j={},R=u.prototype=i.prototype;a.prototype=R.constructor=u,u.constructor=a,a.displayName="GeneratorFunction",_.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===a||"GeneratorFunction"===(t.displayName||t.name):!1},_.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):e.__proto__=u,e.prototype=Object.create(R),e},_.awrap=function(e){return new c(e)},s(l.prototype),_.async=function(e,t,n,o){var i=new l(r(e,t,n,o));return _.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},s(R),R[b]=function(){return this},R.toString=function(){return"[object Generator]"},_.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},_.values=v,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=m,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return i.type="throw",i.arg=e,n.next=t,!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=g.call(o,"catchLoc"),u=g.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?this.next=o.finallyLoc:this.complete(i),j},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),h(n),j}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;h(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:v(e),resultName:t,nextLoc:n},j}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}(),n(2))},function(e,t){function n(){c&&a&&(c=!1,a.length?s=a.concat(s):l=-1,s.length&&r())}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=s.length;t;){for(a=s,s=[];++l<t;)a&&a[l].run();l=-1,t=s.length}a=null,c=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var a,u=e.exports={},s=[],c=!1,l=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new o(e,t)),1!==s.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,n){(function(e){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Html5Popup=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(4);t.Html5Popup=function(t){function n(){return o(this,n),i(this,Object.getPrototypeOf(n).apply(this,arguments))}return a(n,t),u(n,[{key:"open",value:function(){function t(e){return n.apply(this,arguments)}var n=r(regeneratorRuntime.mark(function o(){var t=this,n=arguments.length<=0||void 0===arguments[0]?"/":arguments[0];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this.popup=e.open(n,"_blank","toolbar=no,location=no"),!this.popup){r.next=5;break}this.interval=setInterval(function(){if(t.popup.closed)t.exitCallback();else try{t.loadStopCallback({url:t.popup.location.href})}catch(e){}},100),r.next=6;break;case 5:throw new Error("The popup was blocked.");case 6:return r.abrupt("return",this);case 7:case"end":return r.stop()}},o,this)}));return t}()},{key:"close",value:function(){function e(){return t.apply(this,arguments)}var t=r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.popup&&this.popup.close(),e.abrupt("return",this);case 2:case"end":return e.stop()}},n,this)}));return e}()},{key:"loadStopCallback",value:function(e){this.emit("loaded",e.url)}},{key:"loadErrorCallback",value:function(e){this.emit("error",e.message)}},{key:"exitCallback",value:function(){clearInterval(this.interval),this.emit("closed")}}]),n}(s.EventEmitter)}).call(t,function(){return this}())},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,u,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(i(n))for(u=Array.prototype.slice.call(arguments,1),c=n.slice(),o=c.length,s=0;o>s;s++)c[s].apply(this,u);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,a,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(u=a;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){o=u;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Html5Device=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(6),u=r(a);t.Html5Device=function(){function t(){o(this,t)}return i(t,null,[{key:"toJSON",value:function(){var t=e.navigator.userAgent.toLowerCase(),n=/(chrome)\/([\w]+)/,r=/(firefox)\/([\w.]+)/,o=/(msie) ([\w.]+)/i,i=/(opera)(?:.*version)?[ \/]([\w.]+)/,a=/(safari)\/([\w.]+)/,s=/(applewebkit)\/([\w.]+)/,c=n.exec(t)||r.exec(t)||o.exec(t)||i.exec(t)||a.exec(t)||s.exec(t)||[];return{device:{model:e.navigator.userAgent},platform:{name:"phonegap"},os:{name:c[1],version:c[2]},kinveySDK:{name:u["default"].name,version:u["default"].version}}}}]),t}()}).call(t,function(){return this}())},function(e,t){e.exports={name:"kinvey-html5-sdk",version:"3.0.0-beta.18",description:"Kinvey JavaScript SDK for HTML5.",homepage:"http://www.kinvey.com",bugs:{url:"https://github.com/Kinvey/html5-sdk/issues"},license:"Apache-2.0",author:"Kinvey",contributors:["Thomas Conner <thomas@kinvey.com>"],main:"./es5/index.js",repository:{type:"git",url:"git@github.com:Kinvey/kinvey-html5-sdk"},scripts:{test:"./node_modules/mocha/bin/mocha --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test","test:watch":"./node_modules/mocha/bin/mocha -w --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test","test:jenkins":"istanbul cover _mocha -- --reporter tap --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test > test.tap && istanbul report clover",postpublish:"PACKAGE_VERSION=$(cat package.json | grep version | head -1 | awk -F: '{ print $2 }' | sed 's/[\",]//g' | tr -d '[[:space:]]') && git tag $PACKAGE_VERSION && git push --tags"},dependencies:{"babel-regenerator-runtime":"^6.5.0","kinvey-javascript-sdk-core":"3.0.0-beta.25",lodash:"^4.8.2","parse-headers":"^2.0.1"},devDependencies:{"babel-core":"^6.9.0","babel-eslint":"^6.0.0","babel-polyfill":"^6.9.0","babel-preset-es2015":"^6.9.0","babel-preset-stage-2":"^6.0.15",browserify:"^13.0.0",chai:"^3.5.0","chai-as-promised":"^5.3.0",del:"^2.0.2","eslint-config-airbnb":"^9.0.1","eslint-plugin-import":"^1.8.0","eslint-plugin-jsx-a11y":"^1.2.2","eslint-plugin-react":"^5.1.1",gulp:"^3.9.0","gulp-babel":"^6.1.2","gulp-banner":"^0.1.3","gulp-buffer":"0.0.2","gulp-bump":"^2.1.0","gulp-eslint":"^2.0.0","gulp-file":"^0.3.0","gulp-git":"^1.7.0","gulp-plumber":"^1.0.1","gulp-prompt":"^0.2.0","gulp-rename":"^1.2.2","gulp-s3-upload":"^1.6.0","gulp-sourcemaps":"^1.6.0","gulp-uglify":"^1.5.1","gulp-util":"^3.0.6",istanbul:"^0.4.3","json-loader":"^0.5.4",mocha:"^2.5.3",nock:"^8.0.0",sinon:"^1.17.4","sinon-chai":"^2.8.0","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",webpack:"^1.13.0","webpack-stream":"^3.1.0",yargs:"^4.7.1"},engines:{node:">=4.0"},keywords:["Kinvey","JavaScript","HTML5"]}},function(e,t,n){(function(t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(8),i=r(o),a=n(158),u=n(225),s=n(309),c=n(5),l=n(3),f=a.NetworkRack.sharedInstance();f.swap(u.HttpMiddleware,new s.Html5HttpMiddleware),t.KinveyDevice=c.Html5Device,t.KinveyPopup=l.Html5Popup,e.exports=i["default"]}).call(t,function(){return this}())},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(9),s=n(11),c=n(141),l=r(c),f=n(152),p=r(f),h=n(163),d=n(253),v=n(12),y=n(255),m=n(302),g=n(275),b=r(g),w=n(303),_=n(305),x=n(252),E=n(153),k=n(146),O=r(k),j=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",R=null,S=function(){function e(){i(this,e)}return a(e,null,[{key:"init",value:function(e){if(!e.appKey&&!e.appId)throw new u.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!e.appSecret&&!e.masterSecret)throw new u.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Key.");return R=l["default"].init(e),this.Aggregation=s.Aggregation,this.AuthorizationGrant=_.AuthorizationGrant,this.CustomEndpoint=p["default"],this.DataStore=y.DataStore,this.DataStoreType=y.DataStoreType,this.FileStore=m.FileStore,this.Log=h.Log,this.Metadata=d.Metadata,this.Query=v.Query,this.SocialIdentity=_.SocialIdentity,this.Sync=b["default"],this.User=w.User,this.UserStore=w.UserStore,R}},{key:"ping",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e,t,r=arguments.length<=0||void 0===arguments[0]?l["default"].sharedInstance():arguments[0];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=new x.NetworkRequest({method:E.RequestMethod.GET,authType:E.AuthType.All,url:O["default"].format({protocol:r.protocol,host:r.host,pathname:j+"/"+r.appKey})}),n.next=3,e.execute();case 3:return t=n.sent,n.abrupt("return",t.data);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"client",get:function(){if(!R)throw new u.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return R}},{key:"appVersion",get:function(){return this.client.appVersion},set:function(e){this.client.appVersion=e}}]),e}();t["default"]=S}).call(t,n(2))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncError=t.ParameterValueOutOfRangeError=t.NoResponseError=t.NotFoundError=t.NoActiveUserError=t.NoNetworkConnectionError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.ActiveUserError=t.KinveyError=void 0;var u=n(10),s=r(u),c=t.KinveyError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error has occurred.":arguments[0],n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],r=arguments.length<=2||void 0===arguments[2]?-1:arguments[2];o(this,t);var a=i(this,Object.getPrototypeOf(t).call(this,e));return a.debug=n,a.code=r,a}return a(t,e),t}(s["default"]);t.ActiveUserError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An active user already exists.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.FeatureUnavailableError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Requested functionality is unavailable in this API version.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.IncompleteRequestBodyError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?" The request body is either missing or incomplete.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.InsufficientCredentialsError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.InvalidCredentialsError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?" Invalid credentials. Please retry your request with correct credentials.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.InvalidIdentifierError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"One of more identifier names in the request has an invalid format.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.InvalidQuerySyntaxError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The query string in the request has an invalid syntax.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.JSONParseError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Unable to parse the JSON in the request.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.MissingQueryError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The request is missing a query string.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.MissingRequestHeaderError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The request is missing a required header.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.MissingRequestParameterError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"A required parameter is missing from the request.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.NoNetworkConnectionError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"You do not have a network connect.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.NoActiveUserError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"There is not an active user.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.NotFoundError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The item was not found.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.NoResponseError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"No response was provided.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.ParameterValueOutOfRangeError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The value specified for one of the request parameters is out of range.":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c),t.SyncError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error occurred during sync":arguments[0],n=arguments[1];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e,n))}return a(t,e),t}(c)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];n(this,t);var o=r(this,Object.getPrototypeOf(t).call(this,e));return Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"name",{configurable:!0,enumerable:!1,value:o.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(o,o.constructor),r(o)):(Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),o)}return o(t,e),t}(i(Error));t["default"]=a,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregation=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=n(12),s=n(140),c=r(s),l=n(122),f=r(l),p=n(14),h=r(p),d=n(36),v=r(d),y=n(32),m=r(y),g=n(31),b=r(g);t.Aggregation=function(){function e(t){o(this,e),t=(0,f["default"])({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t),this.query=t.query,this.initial=t.initial,this.key=t.key,this.reduceFn=t.reduceFn}return i(e,[{key:"by",value:function(e){return this.key[e]=!0,this}},{key:"process",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t={},n=[],r=this.toJSON(),o=r.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");r.reduce=new Function(["doc","out"],o),this.query&&(e=this.query.process(e)),(0,h["default"])(e,function(e){var n={},o=Object.keys(e);(0,h["default"])(o,function(t){n[t]=e[t]});var i=JSON.stringify(n);if(!t[i]){t[i]=n;var a=Object.keys(r.initial);(0,h["default"])(a,function(e){t[i][e]=r.initial[e]})}r.reduce(e,t[i])});var i=Object.keys(t);return(0,h["default"])(i,function(e){n.push(t[e])}),n}},{key:"toJSON",value:function(){var e={key:this.key,initial:this.initial,reduceFn:this.reduceFn,condition:this.query?this.query.toJSON().filter:{},query:this.query?this.query.toJSON():null};return e}},{key:"initial",get:function(){return this.aggregationInitial},set:function(e){if(!(0,m["default"])(e))throw new a.KinveyError("initial must be an Object.");this.aggregationInitial=e}},{key:"query",get:function(){return this.aggregationQuery},set:function(e){!e||e instanceof u.Query||(e=new u.Query((0,c["default"])(e,"toJSON",e))),this.aggregationQuery=e}},{key:"reduceFn",get:function(){return this.aggregationReduceFn},set:function(e){if((0,b["default"])(e)&&(e=e.toString()),!(0,v["default"])(e))throw new a.KinveyError("fn argument must be of type function or string.");this.aggregationReduceFn=e}}],[{key:"count",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=new e;return t&&n.by(t),n.initial={result:0},n.reduceFn=function(e,t){return t.result+=1,t},n}},{key:"sum",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var n=new e;return n.initial={result:0},n.reduceFn=function(e,n){n.result+=e["'"+t+"'"]},n}},{key:"min",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var n=new e;return n.initial={result:1/0},n.reduceFn=function(e,n){n.result=Math.min(n.result,e["'"+t+"'"])},n}},{key:"max",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var n=new e;return n.initial={result:-(1/0)},n.reduceFn=function(e,n){n.result=Math.max(n.result,e["'"+t+"'"])},n}},{key:"average",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var n=new e;return n.initial={count:0,result:0},n.reduceFn=function(e,n){n.result=(n.result*n.count+e["'"+t+"'"])/(n.count+1),n.count+=1},n}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Query=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(13),s=n(121),c=r(s),l=n(122),f=r(l),p=n(35),h=r(p),d=n(132),v=r(d),y=n(36),m=r(y),g=n(32),b=r(g),w=n(133),_=r(w),x=n(134),E=r(x),k=n(14),O=r(k),j=n(138),R=r(j),S=["$nearSphere"],T=function(){function e(t){o(this,e),t=(0,f["default"])({fields:[],filter:{},sort:{},limit:null,skip:0},t),this.fields=t.fields,this.filter=t.filter,this.sort=t.sort,this.limit=t.limit,this.skip=t.skip,this.parent=null}return a(e,[{key:"isSupportedLocal",value:function(){var e=this,t=!0;return(0,O["default"])(S,function(n){return t=!(0,R["default"])(e.filter,n)}),t}},{key:"equalTo",value:function(e,t){return this.filter[e]=t,this}},{key:"contains",value:function(e,t){return(0,h["default"])(t)||(t=[t]),this.addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){return(0,h["default"])(t)||(t=[t]),this.addFilter(e,"$all",t)}},{key:"greaterThan",value:function(e,t){if(!(0,v["default"])(t)&&!(0,m["default"])(t))throw new Error("You must supply a number or string.");return this.addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){if(!(0,v["default"])(t)&&!(0,m["default"])(t))throw new Error("You must supply a number or string.");return this.addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){if(!(0,v["default"])(t)&&!(0,m["default"])(t))throw new Error("You must supply a number or string.");
return this.addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){if(!(0,v["default"])(t)&&!(0,m["default"])(t))throw new Error("You must supply a number or string.");return this.addFilter(e,"$lte",t)}},{key:"notEqualTo",value:function(e,t){return this.addFilter(e,"$ne",t)}},{key:"notContainedIn",value:function(e,t){return(0,h["default"])(t)||(t=[t]),this.addFilter(e,"$nin",t)}},{key:"and",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this.join("$and",Array.prototype.slice.call(t))}},{key:"nor",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this.parent&&this.parent.filter.$and?this.parent.nor.apply(this.parent,t):this.join("$nor",Array.prototype.slice.call(t))}},{key:"or",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this.parent?this.parent.or.apply(this.parent,t):this.join("$or",Array.prototype.slice.call(t))}},{key:"exists",value:function(e,t){return t="undefined"==typeof t?!0:t||!1,this.addFilter(e,"$exists",t)}},{key:"mod",value:function(e,t,n){if(n=n||0,(0,m["default"])(t)&&(t=parseFloat(t)),(0,m["default"])(n)&&(n=parseFloat(n)),!(0,v["default"])(t))throw new Error("divisor must be a number");if(!(0,v["default"])(n))throw new Error("remainder must be a number");return this.addFilter(e,"$mod",[t,n])}},{key:"matches",value:function(e,t,n){if(n=n||{},(0,_["default"])(t)||(t=new RegExp(t)),(t.ignoreCase||n.ignoreCase)&&n.ignoreCase!==!1)throw new Error("ignoreCase glag is not supported.");if(0!==t.source.indexOf("^"))throw new Error("regExp must have `^` at the beginning of the expression to make it an anchored expression.");var r=[];(t.multiline||n.multiline)&&n.multiline!==!1&&r.push("m"),n.extended&&r.push("x"),n.dotMatchesAll&&r.push("s");var o=this.addFilter(e,"$regex",t.source);return r.length&&this.addFilter(e,"$options",r.join("")),o}},{key:"near",value:function(e,t,n){if(!(0,h["default"])(t)||!(0,v["default"])(t[0])||!(0,v["default"])(t[1]))throw new Error("coord must be a [number, number]");var r=this.addFilter(e,"$nearSphere",[t[0],t[1]]);return n&&this.addFilter(e,"$maxDistance",n),r}},{key:"withinBox",value:function(e,t,n){if(!(0,h["default"])(t)||!t[0]||!t[1])throw new Error("bottomLeftCoord must be a [number, number]");if(!(0,h["default"])(n)||!n[0]||!n[1])throw new Error("upperRightCoord must be a [number, number]");t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),n[0]=parseFloat(n[0]),n[1]=parseFloat(n[1]);var r=[[t[0],t[1]],[n[0],n[1]]];return this.addFilter(e,"$within",{$box:r})}},{key:"withinPolygon",value:function(e,t){if(!(0,h["default"])(t)||t.length>3)throw new Error("coords must be [[number, number]]");return t=t.map(function(e){if(!e[0]||!e[1])throw new Error("coords argument must be [number, number]");return[parseFloat(e[0]),parseFloat(e[1])]}),this.addFilter(e,"$within",{$polygon:t})}},{key:"size",value:function(e,t){if((0,m["default"])(t)&&(t=parseFloat(t)),!(0,v["default"])(t))throw new Error("size must be a number");return this.addFilter(e,"$size",t)}},{key:"ascending",value:function(e){return this.parent?this.parent.ascending(e):this.sort[e]=1,this}},{key:"descending",value:function(e){return this.parent?this.parent.descending(e):this.sort[e]=-1,this}},{key:"addFilter",value:function(e,t,n){return(0,b["default"])(this.filter[e])||(this.filter[e]={}),this.filter[e][t]=n,this}},{key:"join",value:function(t,n){var r=this,o=this,i={};n=n.map(function(t){if(!(t instanceof e)){if(!(0,b["default"])(t))throw new Error("query argument must be of type: Kinvey.Query[] or Object[].");t=new e(t)}return t.toJSON().filter}),0===n.length&&(o=new e,n=[o.toJSON().filter],o.parent=this);var a=Object.keys(this.filter);return(0,O["default"])(a,function(e){i[e]=r.filter[e],delete r.filter[e]}),this.filter[t]=[i].concat(n),o}},{key:"process",value:function(e){var t=this;if(this.isSupportedLocal()||!function(){var e="This query is not able to run locally. The following filters are not supported locally:";throw(0,O["default"])(S,function(t){e=e+" "+t}),new Error(e)}(),e){var n=function(){if(!(0,h["default"])(e))throw new Error("data argument must be of type: Array.");var n=t.toJSON();return e=(0,c["default"])(n.filter,e),n.fields&&n.fields.length>0&&(e=e.map(function(e){var t=Object.keys(e);return(0,O["default"])(t,function(t){-1===n.fields.indexOf(t)&&delete e[t]}),e})),e=e.sort(function(e,t){var r=Object.keys(n.sort);return(0,O["default"])(r,function(r){var o=(0,u.nested)(e,r),i=(0,u.nested)(t,r);if(o&&!i)return-1;if(i&&!o)return 1;if(o!==i){var a=n.sort[r];return(i>o?-1:1)*a}return 0}),0}),n.limit?{v:e.slice(n.skip,n.skip+n.limit)}:{v:e.slice(n.skip)}}();if("object"===("undefined"==typeof n?"undefined":i(n)))return n.v}return e}},{key:"toJSON",value:function(){if(this.parent)return this.parent.toJSON();var e={fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit};return e}},{key:"toQueryString",value:function(){var e={};(0,E["default"])(this.filter)||(e.query=this.filter),(0,E["default"])(this.fields)||(e.fields=this.fields.join(",")),this.limit&&(e.limit=this.limit),this.skip>0&&(e.skip=this.skip),(0,E["default"])(this.sort)||(e.sort=this.sort);var t=Object.keys(e);return(0,O["default"])(t,function(t){e[t]=(0,m["default"])(e[t])?e[t]:JSON.stringify(e[t])}),e}},{key:"toString",value:function(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function(){return this.queryFields},set:function(e){if(e=e||[],!(0,h["default"])(e))throw new Error("fields must be an Array");this.parent?this.parent.fields=e:this.queryFields=e}},{key:"filter",get:function(){return this.queryFilter},set:function(e){this.queryFilter=e}},{key:"sort",get:function(){return this.querySort},set:function(e){if(e&&!(0,b["default"])(e))throw new Error("sort must an Object");this.parent?this.parent.sort(e):this.querySort=e||{}}},{key:"limit",get:function(){return this.queryLimit},set:function(e){if((0,m["default"])(e)&&(e=parseFloat(e)),e&&!(0,v["default"])(e))throw new Error("limit must be a number");this.parent?this.parent.limit=e:this.queryLimit=e}},{key:"skip",get:function(){return this.querySkip},set:function(e){if((0,m["default"])(e)&&(e=parseFloat(e)),!(0,v["default"])(e))throw new Error("skip must be a number");this.parent?this.parent.skip(e):this.querySkip=e}}]),e}();t.Query=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){if(!t)return e=n?n:e;for(var r=t.split("."),o=r.shift();o&&e;)e=e[o],o=r.shift();return n?n:e}function i(e){return void 0!==e&&null!==e}function a(e){return function(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(0,s["default"])(e,function(e){(0,l["default"])(n[e])&&(t.prototype[e]=function(){for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];return n[e].apply(this,r)})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.nested=o,t.isDefined=i,t.use=a;var u=n(14),s=r(u),c=n(31),l=r(c)},function(e,t,n){function r(e,t){var n=u(e)?o:i;return n(e,a(t,3))}var o=n(15),i=n(16),a=n(40),u=n(35);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0;++n<r&&t(e[n],n,e)!==!1;);return e}e.exports=n},function(e,t,n){var r=n(17),o=n(39),i=o(r);e.exports=i},function(e,t,n){function r(e,t){return e&&o(e,t,i)}var o=n(18),i=n(20);e.exports=r},function(e,t,n){var r=n(19),o=r();e.exports=o},function(e,t){function n(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),u=a.length;u--;){var s=a[e?u:++o];if(n(i[s],s,i)===!1)break}return t}}e.exports=n},function(e,t,n){function r(e){var t=c(e);if(!t&&!u(e))return i(e);var n=a(e),r=!!n,l=n||[],f=l.length;for(var p in e)!o(e,p)||r&&("length"==p||s(p,f))||t&&"constructor"==p||l.push(p);return l}var o=n(21),i=n(23),a=n(24),u=n(28),s=n(37),c=n(38);e.exports=r},function(e,t,n){function r(e,t){return null!=e&&(a.call(e,t)||"object"==typeof e&&t in e&&null===o(e))}var o=n(22),i=Object.prototype,a=i.hasOwnProperty;e.exports=r},function(e,t){function n(e){return r(Object(e))}var r=Object.getPrototypeOf;e.exports=n},function(e,t){function n(e){return r(Object(e))}var r=Object.keys;e.exports=n},function(e,t,n){function r(e){var t=e?e.length:void 0;return u(t)&&(a(e)||s(e)||i(e))?o(t,String):null}var o=n(25),i=n(26),a=n(35),u=n(33),s=n(36);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=n},function(e,t,n){function r(e){return o(e)&&u.call(e,"callee")&&(!c.call(e,"callee")||s.call(e)==i)}var o=n(27),i="[object Arguments]",a=Object.prototype,u=a.hasOwnProperty,s=a.toString,c=a.propertyIsEnumerable;e.exports=r},function(e,t,n){function r(e){return i(e)&&o(e)}var o=n(28),i=n(34);e.exports=r},function(e,t,n){function r(e){return null!=e&&a(o(e))&&!i(e)}var o=n(29),i=n(31),a=n(33);e.exports=r},function(e,t,n){var r=n(30),o=r("length");e.exports=o},function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},function(e,t,n){function r(e){var t=o(e)?s.call(e):"";return t==i||t==a}var o=n(32),i="[object Function]",a="[object GeneratorFunction]",u=Object.prototype,s=u.toString;e.exports=r},function(e,t){function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=n},function(e,t){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&r>=e}var r=9007199254740991;e.exports=n},function(e,t){function n(e){return!!e&&"object"==typeof e}e.exports=n},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){function r(e){return"string"==typeof e||!o(e)&&i(e)&&s.call(e)==a}var o=n(35),i=n(34),a="[object String]",u=Object.prototype,s=u.toString;e.exports=r},function(e,t){function n(e,t){return t=null==t?r:t,!!t&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&t>e}var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=n},function(e,t){function n(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||r;return e===n}var r=Object.prototype;e.exports=n},function(e,t,n){function r(e,t){return function(n,r){if(null==n)return n;if(!o(n))return e(n,r);for(var i=n.length,a=t?i:-1,u=Object(n);(t?a--:++a<i)&&r(u[a],a,u)!==!1;);return n}}var o=n(28);e.exports=r},function(e,t,n){function r(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?u(e)?i(e[0],e[1]):o(e):s(e)}var o=n(41),i=n(104),a=n(118),u=n(35),s=n(119);e.exports=r},function(e,t,n){function r(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}var o=n(42),i=n(101),a=n(103);e.exports=r},function(e,t,n){function r(e,t,n,r){var s=n.length,c=s,l=!r;if(null==e)return!c;for(e=Object(e);s--;){var f=n[s];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++s<c;){f=n[s];var p=f[0],h=e[p],d=f[1];if(l&&f[2]){if(void 0===h&&!(p in e))return!1}else{var v=new o;if(r)var y=r(h,d,p,e,t,v);if(!(void 0===y?i(d,h,r,a|u,v):y))return!1}}return!0}var o=n(43),i=n(82),a=1,u=2;e.exports=r},function(e,t,n){function r(e){this.__data__=new o(e)}var o=n(44),i=n(52),a=n(53),u=n(54),s=n(55),c=n(56);r.prototype.clear=i,r.prototype["delete"]=a,r.prototype.get=u,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(45),i=n(46),a=n(49),u=n(50),s=n(51);r.prototype.clear=o,r.prototype["delete"]=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,e.exports=r},function(e,t){function n(){this.__data__=[]}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);if(0>n)return!1;var r=t.length-1;return n==r?t.pop():a.call(t,n,1),!0}var o=n(47),i=Array.prototype,a=i.splice;e.exports=r},function(e,t,n){function r(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1}var o=n(48);e.exports=r},function(e,t){function n(e,t){return e===t||e!==e&&t!==t}e.exports=n},function(e,t,n){function r(e){var t=this.__data__,n=o(t,e);return 0>n?void 0:t[n][1]}var o=n(47);e.exports=r},function(e,t,n){function r(e){return o(this.__data__,e)>-1}var o=n(47);e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__,r=o(n,e);return 0>r?n.push([e,t]):n[r][1]=t,this}var o=n(47);e.exports=r},function(e,t,n){function r(){this.__data__=new o}var o=n(44);e.exports=r},function(e,t){function n(e){return this.__data__["delete"](e)}e.exports=n},function(e,t){function n(e){return this.__data__.get(e)}e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t,n){function r(e,t){var n=this.__data__;return n instanceof o&&n.__data__.length==a&&(n=this.__data__=new i(n.__data__)),n.set(e,t),this}var o=n(44),i=n(57),a=200;e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(58),i=n(76),a=n(79),u=n(80),s=n(81);r.prototype.clear=o,r.prototype["delete"]=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,e.exports=r},function(e,t,n){function r(){this.__data__={hash:new o,map:new(a||i),string:new o}}var o=n(59),i=n(44),a=n(75);e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(60),i=n(71),a=n(72),u=n(73),s=n(74);r.prototype.clear=o,r.prototype["delete"]=i,r.prototype.get=a,r.prototype.has=u,r.prototype.set=s,e.exports=r},function(e,t,n){function r(){this.__data__=o?o(null):{}}var o=n(61);e.exports=r},function(e,t,n){var r=n(62),o=r(Object,"create");e.exports=o},function(e,t,n){function r(e,t){var n=i(e,t);return o(n)?n:void 0}var o=n(63),i=n(70);e.exports=r},function(e,t,n){function r(e){if(!u(e)||a(e))return!1;var t=o(e)||i(e)?d:l;return t.test(s(e))}var o=n(31),i=n(64),a=n(65),u=n(32),s=n(69),c=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,f=Object.prototype,p=Function.prototype.toString,h=f.hasOwnProperty,d=RegExp("^"+p.call(h).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=r},function(e,t){function n(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}e.exports=n},function(e,t,n){function r(e){return!!i&&i in e}var o=n(66),i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,n){var r=n(67),o=r["__core-js_shared__"];e.exports=o},function(e,t,n){(function(t){var r=n(68),o=r("object"==typeof t&&t),i=r("object"==typeof self&&self),a=r("object"==typeof this&&this),u=o||i||a||Function("return this")();e.exports=u}).call(t,function(){return this}())},function(e,t){function n(e){return e&&e.Object===Object?e:null}e.exports=n},function(e,t){function n(e){if(null!=e){try{return r.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var r=Function.prototype.toString;e.exports=n},function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},function(e,t){function n(e){return this.has(e)&&delete this.__data__[e]}e.exports=n},function(e,t,n){function r(e){var t=this.__data__;if(o){var n=t[e];return n===i?void 0:n}return u.call(t,e)?t[e]:void 0}var o=n(61),i="__lodash_hash_undefined__",a=Object.prototype,u=a.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){var t=this.__data__;return o?void 0!==t[e]:a.call(t,e)}var o=n(61),i=Object.prototype,a=i.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t){var n=this.__data__;return n[e]=o&&void 0===t?i:t,this}var o=n(61),i="__lodash_hash_undefined__";e.exports=r},function(e,t,n){var r=n(62),o=n(67),i=r(o,"Map");e.exports=i},function(e,t,n){function r(e){return o(this,e)["delete"](e)}var o=n(77);e.exports=r},function(e,t,n){function r(e,t){var n=e.__data__;return o(t)?n["string"==typeof t?"string":"hash"]:n.map}var o=n(78);e.exports=r},function(e,t){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=n},function(e,t,n){function r(e){return o(this,e).get(e)}var o=n(77);e.exports=r},function(e,t,n){function r(e){return o(this,e).has(e)}var o=n(77);e.exports=r},function(e,t,n){function r(e,t){return o(this,e).set(e,t),this}var o=n(77);e.exports=r},function(e,t,n){function r(e,t,n,u,s){return e===t?!0:null==e||null==t||!i(e)&&!a(t)?e!==e&&t!==t:o(e,t,r,n,u,s)}var o=n(83),i=n(32),a=n(34);e.exports=r},function(e,t,n){function r(e,t,n,r,y,g){var b=c(e),w=c(t),_=d,x=d;b||(_=s(e),_=_==h?v:_),w||(x=s(t),x=x==h?v:x);var E=_==v&&!l(e),k=x==v&&!l(t),O=_==x;if(O&&!E)return g||(g=new o),b||f(e)?i(e,t,n,r,y,g):a(e,t,_,n,r,y,g);if(!(y&p)){var j=E&&m.call(e,"__wrapped__"),R=k&&m.call(t,"__wrapped__");if(j||R){var S=j?e.value():e,T=R?t.value():t;return g||(g=new o),n(S,T,r,y,g)}}return O?(g||(g=new o),u(e,t,n,r,y,g)):!1}var o=n(43),i=n(84),a=n(89),u=n(94),s=n(95),c=n(35),l=n(64),f=n(100),p=2,h="[object Arguments]",d="[object Array]",v="[object Object]",y=Object.prototype,m=y.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t,n,r,s,c){var l=s&u,f=e.length,p=t.length;if(f!=p&&!(l&&p>f))return!1;var h=c.get(e);if(h)return h==t;var d=-1,v=!0,y=s&a?new o:void 0;for(c.set(e,t);++d<f;){var m=e[d],g=t[d];if(r)var b=l?r(g,m,d,t,e,c):r(m,g,d,e,t,c);if(void 0!==b){if(b)continue;v=!1;break}if(y){if(!i(t,function(e,t){return y.has(t)||m!==e&&!n(m,e,r,s,c)?void 0:y.add(t)})){v=!1;break}}else if(m!==g&&!n(m,g,r,s,c)){v=!1;break}}return c["delete"](e),v}var o=n(85),i=n(88),a=1,u=2;e.exports=r},function(e,t,n){function r(e){var t=-1,n=e?e.length:0;for(this.__data__=new o;++t<n;)this.add(e[t])}var o=n(57),i=n(86),a=n(87);r.prototype.add=r.prototype.push=i,r.prototype.has=a,e.exports=r},function(e,t){function n(e){return this.__data__.set(e,r),this}var r="__lodash_hash_undefined__";e.exports=n},function(e,t){function n(e){return this.__data__.has(e)}e.exports=n},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}e.exports=n},function(e,t,n){function r(e,t,n,r,o,x,k){switch(n){case _:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!r(new i(e),new i(t)));case f:case p:return+e==+t;case h:return e.name==t.name&&e.message==t.message;case v:return e!=+e?t!=+t:e==+t;case y:case g:return e==t+"";case d:var O=u;case m:var j=x&l;if(O||(O=s),e.size!=t.size&&!j)return!1;var R=k.get(e);return R?R==t:(x|=c,k.set(e,t),a(O(e),O(t),r,o,x,k));case b:if(E)return E.call(e)==E.call(t)}return!1}var o=n(90),i=n(91),a=n(84),u=n(92),s=n(93),c=1,l=2,f="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Map]",v="[object Number]",y="[object RegExp]",m="[object Set]",g="[object String]",b="[object Symbol]",w="[object ArrayBuffer]",_="[object DataView]",x=o?o.prototype:void 0,E=x?x.valueOf:void 0;e.exports=r},function(e,t,n){var r=n(67),o=r.Symbol;e.exports=o},function(e,t,n){var r=n(67),o=r.Uint8Array;e.exports=o},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}e.exports=n},function(e,t){function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}e.exports=n},function(e,t,n){function r(e,t,n,r,u,s){var c=u&a,l=i(e),f=l.length,p=i(t),h=p.length;if(f!=h&&!c)return!1;for(var d=f;d--;){var v=l[d];if(!(c?v in t:o(t,v)))return!1}var y=s.get(e);if(y)return y==t;var m=!0;s.set(e,t);for(var g=c;++d<f;){v=l[d];var b=e[v],w=t[v];if(r)var _=c?r(w,b,v,t,e,s):r(b,w,v,e,t,s);if(!(void 0===_?b===w||n(b,w,r,u,s):_)){m=!1;break}g||(g="constructor"==v)}if(m&&!g){var x=e.constructor,E=t.constructor;x!=E&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof E&&E instanceof E)&&(m=!1)}return s["delete"](e),m}var o=n(21),i=n(20),a=2;e.exports=r},function(e,t,n){function r(e){return m.call(e)}var o=n(96),i=n(75),a=n(97),u=n(98),s=n(99),c=n(69),l="[object Map]",f="[object Object]",p="[object Promise]",h="[object Set]",d="[object WeakMap]",v="[object DataView]",y=Object.prototype,m=y.toString,g=c(o),b=c(i),w=c(a),_=c(u),x=c(s);(o&&r(new o(new ArrayBuffer(1)))!=v||i&&r(new i)!=l||a&&r(a.resolve())!=p||u&&r(new u)!=h||s&&r(new s)!=d)&&(r=function(e){var t=m.call(e),n=t==f?e.constructor:void 0,r=n?c(n):void 0;if(r)switch(r){case g:return v;case b:return l;case w:return p;case _:return h;case x:return d}return t}),e.exports=r},function(e,t,n){var r=n(62),o=n(67),i=r(o,"DataView");e.exports=i},function(e,t,n){var r=n(62),o=n(67),i=r(o,"Promise");e.exports=i},function(e,t,n){var r=n(62),o=n(67),i=r(o,"Set");e.exports=i},function(e,t,n){var r=n(62),o=n(67),i=r(o,"WeakMap");e.exports=i},function(e,t,n){function r(e){return i(e)&&o(e.length)&&!!I[P.call(e)]}var o=n(33),i=n(34),a="[object Arguments]",u="[object Array]",s="[object Boolean]",c="[object Date]",l="[object Error]",f="[object Function]",p="[object Map]",h="[object Number]",d="[object Object]",v="[object RegExp]",y="[object Set]",m="[object String]",g="[object WeakMap]",b="[object ArrayBuffer]",w="[object DataView]",_="[object Float32Array]",x="[object Float64Array]",E="[object Int8Array]",k="[object Int16Array]",O="[object Int32Array]",j="[object Uint8Array]",R="[object Uint8ClampedArray]",S="[object Uint16Array]",T="[object Uint32Array]",I={};I[_]=I[x]=I[E]=I[k]=I[O]=I[j]=I[R]=I[S]=I[T]=!0,I[a]=I[u]=I[b]=I[s]=I[w]=I[c]=I[l]=I[f]=I[p]=I[h]=I[d]=I[v]=I[y]=I[m]=I[g]=!1;var A=Object.prototype,P=A.toString;e.exports=r},function(e,t,n){function r(e){for(var t=i(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,o(a)]}return t}var o=n(102),i=n(20);e.exports=r},function(e,t,n){function r(e){return e===e&&!o(e)}var o=n(32);e.exports=r},function(e,t){function n(e,t){return function(n){return null==n?!1:n[e]===t&&(void 0!==t||e in Object(n))}}e.exports=n},function(e,t,n){function r(e,t){return u(e)&&s(t)?c(l(e),t):function(n){var r=i(n,e);return void 0===r&&r===t?a(n,e):o(t,r,void 0,f|p)}}var o=n(82),i=n(105),a=n(115),u=n(113),s=n(102),c=n(103),l=n(114),f=1,p=2;e.exports=r},function(e,t,n){function r(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}var o=n(106);e.exports=r},function(e,t,n){function r(e,t){t=i(t,e)?[t]:o(t);for(var n=0,r=t.length;null!=e&&r>n;)e=e[a(t[n++])];return n&&n==r?e:void 0}var o=n(107),i=n(113),a=n(114);e.exports=r},function(e,t,n){function r(e){return o(e)?e:i(e)}var o=n(35),i=n(108);e.exports=r},function(e,t,n){var r=n(109),o=n(110),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,a=/\\(\\)?/g,u=r(function(e){var t=[];return o(e).replace(i,function(e,n,r,o){t.push(r?o.replace(a,"$1"):n||e)}),t});e.exports=u},function(e,t,n){function r(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(r.Cache||o),n}var o=n(57),i="Expected a function";r.Cache=o,e.exports=r},function(e,t,n){function r(e){return null==e?"":o(e)}var o=n(111);e.exports=r},function(e,t,n){function r(e){if("string"==typeof e)return e;if(i(e))return s?s.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}var o=n(90),i=n(112),a=1/0,u=o?o.prototype:void 0,s=u?u.toString:void 0;e.exports=r},function(e,t,n){function r(e){return"symbol"==typeof e||o(e)&&u.call(e)==i}var o=n(34),i="[object Symbol]",a=Object.prototype,u=a.toString;e.exports=r},function(e,t,n){function r(e,t){if(o(e))return!1;var n=typeof e;return"number"==n||"symbol"==n||"boolean"==n||null==e||i(e)?!0:u.test(e)||!a.test(e)||null!=t&&e in Object(t)}var o=n(35),i=n(112),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=r},function(e,t,n){function r(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}var o=n(112),i=1/0;e.exports=r},function(e,t,n){function r(e,t){return null!=e&&i(e,t,o)}var o=n(116),i=n(117);e.exports=r},function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},function(e,t,n){function r(e,t,n){t=s(t,e)?[t]:o(t);for(var r,p=-1,h=t.length;++p<h;){var d=f(t[p]);if(!(r=null!=e&&n(e,d)))break;e=e[d]}if(r)return r;var h=e?e.length:0;return!!h&&c(h)&&u(d,h)&&(a(e)||l(e)||i(e))}var o=n(107),i=n(26),a=n(35),u=n(37),s=n(113),c=n(33),l=n(36),f=n(114);e.exports=r},function(e,t){function n(e){return e}e.exports=n},function(e,t,n){function r(e){return a(e)?o(u(e)):i(e)}var o=n(30),i=n(120),a=n(113),u=n(114);e.exports=r},function(e,t,n){function r(e){return function(t){return o(t,e)}}var o=n(106);e.exports=r},function(e,t){!function(){"use strict";function t(e){return"function"==typeof e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return e instanceof Date?e.getTime():e instanceof Array?e.map(r):e}function o(e,t){return e.get?e.get(t):e[t]}function i(e){return function(t,r){if(!n(r)||!r.length)return e(t,r);for(var i=0,a=r.length;a>i;i++)if(e(t,o(r,i)))return!0;return!1}}function a(e){return function(t,r){if(!n(r)||!r.length)return e(t,r);for(var i=0,a=r.length;a>i;i++)if(!e(t,o(r,i)))return!1;return!0}}function u(e,t){return e.v(e.a,t)}function s(e,t){for(var n=0;n<e.length;n++)if(u(t,o(e,n)))return n;return-1}function c(e,t){return{a:e,v:t}}function l(e,t){var n=[];return f(t,e.k,0,n),1===n.length?u(e.nv,n[0]):!!~s(n,e.nv)}function f(e,t,r,i){if(r===t.length||void 0==e)return void i.push(e);var a=o(t,r);if(n(e)&&isNaN(Number(a)))for(var u=0,s=e.length;s>u;u++)f(o(e,u),t,r,i);else f(o(e,a),t,r+1,i)}function p(e,t){return{a:{k:e,nv:t},v:l}}function h(e){e=r(e),(!e||"Object"!==e.constructor.toString()&&"functionObject(){[nativecode]}"!==e.constructor.toString().replace(/\n/g,"").replace(/ /g,""))&&(e={$eq:e});var t=[];for(var n in e){var o=e[n];if("$options"!==n)if(y[n])m[n]&&(o=m[n](o,e)),t.push(c(r(o),y[n]));else{if(36===n.charCodeAt(0))throw new Error("Unknown operation "+n);t.push(p(n.split("."),h(o)))}}return 1===t.length?t[0]:c(t,y.$and)}function d(e,t){var n=h(e);return t&&(n={a:n,v:function(e,n){return u(e,t(n))}}),n}function v(e,n,r){function o(e){return u(i,e)}t(n)&&(r=n,n=void 0);var i=d(e,r);return n?n.filter(o):o}var y={$eq:i(function(e,t){return e(t)}),$ne:a(function(e,t){return!e(t)}),$or:function(e,t){for(var n=0,r=e.length;r>n;n++)if(u(o(e,n),t))return!0;return!1},$gt:i(function(e,t){return v.compare(r(t),e)>0}),$gte:i(function(e,t){return v.compare(r(t),e)>=0}),$lt:i(function(e,t){return v.compare(r(t),e)<0}),$lte:i(function(e,t){return v.compare(r(t),e)<=0}),$mod:i(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(!(t instanceof Array))return!!~e.indexOf(r(t));for(var n=t.length;n--;)if(~e.indexOf(r(o(t,n))))return!0;return!1},$nin:function(e,t){return!y.$in(e,t)},$not:function(e,t){return!u(e,t)},$type:function(e,t){return void 0!=t?t instanceof e||t.constructor==e:!1},$all:function(e,t){t||(t=[]);for(var n=e.length;n--;)if(!~r(t).indexOf(o(e,n)))return!1;return!0},$size:function(e,t){return t?e===t.length:!1},$nor:function(e,t){for(var n=0,r=e.length;r>n;n++)if(u(o(e,n),t))return!1;return!0},$and:function(e,t){for(var n=0,r=e.length;r>n;n++)if(!u(o(e,n),t))return!1;return!0},$regex:i(function(e,t){return"string"==typeof t&&e.test(t)}),$where:function(e,t){return e.call(t,t)},$elemMatch:function(e,t){return n(t)?!!~s(t,e):u(e,t)},$exists:function(e,t){return void 0!=t===e}},m={$eq:function(e){return e instanceof RegExp?function(t){return"string"==typeof t&&e.test(t)}:e instanceof Function?e:n(e)&&!e.length?function(e){return n(e)&&!e.length}:null===e?function(e){return null==e}:function(t){return 0===v.compare(r(t),e)}},$ne:function(e){return m.$eq(e)},$and:function(e){return e.map(h)},$or:function(e){return e.map(h)},$nor:function(e){return e.map(h)},$not:function(e){return h(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return"string"==typeof e?new Function("obj","return "+e):e},$elemMatch:function(e){return h(e)},$exists:function(e){return!!e}};v.use=function(e){if(t(e))return e(v);for(var n in e)36===n.charCodeAt(0)&&(y[n]=e[n])},v.indexOf=function(e,t,n){return s(t,d(e,n))},v.compare=function(e,t){if(e===t)return 0;if(typeof e==typeof t){if(e>t)return 1;if(t>e)return-1}},"undefined"!=typeof e&&"undefined"!=typeof e.exports&&(e.exports=v),"undefined"!=typeof window&&(window.sift=v)}()},function(e,t,n){var r=n(123),o=n(124),i=n(125),a=n(28),u=n(38),s=n(20),c=Object.prototype,l=c.hasOwnProperty,f=c.propertyIsEnumerable,p=!f.call({valueOf:1},"valueOf"),h=i(function(e,t){if(p||u(t)||a(t))return void o(t,s(t),e);for(var n in t)l.call(t,n)&&r(e,n,t[n])});e.exports=h},function(e,t,n){function r(e,t,n){var r=e[t];a.call(e,t)&&o(r,n)&&(void 0!==n||t in e)||(e[t]=n)}var o=n(48),i=Object.prototype,a=i.hasOwnProperty;e.exports=r},function(e,t,n){function r(e,t,n,r){n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],s=r?r(n[u],e[u],u,n,e):e[u];o(n,u,s)}return n}var o=n(123);e.exports=r},function(e,t,n){function r(e){return i(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,u=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,u&&o(n[0],n[1],u)&&(a=3>i?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}var o=n(126),i=n(127);e.exports=r},function(e,t,n){function r(e,t,n){if(!u(n))return!1;var r=typeof t;return("number"==r?i(n)&&a(t,n.length):"string"==r&&t in n)?o(n[t],e):!1}var o=n(48),i=n(28),a=n(37),u=n(32);e.exports=r},function(e,t,n){function r(e,t){if("function"!=typeof e)throw new TypeError(a);return t=u(void 0===t?e.length-1:i(t),0),function(){for(var n=arguments,r=-1,i=u(n.length-t,0),a=Array(i);++r<i;)a[r]=n[t+r];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=Array(t+1);for(r=-1;++r<t;)s[r]=n[r];return s[t]=a,o(e,this,s)}}var o=n(128),i=n(129),a="Expected a function",u=Math.max;e.exports=r},function(e,t){function n(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}e.exports=n},function(e,t,n){function r(e){var t=o(e),n=t%1;return t===t?n?t-n:t:0}var o=n(130);e.exports=r},function(e,t,n){function r(e){if(!e)return 0===e?e:0;if(e=o(e),e===i||e===-i){var t=0>e?-1:1;return t*a}return e===e?e:0}var o=n(131),i=1/0,a=1.7976931348623157e308;e.exports=r},function(e,t,n){function r(e){if("number"==typeof e)return e;if(a(e))return u;if(i(e)){var t=o(e.valueOf)?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=l.test(e);return n||f.test(e)?p(e.slice(2),n?2:8):c.test(e)?u:+e}var o=n(31),i=n(32),a=n(112),u=NaN,s=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,p=parseInt;e.exports=r},function(e,t,n){function r(e){return"number"==typeof e||o(e)&&u.call(e)==i}var o=n(34),i="[object Number]",a=Object.prototype,u=a.toString;e.exports=r},function(e,t,n){function r(e){return o(e)&&u.call(e)==i}var o=n(32),i="[object RegExp]",a=Object.prototype,u=a.toString;e.exports=r},function(e,t,n){function r(e){if(u(e)&&(a(e)||f(e)||c(e.splice)||i(e)||s(e)))return!e.length;if(l(e)){var t=o(e);if(t==h||t==d)return!e.size}for(var n in e)if(y.call(e,n))return!1;return!(g&&p(e).length)}var o=n(95),i=n(26),a=n(35),u=n(28),s=n(135),c=n(31),l=n(34),f=n(36),p=n(20),h="[object Map]",d="[object Set]",v=Object.prototype,y=v.hasOwnProperty,m=v.propertyIsEnumerable,g=!m.call({valueOf:1},"valueOf");e.exports=r},function(e,t,n){(function(e){var r=n(67),o=n(137),i="object"==typeof t&&t,a=i&&"object"==typeof e&&e,u=a&&a.exports===i,s=u?r.Buffer:void 0,c=s?function(e){return e instanceof s}:o;e.exports=c}).call(t,n(136)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){function n(){return!1}e.exports=n},function(e,t,n){function r(e,t){return o(e,a(t,3),i)}var o=n(139),i=n(17),a=n(40);e.exports=r},function(e,t){function n(e,t,n){var r;return n(e,function(e,n,o){return t(e,n,o)?(r=n,!1):void 0}),r}e.exports=n},function(e,t,n){function r(e,t,n){t=a(t,e)?[t]:o(t);var r=-1,s=t.length;for(s||(e=void 0,s=1);++r<s;){var c=null==e?void 0:e[u(t[r])];void 0===c&&(r=s,c=n),e=i(c)?c.call(e):c}return e}var o=n(107),i=n(31),a=n(113),u=n(114);
e.exports=r},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=n(142),s=n(146),c=r(s),l=n(122),f=r(l),p=n(36),h=r(p),d=null,v=function(){function t(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,t),n=(0,f["default"])({protocol:e.env.KINVEY_API_PROTOCOL||"https:",host:e.env.KINVEY_API_HOST||"baas.kinvey.com"},n),n.hostname&&(0,h["default"])(n.hostname)){var r=c["default"].parse(n.hostname);n.protocol=r.protocol,n.host=r.host}this.protocol=n.protocol,this.host=n.host,this.appKey=n.appKey||n.appId,this.appSecret=n.appSecret,this.masterSecret=n.masterSecret,this.encryptionKey=n.encryptionKey,this.appVersion=n.appVersion}return i(t,[{key:"toJSON",value:function(){var e={protocol:this.protocol,host:this.host,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion};return e}},{key:"baseUrl",get:function(){return c["default"].format({protocol:this.protocol,host:this.host})}},{key:"activeUser",get:function(){return(0,u.getActiveUser)(this)}},{key:"activeSocialIdentity",get:function(){return(0,u.getActiveSocialIdentity)(this)}},{key:"appVersion",get:function(){return this.clientAppVersion},set:function(e){e&&!(0,h["default"])(e)&&(e=String(e)),this.clientAppVersion=e}}],[{key:"init",value:function(e){var n=new t(e);return d=n,n}},{key:"sharedInstance",value:function(){if(!d)throw new a.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return d}}]),t}();t["default"]=v}).call(t,n(2))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return f["default"].get(""+e.appKey+p)}function i(e,t){if(t)try{return f["default"].set(""+e.appKey+p,t)}catch(n){return!1}return f["default"].remove(""+e.appKey+p)}function a(e){return f["default"].get(""+e.appKey+h)}function u(e,t){if(t)try{return f["default"].set(""+e.appKey+h,t)}catch(n){return!1}return f["default"].remove(""+e.appKey+h)}function s(e){return f["default"].get(""+e.appKey+d)}function c(e,t){if(t)try{return f["default"].set(""+e.appKey+d,t)}catch(n){return!1}return f["default"].remove(""+e.appKey+d)}Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveUser=o,t.setActiveUser=i,t.getActiveSocialIdentity=a,t.setActiveSocialIdentity=u,t.getSyncKey=s,t.setSyncKey=c;var l=n(143),f=r(l),p=e.env.KINVEY_USER_COLLECTION_NAME||"kinvey_user",h=e.env.KINVEY_SOCIAL_IDENTITY_COLLECTION_NAME||"kinvey_socialIdentity",d=e.env.KINVEY_SYNC_KEY_COLLECTION_NAME||"kinvey_syncKey"}).call(t,n(2))},function(e,t,n){(function(t){"use strict";function r(e,t){return 1===arguments.length?o(e):i(e,t)}function o(e){return JSON.parse(l.getItem(e))}function i(e,t){try{return l.setItem(e,JSON.stringify(t)),!0}catch(n){return!1}}function a(e){return l.removeItem(e)}function u(){return l.clear()}var s=n(144),c=n(145),l="localStorage"in t&&t.localStorage?t.localStorage:s;r.set=i,r.get=o,r.remove=a,r.clear=u,r.on=c.on,r.off=c.off,e.exports=r}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){return e in a?a[e]:null}function r(e,t){return a[e]=t,!0}function o(e){var t=e in a;return t?delete a[e]:!1}function i(){return a={},!0}var a={};e.exports={getItem:n,setItem:r,removeItem:o,clear:i}},function(e,t){(function(t){"use strict";function n(){t.addEventListener?t.addEventListener("storage",r,!1):t.attachEvent?t.attachEvent("onstorage",r):t.onstorage=r}function r(e){function n(t){t(JSON.parse(e.newValue),JSON.parse(e.oldValue),e.url||e.uri)}e||(e=t.event);var r=a[e.key];r&&r.forEach(n)}function o(e,t){a[e]?a[e].push(t):a[e]=[t],u===!1&&n()}function i(e,t){var n=a[e];n.length>1?n.splice(n.indexOf(t),1):a[e]=[]}var a={},u=!1;e.exports={on:o,off:i}}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&c.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}function i(e){return c.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)}function a(e,t){return o(e,!1,!0).resolve(t)}function u(e,t){return e?o(e,!1,!0).resolveObject(t):t}var s=n(147),c=n(148);t.parse=o,t.resolve=a,t.resolveObject=u,t.format=i,t.Url=r;var l=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","	"],d=["{","}","|","\\","^","`"].concat(h),v=["'"].concat(d),y=["%","/","?",";","#"].concat(v),m=["/","?","#"],g=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},E={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},k=n(149);r.prototype.parse=function(e,t,n){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",i=e.split(o),a=/\\/g;i[0]=i[0].replace(a,"/"),e=i.join(o);var u=e;if(u=u.trim(),!n&&1===e.split("#").length){var f=p.exec(u);if(f)return this.path=u,this.href=u,this.pathname=f[1],f[2]?(this.search=f[2],t?this.query=k.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=l.exec(u);if(h){h=h[0];var d=h.toLowerCase();this.protocol=d,u=u.substr(h.length)}if(n||h||u.match(/^\/\/[^@\/]+@[^@\/]+/)){var O="//"===u.substr(0,2);!O||h&&x[h]||(u=u.substr(2),this.slashes=!0)}if(!x[h]&&(O||h&&!E[h])){for(var j=-1,R=0;R<m.length;R++){var S=u.indexOf(m[R]);-1!==S&&(-1===j||j>S)&&(j=S)}var T,I;I=-1===j?u.lastIndexOf("@"):u.lastIndexOf("@",j),-1!==I&&(T=u.slice(0,I),u=u.slice(I+1),this.auth=decodeURIComponent(T)),j=-1;for(var R=0;R<y.length;R++){var S=u.indexOf(y[R]);-1!==S&&(-1===j||j>S)&&(j=S)}-1===j&&(j=u.length),this.host=u.slice(0,j),u=u.slice(j),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var P=this.hostname.split(/\./),R=0,q=P.length;q>R;R++){var C=P[R];if(C&&!C.match(b)){for(var D="",N=0,M=C.length;M>N;N++)D+=C.charCodeAt(N)>127?"x":C[N];if(!D.match(b)){var B=P.slice(0,R),K=P.slice(R+1),L=C.match(w);L&&(B.push(L[1]),K.unshift(L[2])),K.length&&(u="/"+K.join(".")+u),this.hostname=B.join(".");break}}}this.hostname.length>g?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=s.toASCII(this.hostname));var U=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+U,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==u[0]&&(u="/"+u))}if(!_[d])for(var R=0,q=v.length;q>R;R++){var $=v[R];if(-1!==u.indexOf($)){var V=encodeURIComponent($);V===$&&(V=escape($)),u=u.split($).join(V)}}var Y=u.indexOf("#");-1!==Y&&(this.hash=u.substr(Y),u=u.slice(0,Y));var z=u.indexOf("?");if(-1!==z?(this.search=u.substr(z),this.query=u.substr(z+1),t&&(this.query=k.parse(this.query)),u=u.slice(0,z)):t&&(this.search="",this.query={}),u&&(this.pathname=u),E[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",J=this.search||"";this.path=U+J}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=k.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||E[t])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+o+n+a+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(c.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var a=o[i];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),s=0;s<u.length;s++){var l=u[s];"protocol"!==l&&(n[l]=e[l])}return E[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!E[e.protocol]){for(var f=Object.keys(e),p=0;p<f.length;p++){var h=f[p];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||x[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var v=n.pathname||"",y=n.search||"";n.path=v+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=g||m||n.host&&e.pathname,w=b,_=n.pathname&&n.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],k=n.protocol&&!E[n.protocol];if(k&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===_[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=d;else if(d.length)_||(_=[]),_.pop(),_=_.concat(d),n.search=e.search,n.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(k){n.hostname=n.host=_.shift();var O=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;O&&(n.auth=O.shift(),n.host=n.hostname=O.shift())}return n.search=e.search,n.query=e.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var j=_.slice(-1)[0],R=(n.host||e.host||_.length>1)&&("."===j||".."===j)||""===j,S=0,T=_.length;T>=0;T--)j=_[T],"."===j?_.splice(T,1):".."===j?(_.splice(T,1),S++):S&&(_.splice(T,1),S--);if(!b&&!w)for(;S--;S)_.unshift("..");!b||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),R&&"/"!==_.join("/").substr(-1)&&_.push("");var I=""===_[0]||_[0]&&"/"===_[0].charAt(0);if(k){n.hostname=n.host=I?"":_.length?_.shift():"";var O=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;O&&(n.auth=O.shift(),n.host=n.hostname=O.shift())}return b=b||n.host&&_.length,b&&!I&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){var r;(function(e,o){!function(i){function a(e){throw RangeError(P[e])}function u(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function s(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(A,".");var o=e.split("."),i=u(o,t).join(".");return r+i}function c(e){for(var t,n,r=[],o=0,i=e.length;i>o;)t=e.charCodeAt(o++),t>=55296&&56319>=t&&i>o?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function l(e){return u(e,function(e){var t="";return e>65535&&(e-=65536,t+=D(e>>>10&1023|55296),e=56320|1023&e),t+=D(e)}).join("")}function f(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:_}function p(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function h(e,t,n){var r=0;for(e=n?C(e/O):e>>1,e+=C(e/t);e>q*E>>1;r+=_)e=C(e/q);return C(r+(q+1)*e/(e+k))}function d(e){var t,n,r,o,i,u,s,c,p,d,v=[],y=e.length,m=0,g=R,b=j;for(n=e.lastIndexOf(S),0>n&&(n=0),r=0;n>r;++r)e.charCodeAt(r)>=128&&a("not-basic"),v.push(e.charCodeAt(r));for(o=n>0?n+1:0;y>o;){for(i=m,u=1,s=_;o>=y&&a("invalid-input"),c=f(e.charCodeAt(o++)),(c>=_||c>C((w-m)/u))&&a("overflow"),m+=c*u,p=b>=s?x:s>=b+E?E:s-b,!(p>c);s+=_)d=_-p,u>C(w/d)&&a("overflow"),u*=d;t=v.length+1,b=h(m-i,t,0==i),C(m/t)>w-g&&a("overflow"),g+=C(m/t),m%=t,v.splice(m++,0,g)}return l(v)}function v(e){var t,n,r,o,i,u,s,l,f,d,v,y,m,g,b,k=[];for(e=c(e),y=e.length,t=R,n=0,i=j,u=0;y>u;++u)v=e[u],128>v&&k.push(D(v));for(r=o=k.length,o&&k.push(S);y>r;){for(s=w,u=0;y>u;++u)v=e[u],v>=t&&s>v&&(s=v);for(m=r+1,s-t>C((w-n)/m)&&a("overflow"),n+=(s-t)*m,t=s,u=0;y>u;++u)if(v=e[u],t>v&&++n>w&&a("overflow"),v==t){for(l=n,f=_;d=i>=f?x:f>=i+E?E:f-i,!(d>l);f+=_)b=l-d,g=_-d,k.push(D(p(d+b%g,0))),l=C(b/g);k.push(D(p(l,0))),i=h(n,m,r==o),n=0,++r}++n,++t}return k.join("")}function y(e){return s(e,function(e){return T.test(e)?d(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return I.test(e)?"xn--"+v(e):e})}var g=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof o&&o);g.global!==g&&g.window!==g&&g.self!==g||(i=g);var b,w=2147483647,_=36,x=1,E=26,k=38,O=700,j=72,R=128,S="-",T=/^xn--/,I=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},q=_-x,C=Math.floor,D=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:c,encode:l},decode:d,encode:v,toASCII:m,toUnicode:y},r=function(){return b}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(136)(e),function(){return this}())},function(e,t){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(150),t.encode=t.stringify=n(151)},function(e,t){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var a=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var c=0;s>c;++c){var l,f,p,h,d=e[c].replace(a,"%20"),v=d.indexOf(r);v>=0?(l=d.substr(0,v),f=d.substr(v+1)):(l=d,f=""),p=decodeURIComponent(l),h=decodeURIComponent(f),n(i,p)?Array.isArray(i[p])?i[p].push(h):i[p]=[i[p],h]:i[p]=h}return i}},function(e,t){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(n(o))+r;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(n(e))}).join(t):i+encodeURIComponent(n(e[o]))}).join(t):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(e)):""}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(141),s=r(u),c=n(153),l=n(9),f=n(252),p=n(146),h=r(p),d=n(122),v=r(d),y=n(36),m=r(y),g=e.env.KINVEY_RPC_NAMESPACE||"rpc",b=function(){function e(){i(this,e)}return a(e,null,[{key:"execute",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,o,i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(0,v["default"])({client:s["default"].sharedInstance()},i),e){n.next=3;break}throw new l.KinveyError("An endpoint is required.");case 3:if((0,m["default"])(e)){n.next=5;break}throw new l.KinveyError("The endpoint must be a string.");case 5:return r=new f.NetworkRequest({method:c.RequestMethod.POST,authType:c.AuthType.Default,url:h["default"].format({protocol:i.client.protocol,host:i.client.host,pathname:"/"+g+"/"+i.client.appKey+"/custom/"+e}),properties:i.properties,body:t,timeout:i.timeout,client:i.client}),n.next=8,r.execute();case 8:return o=n.sent,n.abrupt("return",o.data);case 10:case"end":return n.stop()}},n,this)}));return e}()}]),e}();t["default"]=b}).call(t,n(2))},function(e,t,n){(function(e,r,o){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){if(e){var t=0,n=e.length;e=String(e||"");for(var r=0;n>r;r++){var o=encodeURI(e[r]).split("%").length;t+=1===o?1:o-1}return t}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyRequest=t.Request=t.KinveyRequestConfig=t.RequestConfig=t.Properties=t.Headers=t.RequestMethod=t.AuthType=void 0;var f=function X(e,t,n,r){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&X(i,t,n,r)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(r,n)}return n},p=function Z(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:Z(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(158),v=n(141),y=i(v),m=n(9),g=n(244),b=i(g),w=n(246),_=i(w),x=n(146),E=i(x),k=n(250),O=i(k),j=n(122),R=i(j),S=n(140),T=i(S),I=n(14),A=i(I),P=n(36),q=i(P),C=n(199),D=i(C),N=n(134),M=i(N),B=n(132),K=i(B),L=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",U=e.env.KINVEY_DEFAULT_TIMEOUT||30,F=e.env.KINVEY_DEFAULT_API_VERSION||4,$=e.env.KINVEY_MAX_HEADER_BYTES||2e3,V={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(V),t.AuthType=V;var Y={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(Y),t.RequestMethod=Y;var z={all:function(e){try{return z.session(e)}catch(t){return z.basic(e)}},app:function(e){if(!e.appKey||!e.appSecret)throw new Error("Missing client credentials");return{scheme:"Basic",username:e.appKey,password:e.appSecret}},basic:function(e){try{return z.master(e)}catch(t){return z.app(e)}},master:function(e){if(!e.appKey||!e.masterSecret)throw new Error("Missing client credentials");return{scheme:"Basic",username:e.appKey,password:e.masterSecret}},none:function(){return null},session:function(e){var t=e.activeUser;if(!t)throw new m.NoActiveUserError("There is not an active user. Please login a user and retry the request.");return{scheme:"Kinvey",credentials:t[L].authtoken}}},J=t.Headers=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];c(this,e),this.headers={},this.addAll(t)}return h(e,[{key:"get",value:function(e){if(e){(0,q["default"])(e)||(e=String(e));var t=this.headers;return t[e.toLowerCase()]}}},{key:"set",value:function(e,t){if(!e||!t)throw new Error("A name and value must be provided to set a header.");(0,q["default"])(e)||(e=String(e));var n=this.headers;return e=e.toLowerCase(),(0,q["default"])(t)?n[e]=t:n[e]=JSON.stringify(t),this.headers=n,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.set(e.name,e.value)}},{key:"addAll",value:function(e){var t=this;if(!(0,D["default"])(e))throw new Error("Headers argument must be an object.");var n=Object.keys(e);return(0,A["default"])(n,function(n){var r=e[n];t.set(n,r)}),this}},{key:"remove",value:function(e){if(e){(0,q["default"])(e)||(e=String(e));var t=this.headers;delete t[e.toLowerCase()],this.headers=t}return this}},{key:"clear",value:function(){return this.headers={},this}},{key:"toJSON",value:function(){return this.headers}},{key:"toString",value:function(){return JSON.stringify(this.headers)}}]),e}(),H=t.Properties=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];c(this,e),this.addAll(t)}return h(e,[{key:"get",value:function(e){var t=this.properties||{};return e&&t.hasOwnProperty(e)?t[e]:void 0}},{key:"set",value:function(e,t){if(!e||!t)throw new Error("A key and value must be provided to set a property.");(0,q["default"])(e)||(e=String(e));var n=this.properties||{};return n[e]=t,this.properties=n,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.set(e.name,e.value)}},{key:"addAll",value:function(e){var t=this;if(!(0,D["default"])(e))throw new m.KinveyError("properties argument must be an object");return Object.keys(e).forEach(function(n){var r=e[n];t.set(n,r)}),this}},{key:"remove",value:function(e){if(e){var t=this.properties||{};delete t[e],this.properties=t}return this}},{key:"clear",value:function(){return this.properties={},this}},{key:"toJSON",value:function(){return this.properties}},{key:"toString",value:function(){return JSON.stringify(this.properties)}}]),e}(),G=t.RequestConfig=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];c(this,e),t=(0,R["default"])({method:Y.GET,headers:new J,url:"",body:null,timeout:U,followRedirect:!0,noCache:!1},t),this.method=t.method,this.headers=t.headers,this.url=t.url,this.body=t.body||t.data,this.timeout=t.timeout,this.followRedirect=t.followRedirect,this.noCache=t.noCache}return h(e,[{key:"method",get:function(){return this.configMethod},set:function(e){switch((0,q["default"])(e)||(e=String(e)),e=e.toUpperCase()){case Y.GET:case Y.POST:case Y.PATCH:case Y.PUT:case Y.DELETE:this.configMethod=e;break;default:throw new Error("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function(){var e=this.configHeaders;return e.has("accept")||e.set("accept","application/json; charset=utf-8"),e.has("content-type")||e.set("content-type","application/json; charset=utf-8"),e},set:function(e){e instanceof J||(e=new J((0,T["default"])(e,"toJSON",e))),this.configHeaders=e}},{key:"url",get:function(){return this.noCache===!0?(0,O["default"])(this.configUrl,_["default"].stringify({_:Math.random().toString(36).substr(2)})):this.configUrl},set:function(e){this.configUrl=e}},{key:"body",get:function(){return this.configBody},set:function(e){this.configBody=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}},{key:"timeout",get:function(){return this.configTimeout},set:function(e){this.configTimeout=(0,K["default"])(e)?e:U}},{key:"followRedirect",get:function(){return this.configFollowRedirect},set:function(e){this.configFollowRedirect=!!e}},{key:"noCache",get:function(){return this.configNoCache},set:function(e){this.configNoCache=!!e}}]),e}(),Q=t.KinveyRequestConfig=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];c(this,t);var n=u(this,Object.getPrototypeOf(t).call(this,e));e=(0,R["default"])({authType:V.None,query:null,apiVersion:F,properties:new H,skipBL:!1,trace:!1,client:y["default"].sharedInstance()},e),n.authType=e.authType,n.query=e.query,n.apiVersion=e.apiVersion,n.properties=e.properties,n.client=e.client;var r=n.headers;return r.has("X-Kinvey-Api-Version")||r.set("X-Kinvey-Api-Version",n.apiVersion),e.skipBL===!0&&r.set("X-Kinvey-Skip-Business-Logic",!0),e.trace===!0&&(r.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id"),r.set("X-Kinvey-ResponseWrapper",!0)),n.headers=r,n}return s(t,e),h(t,[{key:"headers",get:function(){var e=p(Object.getPrototypeOf(t.prototype),"headers",this);if(this.appVersion&&e.set("X-Kinvey-Client-App-Version",this.appVersion),this.properties&&!(0,M["default"])(this.properties)){var n=this.properties.toString(),i=l(n);if(i>=$)throw new Error("The custom properties are "+i+" bytes."+("It must be less then "+$+" bytes."),"Please remove some custom properties.");e.set("X-Kinvey-Custom-Request-Properties",n)}if(r.KinveyDevice&&e.set("X-Kinvey-Device-Information",JSON.stringify(r.KinveyDevice.toJSON())),this.authType){var a=void 0;switch(this.authType){case V.All:a=z.all(this.client);break;case V.App:a=z.app(this.client);break;case V.Basic:a=z.basic(this.client);break;case V.Master:a=z.master(this.client);break;case V.None:a=z.none(this.client);break;case V.Session:a=z.session(this.client);break;default:try{a=z.session(this.client)}catch(u){try{a=z.master(this.client)}catch(s){throw u}}}if(a){var c=a.credentials;a.username&&(c=new o(a.username+":"+a.password).toString("base64")),e.set("authorization",a.scheme+" "+c)}}return e},set:function(e){f(Object.getPrototypeOf(t.prototype),"headers",e,this)}},{key:"url",get:function(){var e=p(Object.getPrototypeOf(t.prototype),"url",this),n=this.query?this.query.toQueryString():{};return(0,M["default"])(n)?e:(0,O["default"])(e,_["default"].stringify(n))},set:function(e){f(Object.getPrototypeOf(t.prototype),"url",e,this);var n=r.escape(E["default"].parse(e).pathname),o=new b["default"]("(/:namespace)(/)(:appKey)(/)(:collection)(/)(:entityId)(/)"),i=o.match(n)||{},a=i.appKey,u=i.collection,s=i.entityId;this.appKey=a?r.unescape(a):a,this.collection=u?r.unescape(u):u,this.entityId=s?r.unescape(s):s}},{key:"apiVersion",get:function(){return this.configApiVersion},set:function(e){this.configApiVersion=(0,K["default"])(e)?e:F}},{key:"properties",get:function(){return this.configProperties},set:function(e){!e||e instanceof H||(e=new H((0,T["default"])(e,"toJSON",e))),this.configProperties=e}},{key:"client",get:function(){return this.configClient},set:function(e){if(e){if(!(e instanceof y["default"]))throw new m.KinveyError("client must be an instance of the Client class.");this.appVersion=e.appVersion}this.configClient=e}},{key:"appVersion",get:function(){return this.configAppVersion},set:function(e){this.configAppVersion=e}}]),t}(G),W=t.Request=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?new G:arguments[0];c(this,e),this.config=t,this.executing=!1}return h(e,[{key:"isExecuting",value:function(){return!!this.executing}},{key:"execute",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isExecuting()){e.next=2;break}throw new Error("Unable to execute the request. The request is already executing.");case 2:this.executing=!0;case 3:case"end":return e.stop()}},n,this)}));return e}()},{key:"toJSON",value:function(){var e={method:this.method,headers:this.headers.toJSON(),url:this.url,body:this.body,data:this.body};return e}},{key:"config",get:function(){return this.requestConfig},set:function(e){!e||e instanceof G||(e=new G((0,T["default"])(e,"toJSON",e))),this.requestConfig=e}},{key:"method",get:function(){return this.config.method},set:function(e){this.config.method=e}},{key:"headers",get:function(){return this.config.headers},set:function(e){this.config.headers=e}},{key:"url",get:function(){return this.config.url},set:function(e){this.config.url=e}},{key:"body",get:function(){return this.config.body},set:function(e){this.config.body=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}}]),e}();t.KinveyRequest=function(e){function t(e){c(this,t);var n=u(this,Object.getPrototypeOf(t).call(this,e));return n.rack=new d.KinveyRack,n}return s(t,e),h(t,[{key:"toJSON",value:function(){var e=p(Object.getPrototypeOf(t.prototype),"toJSON",this).call(this);return e.query=this.query,e}},{key:"config",get:function(){return p(Object.getPrototypeOf(t.prototype),"config",this)},set:function(e){!e||e instanceof Q||(e=new Q((0,T["default"])(e,"toJSON",e))),f(Object.getPrototypeOf(t.prototype),"config",e,this)}},{key:"query",get:function(){return this.config.query},set:function(e){this.config.query=e}},{key:"appKey",get:function(){return this.config.appKey}},{key:"collection",get:function(){return this.config.collection}},{key:"entityId",get:function(){return this.config.entityId}},{key:"client",get:function(){return this.config.client},set:function(e){this.config.client=e}}]),t}(W)}).call(t,n(2),function(){return this}(),n(154).Buffer)},function(e,t,n){(function(e,r){"use strict";function o(){function e(){}try{var t=new Uint8Array(1);return t.foo=function(){return 42},t.constructor=e,42===t.foo()&&t.constructor===e&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(n){return!1}}function i(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(t){return this instanceof e?(e.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?a(this,t):"string"==typeof t?u(this,t,arguments.length>1?arguments[1]:"utf8"):s(this,t)):arguments.length>1?new e(t,arguments[1]):new e(t)}function a(t,n){if(t=v(t,0>n?0:0|y(n)),!e.TYPED_ARRAY_SUPPORT)for(var r=0;n>r;r++)t[r]=0;return t}function u(e,t,n){"string"==typeof n&&""!==n||(n="utf8");var r=0|g(t,n);return e=v(e,r),e.write(t,n),e}function s(t,n){if(e.isBuffer(n))return c(t,n);if(Q(n))return l(t,n);if(null==n)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(n.buffer instanceof ArrayBuffer)return f(t,n);if(n instanceof ArrayBuffer)return p(t,n)}return n.length?h(t,n):d(t,n)}function c(e,t){var n=0|y(t.length);return e=v(e,n),t.copy(e,0,0,n),e}function l(e,t){var n=0|y(t.length);e=v(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function f(e,t){var n=0|y(t.length);e=v(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function p(t,n){return e.TYPED_ARRAY_SUPPORT?(n.byteLength,t=e._augment(new Uint8Array(n))):t=f(t,new Uint8Array(n)),t}function h(e,t){var n=0|y(t.length);e=v(e,n);
for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function d(e,t){var n,r=0;"Buffer"===t.type&&Q(t.data)&&(n=t.data,r=0|y(n.length)),e=v(e,r);for(var o=0;r>o;o+=1)e[o]=255&n[o];return e}function v(t,n){e.TYPED_ARRAY_SUPPORT?(t=e._augment(new Uint8Array(n)),t.__proto__=e.prototype):(t.length=n,t._isBuffer=!0);var r=0!==n&&n<=e.poolSize>>>1;return r&&(t.parent=W),t}function y(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function m(t,n){if(!(this instanceof m))return new m(t,n);var r=new e(t,n);return delete r.parent,r}function g(e,t){"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return $(e).length;t=(""+t).toLowerCase(),r=!0}}function b(e,t,n){var r=!1;if(t=0|t,n=void 0===n||n===1/0?this.length:0|n,e||(e="utf8"),0>t&&(t=0),n>this.length&&(n=this.length),t>=n)return"";for(;;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return T(this,t,n);case"binary":return I(this,t,n);case"base64":return j(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function w(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var i=t.length;if(i%2!==0)throw new Error("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;r>a;a++){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))throw new Error("Invalid hex string");e[n+a]=u}return a}function _(e,t,n,r){return J($(t,e.length-n),e,n,r)}function x(e,t,n,r){return J(V(t),e,n,r)}function E(e,t,n,r){return x(e,t,n,r)}function k(e,t,n,r){return J(z(t),e,n,r)}function O(e,t,n,r){return J(Y(t,e.length-n),e,n,r)}function j(e,t,n){return 0===t&&n===e.length?H.fromByteArray(e):H.fromByteArray(e.slice(t,n))}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;n>o;){var i=e[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(n>=o+u){var s,c,l,f;switch(u){case 1:128>i&&(a=i);break;case 2:s=e[o+1],128===(192&s)&&(f=(31&i)<<6|63&s,f>127&&(a=f));break;case 3:s=e[o+1],c=e[o+2],128===(192&s)&&128===(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c,f>2047&&(55296>f||f>57343)&&(a=f));break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128===(192&s)&&128===(192&c)&&128===(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l,f>65535&&1114112>f&&(a=f))}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return S(r)}function S(e){var t=e.length;if(X>=t)return String.fromCharCode.apply(String,e);for(var n="",r=0;t>r;)n+=String.fromCharCode.apply(String,e.slice(r,r+=X));return n}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;n>o;o++)r+=String.fromCharCode(127&e[o]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;n>o;o++)r+=String.fromCharCode(e[o]);return r}function A(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var o="",i=t;n>i;i++)o+=F(e[i]);return o}function P(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function q(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,n,r,o,i,a){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(n>i||a>n)throw new RangeError("value is out of bounds");if(r+o>t.length)throw new RangeError("index out of range")}function D(e,t,n,r){0>t&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);i>o;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function N(e,t,n,r){0>t&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);i>o;o++)e[n+o]=t>>>8*(r?o:3-o)&255}function M(e,t,n,r,o,i){if(t>o||i>t)throw new RangeError("value is out of bounds");if(n+r>e.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function B(e,t,n,r,o){return o||M(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),G.write(e,t,n,r,23,4),n+4}function K(e,t,n,r,o){return o||M(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),G.write(e,t,n,r,52,8),n+8}function L(e){if(e=U(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function U(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function F(e){return 16>e?"0"+e.toString(16):e.toString(16)}function $(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],a=0;r>a;a++){if(n=e.charCodeAt(a),n>55295&&57344>n){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(56320>n){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,128>n){if((t-=1)<0)break;i.push(n)}else if(2048>n){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(65536>n){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function Y(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);a++)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function z(e){return H.toByteArray(L(e))}function J(e,t,n,r){for(var o=0;r>o&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}var H=n(155),G=n(156),Q=n(157);t.Buffer=e,t.SlowBuffer=m,t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var W={};e.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:o(),e.TYPED_ARRAY_SUPPORT?(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array):(e.prototype.length=void 0,e.prototype.parent=void 0),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,n){if(!e.isBuffer(t)||!e.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,o=n.length,i=0,a=Math.min(r,o);a>i&&t[i]===n[i];)++i;return i!==a&&(r=t[i],o=n[i]),o>r?-1:r>o?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,n){if(!Q(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new e(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;r++)n+=t[r].length;var o=new e(n),i=0;for(r=0;r<t.length;r++){var a=t[r];a.copy(o,i),i+=a.length}return o},e.byteLength=g,e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):b.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===e.compare(this,t)},e.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:e.compare(this,t)},e.prototype.indexOf=function(t,n){function r(e,t,n){for(var r=-1,o=0;n+o<e.length;o++)if(e[n+o]===t[-1===r?0:o-r]){if(-1===r&&(r=o),o-r+1===t.length)return n+r}else r=-1;return-1}if(n>2147483647?n=2147483647:-2147483648>n&&(n=-2147483648),n>>=0,0===this.length)return-1;if(n>=this.length)return-1;if(0>n&&(n=Math.max(this.length+n,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,n);if(e.isBuffer(t))return r(this,t,n);if("number"==typeof t)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,n):r(this,[t],n);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},e.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},e.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0);else{var o=r;r=t,t=0|n,n=o}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(0>n||0>t)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return x(this,e,t,n);case"binary":return E(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;e.prototype.slice=function(t,n){var r=this.length;t=~~t,n=void 0===n?r:~~n,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>n?(n+=r,0>n&&(n=0)):n>r&&(n=r),t>n&&(n=t);var o;if(e.TYPED_ARRAY_SUPPORT)o=e._augment(this.subarray(t,n));else{var i=n-t;o=new e(i,void 0);for(var a=0;i>a;a++)o[a]=this[a+t]}return o.length&&(o.parent=this.parent||this),o},e.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||q(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},e.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||q(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},e.prototype.readUInt8=function(e,t){return t||q(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||q(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||q(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||q(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||q(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||q(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},e.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||q(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return t||q(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){t||q(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt16BE=function(e,t){t||q(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},e.prototype.readInt32LE=function(e,t){return t||q(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||q(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||q(e,4,this.length),G.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||q(e,4,this.length),G.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||q(e,8,this.length),G.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||q(e,8,this.length),G.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||C(this,e,t,n,Math.pow(2,8*n),0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},e.prototype.writeUIntBE=function(e,t,n,r){e=+e,t=0|t,n=0|n,r||C(this,e,t,n,Math.pow(2,8*n),0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},e.prototype.writeUInt8=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},e.prototype.writeUInt16LE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):D(this,t,n,!0),n+2},e.prototype.writeUInt16BE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):D(this,t,n,!1),n+2},e.prototype.writeUInt32LE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):N(this,t,n,!0),n+4},e.prototype.writeUInt32BE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):N(this,t,n,!1),n+4},e.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);C(this,e,t,n,o-1,-o)}var i=0,a=1,u=0>e?1:0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=(e/a>>0)-u&255;return t+n},e.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);C(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0>e?1:0;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=(e/a>>0)-u&255;return t+n},e.prototype.writeInt8=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[n]=255&t,n+1},e.prototype.writeInt16LE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):D(this,t,n,!0),n+2},e.prototype.writeInt16BE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):D(this,t,n,!1),n+2},e.prototype.writeInt32LE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):N(this,t,n,!0),n+4},e.prototype.writeInt32BE=function(t,n,r){return t=+t,n=0|n,r||C(this,t,n,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):N(this,t,n,!1),n+4},e.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},e.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},e.prototype.writeDoubleLE=function(e,t,n){return K(this,e,t,!0,n)},e.prototype.writeDoubleBE=function(e,t,n){return K(this,e,t,!1,n)},e.prototype.copy=function(t,n,r,o){if(r||(r=0),o||0===o||(o=this.length),n>=t.length&&(n=t.length),n||(n=0),o>0&&r>o&&(o=r),o===r)return 0;if(0===t.length||0===this.length)return 0;if(0>n)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-n<o-r&&(o=t.length-n+r);var i,a=o-r;if(this===t&&n>r&&o>n)for(i=a-1;i>=0;i--)t[i+n]=this[i+r];else if(1e3>a||!e.TYPED_ARRAY_SUPPORT)for(i=0;a>i;i++)t[i+n]=this[i+r];else t._set(this.subarray(r,r+a),n);return a},e.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),t>n)throw new RangeError("end < start");if(n!==t&&0!==this.length){if(0>t||t>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof e)for(r=t;n>r;r++)this[r]=e;else{var o=$(e.toString()),i=o.length;for(r=t;n>r;r++)this[r]=o[r%i]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),n=0,r=t.length;r>n;n+=1)t[n]=this[n];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var Z=e.prototype;e._augment=function(t){return t.constructor=e,t._isBuffer=!0,t._set=t.set,t.get=Z.get,t.set=Z.set,t.write=Z.write,t.toString=Z.toString,t.toLocaleString=Z.toString,t.toJSON=Z.toJSON,t.equals=Z.equals,t.compare=Z.compare,t.indexOf=Z.indexOf,t.copy=Z.copy,t.slice=Z.slice,t.readUIntLE=Z.readUIntLE,t.readUIntBE=Z.readUIntBE,t.readUInt8=Z.readUInt8,t.readUInt16LE=Z.readUInt16LE,t.readUInt16BE=Z.readUInt16BE,t.readUInt32LE=Z.readUInt32LE,t.readUInt32BE=Z.readUInt32BE,t.readIntLE=Z.readIntLE,t.readIntBE=Z.readIntBE,t.readInt8=Z.readInt8,t.readInt16LE=Z.readInt16LE,t.readInt16BE=Z.readInt16BE,t.readInt32LE=Z.readInt32LE,t.readInt32BE=Z.readInt32BE,t.readFloatLE=Z.readFloatLE,t.readFloatBE=Z.readFloatBE,t.readDoubleLE=Z.readDoubleLE,t.readDoubleBE=Z.readDoubleBE,t.writeUInt8=Z.writeUInt8,t.writeUIntLE=Z.writeUIntLE,t.writeUIntBE=Z.writeUIntBE,t.writeUInt16LE=Z.writeUInt16LE,t.writeUInt16BE=Z.writeUInt16BE,t.writeUInt32LE=Z.writeUInt32LE,t.writeUInt32BE=Z.writeUInt32BE,t.writeIntLE=Z.writeIntLE,t.writeIntBE=Z.writeIntBE,t.writeInt8=Z.writeInt8,t.writeInt16LE=Z.writeInt16LE,t.writeInt16BE=Z.writeInt16BE,t.writeInt32LE=Z.writeInt32LE,t.writeInt32BE=Z.writeInt32BE,t.writeFloatLE=Z.writeFloatLE,t.writeFloatBE=Z.writeFloatBE,t.writeDoubleLE=Z.writeDoubleLE,t.writeDoubleBE=Z.writeDoubleBE,t.fill=Z.fill,t.inspect=Z.inspect,t.toArrayBuffer=Z.toArrayBuffer,t};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(154).Buffer,function(){return this}())},function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===a||t===f?62:t===u||t===p?63:s>t?-1:s+10>t?t-s+26+26:l+26>t?t-l:c+26>t?t-c+26:void 0}function n(e){function n(e){c[f++]=e}var r,o,a,u,s,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=e.length;s="="===e.charAt(l-2)?2:"="===e.charAt(l-1)?1:0,c=new i(3*e.length/4-s),a=s>0?e.length-4:e.length;var f=0;for(r=0,o=0;a>r;r+=4,o+=3)u=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&u)>>16),n((65280&u)>>8),n(255&u);return 2===s?(u=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&u)):1===s&&(u=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(u>>8&255),n(255&u)),c}function o(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var o,i,a,u=e.length%3,s="";for(o=0,a=e.length-u;a>o;o+=3)i=(e[o]<<16)+(e[o+1]<<8)+e[o+2],s+=n(i);switch(u){case 1:i=e[e.length-1],s+=t(i>>2),s+=t(i<<4&63),s+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],s+=t(i>>10),s+=t(i>>4&63),s+=t(i<<2&63),s+="="}return s}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),u="/".charCodeAt(0),s="0".charCodeAt(0),c="a".charCodeAt(0),l="A".charCodeAt(0),f="-".charCodeAt(0),p="_".charCodeAt(0);e.toByteArray=n,e.fromByteArray=o}(t)},function(e,t){t.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,c=s>>1,l=-7,f=n?o-1:0,p=n?-1:1,h=e[t+f];for(f+=p,i=h&(1<<-l)-1,h>>=-l,l+=u;l>0;i=256*i+e[t+f],f+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=p,l-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:(h?-1:1)*(1/0);a+=Math.pow(2,r),i-=c}return(h?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,u,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,d=r?1:-1,v=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),t+=a+f>=1?p/s:p*Math.pow(2,1-f),t*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(t*s-1)*Math.pow(2,o),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[n+h]=255&u,h+=d,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;e[n+h]=255&a,h+=d,a/=256,c-=8);e[n+h-d]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRack=t.CacheRack=t.KinveyRack=t.Rack=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function O(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:O(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=n(159),f=n(161),p=n(223),h=n(224),d=n(225),v=n(208),y=r(v),m=n(221),g=r(m),b=n(226),w=r(b),_=(0,w["default"])(),x=(0,w["default"])(),E=t.Rack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Rack":arguments[0];i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.middlewares=[],n.canceled=!1,n}return u(t,e),s(t,[{key:"getMiddleware",value:function(){var e=arguments.length<=0||void 0===arguments[0]?-1:arguments[0],t=this.middlewares;if(-1>e||e>=t.length)throw new Error("Index "+e+" is out of bounds.");return t[e]}},{key:"use",value:function(e){if(e){if(e instanceof l.KinveyMiddleware)return void this.middlewares.push(e);throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"useBefore",value:function(e,t){if(t){if(t instanceof l.Middleware){var n=this.middlewares,r=(0,y["default"])(n,function(t){return t instanceof e});return void(r>-1&&(n.splice(r,0,t),this.middlewares=n))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"useAfter",value:function(e,t){if(t){if(t instanceof l.Middleware){var n=this.middlewares,r=(0,y["default"])(n,function(t){return t instanceof e});return void(r>-1&&(n.splice(r+1,0,t),this.middlewares=n))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"swap",value:function(e,t){if(t){if(t instanceof l.Middleware){var n=this.middlewares,r=(0,y["default"])(n,function(t){return t instanceof e});return void(r>-1&&(n.splice(r,1,t),this.middlewares=n))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"remove",value:function(e){var t=this.middlewares,n=(0,y["default"])(t,function(t){return t instanceof e});n>-1&&(t.splice(n,1),this.middlewares=t,this.remove(e))}},{key:"reset",value:function(){this.middlewares=[]}},{key:"execute",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Request is null. Please provide a valid request.");case 2:return t.abrupt("return",(0,g["default"])(this.middlewares,function(e,t){return e.then(function(e){return t.handle(e)})},Promise.resolve(e)));case 3:case"end":return t.stop()}},n,this)}));return e}()},{key:"cancel",value:function(){this.canceled=!0}},{key:"handle",value:function(e){return this.execute(e)}},{key:"generateTree",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=c(Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,e),r=this.middlewares;return r.forEach(function(t){n.nodes.push(t.generateTree(e+1))}),n}}]),t}(l.KinveyMiddleware),k=t.KinveyRack=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return u(t,e),s(t,[{key:"execute",value:function(){function e(e){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c(Object.getPrototypeOf(t.prototype),"execute",this).call(this,e);case 2:return e=n.sent,n.abrupt("return",e.response);case 4:case"end":return n.stop()}},r,this)}));return e}()}]),t}(E);t.CacheRack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Cache Rack":arguments[0];i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.use(new f.CacheMiddleware),n}return u(t,e),s(t,null,[{key:"sharedInstance",value:function(){var e=this[_];return e||(e=new t,this[_]=e),e}}]),t}(k),t.NetworkRack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Network Rack":arguments[0];i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.use(new h.SerializeMiddleware),n.use(new d.HttpMiddleware),n.use(new p.ParseMiddleware),n}return u(t,e),s(t,null,[{key:"sharedInstance",value:function(){var e=this[x];return e||(e=new t,this[x]=e),e}}]),t}(k)},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyMiddleware=t.Middleware=void 0;var u=function f(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:f(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(160),l=t.Middleware=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"Middleware":arguments[0];a(this,e),this.name=t}return s(e,[{key:"handle",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Request is null. Please provide a valid request.");case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}},n,this)}));return e}()},{key:"generateTree",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t={value:this.name,level:e,nodes:[]};return t}},{key:"toString",value:function(){var e=this.generateTree();return c.AsciiTree.generate(e)}}]),e}();t.KinveyMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Middleware":arguments[0];return a(this,t),r(this,Object.getPrototypeOf(t).call(this,e))}return o(t,e),s(t,[{key:"handle",value:function(){function e(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",u(Object.getPrototypeOf(t.prototype),"handle",this).call(this,e));case 1:case"end":return n.stop()}},r,this)}));return e}()}]),t}(l)},function(e,t){"use strict";function n(e,t){if(0===e.level)return e.value;for(var n="\r\n",s=t?a:o,c=1;c<e.level;c++)n=""+n+(r[c]?" ":u),n+="  ";return""+n+s+i+" "+e.value}Object.defineProperty(t,"__esModule",{value:!0});var r=[],o=String.fromCharCode(9500),i=String.fromCharCode(9472),a=String.fromCharCode(9492),u=String.fromCharCode(9474);t.AsciiTree={generate:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],o=arguments[1],i=n(t,o);return t.nodes.length>0&&!function(){var n=t.nodes.length-1;t.nodes.forEach(function(t,o){r[t.level]=o===n,i+=e.generate(t,o===n)})}(),i}}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheMiddleware=t.DB=t.DBAdapter=void 0;var s=function U(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:U(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(12),f=n(11),p=n(162),h=r(p),d=n(166),v=n(210),y=n(214),m=n(9),g=n(163),b=n(159),w=n(153),_=n(217),x=n(218),E=r(x),k=n(215),O=r(k),j=n(140),R=r(j),S=n(221),T=r(S),I=n(14),A=r(I),P=n(36),q=r(P),C=n(35),D=r(C),N=e.env.KINVEY_ID_ATTRIBUTE||"_id",M=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd";E["default"].configure(Promise);var B=new E["default"](1,1/0),K={IndexedDB:"IndexedDB",LocalStorage:"LocalStorage",Memory:"Memory",WebSQL:"WebSQL"};Object.freeze(K),t.DBAdapter=K;var L=t.DB=function(){function e(t){var n=this,r=arguments.length<=1||void 0===arguments[1]?[K.IndexedDB,K.WebSQL,K.LocalStorage,K.Memory]:arguments[1];u(this,e),(0,D["default"])(r)||(r=[r]),(0,A["default"])(r,function(e){switch(e){case K.IndexedDB:if(h["default"].isSupported())return n.adapter=new h["default"](t),!1;break;case K.LocalStorage:if(d.LocalStorage.isSupported())return n.adapter=new d.LocalStorage(t),!1;break;case K.Memory:if(v.Memory.isSupported())return n.adapter=new v.Memory(t),!1;break;case K.WebSQL:if(y.WebSQL.isSupported())return n.adapter=new y.WebSQL(t),!1;break;default:g.Log.warn("The "+e+" adapter is is not recognized.")}return!0}),this.adapter||(v.Memory.isSupported()?(g.Log.error("Provided adapters are unsupported on this platform. Defaulting to the Memory adapter.",r),this.adapter=new v.Memory(t)):g.Log.error("Provided adapters are unsupported on this platform.",r))}return c(e,[{key:"generateObjectId",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?24:arguments[0],t="abcdef0123456789",n="",r=0,o=t.length;e>r;r++){var i=Math.floor(Math.random()*o);n+=t.substring(i,i+1)}return n=""+this.objectIdPrefix+n}},{key:"find",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(e,t){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.adapter.find(e);case 3:if(r=n.sent){
n.next=6;break}return n.abrupt("return",[]);case 6:return!t||t instanceof l.Query||(t=new l.Query((0,R["default"])(t,"toJSON",t))),r.length>0&&t&&(r=t.process(r)),n.abrupt("return",r);case 11:if(n.prev=11,n.t0=n["catch"](0),!(n.t0 instanceof m.NotFoundError)){n.next=15;break}return n.abrupt("return",[]);case 15:throw n.t0;case 16:case"end":return n.stop()}},n,this,[[0,11]])}));return e}()},{key:"count",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(e,t){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e,t);case 2:return r=n.sent,n.abrupt("return",{count:r.length});case 4:case"end":return n.stop()}},n,this)}));return e}()},{key:"group",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(e,t){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e);case 2:if(r=n.sent,t instanceof f.Aggregation||(t=new f.Aggregation((0,R["default"])(t,"toJSON",t))),!(r.length>0&&t)){n.next=6;break}return n.abrupt("return",t.process(r));case 6:return n.abrupt("return",null);case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(e,t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,(0,q["default"])(t)){n.next=3;break}throw new m.KinveyError("id must be a string",t);case 3:return n.abrupt("return",this.adapter.findById(e,t));case 6:if(n.prev=6,n.t0=n["catch"](0),!(n.t0 instanceof m.NotFoundError)){n.next=10;break}return n.abrupt("return",void 0);case 10:throw n.t0;case 11:case"end":return n.stop()}},n,this,[[0,6]])}));return e}()},{key:"save",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return B.add(a(regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=!1,n){r.next=3;break}return r.abrupt("return",null);case 3:return(0,D["default"])(n)||(o=!0,n=[n]),n=(0,O["default"])(n,function(e){var n=e[N],r=e[M]||{};return n||(n=t.generateObjectId(),r.local=!0),e[N]=n,e[M]=r,e}),r.next=7,t.adapter.save(e,n);case 7:if(n=r.sent,!(o&&n.length>0)){r.next=10;break}return r.abrupt("return",n[0]);case 10:return r.abrupt("return",n);case 11:case"end":return r.stop()}},r,t)})))}},{key:"remove",value:function(){function e(e,n){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(e,t){var r,o,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return!t||t instanceof l.Query||(t=new l.Query(t)),t&&(t.sort=null,t.limit=null,t.skip=0),n.next=4,this.find(e,t);case 4:return r=n.sent,n.next=7,Promise.all(r.map(function(t){return i.removeById(e,t[N])}));case 7:return o=n.sent,n.abrupt("return",(0,T["default"])(o,function(e,t){return e.push(t),e},[]));case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeById",value:function(e,t){var n=this;return B.add(function(){if(t){if(!(0,q["default"])(t))throw new m.KinveyError("id must be a string",t);return n.adapter.removeById(e,t)}})}},{key:"clear",value:function(){var e=this;return B.add(function(){return e.adapter.clear()})}},{key:"objectIdPrefix",get:function(){return""}}]),e}();t.CacheMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?[K.IndexedDB,K.WebSQL,K.LocalStorage,K.Memory]:arguments[0];u(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,"Kinvey Cache Middleware"));return n.adapters=e,n}return i(t,e),c(t,[{key:"handle",value:function(){function e(e){return n.apply(this,arguments)}var n=a(regeneratorRuntime.mark(function r(e){var n,o,i,a,u,c,l,f,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s(Object.getPrototypeOf(t.prototype),"handle",this).call(this,e);case 2:if(e=r.sent,n=e,o=n.method,i=n.query,a=n.body,u=n.appKey,c=n.collection,l=n.entityId,f=new L(u,this.adapters),p=void 0,o!==w.RequestMethod.GET){r.next=36;break}if(!l){r.next=31;break}if("_count"!==l){r.next=20;break}return r.next=17,f.count(c,i);case 17:p=r.sent,r.next=29;break;case 20:if("_group"!==l){r.next=26;break}return r.next=23,f.group(c,a);case 23:p=r.sent,r.next=29;break;case 26:return r.next=28,f.findById(c,e.entityId);case 28:p=r.sent;case 29:r.next=34;break;case 31:return r.next=33,f.find(c,i);case 33:p=r.sent;case 34:r.next=58;break;case 36:if(o!==w.RequestMethod.POST&&o!==w.RequestMethod.PUT){r.next=42;break}return r.next=39,f.save(c,a);case 39:p=r.sent,r.next=58;break;case 42:if(o!==w.RequestMethod.DELETE){r.next=58;break}if(!c||!l){r.next=49;break}return r.next=46,f.removeById(c,l);case 46:p=r.sent,r.next=58;break;case 49:if(c){r.next=55;break}return r.next=52,f.clear();case 52:p=r.sent,r.next=58;break;case 55:return r.next=57,f.remove(c,i);case 57:p=r.sent;case 58:return e.response={statusCode:o===w.RequestMethod.POST?_.StatusCode.Created:_.StatusCode.Ok,headers:{},data:p},p||(e.response.statusCode=_.StatusCode.Empty),r.abrupt("return",e);case 61:case"end":return r.stop()}},r,this)}));return e}()}]),t}(b.KinveyMiddleware)}).call(t,n(2))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(9),s=n(163),c=n(14),l=r(c),f=n(36),p=r(f),h=n(35),d=r(h),v=n(31),y=r(v),m={};"undefined"!=typeof window&&n(165);var g=e.shimIndexedDB||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,b={ReadWrite:"readwrite",ReadOnly:"readonly"};Object.freeze(b);var w=function(){function e(t){if(i(this,e),!t)throw new u.KinveyError("A name for the collection is required to use the indexeddb persistence adapter.",t);if(!(0,p["default"])(t))throw new u.KinveyError("The name of the collection must be a string to use the indexeddb persistence adapter",t);this.name=t,this.inTransaction=!1,this.queue=[]}return a(e,[{key:"openTransaction",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=arguments[2],r=this,o=arguments[3],i=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],a=m[this.name];if(a){var s=(0,y["default"])(a.objectStoreNames.contains)?a.objectStoreNames.contains(e):-1!==a.objectStoreNames.indexOf(e);if(s)try{var c=t?b.ReadWrite:b.ReadOnly,f=a.transaction(e,c);if(f)return n(f);throw new u.KinveyError("Unable to open a transaction for the "+e+(" collection on the "+this.name+" indexedDB database."))}catch(p){return o(p)}else if(!t)return o(new u.NotFoundError("The "+e+" collection was not found on"+(" the "+this.name+" indexedDB database.")))}if(!i&&this.inTransaction)return this.queue.push(function(){r.openTransaction(e,t,n,o)});this.inTransaction=!0;var h=void 0;if(a){var d=a.version+1;a.close(),h=g.open(this.name,d)}else h=g.open(this.name);return h.onupgradeneeded=function(n){a=n.target.result,m[r.name]=a,t&&a.createObjectStore(e,{keyPath:"_id"})},h.onsuccess=function(i){a=i.target.result,m[r.name]=a,a.onversionchange=function(){a&&(a.close(),a=null,m[r.name]=null)};var u=function(e){var t=function(t){if(e(t),r.inTransaction=!1,r.queue.length>0){var n=r.queue;r.queue=[],(0,l["default"])(n,function(e){e.call(r)})}};return t};return r.openTransaction(e,t,u(n),u(o),!0)},h.onblocked=function(){o(new u.KinveyError("The "+r.name+" indexedDB database version can't be upgraded because the database is already open."))},h.onerror=function(e){o(new u.KinveyError("Unable to open the "+r.name+" indexedDB database. "+(e.target.error.message+".")))},h}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,r){t.openTransaction(e,!1,function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:o=r.objectStore(e),a=o.openCursor(),u=[],a.onsuccess=function(e){var t=e.target.result;return t?(u.push(t.value),t["continue"]()):n(u)},a.onerror=function(r){s.Log.error("An error occurred while trying to find entities for the "+e+" collection"+(" on the "+t.name+" IndexedDB database. "+r.targer.error.message+".")),n([])};case 5:case"end":return i.stop()}},i,t)}));return function(e){return r.apply(this,arguments)}}(),r)}));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,i){r.openTransaction(e,!1,function(){var a=o(regeneratorRuntime.mark(function s(o){var a,c;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=o.objectStore(e),c=a.get(t),c.onsuccess=function(o){var a=o.target.result;a?n(a):i(new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+r.name+" indexedDB database.")))},c.onerror=function(){i(new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+r.name+" indexedDB database.")))};case 4:case"end":return s.stop()}},s,r)}));return function(e){return a.apply(this,arguments)}}(),i)}));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"save",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!1,(0,d["default"])(t)||(r=!0,t=[t]),0!==t.length){n.next=4;break}return n.abrupt("return",null);case 4:return n.abrupt("return",new Promise(function(n,a){i.openTransaction(e,!0,function(){var s=o(regeneratorRuntime.mark(function c(o){var s;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:s=o.objectStore(e),(0,l["default"])(t,function(e){s.put(e)}),o.oncomplete=function(){n(r?t[0]:t)},o.onerror=function(t){a(new u.KinveyError("An error occurred while saving the entities to the "+e+(" collection on the "+i.name+" indexedDB database. "+t.target.error.message+".")))};case 4:case"end":return c.stop()}},c,i)}));return function(e){return s.apply(this,arguments)}}(),a)}));case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,i){r.openTransaction(e,!0,function(){var a=o(regeneratorRuntime.mark(function s(o){var a,c;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=o.objectStore(e),c=a.get(t),a["delete"](t),o.oncomplete=function(){var o=c.result;o?n(o):i(new u.NotFoundError("An entity with id = "+t+" was not found in the "+e+(" collection on the "+r.name+" indexedDB database.")))},o.onerror=function(){i(new u.NotFoundError("An entity with id = "+t+" was not found in the "+e+(" collection on the "+r.name+" indexedDB database.")))};case 5:case"end":return s.stop()}},s,r)}));return function(e){return a.apply(this,arguments)}}(),i)}));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){var r=g.deleteDatabase(e.name);r.onsuccess=function(){m={},t()},r.onerror=function(t){n(new u.KinveyError("An error occurred while clearing the "+e.name+" indexedDB database."+(" "+t.target.error.message+".")))}}));case 1:case"end":return t.stop()}},n,this)}));return e}()}],[{key:"isSupported",value:function(){return!!g}}]),e}();t["default"]=w}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var o=n(164),i=r(o),a=i["default"].methodFactory;i["default"].methodFactory=function(e,t,n){var r=a(e,t,n);return function(e){r("Kinvey: "+e)}},i["default"].setDefaultLevel(i["default"].levels.SILENT),t.Log=i["default"]},function(e,t,n){var r,o;!function(i,a){"use strict";r=a,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o))}(this,function(){"use strict";function e(e){return typeof console===u?!1:void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):a}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t,n){return function(){typeof console!==u&&(r.call(this,t,n),this[e].apply(this,arguments))}}function r(e,t){for(var n=0;n<s.length;n++){var r=s[n];this[r]=e>n?a:this.methodFactory(r,e,t)}}function o(t,r,o){return e(t)||n.apply(this,arguments)}function i(e,t,n){function i(e){var t=(s[e]||"silent").toUpperCase();try{return void(window.localStorage[f]=t)}catch(n){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(n){}}function a(){var e;try{e=window.localStorage[f]}catch(t){}if(typeof e===u)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(f)+"=");r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(t){}return void 0===l.levels[e]&&(e=void 0),e}var c,l=this,f="loglevel";e&&(f+=":"+e),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=n||o,l.getLevel=function(){return c},l.setLevel=function(t,n){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;return c=t,n!==!1&&i(t),r.call(l,t,e),typeof console===u&&t<l.levels.SILENT?"No console available for logging":void 0},l.setDefaultLevel=function(e){a()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var p=a();null==p&&(p=null==t?"WARN":t),l.setLevel(p,!1)}var a=function(){},u="undefined",s=["trace","debug","info","warn","error"],c=new i,l={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==u?window.log:void 0;return c.noConflict=function(){return typeof window!==u&&window.log===c&&(window.log=f),c},c})},function(module,exports){var idbModules={util:{cleanInterface:!1}};!function(){"use strict";var e={test:!0};if(Object.defineProperty)try{Object.defineProperty(e,"test",{enumerable:!1}),e.test&&(idbModules.util.cleanInterface=!0)}catch(t){}}(),function(e){"use strict";function t(e,t,n){n.target=t,"function"==typeof t[e]&&t[e].apply(t,[n])}var n=function(){this.length=0,this._items=[],e.util.cleanInterface&&Object.defineProperty(this,"_items",{enumerable:!1})};if(n.prototype={contains:function(e){return-1!==this._items.indexOf(e)},item:function(e){return this._items[e]},indexOf:function(e){return this._items.indexOf(e)},push:function(e){this._items.push(e),this.length+=1;for(var t=0;t<this._items.length;t++)this[t]=this._items[t]},splice:function(){this._items.splice.apply(this._items,arguments),this.length=this._items.length;for(var e in this)e===String(parseInt(e,10))&&delete this[e];for(e=0;e<this._items.length;e++)this[e]=this._items[e]}},e.util.cleanInterface)for(var r in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(n.prototype,r,{enumerable:!1});e.util.callback=t,e.util.StringList=n,e.util.quote=function(e){return'"'+e+'"'}}(idbModules),function(e){"use strict";function t(){(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/))&&n()}function n(){var e=IDBFactory.prototype.cmp,t=IDBDatabase.prototype.createObjectStore,n=IDBObjectStore.prototype.createIndex,i=IDBObjectStore.prototype.add,c=IDBObjectStore.prototype.put,l=IDBIndex.prototype.get,f=IDBIndex.prototype.getKey,p=IDBIndex.prototype.openCursor,h=IDBIndex.prototype.openKeyCursor,d=IDBObjectStore.prototype.get,v=IDBObjectStore.prototype["delete"],y=IDBObjectStore.prototype.openCursor,m=IDBObjectStore.prototype.openKeyCursor,g=IDBKeyRange.bound,b=IDBKeyRange.upperBound,w=IDBKeyRange.lowerBound,_=IDBKeyRange.only,x=Object.getOwnPropertyDescriptor(IDBRequest.prototype,"result"),E=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"primaryKey"),k=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"key"),O=Object.getOwnPropertyDescriptor(IDBCursorWithValue.prototype,"value");IDBFactory.prototype.cmp=function(t,n){var r=Array.prototype.slice.call(arguments);return t instanceof Array&&(r[0]=s(t)),n instanceof Array&&(r[1]=s(n)),e.apply(this,r)},IDBDatabase.prototype.createObjectStore=function(e,n){return n&&n.keyPath instanceof Array&&(n.keyPath=o(n.keyPath)),t.apply(this,arguments)},IDBObjectStore.prototype.createIndex=function(e,t,r){var i=Array.prototype.slice.call(arguments);return t instanceof Array&&(i[1]=o(t)),n.apply(this,i)},IDBObjectStore.prototype.add=function(e,t){return this.__insertData(i,arguments)},IDBObjectStore.prototype.put=function(e,t){return this.__insertData(c,arguments)},IDBObjectStore.prototype.__insertData=function(e,t){t=Array.prototype.slice.call(t);var n=t[0],o=t[1];if(o instanceof Array&&(t[1]=s(o)),"object"==typeof n){r(this.keyPath)&&a(n,this.keyPath);for(var i=0;i<this.indexNames.length;i++){var u=this.index(this.indexNames[i]);if(r(u.keyPath))try{a(n,u.keyPath)}catch(c){}}}return e.apply(this,t)},IDBIndex.prototype.get=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),l.apply(this,t)},IDBIndex.prototype.getKey=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),f.apply(this,t)},IDBIndex.prototype.openCursor=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),p.apply(this,t)},IDBIndex.prototype.openKeyCursor=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),h.apply(this,t)},IDBObjectStore.prototype.get=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),d.apply(this,t)},IDBObjectStore.prototype["delete"]=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),v.apply(this,t)},IDBObjectStore.prototype.openCursor=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),y.apply(this,t)},IDBObjectStore.prototype.openKeyCursor=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),m.apply(this,t)},IDBKeyRange.bound=function(e,t,n,r){var o=Array.prototype.slice.call(arguments);return e instanceof Array&&(o[0]=s(e)),t instanceof Array&&(o[1]=s(t)),g.apply(IDBKeyRange,o)},IDBKeyRange.upperBound=function(e,t){var n=Array.prototype.slice.call(arguments);return e instanceof Array&&(n[0]=s(e)),b.apply(IDBKeyRange,n)},IDBKeyRange.lowerBound=function(e,t){var n=Array.prototype.slice.call(arguments);return e instanceof Array&&(n[0]=s(e)),w.apply(IDBKeyRange,n)},IDBKeyRange.only=function(e){var t=Array.prototype.slice.call(arguments);return e instanceof Array&&(t[0]=s(e)),_.apply(IDBKeyRange,t)},Object.defineProperty(IDBRequest.prototype,"result",{enumerable:x.enumerable,configurable:x.configurable,get:function(){var e=x.get.call(this);return u(e)}}),Object.defineProperty(IDBCursor.prototype,"primaryKey",{enumerable:E.enumerable,configurable:E.configurable,get:function(){var e=E.get.call(this);return u(e)}}),Object.defineProperty(IDBCursor.prototype,"key",{enumerable:k.enumerable,configurable:k.configurable,get:function(){var e=k.get.call(this);return u(e)}}),Object.defineProperty(IDBCursorWithValue.prototype,"value",{enumerable:O.enumerable,configurable:O.configurable,get:function(){var e=O.get.call(this);return u(e)}});try{IDBTransaction.VERSION_CHANGE||(IDBTransaction.VERSION_CHANGE="versionchange")}catch(j){}}function r(e){return e&&0===e.indexOf(f+".")}function o(e){for(var t=0;t<e.length;t++)e[t]=e[t].replace(/\./g,h);return f+"."+e.join(d)}function i(e){e=e.substr(f.length+1),e=e.split(d);for(var t=0;t<e.length;t++)e[t]=e[t].replace(p,".");return e}function a(t,n){var r=i(n),o=e.Key.getValue(t,r),a=s(o);n=n.substr(f.length+1),t[f]=t[f]||{},t[f][n]=a}function u(e){return"string"==typeof e&&r(e)?c(e):(e&&"object"==typeof e[f]&&delete e[f],e)}function s(t){return e.Key.validate(t),t=e.Key.encode(t),t=f+"."+t,l(t),t}function c(t){return l(t),t=t.substr(f.length+1),t=e.Key.decode(t)}function l(t){if(t.length>889)throw e.util.createDOMException("DataError","The encoded key is "+t.length+" characters long, but IE only allows 889 characters. Consider replacing numeric keys with strings to reduce the encoded length.")}var f="__$$compoundKey",p=/\$\$/g,h="$$$$",d="$_$";e.polyfill=t}(idbModules),function(idbModules){"use strict";var Sca=function(){return{decycle:function(object,callback){function checkForCompletion(){0===queuedObjects.length&&returnCallback(derezObj)}function readBlobAsDataURL(e,t){var n=new FileReader;n.onloadend=function(n){var r=n.target.result,o="Blob";e instanceof File,updateEncodedBlob(r,t,o)},n.readAsDataURL(e)}function updateEncodedBlob(dataURL,path,blobtype){var encoded=queuedObjects.indexOf(path);path=path.replace("$","derezObj"),eval(path+'.$enc="'+dataURL+'"'),eval(path+'.$type="'+blobtype+'"'),queuedObjects.splice(encoded,1),checkForCompletion()}function derez(e,t){var n,r,o;if(!("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof Blob||e instanceof String)){for(n=0;n<objects.length;n+=1)if(objects[n]===e)return{$ref:paths[n]};if(objects.push(e),paths.push(t),"[object Array]"===Object.prototype.toString.apply(e))for(o=[],n=0;n<e.length;n+=1)o[n]=derez(e[n],t+"["+n+"]");else{o={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=derez(e[r],t+"["+JSON.stringify(r)+"]"))}return o}return e instanceof Blob?(queuedObjects.push(t),readBlobAsDataURL(e,t)):e instanceof Boolean?e={$type:"Boolean",$enc:e.toString()}:e instanceof Date?e={$type:"Date",$enc:e.getTime()}:e instanceof Number?e={$type:"Number",$enc:e.toString()}:e instanceof RegExp?e={$type:"RegExp",$enc:e.toString()}:"number"==typeof e?e={$type:"number",$enc:e+""}:void 0===e&&(e={$type:"undefined"}),e}var objects=[],paths=[],queuedObjects=[],returnCallback=callback,derezObj=derez(object,"$");checkForCompletion()},retrocycle:function retrocycle($){function dataURLToBlob(e){var t,n,r,o=";base64,";if(-1===e.indexOf(o))return n=e.split(","),t=n[0].split(":")[1],r=n[1],new Blob([r],{type:t});n=e.split(o),t=n[0].split(":")[1],r=window.atob(n[1]);for(var i=r.length,a=new Uint8Array(i),u=0;i>u;++u)a[u]=r.charCodeAt(u);return new Blob([a.buffer],{type:t})}function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;i<value.length;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[i]=eval(path):value[i]=rez(item));else if(void 0!==value.$type)switch(value.$type){case"Blob":case"File":value=dataURLToBlob(value.$enc);break;case"Boolean":value=Boolean("true"===value.$enc);break;case"Date":value=new Date(value.$enc);break;case"Number":value=Number(value.$enc);break;case"RegExp":value=eval(value.$enc);break;case"number":value=parseFloat(value.$enc);break;case"undefined":value=void 0}else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[name]=eval(path):value[name]=rez(item)));return value}var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return rez($)},encode:function(e,t){function n(e){t(JSON.stringify(e))}this.decycle(e,n)},decode:function(e){return this.retrocycle(JSON.parse(e))}}}();idbModules.Sca=Sca}(idbModules),function(idbModules){"use strict";function padBase32Exponent(e){return e=e.toString(32),1===e.length?"0"+e:e}function padBase32Mantissa(e){return(e+zeros(11)).slice(0,11)}function flipBase32(e){for(var t="",n=0;n<e.length;n++)t+=(31-parseInt(e[n],32)).toString(32);return t}function pow32(e,t){var n,r,o;return t=parseInt(t,32),0>t?roundToPrecision(parseInt(e,32)*Math.pow(32,t-10)):11>t?(n=e.slice(0,t),n=parseInt(n,32),r=e.slice(t),r=parseInt(r,32)*Math.pow(32,t-11),roundToPrecision(n+r)):(o=e+zeros(t-11),parseInt(o,32))}function roundToPrecision(e,t){return t=t||16,parseFloat(e.toPrecision(t))}function zeros(e){for(var t="";e--;)t+="0";return t}function negate(e){return"-"+e}function getType(e){return e instanceof Date?"date":e instanceof Array?"array":typeof e}function validate(e){var t=getType(e);if("array"===t)for(var n=0;n<e.length;n++)validate(e[n]);else if(!types[t]||"string"!==t&&isNaN(e))throw idbModules.util.createDOMException("DataError","Not a valid key")}function getValue(source,keyPath){try{if(keyPath instanceof Array){for(var arrayValue=[],i=0;i<keyPath.length;i++)arrayValue.push(eval("source."+keyPath[i]));return arrayValue}return eval("source."+keyPath)}catch(e){return}}function setValue(e,t,n){for(var r=t.split("."),o=0;o<r.length-1;o++){var i=r[o];e=e[i]=e[i]||{}}e[r[r.length-1]]=n}function isMultiEntryMatch(e,t){var n=collations[t.substring(0,1)];return"array"===n?t.indexOf(e)>1:t===e}function isKeyInRange(e,t){var n=void 0===t.lower,r=void 0===t.upper,o=idbModules.Key.encode(e,!0);return void 0!==t.lower&&(t.lowerOpen&&o>t.__lower&&(n=!0),!t.lowerOpen&&o>=t.__lower&&(n=!0)),void 0!==t.upper&&(t.upperOpen&&o<t.__upper&&(r=!0),!t.upperOpen&&o<=t.__upper&&(r=!0)),n&&r}function findMultiEntryMatches(e,t){var n=[];if(e instanceof Array)for(var r=0;r<e.length;r++){var o=e[r];if(o instanceof Array){if(t.lower===t.upper)continue;if(1!==o.length){var i=findMultiEntryMatches(o,t);i.length>0&&n.push(o);continue}o=o[0]}isKeyInRange(o,t)&&n.push(o)}else isKeyInRange(e,t)&&n.push(e);return n}var collations=["undefined","number","date","string","array"],signValues=["negativeInfinity","bigNegative","smallNegative","smallPositive","bigPositive","positiveInfinity"],types={undefined:{encode:function(e){return collations.indexOf("undefined")+"-"},decode:function(e){}},date:{encode:function(e){return collations.indexOf("date")+"-"+e.toJSON()},decode:function(e){return new Date(e.substring(2))}},number:{encode:function(e){var t=Math.abs(e).toString(32),n=t.indexOf(".");t=-1!==n?t.replace(".",""):t;var r=t.search(/[^0]/);t=t.slice(r);var o,i=zeros(2),a=zeros(11);return isFinite(e)?0>e?e>-1?(o=signValues.indexOf("smallNegative"),i=padBase32Exponent(r),a=flipBase32(padBase32Mantissa(t))):(o=signValues.indexOf("bigNegative"),i=flipBase32(padBase32Exponent(-1!==n?n:t.length)),a=flipBase32(padBase32Mantissa(t))):1>e?(o=signValues.indexOf("smallPositive"),i=flipBase32(padBase32Exponent(r)),a=padBase32Mantissa(t)):(o=signValues.indexOf("bigPositive"),i=padBase32Exponent(-1!==n?n:t.length),a=padBase32Mantissa(t)):o=signValues.indexOf(e>0?"positiveInfinity":"negativeInfinity"),collations.indexOf("number")+"-"+o+i+a},decode:function(e){var t=+e.substr(2,1),n=e.substr(3,2),r=e.substr(5,11);switch(signValues[t]){case"negativeInfinity":return-(1/0);case"positiveInfinity":return 1/0;case"bigPositive":return pow32(r,n);case"smallPositive":return n=negate(flipBase32(n)),pow32(r,n);case"smallNegative":return n=negate(n),r=flipBase32(r),-pow32(r,n);case"bigNegative":return n=flipBase32(n),r=flipBase32(r),-pow32(r,n);default:throw new Error("Invalid number.")}}},string:{encode:function(e,t){return t&&(e=e.replace(/(.)/g,"-$1")+" "),collations.indexOf("string")+"-"+e},decode:function(e,t){return e=e.substring(2),t&&(e=e.substr(0,e.length-1).replace(/-(.)/g,"$1")),e}},array:{encode:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=idbModules.Key.encode(r,!0);t[n]=o}return t.push(collations.indexOf("undefined")+"-"),collations.indexOf("array")+"-"+JSON.stringify(t)},decode:function(e){var t=JSON.parse(e.substring(2));t.pop();for(var n=0;n<t.length;n++){var r=t[n],o=idbModules.Key.decode(r,!0);t[n]=o}return t}}};idbModules.Key={encode:function(e,t){return void 0===e?null:types[getType(e)].encode(e,t)},decode:function(e,t){return"string"==typeof e?types[collations[e.substring(0,1)]].decode(e,t):void 0},validate:validate,getValue:getValue,setValue:setValue,isMultiEntryMatch:isMultiEntryMatch,findMultiEntryMatches:findMultiEntryMatches}}(idbModules),function(e){"use strict";function t(e,t){var n=new Event(e);return n.debug=t,Object.defineProperty(n,"target",{writable:!0}),n}function n(e,t){this.type=e,this.debug=t,this.bubbles=!1,this.cancelable=!1,this.eventPhase=0,this.timeStamp=(new Date).valueOf()}var r=!1;try{var o=t("test type","test debug"),i={test:"test target"};o.target=i,o instanceof Event&&"test type"===o.type&&"test debug"===o.debug&&o.target===i&&(r=!0)}catch(a){}r?(e.Event=Event,e.IDBVersionChangeEvent=Event,e.util.createEvent=t):(e.Event=n,e.IDBVersionChangeEvent=n,e.util.createEvent=function(e,t){return new n(e,t)})}(idbModules),function(e){"use strict";function t(e,t){var n=new DOMException.prototype.constructor(0,t);return n.name=e||"DOMException",n.message=t,n}function n(e,t){e=e||"DOMError";var n=new DOMError(e,t);return n.name===e||(n.name=e),n.message===t||(n.message=t),n}function r(e,t){var n=new Error(t);return n.name=e||"DOMException",n.message=t,n}e.util.logError=function(t,n,r){if(e.DEBUG){r&&r.message&&(r=r.message);var o="function"==typeof console.error?"error":"log";console[o](t+": "+n+". "+(r||"")),console.trace&&console.trace()}},e.util.findError=function(e){var t;if(e){if(1===e.length)return e[0];for(var n=0;n<e.length;n++){var r=e[n];if(r instanceof Error||r instanceof DOMException)return r;r&&"string"==typeof r.message&&(t=r)}}return t};var o,i=!1,a=!1;try{o=t("test name","test message"),o instanceof DOMException&&"test name"===o.name&&"test message"===o.message&&(i=!0)}catch(u){}try{o=n("test name","test message"),o instanceof DOMError&&"test name"===o.name&&"test message"===o.message&&(a=!0)}catch(u){}i?(e.DOMException=DOMException,e.util.createDOMException=function(n,r,o){return e.util.logError(n,r,o),t(n,r)}):(e.DOMException=Error,e.util.createDOMException=function(t,n,o){return e.util.logError(t,n,o),r(t,n)}),a?(e.DOMError=DOMError,e.util.createDOMError=function(t,r,o){return e.util.logError(t,r,o),n(t,r)}):(e.DOMError=Error,e.util.createDOMError=function(t,n,o){return e.util.logError(t,n,o),r(t,n)})}(idbModules),function(e){"use strict";function t(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null,this.readyState="pending"}function n(){this.onblocked=this.onupgradeneeded=null}n.prototype=new t,n.prototype.constructor=n,e.IDBRequest=t,e.IDBOpenDBRequest=n}(idbModules),function(e,t){"use strict";function n(n,r,o,i){n!==t&&e.Key.validate(n),r!==t&&e.Key.validate(r),this.lower=n,this.upper=r,this.lowerOpen=!!o,this.upperOpen=!!i}
n.only=function(e){return new n(e,e,!1,!1)},n.lowerBound=function(e,r){return new n(e,t,r,t)},n.upperBound=function(e,r){return new n(t,e,t,r)},n.bound=function(e,t,r,o){return new n(e,t,r,o)},e.IDBKeyRange=n}(idbModules),function(e,t){"use strict";function n(n,r,o,i,a,u,s){if(null===n&&(n=t),n===t||n instanceof e.IDBKeyRange||(n=new e.IDBKeyRange(n,n,!1,!1)),o.transaction.__assertActive(),r!==t&&-1===["next","prev","nextunique","prevunique"].indexOf(r))throw new TypeError(r+"is not a valid cursor direction");this.source=i,this.direction=r||"next",this.key=t,this.primaryKey=t,this.__store=o,this.__range=n,this.__req=new e.IDBRequest,this.__keyColumnName=a,this.__valueColumnName=u,this.__valueDecoder="value"===u?e.Sca:e.Key,this.__count=s,this.__offset=-1,this.__lastKeyContinued=t,this.__multiEntryIndex=i instanceof e.IDBIndex?i.multiEntry:!1,this.__unique=-1!==this.direction.indexOf("unique"),n!==t&&(n.__lower=n.lower!==t&&e.Key.encode(n.lower,this.__multiEntryIndex),n.__upper=n.upper!==t&&e.Key.encode(n.upper,this.__multiEntryIndex)),this["continue"]()}n.prototype.__find=function(){var e=Array.prototype.slice.call(arguments);this.__multiEntryIndex?this.__findMultiEntry.apply(this,e):this.__findBasic.apply(this,e)},n.prototype.__findBasic=function(n,r,o,i,a){a=a||1;var u=this,s=e.util.quote(u.__keyColumnName),c=["SELECT * FROM",e.util.quote(u.__store.name)],l=[];c.push("WHERE",s,"NOT NULL"),!u.__range||u.__range.lower===t&&u.__range.upper===t||(c.push("AND"),u.__range.lower!==t&&(c.push(s,u.__range.lowerOpen?">":">=","?"),l.push(u.__range.__lower)),u.__range.lower!==t&&u.__range.upper!==t&&c.push("AND"),u.__range.upper!==t&&(c.push(s,u.__range.upperOpen?"<":"<=","?"),l.push(u.__range.__upper))),"undefined"!=typeof n&&(u.__lastKeyContinued=n,u.__offset=0),u.__lastKeyContinued!==t&&(c.push("AND",s,">= ?"),e.Key.validate(u.__lastKeyContinued),l.push(e.Key.encode(u.__lastKeyContinued)));var f="prev"===u.direction||"prevunique"===u.direction?"DESC":"ASC";u.__count||(c.push("ORDER BY",s,f),c.push("LIMIT",a,"OFFSET",u.__offset)),c=c.join(" "),e.DEBUG&&console.log(c,l),u.__prefetchedData=null,u.__prefetchedIndex=0,r.executeSql(c,l,function(n,r){u.__count?o(t,r.rows.length,t):r.rows.length>1?(u.__prefetchedData=r.rows,u.__prefetchedIndex=0,e.DEBUG&&console.log("Preloaded "+u.__prefetchedData.length+" records for cursor"),u.__decode(r.rows.item(0),o)):1===r.rows.length?u.__decode(r.rows.item(0),o):(e.DEBUG&&console.log("Reached end of cursors"),o(t,t,t))},function(t,n){e.DEBUG&&console.log("Could not execute Cursor.continue",c,l),i(n)})},n.prototype.__findMultiEntry=function(n,r,o,i){var a=this;if(a.__prefetchedData&&a.__prefetchedData.length===a.__prefetchedIndex)return e.DEBUG&&console.log("Reached end of multiEntry cursor"),void o(t,t,t);var u=e.util.quote(a.__keyColumnName),s=["SELECT * FROM",e.util.quote(a.__store.name)],c=[];s.push("WHERE",u,"NOT NULL"),a.__range&&a.__range.lower!==t&&a.__range.upper!==t&&0===a.__range.upper.indexOf(a.__range.lower)&&(s.push("AND",u,"LIKE ?"),c.push("%"+a.__range.__lower.slice(0,-1)+"%")),"undefined"!=typeof n&&(a.__lastKeyContinued=n,a.__offset=0),a.__lastKeyContinued!==t&&(s.push("AND",u,">= ?"),e.Key.validate(a.__lastKeyContinued),c.push(e.Key.encode(a.__lastKeyContinued)));var l="prev"===a.direction||"prevunique"===a.direction?"DESC":"ASC";a.__count||s.push("ORDER BY key",l),s=s.join(" "),e.DEBUG&&console.log(s,c),a.__prefetchedData=null,a.__prefetchedIndex=0,r.executeSql(s,c,function(n,r){if(a.__multiEntryOffset=r.rows.length,r.rows.length>0){for(var i=[],u=0;u<r.rows.length;u++)for(var s=r.rows.item(u),c=e.Key.decode(s[a.__keyColumnName],!0),l=e.Key.findMultiEntryMatches(c,a.__range),f=0;f<l.length;f++){var p=l[f],h={matchingKey:e.Key.encode(p,!0),key:s.key};h[a.__keyColumnName]=s[a.__keyColumnName],h[a.__valueColumnName]=s[a.__valueColumnName],i.push(h)}var d=0===a.direction.indexOf("prev");i.sort(function(e,t){return e.matchingKey.replace("[","z")<t.matchingKey.replace("[","z")?d?1:-1:e.matchingKey.replace("[","z")>t.matchingKey.replace("[","z")?d?-1:1:e.key<t.key?"prev"===a.direction?1:-1:e.key>t.key?"prev"===a.direction?-1:1:0}),a.__prefetchedData={data:i,length:i.length,item:function(e){return this.data[e]}},a.__prefetchedIndex=0,a.__count?o(t,i.length,t):i.length>1?(e.DEBUG&&console.log("Preloaded "+a.__prefetchedData.length+" records for multiEntry cursor"),a.__decode(i[0],o)):1===i.length?(e.DEBUG&&console.log("Reached end of multiEntry cursor"),a.__decode(i[0],o)):(e.DEBUG&&console.log("Reached end of multiEntry cursor"),o(t,t,t))}else e.DEBUG&&console.log("Reached end of multiEntry cursor"),o(t,t,t)},function(t,n){e.DEBUG&&console.log("Could not execute Cursor.continue",s,c),i(n)})},n.prototype.__onsuccess=function(e){var n=this;return function(r,o,i){if(n.__count)e(o,n.__req);else{n.key=r===t?null:r,n.value=o===t?null:o,n.primaryKey=i===t?null:i;var a=r===t?null:n;e(a,n.__req)}}},n.prototype.__decode=function(n,r){if(this.__multiEntryIndex&&this.__unique){if(this.__matchedKeys||(this.__matchedKeys={}),this.__matchedKeys[n.matchingKey])return void r(t,t,t);this.__matchedKeys[n.matchingKey]=!0}var o=e.Key.decode(this.__multiEntryIndex?n.matchingKey:n[this.__keyColumnName],this.__multiEntryIndex),i=this.__valueDecoder.decode(n[this.__valueColumnName]),a=e.Key.decode(n.key);r(o,i,a)},n.prototype["continue"]=function(t){var n=e.cursorPreloadPackSize||100,r=this;this.__store.transaction.__pushToQueue(r.__req,function(e,o,i,a){return r.__offset++,r.__prefetchedData&&(r.__prefetchedIndex++,r.__prefetchedIndex<r.__prefetchedData.length)?void r.__decode(r.__prefetchedData.item(r.__prefetchedIndex),r.__onsuccess(i)):void r.__find(t,e,r.__onsuccess(i),a,n)})},n.prototype.advance=function(n){if(0>=n)throw e.util.createDOMException("Type Error","Count is invalid - 0 or negative",n);var r=this;this.__store.transaction.__pushToQueue(r.__req,function(e,o,i,a){r.__offset+=n,r.__find(t,e,r.__onsuccess(i),a)})},n.prototype.update=function(n){var r=this;return r.__store.transaction.__assertWritable(),r.__store.transaction.__addToTransactionQueue(function(o,i,a,u){e.Sca.encode(n,function(i){r.__find(t,o,function(t,s,c){var l=r.__store,f=[i],p=["UPDATE",e.util.quote(l.name),"SET value = ?"];e.Key.validate(c);for(var h=0;h<l.indexNames.length;h++){var d=l.__indexes[l.indexNames[h]],v=e.Key.getValue(n,d.keyPath);p.push(",",e.util.quote(d.name),"= ?"),f.push(e.Key.encode(v,d.multiEntry))}p.push("WHERE key = ?"),f.push(e.Key.encode(c)),e.DEBUG&&console.log(p.join(" "),i,t,c),o.executeSql(p.join(" "),f,function(e,n){r.__prefetchedData=null,r.__prefetchedIndex=0,1===n.rowsAffected?a(t):u("No rows with key found"+t)},function(e,t){u(t)})},u)})})},n.prototype["delete"]=function(){var n=this;return n.__store.transaction.__assertWritable(),this.__store.transaction.__addToTransactionQueue(function(r,o,i,a){n.__find(t,r,function(o,u,s){var c="DELETE FROM  "+e.util.quote(n.__store.name)+" WHERE key = ?";e.DEBUG&&console.log(c,o,s),e.Key.validate(s),r.executeSql(c,[e.Key.encode(s)],function(e,r){n.__prefetchedData=null,n.__prefetchedIndex=0,1===r.rowsAffected?(n.__offset--,i(t)):a("No rows with key found"+o)},function(e,t){a(t)})},a)})},e.IDBCursor=n}(idbModules),function(e,t){"use strict";function n(e,t){this.objectStore=e,this.name=t.columnName,this.keyPath=t.keyPath,this.multiEntry=t.optionalParams&&t.optionalParams.multiEntry,this.unique=t.optionalParams&&t.optionalParams.unique,this.__deleted=!!t.__deleted}n.__clone=function(e,t){return new n(t,{columnName:e.name,keyPath:e.keyPath,optionalParams:{multiEntry:e.multiEntry,unique:e.unique}})},n.__createIndex=function(t,r){var o=!!t.__indexes[r.name]&&t.__indexes[r.name].__deleted;t.__indexes[r.name]=r,t.indexNames.push(r.name);var i=t.transaction;i.__addToTransactionQueue(function(i,a,u,s){function c(t,n){s(e.util.createDOMException(0,'Could not create index "'+r.name+'"',n))}function l(o){n.__updateIndexList(t,o,function(){o.executeSql("SELECT * FROM "+e.util.quote(t.name),[],function(n,o){function i(a){if(a<o.rows.length)try{var s=e.Sca.decode(o.rows.item(a).value),l=e.Key.getValue(s,r.keyPath);l=e.Key.encode(l,r.multiEntry),n.executeSql("UPDATE "+e.util.quote(t.name)+" set "+e.util.quote(r.name)+" = ? where key = ?",[l,o.rows.item(a).key],function(e,t){i(a+1)},c)}catch(f){i(a+1)}else u(t)}e.DEBUG&&console.log("Adding existing "+t.name+" records to the "+r.name+" index"),i(0)},c)},c)}if(o)l(i);else{var f=["ALTER TABLE",e.util.quote(t.name),"ADD",e.util.quote(r.name),"BLOB"].join(" ");e.DEBUG&&console.log(f),i.executeSql(f,[],l,c)}})},n.__deleteIndex=function(t,r){t.__indexes[r.name].__deleted=!0,t.indexNames.splice(t.indexNames.indexOf(r.name),1);var o=t.transaction;o.__addToTransactionQueue(function(o,i,a,u){function s(t,n){u(e.util.createDOMException(0,'Could not delete index "'+r.name+'"',n))}n.__updateIndexList(t,o,a,s)})},n.__updateIndexList=function(t,n,r,o){for(var i={},a=0;a<t.indexNames.length;a++){var u=t.__indexes[t.indexNames[a]];i[u.name]={columnName:u.name,keyPath:u.keyPath,optionalParams:{unique:u.unique,multiEntry:u.multiEntry},deleted:!!u.deleted}}e.DEBUG&&console.log("Updating the index list for "+t.name,i),n.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[JSON.stringify(i),t.name],function(){r(t)},o)},n.prototype.__fetchIndexData=function(n,r){var o,i,a=this;return 1===arguments.length?(r=n,o=!1):(e.Key.validate(n),i=e.Key.encode(n,a.multiEntry),o=!0),a.objectStore.transaction.__addToTransactionQueue(function(n,u,s,c){var l=["SELECT * FROM",e.util.quote(a.objectStore.name),"WHERE",e.util.quote(a.name),"NOT NULL"],f=[];o&&(a.multiEntry?(l.push("AND",e.util.quote(a.name),"LIKE ?"),f.push("%"+i+"%")):(l.push("AND",e.util.quote(a.name),"= ?"),f.push(i))),e.DEBUG&&console.log("Trying to fetch data for Index",l.join(" "),f),n.executeSql(l.join(" "),f,function(n,u){var c=0,l=null;if(a.multiEntry)for(var f=0;f<u.rows.length;f++){var p=u.rows.item(f),h=e.Key.decode(p[a.name]);o&&e.Key.isMultiEntryMatch(i,p[a.name])?(c++,l=l||p):o||h===t||(c+=h instanceof Array?h.length:1,l=l||p)}else c=u.rows.length,l=c&&u.rows.item(0);s("count"===r?c:0===c?t:"key"===r?e.Key.decode(l.key):e.Sca.decode(l.value))},c)})},n.prototype.openCursor=function(t,n){return new e.IDBCursor(t,n,this.objectStore,this,this.name,"value").__req},n.prototype.openKeyCursor=function(t,n){return new e.IDBCursor(t,n,this.objectStore,this,this.name,"key").__req},n.prototype.get=function(e){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(e,"value")},n.prototype.getKey=function(e){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(e,"key")},n.prototype.count=function(n){return n===t?this.__fetchIndexData("count"):n instanceof e.IDBKeyRange?new e.IDBCursor(n,"next",this.objectStore,this,this.name,"value",!0).__req:this.__fetchIndexData(n,"count")},e.IDBIndex=n}(idbModules),function(e){"use strict";function t(t,n){this.name=t.name,this.keyPath=JSON.parse(t.keyPath),this.transaction=n,this.autoIncrement="string"==typeof t.autoInc?"true"===t.autoInc:!!t.autoInc,this.__indexes={},this.indexNames=new e.util.StringList;var r=JSON.parse(t.indexList);for(var o in r)if(r.hasOwnProperty(o)){var i=new e.IDBIndex(this,r[o]);this.__indexes[i.name]=i,i.__deleted||this.indexNames.push(i.name)}}t.__clone=function(e,n){var r=new t({name:e.name,keyPath:JSON.stringify(e.keyPath),autoInc:JSON.stringify(e.autoIncrement),indexList:"{}"},n);return r.__indexes=e.__indexes,r.indexNames=e.indexNames,r},t.__createObjectStore=function(t,n){t.__objectStores[n.name]=n,t.objectStoreNames.push(n.name);var r=t.__versionTransaction;e.IDBTransaction.__assertVersionChange(r),r.__addToTransactionQueue(function(t,r,o,i){function a(t,r){throw e.util.createDOMException(0,'Could not create object store "'+n.name+'"',r)}var u=["CREATE TABLE",e.util.quote(n.name),"(key BLOB",n.autoIncrement?"UNIQUE, inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");e.DEBUG&&console.log(u),t.executeSql(u,[],function(e,t){e.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[n.name,JSON.stringify(n.keyPath),n.autoIncrement,"{}"],function(){o(n)},a)},a)})},t.__deleteObjectStore=function(t,n){t.__objectStores[n.name]=void 0,t.objectStoreNames.splice(t.objectStoreNames.indexOf(n.name),1);var r=t.__versionTransaction;e.IDBTransaction.__assertVersionChange(r),r.__addToTransactionQueue(function(t,r,o,i){function a(t,n){i(e.util.createDOMException(0,"Could not delete ObjectStore",n))}t.executeSql("SELECT * FROM __sys__ where name = ?",[n.name],function(t,r){r.rows.length>0&&t.executeSql("DROP TABLE "+e.util.quote(n.name),[],function(){t.executeSql("DELETE FROM __sys__ WHERE name = ?",[n.name],function(){o()},a)},a)})})},t.prototype.__validateKey=function(t,n){if(this.keyPath){if("undefined"!=typeof n)throw e.util.createDOMException("DataError","The object store uses in-line keys and the key parameter was provided",this);if(!t||"object"!=typeof t)throw e.util.createDOMException("DataError","KeyPath was specified, but value was not an object");if(n=e.Key.getValue(t,this.keyPath),void 0===n){if(this.autoIncrement)return;throw e.util.createDOMException("DataError","Could not eval key from keyPath")}}else if("undefined"==typeof n){if(this.autoIncrement)return;throw e.util.createDOMException("DataError","The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",this)}e.Key.validate(n)},t.prototype.__deriveKey=function(t,n,r,o,i){function a(n){t.executeSql("SELECT * FROM sqlite_sequence where name like ?",[u.name],function(e,t){n(1!==t.rows.length?1:t.rows.item(0).seq+1)},function(t,n){i(e.util.createDOMException("DataError","Could not get the auto increment value for key",n))})}var u=this;if(u.keyPath){var s=e.Key.getValue(n,u.keyPath);void 0===s&&u.autoIncrement?a(function(t){try{e.Key.setValue(n,u.keyPath,t),o(t)}catch(r){i(e.util.createDOMException("DataError","Could not assign a generated value to the keyPath",r))}}):o(s)}else"undefined"==typeof r&&u.autoIncrement?a(o):o(r)},t.prototype.__insertData=function(t,n,r,o,i,a){try{var u={};"undefined"!=typeof o&&(e.Key.validate(o),u.key=e.Key.encode(o));for(var s=0;s<this.indexNames.length;s++){var c=this.__indexes[this.indexNames[s]];u[c.name]=e.Key.encode(e.Key.getValue(r,c.keyPath),c.multiEntry)}var l=["INSERT INTO ",e.util.quote(this.name),"("],f=[" VALUES ("],p=[];for(var h in u)l.push(e.util.quote(h)+","),f.push("?,"),p.push(u[h]);l.push("value )"),f.push("?)"),p.push(n);var d=l.join(" ")+f.join(" ");e.DEBUG&&console.log("SQL for adding",d,p),t.executeSql(d,p,function(t,n){e.Sca.encode(o,function(t){t=e.Sca.decode(t),i(t)})},function(t,n){a(e.util.createDOMError("ConstraintError",n.message,n))})}catch(v){a(v)}},t.prototype.add=function(t,n){var r=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(t,n),r.transaction.__assertWritable();var o=r.transaction.__createRequest();return r.transaction.__pushToQueue(o,function(o,i,a,u){r.__deriveKey(o,t,n,function(n){e.Sca.encode(t,function(e){r.__insertData(o,e,t,n,a,u)})},u)}),o},t.prototype.put=function(t,n){var r=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(t,n),r.transaction.__assertWritable();var o=r.transaction.__createRequest();return r.transaction.__pushToQueue(o,function(o,i,a,u){r.__deriveKey(o,t,n,function(n){e.Sca.encode(t,function(i){e.Key.validate(n);var s="DELETE FROM "+e.util.quote(r.name)+" where key = ?";o.executeSql(s,[e.Key.encode(n)],function(o,s){e.DEBUG&&console.log("Did the row with the",n,"exist? ",s.rowsAffected),r.__insertData(o,i,t,n,a,u)},function(e,t){u(t)})})},u)}),o},t.prototype.get=function(t){var n=this;if(0===arguments.length)throw new TypeError("No key was specified");e.Key.validate(t);var r=e.Key.encode(t);return n.transaction.__addToTransactionQueue(function(t,o,i,a){e.DEBUG&&console.log("Fetching",n.name,r),t.executeSql("SELECT * FROM "+e.util.quote(n.name)+" where key = ?",[r],function(t,n){e.DEBUG&&console.log("Fetched data",n);var r;try{if(0===n.rows.length)return i();r=e.Sca.decode(n.rows.item(0).value)}catch(o){e.DEBUG&&console.log(o)}i(r)},function(e,t){a(t)})})},t.prototype["delete"]=function(t){var n=this;if(0===arguments.length)throw new TypeError("No key was specified");n.transaction.__assertWritable(),e.Key.validate(t);var r=e.Key.encode(t);return n.transaction.__addToTransactionQueue(function(t,o,i,a){e.DEBUG&&console.log("Fetching",n.name,r),t.executeSql("DELETE FROM "+e.util.quote(n.name)+" where key = ?",[r],function(t,n){e.DEBUG&&console.log("Deleted from database",n.rowsAffected),i()},function(e,t){a(t)})})},t.prototype.clear=function(){var t=this;return t.transaction.__assertWritable(),t.transaction.__addToTransactionQueue(function(n,r,o,i){n.executeSql("DELETE FROM "+e.util.quote(t.name),[],function(t,n){e.DEBUG&&console.log("Cleared all records from database",n.rowsAffected),o()},function(e,t){i(t)})})},t.prototype.count=function(t){if(t instanceof e.IDBKeyRange)return new e.IDBCursor(t,"next",this,this,"key","value",!0).__req;var n=this,r=!1;return void 0!==t&&(r=!0,e.Key.validate(t)),n.transaction.__addToTransactionQueue(function(o,i,a,u){var s="SELECT * FROM "+e.util.quote(n.name)+(r?" WHERE key = ?":""),c=[];r&&c.push(e.Key.encode(t)),o.executeSql(s,c,function(e,t){a(t.rows.length)},function(e,t){u(t)})})},t.prototype.openCursor=function(t,n){return new e.IDBCursor(t,n,this,this,"key","value").__req},t.prototype.index=function(t){if(0===arguments.length)throw new TypeError("No index name was specified");var n=this.__indexes[t];if(!n)throw e.util.createDOMException("NotFoundError",'Index "'+t+'" does not exist on '+this.name);return e.IDBIndex.__clone(n,this)},t.prototype.createIndex=function(t,n,r){if(0===arguments.length)throw new TypeError("No index name was specified");if(1===arguments.length)throw new TypeError("No key path was specified");if(n instanceof Array&&r&&r.multiEntry)throw e.util.createDOMException("InvalidAccessError","The keyPath argument was an array and the multiEntry option is true.");if(this.__indexes[t]&&!this.__indexes[t].__deleted)throw e.util.createDOMException("ConstraintError",'Index "'+t+'" already exists on '+this.name);this.transaction.__assertVersionChange(),r=r||{};var o={columnName:t,keyPath:n,optionalParams:{unique:!!r.unique,multiEntry:!!r.multiEntry}},i=new e.IDBIndex(this,o);return e.IDBIndex.__createIndex(this,i),i},t.prototype.deleteIndex=function(t){if(0===arguments.length)throw new TypeError("No index name was specified");var n=this.__indexes[t];if(!n)throw e.util.createDOMException("NotFoundError",'Index "'+t+'" does not exist on '+this.name);this.transaction.__assertVersionChange(),e.IDBIndex.__deleteIndex(this,n)},e.IDBObjectStore=t}(idbModules),function(e){"use strict";function t(e,t,r){this.__id=++n,this.__active=!0,this.__running=!1,this.__errored=!1,this.__requests=[],this.__storeNames=t,this.mode=r,this.db=e,this.error=null,this.onabort=this.onerror=this.oncomplete=null;var o=this;setTimeout(function(){o.__executeRequests()},0)}var n=0;t.prototype.__executeRequests=function(){function t(t){if(e.util.logError("Error","An error occurred in a transaction",t),!r.__errored){if(r.__errored=!0,!r.__active)throw t;try{r.error=t;var n=e.util.createEvent("error");e.util.callback("onerror",r,n),e.util.callback("onerror",r.db,n)}finally{r.abort()}}}function n(){e.DEBUG&&console.log("Transaction completed");var t=e.util.createEvent("complete");try{e.util.callback("oncomplete",r,t),e.util.callback("__oncomplete",r,t)}catch(n){throw r.__errored=!0,n}}if(this.__running)return void(e.DEBUG&&console.log("Looks like the request set is already running",this.mode));this.__running=!0;var r=this;r.db.__db.transaction(function(o){function i(t,n){n&&(s.req=n),s.req.readyState="done",s.req.result=t,delete s.req.error;var r=e.util.createEvent("success");e.util.callback("onsuccess",s.req,r),c++,u()}function a(n,r){r=e.util.findError(arguments);try{s.req.readyState="done",s.req.error=r||"DOMError",s.req.result=void 0;var o=e.util.createEvent("error",r);e.util.callback("onerror",s.req,o)}finally{t(r)}}function u(){if(c>=r.__requests.length)r.__requests=[],r.__active&&(r.__active=!1,n());else try{s=r.__requests[c],s.op(o,s.args,i,a)}catch(e){a(e)}}r.__tx=o;var s=null,c=0;u()},function(e){t(e)})},t.prototype.__createRequest=function(){var t=new e.IDBRequest;return t.source=this.db,t.transaction=this,t},t.prototype.__addToTransactionQueue=function(e,t){var n=this.__createRequest();return this.__pushToQueue(n,e,t),n},t.prototype.__pushToQueue=function(e,t,n){this.__assertActive(),this.__requests.push({op:t,args:n,req:e})},t.prototype.__assertActive=function(){if(!this.__active)throw e.util.createDOMException("TransactionInactiveError","A request was placed against a transaction which is currently not active, or which is finished")},t.prototype.__assertWritable=function(){if(this.mode===t.READ_ONLY)throw e.util.createDOMException("ReadOnlyError","The transaction is read only")},t.prototype.__assertVersionChange=function(){t.__assertVersionChange(this)},t.__assertVersionChange=function(n){if(!n||n.mode!==t.VERSION_CHANGE)throw e.util.createDOMException("InvalidStateError","Not a version transaction")},t.prototype.objectStore=function(n){if(0===arguments.length)throw new TypeError("No object store name was specified");if(!this.__active)throw e.util.createDOMException("InvalidStateError","A request was placed against a transaction which is currently not active, or which is finished");if(-1===this.__storeNames.indexOf(n)&&this.mode!==t.VERSION_CHANGE)throw e.util.createDOMException("NotFoundError",n+" is not participating in this transaction");var r=this.db.__objectStores[n];if(!r)throw e.util.createDOMException("NotFoundError",n+" does not exist in "+this.db.name);return e.IDBObjectStore.__clone(r,this)},t.prototype.abort=function(){var t=this;e.DEBUG&&console.log("The transaction was aborted",t),t.__active=!1;var n=e.util.createEvent("abort");setTimeout(function(){e.util.callback("onabort",t,n)},0)},t.READ_ONLY="readonly",t.READ_WRITE="readwrite",t.VERSION_CHANGE="versionchange",e.IDBTransaction=t}(idbModules),function(e){"use strict";function t(t,n,r,o){this.__db=t,this.__closed=!1,this.version=r,this.name=n,this.onabort=this.onerror=this.onversionchange=null,this.__objectStores={},this.objectStoreNames=new e.util.StringList;for(var i=0;i<o.rows.length;i++){var a=new e.IDBObjectStore(o.rows.item(i));this.__objectStores[a.name]=a,this.objectStoreNames.push(a.name)}}t.prototype.createObjectStore=function(t,n){if(0===arguments.length)throw new TypeError("No object store name was specified");if(this.__objectStores[t])throw e.util.createDOMException("ConstraintError",'Object store "'+t+'" already exists in '+this.name);this.__versionTransaction.__assertVersionChange(),n=n||{};var r={name:t,keyPath:JSON.stringify(n.keyPath||null),autoInc:JSON.stringify(n.autoIncrement),indexList:"{}"},o=new e.IDBObjectStore(r,this.__versionTransaction);return e.IDBObjectStore.__createObjectStore(this,o),o},t.prototype.deleteObjectStore=function(t){if(0===arguments.length)throw new TypeError("No object store name was specified");var n=this.__objectStores[t];if(!n)throw e.util.createDOMException("NotFoundError",'Object store "'+t+'" does not exist in '+this.name);this.__versionTransaction.__assertVersionChange(),e.IDBObjectStore.__deleteObjectStore(this,n)},t.prototype.close=function(){this.__closed=!0},t.prototype.transaction=function(t,n){if(this.__closed)throw e.util.createDOMException("InvalidStateError","An attempt was made to start a new transaction on a database connection that is not open");if("number"==typeof n?(n=1===n?IDBTransaction.READ_WRITE:IDBTransaction.READ_ONLY,e.DEBUG&&console.log("Mode should be a string, but was specified as ",n)):n=n||IDBTransaction.READ_ONLY,n!==IDBTransaction.READ_ONLY&&n!==IDBTransaction.READ_WRITE)throw new TypeError("Invalid transaction mode: "+n);if(t="string"==typeof t?[t]:t,0===t.length)throw e.util.createDOMException("InvalidAccessError","No object store names were specified");for(var r=0;r<t.length;r++)if(!this.objectStoreNames.contains(t[r]))throw e.util.createDOMException("NotFoundError",'The "'+t[r]+'" object store does not exist');var o=new e.IDBTransaction(this,t,n);return o},e.IDBDatabase=t}(idbModules),function(e){"use strict";function t(t,n){function i(t,r){r=e.util.findError(arguments),e.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",r),n(r)}r?t():(r=window.openDatabase("__sysdb__",1,"System Database",o),r.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[],t,i)},i))}function n(){this.modules=e}var r,o=4194304;n.prototype.open=function(n,i){function a(t,n){if(!c){n=e.util.findError(arguments),c=!0;var r=e.util.createEvent("error",arguments);s.readyState="done",s.error=n||"DOMError",e.util.callback("onerror",s,r)}}function u(t){var u=window.openDatabase(n,1,n,o);if(s.readyState="done","undefined"==typeof i&&(i=t||1),0>=i||t>i){var c=e.util.createDOMError("VersionError","An attempt was made to open a database using a lower version than the existing version.",i);return void a(c)}u.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){o.executeSql("SELECT * FROM __sys__",[],function(o,c){var l=e.util.createEvent("success");s.source=s.result=new e.IDBDatabase(u,n,i,c),i>t?r.transaction(function(r){r.executeSql("UPDATE dbVersions set version = ? where name = ?",[i,n],function(){var n=e.util.createEvent("upgradeneeded");n.oldVersion=t,n.newVersion=i,s.transaction=s.result.__versionTransaction=new e.IDBTransaction(s.source,[],e.IDBTransaction.VERSION_CHANGE),s.transaction.__addToTransactionQueue(function(t,r,o){e.util.callback("onupgradeneeded",s,n),o()}),s.transaction.__oncomplete=function(){s.transaction=null;var t=e.util.createEvent("success");e.util.callback("onsuccess",s,t)}},a)},a):e.util.callback("onsuccess",s,l)},a)},a)},a)}var s=new e.IDBOpenDBRequest,c=!1;if(0===arguments.length)throw new TypeError("Database name is required");if(2===arguments.length&&(i=parseFloat(i),isNaN(i)||!isFinite(i)||0>=i))throw new TypeError("Invalid database version: "+i);return n+="",t(function(){r.transaction(function(e){e.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(e,t){0===t.rows.length?e.executeSql("INSERT INTO dbVersions VALUES (?,?)",[n,i||1],function(){u(0)},a):u(t.rows.item(0).version)},a)},a)},a),s},n.prototype.deleteDatabase=function(n){function i(t,n){if(!s){n=e.util.findError(arguments),u.readyState="done",u.error=n||"DOMError";var r=e.util.createEvent("error");r.debug=arguments,e.util.callback("onerror",u,r),s=!0}}function a(){r.transaction(function(t){t.executeSql("DELETE FROM dbVersions where name = ? ",[n],function(){u.result=void 0;var t=e.util.createEvent("success");t.newVersion=null,t.oldVersion=c,e.util.callback("onsuccess",u,t)},i)},i)}var u=new e.IDBOpenDBRequest,s=!1,c=null;if(0===arguments.length)throw new TypeError("Database name is required");return n+="",t(function(){r.transaction(function(t){t.executeSql("SELECT * FROM dbVersions where name = ?",[n],function(t,r){if(0===r.rows.length){u.result=void 0;var s=e.util.createEvent("success");return s.newVersion=null,s.oldVersion=c,void e.util.callback("onsuccess",u,s)}c=r.rows.item(0).version;var l=window.openDatabase(n,1,n,o);l.transaction(function(t){t.executeSql("SELECT * FROM __sys__",[],function(t,n){var r=n.rows;!function o(n){n>=r.length?t.executeSql("DROP TABLE IF EXISTS __sys__",[],function(){a()},i):t.executeSql("DROP TABLE "+e.util.quote(r.item(n).name),[],function(){o(n+1)},function(){o(n+1)})}(0)},function(e){a()})})},i)},i)},i),u},n.prototype.cmp=function(t,n){if(arguments.length<2)throw new TypeError("You must provide two keys to be compared");e.Key.validate(t),e.Key.validate(n);var r=e.Key.encode(t),o=e.Key.encode(n),i=r>o?1:r===o?0:-1;if(e.DEBUG){var a=e.Key.decode(r),u=e.Key.decode(o);"object"==typeof t&&(t=JSON.stringify(t),a=JSON.stringify(a)),"object"==typeof n&&(n=JSON.stringify(n),u=JSON.stringify(u)),a!==t&&console.warn(t+" was incorrectly encoded as "+a),u!==n&&console.warn(n+" was incorrectly encoded as "+u)}return i},e.shimIndexedDB=new n,e.IDBFactory=n}(idbModules),function(e,t){"use strict";function n(t,n){try{e[t]=n}catch(r){}if(e[t]!==n&&Object.defineProperty){try{Object.defineProperty(e,t,{value:n})}catch(r){}e[t]!==n&&e.console&&console.warn&&console.warn("Unable to shim "+t)}}n("shimIndexedDB",t.shimIndexedDB),e.shimIndexedDB&&(e.shimIndexedDB.__useShim=function(){"undefined"!=typeof e.openDatabase?(n("indexedDB",t.shimIndexedDB),n("IDBFactory",t.IDBFactory),n("IDBDatabase",t.IDBDatabase),n("IDBObjectStore",t.IDBObjectStore),n("IDBIndex",t.IDBIndex),n("IDBTransaction",t.IDBTransaction),n("IDBCursor",t.IDBCursor),n("IDBKeyRange",t.IDBKeyRange),n("IDBRequest",t.IDBRequest),n("IDBOpenDBRequest",t.IDBOpenDBRequest),n("IDBVersionChangeEvent",t.IDBVersionChangeEvent)):"object"==typeof e.indexedDB&&t.polyfill()},e.shimIndexedDB.__debug=function(e){t.DEBUG=e}),"indexedDB"in e||(e.indexedDB=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.oIndexedDB||e.msIndexedDB);var r=!1;if((navigator.userAgent.match(/Android 2/)||navigator.userAgent.match(/Android 3/)||navigator.userAgent.match(/Android 4\.[0-3]/))&&(navigator.userAgent.match(/Chrome/)||(r=!0)),"undefined"!=typeof e.indexedDB&&e.indexedDB&&!r||"undefined"==typeof e.openDatabase){e.IDBDatabase=e.IDBDatabase||e.webkitIDBDatabase,e.IDBTransaction=e.IDBTransaction||e.webkitIDBTransaction,e.IDBCursor=e.IDBCursor||e.webkitIDBCursor,e.IDBKeyRange=e.IDBKeyRange||e.webkitIDBKeyRange,e.IDBTransaction||(e.IDBTransaction={});try{e.IDBTransaction.READ_ONLY=e.IDBTransaction.READ_ONLY||"readonly",e.IDBTransaction.READ_WRITE=e.IDBTransaction.READ_WRITE||"readwrite"}catch(o){}}else e.shimIndexedDB.__useShim()}(window,idbModules)},function(e,t,n){(function(e,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorage=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),c=n(167),l=o(c),f=n(171),p=o(f),h=n(205),d=o(h),v=n(14),y=o(v),m=n(208),g=o(m),b=e.env.KINVEY_ID_ATTRIBUTE||"_id",w="master",_=r.localStorage;t.LocalStorage=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"kinvey":arguments[0];a(this,e),this.name=t}return u(e,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=_.getItem(""+this.name+e),!t){n.next=3;break}return n.abrupt("return",JSON.parse(t));case 3:return n.abrupt("return",t);case 4:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e);case 2:if(r=n.sent,o=find(r,function(e){return e[b]===t})){n.next=6;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" localstorage database."));
case 6:return n.abrupt("return",o);case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"save",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r,o,i,a,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(w);case 2:return r=n.sent,-1===(0,g["default"])(r,e)&&(r.push(e),_.setItem(""+this.name+w,JSON.stringify(r))),n.next=6,this.find(e);case 6:return o=n.sent,i=(0,l["default"])(o,b),a=(0,l["default"])(t,b),u=Object.keys(i),(0,y["default"])(u,function(e){var t=i[e],n=a[e];n&&(a[e]=(0,p["default"])(t,n))}),_.setItem(""+this.name+e,JSON.stringify((0,d["default"])(a))),n.abrupt("return",t);case 13:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r,o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e);case 2:if(r=n.sent,o=(0,l["default"])(r,b),i=o[t]){n.next=7;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" "+("collection on the "+this.name+" memory database."));case 7:return delete o[t],_.setItem(""+this.name+e,JSON.stringify((0,d["default"])(o))),n.abrupt("return",i);case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(w);case 2:e=n.sent,(0,y["default"])(e,function(e){_.removeItem(""+t.name+e)});case 4:case"end":return n.stop()}},n,this)}));return e}()}],[{key:"isSupported",value:function(){if(_){var e="testLocalStorageSupport";try{return _.setItem(e,e),_.removeItem(e),!0}catch(t){return!1}}return!1}}]),e}()}).call(t,n(2),function(){return this}())},function(e,t,n){var r=n(168),o=r(function(e,t,n){e[n]=t});e.exports=o},function(e,t,n){function r(e,t){return function(n,r){var s=u(n)?o:i,c=t?t():{};return s(n,e,a(r),c)}}var o=n(169),i=n(170),a=n(40),u=n(35);e.exports=r},function(e,t){function n(e,t,n,r){for(var o=-1,i=e?e.length:0;++o<i;){var a=e[o];t(r,a,n(a),e)}return r}e.exports=n},function(e,t,n){function r(e,t,n,r){return o(e,function(e,o,i){t(r,e,n(e),i)}),r}var o=n(16);e.exports=r},function(e,t,n){var r=n(172),o=n(125),i=o(function(e,t,n){r(e,t,n)});e.exports=i},function(e,t,n){function r(e,t,n,p,h){if(e!==t){if(!s(t)&&!l(t))var d=f(t);i(d||t,function(i,s){if(d&&(s=i,i=t[s]),c(i))h||(h=new o),u(e,t,s,n,r,p,h);else{var l=p?p(e[s],i,s+"",e,t,h):void 0;void 0===l&&(l=i),a(e,s,l)}})}}var o=n(43),i=n(15),a=n(173),u=n(174),s=n(35),c=n(32),l=n(100),f=n(201);e.exports=r},function(e,t,n){function r(e,t,n){(void 0===n||o(e[t],n))&&("number"!=typeof t||void 0!==n||t in e)||(e[t]=n)}var o=n(48);e.exports=r},function(e,t,n){function r(e,t,n,r,v,y,m){var g=e[n],b=t[n],w=m.get(b);if(w)return void o(e,n,w);var _=y?y(g,b,n+"",e,t,m):void 0,x=void 0===_;x&&(_=b,s(b)||h(b)?s(g)?_=g:c(g)?_=a(g):(x=!1,_=i(b,!0)):p(b)||u(b)?u(g)?_=d(g):!f(g)||r&&l(g)?(x=!1,_=i(b,!0)):_=g:x=!1),m.set(b,_),x&&v(_,b,r,y,m),m["delete"](b),o(e,n,_)}var o=n(173),i=n(175),a=n(178),u=n(26),s=n(35),c=n(27),l=n(31),f=n(32),p=n(199),h=n(100),d=n(200);e.exports=r},function(e,t,n){function r(e,t,n,x,E,k,O){var S;if(x&&(S=k?x(e,E,k,O):x(e)),void 0!==S)return S;if(!b(e))return e;var T=y(e);if(T){if(S=h(e),!t)return c(e,S)}else{var A=p(e),P=A==j||A==R;if(m(e))return s(e,t);if(A==I||A==_||P&&!k){if(g(e))return k?e:{};if(S=v(P?{}:e),!t)return l(e,u(S,e))}else{if(!J[A])return k?e:{};S=d(e,A,r,t)}}O||(O=new o);var q=O.get(e);if(q)return q;if(O.set(e,S),!T)var C=n?f(e):w(e);return i(C||e,function(o,i){C&&(i=o,o=e[i]),a(S,i,r(o,t,n,x,i,e,O))}),S}var o=n(43),i=n(15),a=n(123),u=n(176),s=n(177),c=n(178),l=n(179),f=n(182),p=n(95),h=n(185),d=n(186),v=n(197),y=n(35),m=n(135),g=n(64),b=n(32),w=n(20),_="[object Arguments]",x="[object Array]",E="[object Boolean]",k="[object Date]",O="[object Error]",j="[object Function]",R="[object GeneratorFunction]",S="[object Map]",T="[object Number]",I="[object Object]",A="[object RegExp]",P="[object Set]",q="[object String]",C="[object Symbol]",D="[object WeakMap]",N="[object ArrayBuffer]",M="[object DataView]",B="[object Float32Array]",K="[object Float64Array]",L="[object Int8Array]",U="[object Int16Array]",F="[object Int32Array]",$="[object Uint8Array]",V="[object Uint8ClampedArray]",Y="[object Uint16Array]",z="[object Uint32Array]",J={};J[_]=J[x]=J[N]=J[M]=J[E]=J[k]=J[B]=J[K]=J[L]=J[U]=J[F]=J[S]=J[T]=J[I]=J[A]=J[P]=J[q]=J[C]=J[$]=J[V]=J[Y]=J[z]=!0,J[O]=J[j]=J[D]=!1,e.exports=r},function(e,t,n){function r(e,t){return e&&o(t,i(t),e)}var o=n(124),i=n(20);e.exports=r},function(e,t){function n(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}e.exports=n},function(e,t){function n(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}e.exports=n},function(e,t,n){function r(e,t){return o(e,i(e),t)}var o=n(124),i=n(180);e.exports=r},function(e,t,n){function r(e){return i(Object(e))}var o=n(181),i=Object.getOwnPropertySymbols;i||(r=o),e.exports=r},function(e,t){function n(){return[]}e.exports=n},function(e,t,n){function r(e){return o(e,a,i)}var o=n(183),i=n(180),a=n(20);e.exports=r},function(e,t,n){function r(e,t,n){var r=t(e);return i(e)?r:o(r,n(e))}var o=n(184),i=n(35);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}e.exports=n},function(e,t){function n(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var r=Object.prototype,o=r.hasOwnProperty;e.exports=n},function(e,t,n){function r(e,t,n,r){var I=e.constructor;switch(t){case b:return o(e);case f:case p:return new I(+e);case w:return i(e,r);case _:case x:case E:case k:case O:case j:case R:case S:case T:return l(e,r);case h:return a(e,r,n);case d:case m:return new I(e);case v:return u(e);case y:return s(e,r,n);case g:return c(e)}}var o=n(187),i=n(188),a=n(189),u=n(192),s=n(193),c=n(195),l=n(196),f="[object Boolean]",p="[object Date]",h="[object Map]",d="[object Number]",v="[object RegExp]",y="[object Set]",m="[object String]",g="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",_="[object Float32Array]",x="[object Float64Array]",E="[object Int8Array]",k="[object Int16Array]",O="[object Int32Array]",j="[object Uint8Array]",R="[object Uint8ClampedArray]",S="[object Uint16Array]",T="[object Uint32Array]";e.exports=r},function(e,t,n){function r(e){var t=new e.constructor(e.byteLength);return new o(t).set(new o(e)),t}var o=n(91);e.exports=r},function(e,t,n){function r(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var o=n(187);e.exports=r},function(e,t,n){function r(e,t,n){var r=t?n(a(e),!0):a(e);return i(r,o,new e.constructor)}var o=n(190),i=n(191),a=n(92);e.exports=r},function(e,t){function n(e,t){return e.set(t[0],t[1]),e}e.exports=n},function(e,t){function n(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}e.exports=n},function(e,t){function n(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}var r=/\w*$/;e.exports=n},function(e,t,n){function r(e,t,n){var r=t?n(a(e),!0):a(e);return i(r,o,new e.constructor)}var o=n(194),i=n(191),a=n(93);e.exports=r},function(e,t){function n(e,t){return e.add(t),e}e.exports=n},function(e,t,n){function r(e){return a?Object(a.call(e)):{}}var o=n(90),i=o?o.prototype:void 0,a=i?i.valueOf:void 0;e.exports=r},function(e,t,n){function r(e,t){var n=t?o(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var o=n(187);e.exports=r},function(e,t,n){function r(e){return"function"!=typeof e.constructor||a(e)?{}:o(i(e))}var o=n(198),i=n(22),a=n(38);e.exports=r},function(e,t,n){function r(e){return o(e)?i(e):{}}var o=n(32),i=Object.create;e.exports=r},function(e,t,n){function r(e){if(!a(e)||p.call(e)!=u||i(e))return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==f}var o=n(22),i=n(64),a=n(34),u="[object Object]",s=Object.prototype,c=Function.prototype.toString,l=s.hasOwnProperty,f=c.call(Object),p=s.toString;e.exports=r},function(e,t,n){function r(e){return o(e,i(e))}var o=n(124),i=n(201);e.exports=r},function(e,t,n){function r(e){for(var t=-1,n=u(e),r=o(e),s=r.length,l=i(e),f=!!l,p=l||[],h=p.length;++t<s;){var d=r[t];f&&("length"==d||a(d,h))||"constructor"==d&&(n||!c.call(e,d))||p.push(d)}return p}var o=n(202),i=n(24),a=n(37),u=n(38),s=Object.prototype,c=s.hasOwnProperty;e.exports=r},function(e,t,n){function r(e){e=null==e?e:Object(e);var t=[];for(var n in e)t.push(n);return t}var o=n(203),i=n(204),a=Object.prototype,u=o?o.enumerate:void 0,s=a.propertyIsEnumerable;u&&!s.call({valueOf:1},"valueOf")&&(r=function(e){return i(u(e))}),e.exports=r},function(e,t,n){var r=n(67),o=r.Reflect;e.exports=o},function(e,t){function n(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}e.exports=n},function(e,t,n){function r(e){return e?o(e,i(e)):[]}var o=n(206),i=n(20);e.exports=r},function(e,t,n){function r(e,t){return o(t,function(t){return e[t]})}var o=n(207);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}e.exports=n},function(e,t,n){function r(e,t,n){var r=e?e.length:0;if(!r)return-1;var s=null==n?0:a(n);return 0>s&&(s=u(r+s,0)),o(e,i(t,3),s)}var o=n(209),i=n(40),a=n(129),u=Math.max;e.exports=r},function(e,t){function n(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}e.exports=n},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Memory=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(9),s=n(211),c=r(s),l=n(167),f=r(l),p=n(14),h=r(p),d=n(205),v=r(d),y=n(212),m=r(y),g=n(36),b=r(g),w=n(35),_=r(w),x=e.env.KINVEY_ID_ATTRIBUTE||"_id",E=[];t.Memory=function(){function e(t){if(i(this,e),!t)throw new u.KinveyError("A name for the collection is required to use the memory persistence adapter.",t);if(!(0,b["default"])(t))throw new u.KinveyError("The name of the collection must be a string to use the memory persistence adapter",t);this.name=t,this.cache=E[t],this.cache||(this.cache=new c["default"],E[t]=this.cache)}return a(e,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=this.cache.get(e),!t){n.next=3;break}return n.abrupt("return",JSON.parse(t));case 3:return n.abrupt("return",[]);case 4:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e);case 2:if(r=n.sent,o=(0,m["default"])(r,function(e){return e[x]===t})){n.next=6;break}throw new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" memory database."));case 6:return n.abrupt("return",o);case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"save",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!1,(0,_["default"])(t)||(t=[t],r=!0),0!==t.length){n.next=4;break}return n.abrupt("return",t);case 4:return n.next=6,this.find(e);case 6:return o=n.sent,o=(0,f["default"])(o,x),t=(0,f["default"])(t,x),i=Object.keys(t),(0,h["default"])(i,function(e){o[e]=t[e]}),this.cache.set(e,JSON.stringify((0,v["default"])(o))),t=(0,v["default"])(t),n.abrupt("return",r?t[0]:t);case 14:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.find(e);case 2:if(r=n.sent,r=(0,f["default"])(r,x),o=r[t]){n.next=7;break}throw new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" memory database."));case 7:return delete r[t],this.cache.set(e,JSON.stringify((0,v["default"])(r))),n.abrupt("return",o);case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.clear(),e.abrupt("return",null);case 2:case"end":return e.stop()}},n,this)}));return e}()}],[{key:"isSupported",value:function(){return!0}}]),e}()}).call(t,n(2))},function(e,t){"use strict";function n(){this._cache=r(),this._timeouts=r()}function r(){return Object.create(null)}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t,n){this["delete"](e),this._cache[e]=t,n&&(this._timeouts[e]=setTimeout(this["delete"].bind(this,e),1e3*n))},n.prototype["delete"]=function(e){delete this._cache[e],e in this._timeouts&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},n.prototype.clear=function(){this._cache=r();for(var e in this._timeouts)clearTimeout(this._timeouts[e]);this._timeouts=r()},e.exports=n},function(e,t,n){var r=n(213),o=n(208),i=r(o);e.exports=i},function(e,t,n){function r(e){return function(t,n,r){var u=Object(t);if(n=o(n,3),!i(t))var s=a(t);var c=e(s||t,function(e,t){return s&&(t=e,e=u[t]),n(e,t,u)},r);return c>-1?t[s?s[c]:c]:void 0}}var o=n(40),i=n(28),a=n(20);e.exports=r},function(e,t,n){(function(e,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.WebSQL=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),c=n(215),l=o(c),f=n(14),p=o(f),h=n(35),d=o(h),v=n(31),y=o(v),m=n(36),g=o(m),b=e.env.KINVEY_ID_ATTRIBUTE||"_id",w="sqlite_master",_=5e6,x=null,E={};"undefined"!=typeof window&&(x={openDatabase:"undefined"!=typeof openDatabase?openDatabase:r.openDatabase});t.WebSQL=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"kinvey":arguments[0];a(this,e),this.name=t}return u(e,[{key:"openTransaction",value:function(e,t,n){var r=this,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],i=E[this.name],a='"'+e+'"',u=e===w,c=(0,d["default"])(t);t=c?t:[[t,n]],i||(i=x.openDatabase(this.name,1,"",_),E[this.name]=i);var l=new Promise(function(n,l){var f=o||!(0,y["default"])(i.readTransaction);i[f?"transaction":"readTransaction"](function(e){o&&!u&&e.executeSql("CREATE TABLE IF NOT EXISTS "+a+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)");var r=t.length,i=[];(0,p["default"])(t,function(t){var o=t[0].replace("#{collection}",a);e.executeSql(o,t[1],function(e,t){var o={rowCount:t.rowsAffected,result:[]};if(t.rows.length)for(var a=0,s=t.rows.length;s>a;a++)try{var l=t.rows.item(a).value,f=u?l:JSON.parse(l);o.result.push(f)}catch(p){}i.push(o),r-=1,0===r&&n(c?i:i.shift())})})},function(t){if(t=(0,g["default"])(t)?t:t.message,t&&-1===t.indexOf("no such table"))return l(new s.NotFoundError("The "+e+" collection was not found on "+("the "+r.name+" webSQL database.")));var n="SELECT name AS value from #{collection} WHERE type = ? AND name = ?",o=["table",e];return r.openTransaction(w,n,o).then(function(t){return l(0===t.result.length?new s.NotFoundError("The "+e+" collection was not found on "+("the "+r.name+" webSQL database.")):new s.KinveyError("Unable to open a transaction for the "+e+" "+("collection on the "+r.name+" webSQL database.")))})["catch"](function(t){l(new s.KinveyError("Unable to open a transaction for the "+e+" "+("collection on the "+r.name+" webSQL database."),t))})})});return l}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){var t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="SELECT value FROM #{collection}",n.next=3,this.openTransaction(e,t,[]);case 3:return r=n.sent,n.abrupt("return",r.result);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r,o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r="SELECT value FROM #{collection} WHERE key = ?",n.next=3,this.openTransaction(e,r,[t]);case 3:if(o=n.sent,i=o.result,0!==i.length){n.next=7;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" webSQL database."));case 7:return n.abrupt("return",i[0]);case 8:case"end":return n.stop()}},n,this)}));return e}()},{key:"save",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],t=(0,l["default"])(t,function(e){return r.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e[b],JSON.stringify(e)]]),e}),n.next=4,this.openTransaction(e,r,null,!0);case 4:return n.abrupt("return",t);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"removeById",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var r,o,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[["SELECT value FROM #{collection} WHERE key = ?",[t]],["DELETE FROM #{collection} WHERE key = ?",[t]]],n.next=3,this.openTransaction(e,r,null,!0);case 3:if(o=n.sent,i=o[0].result,a=o[1].rowCount,a=a?a:i.length,0!==a){n.next=9;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" webSQL database."));case 9:return n.abrupt("return",i[0]);case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.openTransaction(w,"SELECT name AS value FROM #{collection} WHERE type = ?",["table"],!1);case 2:if(e=n.sent,t=e.result,0!==t.length){n.next=6;break}return n.abrupt("return",null);case 6:return r=t.filter(function(e){return/^[a-zA-Z0-9\-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]}),n.next=9,this.openTransaction(w,r,null,!0);case 9:return E={},n.abrupt("return",null);case 11:case"end":return n.stop()}},n,this)}));return e}()}],[{key:"isSupported",value:function(){return!!x}}]),e}()}).call(t,n(2),function(){return this}())},function(e,t,n){function r(e,t){var n=u(e)?o:a;return n(e,i(t,3))}var o=n(207),i=n(40),a=n(216),u=n(35);e.exports=r},function(e,t,n){function r(e,t){var n=-1,r=i(e)?Array(e.length):[];return o(e,function(e,o,i){r[++n]=t(e,o,i)}),r}var o=n(16),i=n(28);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyResponse=t.Response=t.KinveyResponseConfig=t.ResponseConfig=t.StatusCode=void 0;var u=function w(e,t,n,r){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&w(i,t,n,r)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(r,n)}return n},s=function _(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:_(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(9),f=n(153),p=n(122),h=r(p),d=n(140),v=r(d),y={Ok:200,Created:201,Empty:204,RedirectTemporarily:301,RedirectPermanetly:302,NotFound:404,ServerError:500};Object.freeze(y),t.StatusCode=y;var m=t.ResponseConfig=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,e),t=(0,h["default"])({statusCode:y.Empty,headers:new f.Headers,data:null},t),this.statusCode=t.statusCode,this.headers=t.headers,this.data=t.data}return c(e,[{key:"headers",get:function(){return this.configHeaders},set:function(e){e instanceof f.Headers||(e=new f.Headers((0,v["default"])(e,"toJSON",e))),this.configHeaders=e}},{key:"data",get:function(){return this.configData},set:function(e){this.configData=e}}]),e}(),g=t.KinveyResponseConfig=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),t}(m),b=t.Response=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?new m:arguments[0];a(this,e),this.config=t}return c(e,[{key:"isSuccess",value:function(){return this.statusCode>=200&&this.statusCode<300||302===this.statusCode}},{key:"config",get:function(){return this.responseConfig},set:function(e){!e||e instanceof m||(e=new m(e)),this.responseConfig=e}},{key:"statusCode",get:function(){return this.config.statusCode},set:function(e){this.config.statusCode=e}},{key:"headers",get:function(){return this.config.headers},set:function(e){this.config.headers=e}},{key:"data",get:function(){return this.config.data},set:function(e){this.config.data=e}},{key:"error",get:function(){return this.isSuccess()?null:new Error}}]),e}();t.KinveyResponse=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),c(t,[{key:"config",get:function(){return s(Object.getPrototypeOf(t.prototype),"config",this)},set:function(e){!e||e instanceof g||(e=new g(e)),u(Object.getPrototypeOf(t.prototype),"config",e,this)}},{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},t=e.name||e.error,n=e.message||e.description,r=e.debug,o=this.statusCode;return"FeatureUnavailableError"===t?new l.FeatureUnavailableError(n,r,o):"IncompleteRequestBodyError"===t?new l.IncompleteRequestBodyError(n,r,o):"InsufficientCredentials"===t?new l.InsufficientCredentialsError(n,r,o):"InvalidCredentials"===t?new l.InvalidCredentialsError(n,r,o):"InvalidIdentifierError"===t?new l.InvalidIdentifierError(n,r,o):"InvalidQuerySyntaxError"===t?new l.InvalidQuerySyntaxError(n,r,o):"JSONParseError"===t?new l.JSONParseError(n,r,o):"MissingQueryError"===t?new l.MissingQueryError(n,r,o):"MissingRequestHeaderError"===t?new l.MissingRequestHeaderError(n,r,o):"MissingRequestParameterError"===t?new l.MissingRequestParameterError(n,r,o):"EntityNotFound"===t||"CollectionNotFound"===t||"AppNotFound"===t||"UserNotFound"===t||"BlobNotFound"===t||"DocumentNotFound"===t||404===o?new l.NotFoundError(n,r,o):"ParameterValueOutOfRangeError"===t?new l.ParameterValueOutOfRangeError(n,r,o):new l.KinveyError(n,r,o)}}]),t}(b)},function(e,t,n){(function(t){e.exports=n(t.env.PROMISE_QUEUE_COVERAGE?219:220)}).call(t,n(2))},function(e,t){},function(e,t,n){var r,o;!function(i,a){"use strict";"object"==typeof e&&e.exports?e.exports=a():(r=a,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o)))}(this,function(){"use strict";function e(e,t){this.pendingPromises=0,this.maxPendingPromises="undefined"!=typeof e?e:1/0,this.maxQueuedPromises="undefined"!=typeof t?t:1/0,this.queue=[]}var t="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},n=function(){},r=function(e){return e&&"function"==typeof e.then?e:new t(function(t){t(e)})};return e.configure=function(e){t=e},e.prototype.add=function(e){var r=this;return new t(function(t,o,i){return r.queue.length>=r.maxQueuedPromises?void o(new Error("Queue limit reached")):(r.queue.push({promiseGenerator:e,resolve:t,reject:o,notify:i||n}),void r._dequeue())})},e.prototype.getPendingLength=function(){return this.pendingPromises},e.prototype.getQueueLength=function(){return this.queue.length},e.prototype._dequeue=function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var t=this.queue.shift();if(!t)return!1;try{this.pendingPromises++,r(t.promiseGenerator()).then(function(n){e.pendingPromises--,t.resolve(n),e._dequeue()},function(n){e.pendingPromises--,t.reject(n),e._dequeue()},function(e){t.notify(e)})}catch(n){e.pendingPromises--,t.reject(n),e._dequeue()}return!0},e})},function(e,t,n){function r(e,t,n){var r=s(e)?o:u,c=arguments.length<3;return r(e,a(t,4),n,c,i)}var o=n(191),i=n(16),a=n(40),u=n(222),s=n(35);e.exports=r},function(e,t){function n(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}e.exports=n},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParseMiddleware=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function l(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:l(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=n(159);t.ParseMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Parse Middleware":arguments[0];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),u(t,[{key:"handle",value:function(){function e(e){return n.apply(this,arguments)}var n=r(regeneratorRuntime.mark(function o(e){var n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,s(Object.getPrototypeOf(t.prototype),"handle",this).call(this,e);case 2:if(e=o.sent,n=e.response,n&&n.data&&(r=n.headers["content-type"]||n.headers["Content-Type"],r&&0===r.indexOf("application/json"))){try{n.data=JSON.parse(n.data)}catch(i){n.data=n.data}e.response=n}return o.abrupt("return",e);case 6:case"end":return o.stop()}},o,this)}));return e}()}]),t}(c.KinveyMiddleware)},function(e,t,n){(function(e){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeMiddleware=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function l(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:l(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=n(159);t.SerializeMiddleware=function(t){function n(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Serialize Middleware":arguments[0];return o(this,n),i(this,Object.getPrototypeOf(n).call(this,e))}return a(n,t),u(n,[{key:"handle",value:function(){function t(e){return o.apply(this,arguments)}var o=r(regeneratorRuntime.mark(function i(t){var r,o,a,u,c,l,f,p,h,d;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,s(Object.getPrototypeOf(n.prototype),"handle",this).call(this,t);case 2:if(t=i.sent,!t||!t.body){i.next=34;break}if(r=t.headers.get("content-type"),!r){i.next=34;break}if(0!==r.indexOf("application/json")){i.next=10;break}t.body=JSON.stringify(t.body),i.next=34;break;case 10:if(0!==r.indexOf("application/x-www-form-urlencoded")){i.next=34;break}for(o=t.body,a=Object.keys(o),u=[],c=!0,l=!1,f=void 0,i.prev=17,p=a[Symbol.iterator]();!(c=(h=p.next()).done);c=!0)d=h.value,u.push(e.encodeURIComponent(d)+"="+e.encodeURIComponent(o[d]));i.next=25;break;case 21:i.prev=21,i.t0=i["catch"](17),l=!0,f=i.t0;case 25:i.prev=25,i.prev=26,!c&&p["return"]&&p["return"]();case 28:if(i.prev=28,!l){i.next=31;break}throw f;case 31:return i.finish(28);case 32:return i.finish(25);case 33:t.body=u.join("&");case 34:return i.abrupt("return",t);case 35:
case"end":return i.stop()}},i,this,[[17,21,25,33],[26,,28,32]])}));return t}()}]),n}(c.KinveyMiddleware)}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMiddleware=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function c(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:c(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},s=n(159);t.HttpMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey Http Middleware":arguments[0];return r(this,t),o(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),a(t,[{key:"handle",value:function(e){return u(Object.getPrototypeOf(t.prototype),"handle",this).call(this,e).then(function(){var e=new Promise(function(e,t){t(new Error("http middleware not installed"))});return e})}}]),t}(s.KinveyMiddleware)},function(e,t,n){"use strict";e.exports=n(227)()?Symbol:n(228)},function(e,t){"use strict";var n={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(t){return!1}return n[typeof Symbol.iterator]&&n[typeof Symbol.toPrimitive]?!!n[typeof Symbol.toStringTag]:!1}},function(e,t,n){"use strict";var r,o,i,a,u=n(229),s=n(242),c=Object.create,l=Object.defineProperties,f=Object.defineProperty,p=Object.prototype,h=c(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),a=!0}catch(d){}}var v=function(){var e=c(null);return function(t){for(var n,r,o=0;e[t+(o||"")];)++o;return t+=o||"",e[t]=!0,n="@@"+t,f(p,n,u.gs(null,function(e){r||(r=!0,f(this,n,u(e)),r=!1)})),n}}();i=function(e){if(this instanceof i)throw new TypeError("TypeError: Symbol is not a constructor");return o(e)},e.exports=o=function y(e){var t;if(this instanceof y)throw new TypeError("TypeError: Symbol is not a constructor");return a?r(e):(t=c(i.prototype),e=void 0===e?"":String(e),l(t,{__description__:u("",e),__name__:u("",v(e))}))},l(o,{"for":u(function(e){return h[e]?h[e]:h[e]=o(String(e))}),keyFor:u(function(e){var t;s(e);for(t in h)if(h[t]===e)return t}),hasInstance:u("",r&&r.hasInstance||o("hasInstance")),isConcatSpreadable:u("",r&&r.isConcatSpreadable||o("isConcatSpreadable")),iterator:u("",r&&r.iterator||o("iterator")),match:u("",r&&r.match||o("match")),replace:u("",r&&r.replace||o("replace")),search:u("",r&&r.search||o("search")),species:u("",r&&r.species||o("species")),split:u("",r&&r.split||o("split")),toPrimitive:u("",r&&r.toPrimitive||o("toPrimitive")),toStringTag:u("",r&&r.toStringTag||o("toStringTag")),unscopables:u("",r&&r.unscopables||o("unscopables"))}),l(i.prototype,{constructor:u(o),toString:u("",function(){return this.__name__})}),l(o.prototype,{toString:u(function(){return"Symbol ("+s(this).__description__+")"}),valueOf:u(function(){return s(this)})}),f(o.prototype,o.toPrimitive,u("",function(){var e=s(this);return"symbol"==typeof e?e:e.toString()})),f(o.prototype,o.toStringTag,u("c","Symbol")),f(i.prototype,o.toStringTag,u("c",o.prototype[o.toStringTag])),f(i.prototype,o.toPrimitive,u("c",o.prototype[o.toPrimitive]))},function(e,t,n){"use strict";var r,o=n(230),i=n(237),a=n(238),u=n(239);r=e.exports=function(e,t){var n,r,a,s,c;return arguments.length<2||"string"!=typeof e?(s=t,t=e,e=null):s=arguments[2],null==e?(n=a=!0,r=!1):(n=u.call(e,"c"),r=u.call(e,"e"),a=u.call(e,"w")),c={value:t,configurable:n,enumerable:r,writable:a},s?o(i(s),c):c},r.gs=function(e,t,n){var r,s,c,l;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:a(t)?null==n?n=void 0:a(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(r=!0,s=!1):(r=u.call(e,"c"),s=u.call(e,"e")),l={get:t,set:n,configurable:r,enumerable:s},c?o(i(c),l):l}},function(e,t,n){"use strict";e.exports=n(231)()?Object.assign:n(232)},function(e,t){"use strict";e.exports=function(){var e,t=Object.assign;return"function"!=typeof t?!1:(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(233),o=n(236),i=Math.max;e.exports=function(e,t){var n,a,u,s=i(arguments.length,2);for(e=Object(o(e)),u=function(r){try{e[r]=t[r]}catch(o){n||(n=o)}},a=1;s>a;++a)t=arguments[a],r(t).forEach(u);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(234)()?Object.keys:n(235)},function(e,t){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t){"use strict";var n=Object.keys;e.exports=function(e){return n(null==e?e:Object(e))}},function(e,t){"use strict";e.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}},function(e,t){"use strict";var n=Array.prototype.forEach,r=Object.create,o=function(e,t){var n;for(n in e)t[n]=e[n]};e.exports=function(e){var t=r(null);return n.call(arguments,function(e){null!=e&&o(Object(e),t)}),t}},function(e,t){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";e.exports=n(240)()?String.prototype.contains:n(241)},function(e,t){"use strict";var n="razdwatrzy";e.exports=function(){return"function"!=typeof n.contains?!1:n.contains("dwa")===!0&&n.contains("foo")===!1}},function(e,t){"use strict";var n=String.prototype.indexOf;e.exports=function(e){return n.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";var r=n(243);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},function(e,t){"use strict";e.exports=function(e){return e?"symbol"==typeof e?!0:e.constructor?"Symbol"!==e.constructor.name?!1:"Symbol"===e[e.constructor.toStringTag]:!1:!1}},function(e,t,n){var r,o,i,a=[].slice;!function(a,u){return null!=n(245)?(o=[],r=u,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i))):"undefined"!=typeof t&&null!==t?e.exports=u():a.UrlPattern=u()}(this,function(){var e,t,n,r,o,i,u,s,c,l,f,p,h,d,v;return c=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},u=function(e,t){var n,r,o;for(o=[],n=-1,r=e.length;++n<r;)o=o.concat(t(e[n]));return o},d=function(e,t){var n,r,o;for(o="",n=-1,r=e.length;++n<r;)o+=t(e[n]);return o},h=function(e){return new RegExp(e.toString()+"|").exec("").length-1},f=function(e,t){var n,r,o,i,a;for(i={},n=-1,o=e.length;++n<o;)r=e[n],a=t[n],null!=a&&(null!=i[r]?(Array.isArray(i[r])||(i[r]=[i[r]]),i[r].push(a)):i[r]=a);return i},e={},e.Result=function(e,t){this.value=e,this.rest=t},e.Tagged=function(e,t){this.tag=e,this.value=t},e.tag=function(t,n){return function(r){var o,i;return o=n(r),null!=o?(i=new e.Tagged(t,o.value),new e.Result(i,o.rest)):void 0}},e.regex=function(t){return function(n){var r,o;return r=t.exec(n),null!=r?(o=r[0],new e.Result(o,n.slice(o.length))):void 0}},e.sequence=function(){var t;return t=1<=arguments.length?a.call(arguments,0):[],function(n){var r,o,i,a,u,s;for(r=-1,o=t.length,s=[],a=n;++r<o;){if(i=t[r],u=i(a),null==u)return;s.push(u.value),a=u.rest}return new e.Result(s,a)}},e.pick=function(){var t,n;return t=arguments[0],n=2<=arguments.length?a.call(arguments,1):[],function(r){var o,i;return i=e.sequence.apply(e,n)(r),null!=i?(o=i.value,i.value=o[t],i):void 0}},e.string=function(t){var n;return n=t.length,function(r){return r.slice(0,n)===t?new e.Result(t,r.slice(n)):void 0}},e.lazy=function(e){var t;return t=null,function(n){return null==t&&(t=e()),t(n)}},e.baseMany=function(t,n,r,o,i){var a,u,s,c;for(s=i,c=r?"":[];;){if(null!=n&&(a=n(s),null!=a))break;if(u=t(s),null==u)break;r?c+=u.value:c.push(u.value),s=u.rest}return o&&0===c.length?void 0:new e.Result(c,s)},e.many1=function(t){return function(n){return e.baseMany(t,null,!1,!0,n)}},e.concatMany1Till=function(t,n){return function(r){return e.baseMany(t,n,!0,!0,r)}},e.firstChoice=function(){var e;return e=1<=arguments.length?a.call(arguments,0):[],function(t){var n,r,o,i;for(n=-1,r=e.length;++n<r;)if(o=e[n],i=o(t),null!=i)return i}},p=function(t){var n;return n={},n.wildcard=e.tag("wildcard",e.string(t.wildcardChar)),n.optional=e.tag("optional",e.pick(1,e.string(t.optionalSegmentStartChar),e.lazy(function(){return n.pattern}),e.string(t.optionalSegmentEndChar))),n.name=e.regex(new RegExp("^["+t.segmentNameCharset+"]+")),n.named=e.tag("named",e.pick(1,e.string(t.segmentNameStartChar),e.lazy(function(){return n.name}))),n.escapedChar=e.pick(1,e.string(t.escapeChar),e.regex(/^./)),n["static"]=e.tag("static",e.concatMany1Till(e.firstChoice(e.lazy(function(){return n.escapedChar}),e.regex(/^./)),e.firstChoice(e.string(t.segmentNameStartChar),e.string(t.optionalSegmentStartChar),e.string(t.optionalSegmentEndChar),n.wildcard))),n.token=e.lazy(function(){return e.firstChoice(n.wildcard,n.optional,n.named,n["static"])}),n.pattern=e.many1(e.lazy(function(){return n.token})),n},s={escapeChar:"\\",segmentNameStartChar:":",segmentValueCharset:"a-zA-Z0-9-_~ %",segmentNameCharset:"a-zA-Z0-9",optionalSegmentStartChar:"(",optionalSegmentEndChar:")",wildcardChar:"*"},i=function(e,t){if(Array.isArray(e))return d(e,function(e){return i(e,t)});switch(e.tag){case"wildcard":return"(.*?)";case"named":return"(["+t+"]+)";case"static":return c(e.value);case"optional":return"(?:"+i(e.value,t)+")?"}},o=function(e,t){return null==t&&(t=s.segmentValueCharset),"^"+i(e,t)+"$"},r=function(e){if(Array.isArray(e))return u(e,r);switch(e.tag){case"wildcard":return["_"];case"named":return[e.value];case"static":return[];case"optional":return r(e.value)}},l=function(e,t,n,r){var o,i,a,u;if(null==r&&(r=!1),u=e[t],null!=u){if(o=n[t]||0,i=Array.isArray(u)?u.length-1:0,!(o>i))return a=Array.isArray(u)?u[o]:u,r&&(n[t]=o+1),a;if(r)throw new Error("too few values provided for key `"+t+"`")}else if(r)throw new Error("no values provided for key `"+t+"`")},n=function(e,t,r){var o,i;if(Array.isArray(e)){for(o=-1,i=e.length;++o<i;)if(n(e[o],t,r))return!0;return!1}switch(e.tag){case"wildcard":return null!=l(t,"_",r,!1);case"named":return null!=l(t,e.value,r,!1);case"static":return!1;case"optional":return n(e.value,t,r)}},v=function(e,t,r){if(Array.isArray(e))return d(e,function(e){return v(e,t,r)});switch(e.tag){case"wildcard":return l(t,"_",r,!0);case"named":return l(t,e.value,r,!0);case"static":return e.value;case"optional":return n(e.value,t,r)?v(e.value,t,r):""}},t=function(e,n){var i,a,u,c,l;if(e instanceof t)return this.isRegex=e.isRegex,this.regex=e.regex,this.ast=e.ast,void(this.names=e.names);if(this.isRegex=e instanceof RegExp,"string"!=typeof e&&!this.isRegex)throw new TypeError("argument must be a regex or a string");if(this.isRegex){if(this.regex=e,null!=n){if(!Array.isArray(n))throw new Error("if first argument is a regex the second argument may be an array of group names but you provided something else");if(i=h(this.regex),n.length!==i)throw new Error("regex contains "+i+" groups but array of group names contains "+n.length);this.names=n}}else{if(""===e)throw new Error("argument must not be the empty string");if(l=e.replace(/\s+/g,""),l!==e)throw new Error("argument must not contain whitespace");if(a={escapeChar:(null!=n?n.escapeChar:void 0)||s.escapeChar,segmentNameStartChar:(null!=n?n.segmentNameStartChar:void 0)||s.segmentNameStartChar,segmentNameCharset:(null!=n?n.segmentNameCharset:void 0)||s.segmentNameCharset,segmentValueCharset:(null!=n?n.segmentValueCharset:void 0)||s.segmentValueCharset,optionalSegmentStartChar:(null!=n?n.optionalSegmentStartChar:void 0)||s.optionalSegmentStartChar,optionalSegmentEndChar:(null!=n?n.optionalSegmentEndChar:void 0)||s.optionalSegmentEndChar,wildcardChar:(null!=n?n.wildcardChar:void 0)||s.wildcardChar},c=p(a),u=c.pattern(e),null==u)throw new Error("couldn't parse pattern");if(""!==u.rest)throw new Error("could only partially parse pattern");this.ast=u.value,this.regex=new RegExp(o(this.ast,a.segmentValueCharset)),this.names=r(this.ast)}},t.prototype.match=function(e){var t,n;return n=this.regex.exec(e),null==n?null:(t=n.slice(1),this.names?f(this.names,t):t)},t.prototype.stringify=function(e){if(null==e&&(e={}),this.isRegex)throw new Error("can't stringify patterns generated from a regex");if(e!==Object(e))throw new Error("argument must be an object or undefined");return v(this.ast,e,{})},t.escapeForRegex=c,t.concatMap=u,t.stringConcatMap=d,t.regexGroupCount=h,t.keysAndValuesToObject=f,t.P=e,t.newParser=p,t.defaultOptions=s,t.astNodeToRegexString=o,t.astNodeToNames=r,t.getParam=l,t.astNodeContainsSegmentsForProvidedParams=n,t.stringify=v,t})},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";var r=n(247),o=n(249);e.exports={stringify:r,parse:o}},function(e,t,n){"use strict";var r=n(248),o={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},i={delimiter:"&",strictNullHandling:!1,skipNulls:!1,encode:!0,encoder:r.encode},a=function u(e,t,n,o,i,a,s,c,l){var f=e;if("function"==typeof s)f=s(t,f);else if(f instanceof Date)f=f.toISOString();else if(null===f){if(o)return a?a(t):t;f=""}if("string"==typeof f||"number"==typeof f||"boolean"==typeof f||r.isBuffer(f))return a?[a(t)+"="+a(f)]:[t+"="+String(f)];var p=[];if("undefined"==typeof f)return p;var h;if(Array.isArray(s))h=s;else{var d=Object.keys(f);h=c?d.sort(c):d}for(var v=0;v<h.length;++v){var y=h[v];i&&null===f[y]||(p=Array.isArray(f)?p.concat(u(f[y],n(t,y),n,o,i,a,s,c,l)):p.concat(u(f[y],t+(l?"."+y:"["+y+"]"),n,o,i,a,s,c,l)))}return p};e.exports=function(e,t){var n,r,u=e,s=t||{},c="undefined"==typeof s.delimiter?i.delimiter:s.delimiter,l="boolean"==typeof s.strictNullHandling?s.strictNullHandling:i.strictNullHandling,f="boolean"==typeof s.skipNulls?s.skipNulls:i.skipNulls,p="boolean"==typeof s.encode?s.encode:i.encode,h=p?"function"==typeof s.encoder?s.encoder:i.encoder:null,d="function"==typeof s.sort?s.sort:null,v="undefined"==typeof s.allowDots?!1:s.allowDots;if(null!==s.encoder&&void 0!==s.encoder&&"function"!=typeof s.encoder)throw new TypeError("Encoder has to be a function.");"function"==typeof s.filter?(r=s.filter,u=r("",u)):Array.isArray(s.filter)&&(n=r=s.filter);var y=[];if("object"!=typeof u||null===u)return"";var m;m=s.arrayFormat in o?s.arrayFormat:"indices"in s?s.indices?"indices":"repeat":"indices";var g=o[m];n||(n=Object.keys(u)),d&&n.sort(d);for(var b=0;b<n.length;++b){var w=n[b];f&&null===u[w]||(y=y.concat(a(u[w],w,g,l,f,h,r,d,v)))}return y.join(c)}},function(e,t){"use strict";var n=function(){for(var e=new Array(256),t=0;256>t;++t)e[t]="%"+((16>t?"0":"")+t.toString(16)).toUpperCase();return e}();t.arrayToObject=function(e,t){for(var n=t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)"undefined"!=typeof e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,r){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];e[n]=!0}return e}if("object"!=typeof e)return[e].concat(n);var o=e;return Array.isArray(e)&&!Array.isArray(n)&&(o=t.arrayToObject(e,r)),Object.keys(n).reduce(function(e,o){var i=n[o];return Object.prototype.hasOwnProperty.call(e,o)?e[o]=t.merge(e[o],i,r):e[o]=i,e},o)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",o=0;o<t.length;++o){var i=t.charCodeAt(o);45===i||46===i||95===i||126===i||i>=48&&57>=i||i>=65&&90>=i||i>=97&&122>=i?r+=t.charAt(o):128>i?r+=n[i]:2048>i?r+=n[192|i>>6]+n[128|63&i]:55296>i||i>=57344?r+=n[224|i>>12]+n[128|i>>6&63]+n[128|63&i]:(o+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(o)),r+=n[240|i>>18]+n[128|i>>12&63]+n[128|i>>6&63]+n[128|63&i])}return r},t.compact=function(e,n){if("object"!=typeof e||null===e)return e;var r=n||[],o=r.indexOf(e);if(-1!==o)return r[o];if(r.push(e),Array.isArray(e)){for(var i=[],a=0;a<e.length;++a)e[a]&&"object"==typeof e[a]?i.push(t.compact(e[a],r)):"undefined"!=typeof e[a]&&i.push(e[a]);return i}for(var u=Object.keys(e),s=0;s<u.length;++s){var c=u[s];e[c]=t.compact(e[c],r)}return e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null===e||"undefined"==typeof e?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";var r=n(248),o={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3,strictNullHandling:!1,plainObjects:!1,allowPrototypes:!1,allowDots:!1,decoder:r.decode},i=function(e,t){for(var n={},r=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),o=0;o<r.length;++o){var i=r[o],a=-1===i.indexOf("]=")?i.indexOf("="):i.indexOf("]=")+1;if(-1===a)n[t.decoder(i)]="",t.strictNullHandling&&(n[t.decoder(i)]=null);else{var u=t.decoder(i.slice(0,a)),s=t.decoder(i.slice(a+1));Object.prototype.hasOwnProperty.call(n,u)?n[u]=[].concat(n[u]).concat(s):n[u]=s}}return n},a=function s(e,t,n){if(!e.length)return t;var r,o=e.shift();if("[]"===o)r=[],r=r.concat(s(e,t,n));else{r=n.plainObjects?Object.create(null):{};var i="["===o[0]&&"]"===o[o.length-1]?o.slice(1,o.length-1):o,a=parseInt(i,10);!isNaN(a)&&o!==i&&String(a)===i&&a>=0&&n.parseArrays&&a<=n.arrayLimit?(r=[],r[a]=s(e,t,n)):r[i]=s(e,t,n)}return r},u=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^\.\[]+)/g,"[$1]"):e,o=/^([^\[\]]*)/,i=/(\[[^\[\]]*\])/g,u=o.exec(r),s=[];if(u[1]){if(!n.plainObjects&&Object.prototype.hasOwnProperty(u[1])&&!n.allowPrototypes)return;s.push(u[1])}for(var c=0;null!==(u=i.exec(r))&&c<n.depth;)c+=1,(n.plainObjects||!Object.prototype.hasOwnProperty(u[1].replace(/\[|\]/g,""))||n.allowPrototypes)&&s.push(u[1]);return u&&s.push("["+r.slice(u.index)+"]"),a(s,t,n)}};e.exports=function(e,t){var n=t||{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:o.delimiter,n.depth="number"==typeof n.depth?n.depth:o.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:o.arrayLimit,n.parseArrays=n.parseArrays!==!1,n.decoder="function"==typeof n.decoder?n.decoder:o.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:o.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:o.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:o.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:o.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:o.strictNullHandling,""===e||null===e||"undefined"==typeof e)return n.plainObjects?Object.create(null):{};for(var a="string"==typeof e?i(e,n):e,s=n.plainObjects?Object.create(null):{},c=Object.keys(a),l=0;l<c.length;++l){var f=c[l],p=u(f,a[f],n);s=r.merge(s,p,n)}return r.compact(s)}},function(e,t,n){function r(e,t){var n=[],o=!1;return Array.isArray(e)&&t&&(o=!0),Object.keys(e).forEach(function(i){var a,u,s=e[i];a=t?t+"["+(o?"":i)+"]":i,u="object"==typeof s?r(s,a):encodeURIComponent(a)+"="+encodeURIComponent(s),n.push(u)}),n.join("&")}var o=n(149),i=n(251),a=n(146);e.exports=function(e,t){var n=a.parse(e,!0),u=i(!0,{},n.query,"string"==typeof t?o.parse(t):t);return n.search="?"+r(u),a.format(n)}},function(e,t){var n,r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=function(e){"use strict";if(!e||"[object Object]"!==o.call(e)||e.nodeType||e.setInterval)return!1;var t=r.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;var a;for(a in e);return a===n||r.call(e,a)};e.exports=function a(){"use strict";var e,t,r,o,u,s,c=arguments[0],l=1,f=arguments.length,p=!1;for("boolean"==typeof c?(p=c,c=arguments[1]||{},l=2):("object"!=typeof c&&"function"!=typeof c||c==n)&&(c={});f>l;++l)if(null!=(e=arguments[l]))for(t in e)r=c[t],o=e[t],c!==o&&(p&&o&&(i(o)||(u=Array.isArray(o)))?(u?(u=!1,s=r&&Array.isArray(r)?r:[]):s=r&&i(r)?r:{},c[t]=a(p,s,o)):o!==n&&(c[t]=o));return c}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRequest=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function _(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:_(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=n(153),f=n(158),p=n(9),h=n(217),d=n(142),v=n(146),y=r(v),m=e.env.KINVEY_SOCIAL_IDENTITY_ATTRIBUTE||"_socialIdentity",g=e.env.KINVEY_MIC_IDENTITY||"kinveyAuth",b=e.env.KINVEY_MIC_TOKEN_PATHNAME||"/oauth/token",w=e.env.KINVEY_USERS_NAMESPACE||"user";t.NetworkRequest=function(e){function t(e){i(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.rack=f.NetworkRack.sharedInstance(),n.automaticallyRefreshAuthToken=!0,n}return u(t,e),s(t,[{key:"execute",value:function(){function e(){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(){var e,n,o,i,a,u,s,f,v,_,x,E;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c(Object.getPrototypeOf(t.prototype),"execute",this).call(this);case 3:return r.next=5,this.rack.execute(this);case 5:if(e=r.sent,this.executing=!1,e){r.next=9;break}throw new p.NoResponseError;case 9:if(e instanceof h.KinveyResponse||(e=new h.KinveyResponse(new h.KinveyResponseConfig({statusCode:e.statusCode,headers:e.headers,data:e.data}))),e.isSuccess()){r.next=12;break}throw e.error;case 12:return r.abrupt("return",e);case 15:if(r.prev=15,r.t0=r["catch"](0),!(r.t0 instanceof p.InvalidCredentialsError&&this.automaticallyRefreshAuthToken)){r.next=53;break}if(this.automaticallyRefreshAuthToken=!1,n=this.client?this.client.activeSocialIdentity:void 0,!n||n.identity!==g){r.next=53;break}return o=n.token,i=new l.KinveyRequestConfig({method:l.RequestMethod.POST,authType:l.AuthType.App,url:y["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:b}),properties:this.properties,body:{grant_type:"refresh_token",client_id:o.audience,redirect_uri:n.redirectUri,refresh_token:o.refresh_token}}),i.headers.set("Content-Type","application/x-www-form-urlencoded"),a=new t(i),a.automaticallyRefreshAuthToken=!1,r.next=28,a.execute().then(function(e){return e.data});case 28:return u=r.sent,s=this.client.activeUser,f=s[m],f[n.identity]=u,v={},v[m]=f,_=new t({method:l.RequestMethod.POST,authType:l.AuthType.App,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+w+"/"+this.client.appKey+"/login"}),properties:this.properties,data:v,timeout:this.timeout,client:this.client}),_.automaticallyRefreshAuthToken=!1,r.next=38,_.execute().then(function(e){return e.data});case 38:return x=r.sent,(0,d.setActiveUser)(this.client,x),(0,d.setActiveSocialIdentity)(this.client,{identity:n.identity,redirectUri:n.redirectUri,token:x[m][n.identity],client:n.client}),r.prev=41,r.next=44,this.execute();case 44:return E=r.sent,this.automaticallyRefreshAuthToken=!0,r.abrupt("return",E);case 49:throw r.prev=49,r.t1=r["catch"](41),this.automaticallyRefreshAuthToken=!0,r.t1;case 53:throw r.t0;case 54:case"end":return r.stop()}},r,this,[[0,15],[41,49]])}));return e}()},{key:"cancel",value:function(){var e=this,n=c(Object.getPrototypeOf(t.prototype),"cancel",this).call(this).then(function(){return e.rack.cancel()});return n}}]),t}(l.KinveyRequest)}).call(t,n(2))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=n(254),s=r(u),c=n(199),l=r(c),f=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd";t.Metadata=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),!(0,l["default"])(t))throw new a.KinveyError("entity argument must be an object");this.kmd=(0,s["default"])(t[f]||{})}return i(e,[{key:"isLocal",value:function(){return!!this.kmd.local}},{key:"toJSON",value:function(){return this.kmd}},{key:"createdAt",get:function(){return this.kmd.ect?Date.parse(this.kmd.ect):void 0}},{key:"emailVerification",get:function(){return this.kmd.emailVerification.status}},{key:"lastModified",get:function(){return this.kmd.lmt?Date.parse(this.kmd.lmt):void 0}},{key:"lmt",get:function(){return this.lastModified}},{key:"authtoken",get:function(){return this.kmd.authtoken},set:function(e){this.kmd.authtoken=e}}]),e}()}).call(t,n(2))},function(e,t,n){function r(e){return o(e,!1,!0)}var o=n(175);e.exports=r},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DataStore=t.DataStoreType=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),c=n(256),l=r(c),f=n(257),p=n(252),h=n(153),d=n(12),v=n(258),y=n(253),m=n(141),g=r(m),b=n(226),w=r(b),_=n(275),x=r(_),E=n(284),k=r(E),O=n(167),j=r(O),R=n(36),S=r(R),T=n(146),I=r(T),A=n(294),P=r(A),q=n(215),C=r(q),D=n(140),N=r(D),M=n(35),B=r(M),K=n(297),L=r(K),U=e.env.KINVEY_ID_ATTRIBUTE||"_id",F=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",$=(0,w["default"])(),V=(0,w["default"])(),Y={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(Y),t.DataStoreType=Y;var z=function(){function e(t){if(i(this,e),t&&!(0,S["default"])(t))throw new s.KinveyError("Collection must be a string.");this.collection=t,this.ttl=void 0,this.useDeltaFetch=!1,this.client=g["default"].sharedInstance(),this.dataStoreSync=new x["default"],this.dataStoreSync.client=this.client,this.online(),this.enableCache()}return u(e,[{key:"disableCache",value:function(){if(!this.isOnline())throw new s.KinveyError("Unable to disable the cache when the store is offline. Please make the store online by calling `store.online()`.");return this[$]=!1,this}},{key:"enableCache",value:function(){return this[$]=!0,this}},{key:"isCacheEnabled",value:function(){return this[$]}},{key:"offline",value:function(){if(!this.isCacheEnabled())throw new s.KinveyError("Unable to go offline when the cache for the store is disabled. Please enable the cache by calling `store.enableCache()`.");return this[V]=!1,this}},{key:"online",value:function(){return this[V]=!0,this}},{key:"isOnline",value:function(){return this[V]}},{key:"find",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,c,v,y,m,g,b,w,_,x,E,O,R;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o=[],a=[],!e||e instanceof d.Query){i.next=4;break}return i.abrupt("return",r.error(new s.KinveyError("Invalid query. It must be an instance of the Query class.")));case 4:if(i.prev=4,!t.isCacheEnabled()){i.next=25;break}if(!t.isOnline()){i.next=18;break}return i.next=9,t.syncCount();case 9:if(u=i.sent,!(u>0)){i.next=16;break}return i.next=13,t.push();case 13:return i.next=15,t.syncCount();case 15:u=i.sent;case 16:if(!(u>0)){i.next=18;break}throw new s.KinveyError("Unable to load data from the network. "+("There are "+u+" entities that need ")+"to be synced before data is loaded from the network.");case 18:return c=new h.KinveyRequestConfig({method:h.RequestMethod.GET,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),v=new l["default"](c),i.next=22,v.execute();case 22:y=i.sent,o=y.data,r.next(o);case 25:i.next=30;break;case 27:i.prev=27,i.t0=i["catch"](4),r.next([]);case 30:if(i.prev=30,!t.isOnline()){i.next=51;break}return m=n.useDeltaFetch||!!t.useDeltaFetch,g=new h.KinveyRequestConfig({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}),b=new p.NetworkRequest(g),m&&(b=new f.DeltaFetchRequest(g)),i.next=38,b.execute();case 38:if(w=i.sent,a=w.data,!t.isCacheEnabled()){i.next=50;break}return _=(0,k["default"])(o,a,U),x=Object.keys((0,j["default"])(_,U)),E=(new d.Query).contains(U,x),O=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:E,timeout:n.timeout}),R=new l["default"](O),i.next=48,R.execute();case 48:return i.next=50,t.updateCache(a);case 50:r.next(a);case 51:i.next=56;break;case 53:return i.prev=53,i.t1=i["catch"](30),i.abrupt("return",r.error(i.t1));case 56:return i.abrupt("return",r.complete());case 57:case"end":return i.stop()}},i,t,[[4,27],[30,53]])}));return function(e){return r.apply(this,arguments)}}());return r}},{key:"findById",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,c,d,v,y,m,g,b,w;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e){i.next=4;break}r.next(null),i.next=52;break;
case 4:if(i.prev=4,!t.isCacheEnabled()){i.next=24;break}if(!t.isOnline()){i.next=18;break}return i.next=9,t.syncCount();case 9:if(o=i.sent,!(o>0)){i.next=16;break}return i.next=13,t.push();case 13:return i.next=15,t.syncCount();case 15:o=i.sent;case 16:if(!(o>0)){i.next=18;break}throw new s.KinveyError("Unable to load data. "+("There are "+o+" entities that need ")+"to be synced before data can be loaded.");case 18:return a=new h.KinveyRequestConfig({method:h.RequestMethod.GET,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:n.query}),properties:n.properties,timeout:n.timeout}),u=new l["default"](a),i.next=22,u.execute();case 22:c=i.sent,r.next(c.data);case 24:i.next=29;break;case 26:i.prev=26,i.t0=i["catch"](4),r.next(void 0);case 29:if(i.prev=29,!t.isOnline()){i.next=42;break}return d=n.useDeltaFetch||!!t.useDeltaFetch,v=new h.KinveyRequestConfig({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:n.query}),properties:n.properties,timeout:n.timeout,client:t.client}),y=new p.NetworkRequest(v),d&&(y=new f.DeltaFetchRequest(v)),i.next=37,y.execute();case 37:return m=i.sent,g=m.data,r.next(g),i.next=42,t.updateCache(g);case 42:i.next=52;break;case 44:if(i.prev=44,i.t1=i["catch"](29),!(i.t1 instanceof s.NotFoundError)){i.next=51;break}return b=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:n.query}),properties:n.properties,timeout:n.timeout}),w=new l["default"](b),i.next=51,w.execute();case 51:return i.abrupt("return",r.error(i.t1));case 52:return i.abrupt("return",r.complete());case 53:case"end":return i.stop()}},i,t,[[4,26],[29,44]])}));return function(e){return r.apply(this,arguments)}}());return r}},{key:"count",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,c,f,v,y,m,g;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e||e instanceof d.Query){i.next=2;break}return i.abrupt("return",r.error(new s.KinveyError("Invalid query. It must be an instance of the Query class.")));case 2:if(i.prev=2,!t.isCacheEnabled()){i.next=23;break}if(!t.isOnline()){i.next=16;break}return i.next=7,t.syncCount();case 7:if(o=i.sent,!(o>0)){i.next=14;break}return i.next=11,t.push();case 11:return i.next=13,t.syncCount();case 13:o=i.sent;case 14:if(!(o>0)){i.next=16;break}throw new s.KinveyError("Unable to count data. "+("There are "+o+" entities that need ")+"to be synced before data is counted.");case 16:return a=new h.KinveyRequestConfig({method:h.RequestMethod.GET,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/_count",query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),u=new l["default"](a),i.next=20,u.execute();case 20:c=i.sent,f=c.data,r.next(f?f.count:0);case 23:i.next=28;break;case 25:i.prev=25,i.t0=i["catch"](2),r.next(null);case 28:if(i.prev=28,!t.isOnline()){i.next=37;break}return v=new h.KinveyRequestConfig({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/_count",query:n.query}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}),y=new p.NetworkRequest(v),i.next=34,y.execute();case 34:m=i.sent,g=m.data,r.next(g?g.count:0);case 37:i.next=42;break;case 39:return i.prev=39,i.t1=i["catch"](28),i.abrupt("return",r.error(i.t1));case 42:return i.abrupt("return",r.complete());case 43:case"end":return i.stop()}},i,t,[[2,25],[28,39]])}));return function(e){return r.apply(this,arguments)}}());return r}},{key:"create",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,s,c,f,v,y;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}r.next(null),i.next=34;break;case 5:if(o=!1,(0,B["default"])(e)||(o=!0,e=[e]),!t.isCacheEnabled()){i.next=28;break}return a=new h.KinveyRequestConfig({method:h.RequestMethod.POST,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,body:e,timeout:n.timeout}),u=new l["default"](a),i.next=12,u.execute();case 12:if(s=i.sent,e=s.data,!(e.length>0)){i.next=25;break}return i.next=17,t.dataStoreSync.addCreateOperation(t.collection,e,n);case 17:if(!t.isOnline()){i.next=25;break}return c=Object.keys((0,j["default"])(e,U)),f=(new d.Query).contains("entity._id",c),i.next=22,t.push(f,n);case 22:v=i.sent,v=(0,P["default"])(v,function(e){return!e.error}),e=(0,C["default"])(v,function(e){return e.entity});case 25:r.next(o?e[0]:e),i.next=34;break;case 28:if(!t.isOnline()){i.next=34;break}return i.next=31,Promise.all((0,C["default"])(e,function(e){var r=new h.KinveyRequestConfig({method:h.RequestMethod.POST,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}),o=new p.NetworkRequest(r);return o.execute()}));case 31:y=i.sent,e=(0,C["default"])(y,function(e){return e.data}),r.next(o?e[0]:e);case 34:i.next=39;break;case 36:return i.prev=36,i.t0=i["catch"](0),i.abrupt("return",r.error(i.t0));case 39:return i.abrupt("return",r.complete());case 40:case"end":return i.stop()}},i,t,[[0,36]])}));return function(e){return r.apply(this,arguments)}}());return r.toPromise()}},{key:"update",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,s,c,f,v,y,m;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}r.next(null),i.next=35;break;case 5:if(o=!1,a=e[U],(0,B["default"])(e)||(o=!0,e=[e]),!t.isCacheEnabled()){i.next=29;break}return u=new h.KinveyRequestConfig({method:h.RequestMethod.PUT,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:a?t.pathname+"/"+a:t.pathname,query:n.query}),properties:n.properties,body:e,timeout:n.timeout}),s=new l["default"](u),i.next=13,s.execute();case 13:if(c=i.sent,e=c.data,!(e.length>0)){i.next=26;break}return i.next=18,t.dataStoreSync.addUpdateOperation(t.collection,e,n);case 18:if(!t.isOnline()){i.next=26;break}return f=Object.keys((0,j["default"])(e,U)),v=(new d.Query).contains("entity._id",f),i.next=23,t.push(v,n);case 23:y=i.sent,y=(0,P["default"])(y,function(e){return!e.error}),e=(0,C["default"])(y,function(e){return e.entity});case 26:r.next(o?e[0]:e),i.next=35;break;case 29:if(!t.isOnline()){i.next=35;break}return i.next=32,Promise.all((0,C["default"])(e,function(e){var r=e[U],o=new h.KinveyRequestConfig({method:h.RequestMethod.PUT,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:r?t.pathname+"/"+r:t.pathname,query:n.query}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}),i=new p.NetworkRequest(o);return i.execute()}));case 32:m=i.sent,e=(0,C["default"])(m,function(e){return e.data}),r.next(o?e[0]:e);case 35:i.next=40;break;case 37:return i.prev=37,i.t0=i["catch"](0),i.abrupt("return",r.error(i.t0));case 40:return i.abrupt("return",r.complete());case 41:case"end":return i.stop()}},i,t,[[0,37]])}));return function(e){return r.apply(this,arguments)}}());return r.toPromise()}},{key:"save",value:function(e,t){return e[U]?this.update(e,t):this.create(e,t)}},{key:"remove",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,c,f,v,m,g,b,w,_,x,E;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof d.Query){i.next=5;break}throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");case 5:if(!t.isCacheEnabled()){i.next=31;break}return o=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),a=new l["default"](o),i.next=10,a.execute();case 10:if(u=i.sent,c=u.data,!(c.length>0)){i.next=28;break}return f=(0,P["default"])(c,function(e){var t=new y.Metadata(e);return t.isLocal()}),v=(new d.Query).contains("entity._id",Object.keys((0,j["default"])(f,U))),i.next=17,t.dataStoreSync.clear(v,n);case 17:return m=(0,L["default"])(c,f,function(e,t){return e[U]===t[U]}),i.next=20,t.dataStoreSync.addDeleteOperation(t.collection,m,n);case 20:if(!t.isOnline()){i.next=28;break}return g=Object.keys((0,j["default"])(m,U)),b=(new d.Query).contains("entity._id",g),i.next=25,t.push(b,n);case 25:w=i.sent,w=(0,P["default"])(w,function(e){return!e.error}),c=(0,C["default"])(w,function(e){return e.entity});case 28:r.next(c),i.next=38;break;case 31:if(!t.isOnline()){i.next=38;break}return _=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}),x=new p.NetworkRequest(_),i.next=36,x.execute();case 36:E=i.sent,r.next(E.data);case 38:i.next=43;break;case 40:return i.prev=40,i.t0=i["catch"](0),i.abrupt("return",r.error(i.t0));case 43:return i.abrupt("return",r.complete());case 44:case"end":return i.stop()}},i,t,[[0,40]])}));return function(e){return r.apply(this,arguments)}}());return r.toPromise()}},{key:"removeById",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,s,c,f,v,m,g,b,w;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}r.next(null),i.next=34;break;case 5:if(!t.isCacheEnabled()){i.next=33;break}return o=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:n.query}),properties:n.properties,authType:h.AuthType.Default,timeout:n.timeout}),a=new l["default"](o),i.next=10,a.execute();case 10:if(u=i.sent,s=u.data,!s){i.next=30;break}if(c=new y.Metadata(s),!c.isLocal()){i.next=21;break}return f=new d.Query,f.equalTo("entity._id",s[U]),i.next=19,t.dataStoreSync.clear(t.collection,f,n);case 19:i.next=23;break;case 21:return i.next=23,t.dataStoreSync.addDeleteOperation(t.collection,s,n);case 23:if(!t.isOnline()){i.next=30;break}return v=(new d.Query).equalTo("entity._id",s[U]),i.next=27,t.push(v,n);case 27:m=i.sent,m=(0,P["default"])(m,function(e){return!e.error}),s=(0,C["default"])(m,function(e){return e.entity});case 30:r.next(s),i.next=34;break;case 33:t.isOnline()&&(g=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,authType:h.AuthType.Default,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:n.query}),properties:n.properties,timeout:n.timeout}),b=new p.NetworkRequest(g),w=b.execute(),r.next(w.data));case 34:i.next=39;break;case 36:return i.prev=36,i.t0=i["catch"](0),i.abrupt("return",r.error(i.t0));case 39:return i.abrupt("return",r.complete());case 40:case"end":return i.stop()}},i,t,[[0,36]])}));return function(e){return r.apply(this,arguments)}}());return r.toPromise()}},{key:"clear",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=v.KinveyObservable.create(function(){var r=o(regeneratorRuntime.mark(function i(r){var o,a,u,c,f,p;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e||e instanceof d.Query){i.next=2;break}return i.abrupt("return",r.error(new s.KinveyError("Invalid query. It must be an instance of the Query class.")));case 2:if(i.prev=2,!t.isCacheEnabled()){i.next=21;break}return o=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,url:I["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),a=new l["default"](o),i.next=8,a.execute();case 8:if(u=i.sent,c=u.data,!(c.length>0)){i.next=16;break}return f=(new d.Query).contains("entity._id",Object.keys((0,j["default"])(c,U))),i.next=14,t.dataStoreSync.clear(f,n);case 14:i.next=20;break;case 16:if(e){i.next=20;break}return p=(new d.Query).equalTo("collection",t.collection),i.next=20,t.dataStoreSync.clear(p,n);case 20:r.next(c);case 21:i.next=26;break;case 23:return i.prev=23,i.t0=i["catch"](2),i.abrupt("return",r.error(i.t0));case 26:return i.abrupt("return",r.complete());case 27:case"end":return i.stop()}},i,t,[[2,23]])}));return function(e){return r.apply(this,arguments)}}());return r.toPromise()}},{key:"push",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e=arguments.length<=0||void 0===arguments[0]?new d.Query:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isCacheEnabled()){n.next=4;break}return e instanceof d.Query||(e=new d.Query((0,N["default"])(e,"toJSON",e))),e.equalTo("collection",this.collection),n.abrupt("return",this.dataStoreSync.push(e,t));case 4:throw new s.KinveyError("Unable to push because the cache is disabled.");case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"pull",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r=this,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isCacheEnabled()){n.next=5;break}return n.delegateYield(regeneratorRuntime.mark(function i(){var t,n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.syncCount(null,o);case 2:if(t=i.sent,!(t>0)){i.next=5;break}throw new s.KinveyError(t+" items could not be pushed to the backend. You must push all pending sync items before new data is pulled.","Call push() on the data store instance to push the remaining sync items.");case 5:return n=r.isOnline(),r.online(),i.abrupt("return",{v:r.find(e,o).toPromise().then(function(e){return n===!1&&r.offline(),e})["catch"](function(e){throw n===!1&&r.offline(),e})});case 8:case"end":return i.stop()}},i,r)})(),"t0",2);case 2:if(t=n.t0,"object"!==("undefined"==typeof t?"undefined":a(t))){n.next=5;break}return n.abrupt("return",t.v);case 5:throw new s.KinveyError("Unable to pull because the cache is disabled.");case 6:case"end":return n.stop()}},n,this)}));return e}()},{key:"sync",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isCacheEnabled()){n.next=8;break}return n.next=3,this.push(null,o);case 3:return t=n.sent,n.next=6,this.pull(e,o);case 6:return r=n.sent,n.abrupt("return",{push:t,pull:r});case 8:throw new s.KinveyError("Unable to sync because the cache is disabled.");case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"syncCount",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e=arguments.length<=0||void 0===arguments[0]?new d.Query:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isCacheEnabled()){n.next=4;break}return e instanceof d.Query||(e=new d.Query((0,N["default"])(e,"toJSON",e))),e.equalTo("collection",this.collection),n.abrupt("return",this.dataStoreSync.count(e,t));case 4:throw new s.KinveyError("Unable to get the sync count because the cache is disabled.");case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"updateCache",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isCacheEnabled()){n.next=7;break}return t=new h.KinveyRequestConfig({method:h.RequestMethod.PUT,url:I["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname,query:i.query}),properties:i.properties,data:e,timeout:i.timeout}),r=new l["default"](t),n.next=5,r.execute();case 5:return o=n.sent,n.abrupt("return",o.data);case 7:throw new s.KinveyError("Unable to update the cache because the cache is disabled.");case 8:case"end":return n.stop()}},n,this)}));return e}()},{key:"pathname",get:function(){var e="/"+F;return this.client&&(e=e+"/"+this.client.appKey),this.collection&&(e=e+"/"+this.collection),e}}],[{key:"collection",value:function(t){var n=arguments.length<=1||void 0===arguments[1]?Y.Cache:arguments[1],r=new e(t);switch(n){case Y.Network:r.online(),r.disableCache();break;case Y.Sync:r.enableCache(),r.offline();break;case Y.Cache:default:r.online(),r.enableCache()}return r}},{key:"getInstance",value:function(t,n){return e.collection(t,n)}},{key:"clear",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e,t,r,o,i,a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.client||g["default"].sharedInstance(),t="/"+F+"/"+e.appKey,r=new h.KinveyRequestConfig({method:h.RequestMethod.DELETE,url:I["default"].format({protocol:e.protocol,host:e.host,pathname:t,query:a.query}),properties:a.properties,timeout:a.timeout}),o=new l["default"](r),n.next=6,o.execute();case 6:return i=n.sent,n.abrupt("return",i.data);case 8:case"end":return n.stop()}},n,this)}));return e}()}]),e}();t.DataStore=z}).call(t,n(2))},function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function d(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:d(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=n(153),l=n(158),f=n(9),p=n(217),h=function(e){function t(e){o(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.rack=l.CacheRack.sharedInstance(),n}return a(t,e),u(t,[{key:"execute",value:function(){function e(){return n.apply(this,arguments)}var n=r(regeneratorRuntime.mark(function o(){var e,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s(Object.getPrototypeOf(t.prototype),"execute",this).call(this);case 2:return r.next=4,this.rack.execute(this);case 4:if(e=r.sent,this.executing=!1,e){r.next=8;break}throw new f.NoResponseError;case 8:if(e instanceof p.KinveyResponse||(n=new p.KinveyResponseConfig({statusCode:e.statusCode,headers:e.headers,data:e.data}),e=new p.KinveyResponse(n)),e.isSuccess()){r.next=11;break}throw e.error;case 11:return r.abrupt("return",e);case 12:case"end":return r.stop()}},o,this)}));return e}()},{key:"cancel",value:function(){function e(){return n.apply(this,arguments)}var n=r(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(Object.getPrototypeOf(t.prototype),"cancel",this).call(this);case 2:return e.abrupt("return",this.rack.cancel());case 3:case"end":return e.stop()}},o,this)}));return e}()}]),t}(c.KinveyRequest);t["default"]=h},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFetchRequest=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function N(e,t,n,r){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&N(i,t,n,r)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(r,n)}return n},f=function M(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:M(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},p=n(153),h=n(256),d=r(h),v=n(252),y=n(217),m=n(9),g=n(12),b=n(167),w=r(b),_=n(221),x=r(_),E=n(140),k=r(E),O=n(205),j=r(O),R=n(14),S=r(R),T=n(35),I=r(T),A=n(36),P=r(A),q=e.env.KINVEY_ID_ATTRIBUTE||"_id",C=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",D=200;t.DeltaFetchRequest=function(e){function t(){return i(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return u(t,e),c(t,[{key:"execute",value:function(){function e(){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(){var e,n,o,i,a=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],r.next=3,f(Object.getPrototypeOf(t.prototype),"execute",this).call(this);case 3:return r.prev=3,n=new d["default"]({method:p.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client}),r.next=7,n.execute().then(function(e){return e.data});case 7:e=r.sent,r.next=15;break;case 10:if(r.prev=10,r.t0=r["catch"](3),r.t0 instanceof m.NotFoundError){r.next=14;break}throw r.t0;case 14:e=[];case 15:if(!((0,I["default"])(e)&&e.length>0)){r.next=20;break}return r.delegateYield(regeneratorRuntime.mark(function u(){var t,n,r,o,i,s,c,l,f,h,d,m,b,_,E,O,R;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=(0,w["default"])(e,q),n=new g.Query((0,k["default"])(a.query,"toJSON",a.query)),n.fields=[q,C+".lmt"],r=new v.NetworkRequest({method:p.RequestMethod.GET,url:a.url,headers:a.headers,auth:a.auth,query:n,timeout:a.timeout,client:a.client}),u.next=6,r.execute().then(function(e){return e.data});case 6:for(o=u.sent,i=(0,w["default"])(o,q),s=i,c=Object.keys(t),(0,S["default"])(c,function(e){var n=t[e],r=i[e];r&&r[C]&&n[C]&&r[C].lmt===n[C].lmt?delete s[e]:delete t[e]}),l=Object.keys(s),f=[],h=0;h<l.length;)d=new g.Query((0,k["default"])(a.query,"toJSON",a.query)),m=l.slice(h,l.length>D+h?D:l.length),d.contains(q,m),b=new v.NetworkRequest({method:p.RequestMethod.GET,url:a.url,headers:a.headers,auth:a.auth,query:d,timeout:a.timeout,client:a.client}),_=b.execute(),f.push(_),h+=D;return u.next=17,Promise.all(f);case 17:return E=u.sent,O=(0,x["default"])(E,function(e,t){if(t.isSuccess()){var n=e.headers;n.addHeaders(t.headers),e.headers=n,e.data=e.data.concat(t.data)}return e},new y.KinveyResponse(new y.KinveyResponseConfig({statusCode:y.StatusCode.Ok,data:[]}))),O.data=O.data.concat((0,j["default"])(t)),a.query&&(R=new g.Query((0,k["default"])(a.query,"toJSON",a.query)),R.skip(0).limit(0),O.data=R.process(O.data)),u.abrupt("return",{v:O});case 22:case"end":return u.stop()}},u,a)})(),"t1",17);case 17:if(o=r.t1,"object"!==("undefined"==typeof o?"undefined":s(o))){r.next=20;break}return r.abrupt("return",o.v);case 20:return i=new v.NetworkRequest({method:p.RequestMethod.GET,url:this.url,headers:this.headers,auth:this.auth,query:this.query,timeout:this.timeout,client:this.client}),r.abrupt("return",i.execute());case 22:case"end":return r.stop()}},r,this,[[3,10]])}));return e}()},{key:"method",get:function(){return f(Object.getPrototypeOf(t.prototype),"method",this)},set:function(e){switch((0,P["default"])(e)||(e=String(e)),e=e.toUpperCase()){case p.RequestMethod.GET:l(Object.getPrototypeOf(t.prototype),"method",e,this);break;case p.RequestMethod.POST:case p.RequestMethod.PATCH:case p.RequestMethod.PUT:case p.RequestMethod.DELETE:default:throw new Error("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]),t}(p.KinveyRequest)}).call(t,n(2))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyObservable=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(259),s=n(274);t.KinveyObservable=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),a(t,[{key:"toPromise",value:function(){return s.toPromise.call(this)}}],[{key:"create",value:function(e){return new t(e)}}]),t}(u.Observable)},function(e,t,n){"use strict";var r=n(260),o=n(261),i=n(272),a=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=o.toSubscriber(e,t,n);if(r?r.call(i,this):i.add(this._subscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype.forEach=function(e,t){var n=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var o=n.subscribe(function(t){if(o)try{e(t)}catch(n){r(n),o.unsubscribe()}else e(t)},r,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[i]=function(){return this},e.create=function(t){return new e(t)},e}();t.Observable=a},function(e,t,n){(function(e,n){"use strict";var r={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};t.root=r[typeof self]&&self||r[typeof window]&&window;var o=(r[typeof t]&&t&&!t.nodeType&&t,r[typeof e]&&e&&!e.nodeType&&e,r[typeof n]&&n);!o||o.global!==o&&o.window!==o||(t.root=o)}).call(t,n(136)(e),function(){return this}())},function(e,t,n){"use strict";function r(e,t,n){if(e){if(e instanceof o.Subscriber)return e;if(e[i.$$rxSubscriber])return e[i.$$rxSubscriber]()}return e||t||n?new o.Subscriber(e,t,n):new o.Subscriber}var o=n(262),i=n(271);t.toSubscriber=r},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(263),i=n(264),a=n(270),u=n(271),s=function(e){function t(n,r,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!n){this.destination=a.empty;break}if("object"==typeof n){n instanceof t?(this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,n,r,o)}}return r(t,e),t.prototype[u.$$rxSubscriber]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.isUnsubscribed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t}(i.Subscription);t.Subscriber=s;var c=function(e){function t(t,n,r,i){e.call(this),this._parent=t;var a,u=this;o.isFunction(n)?a=n:n&&(u=n,a=n.next,r=n.error,i=n.complete,o.isFunction(u.unsubscribe)&&this.add(u.unsubscribe.bind(u)),u.unsubscribe=this.unsubscribe.bind(this)),this._context=u,this._next=a,this._error=r,this._complete=i}return r(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parent;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parent;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){if(!this.isStopped){var e=this._parent;this._complete?e.syncErrorThrowable?(this.__tryOrSetError(e,this._complete),this.unsubscribe()):(this.__tryOrUnsub(this._complete),this.unsubscribe()):this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(n){
throw this.unsubscribe(),n}},t.prototype.__tryOrSetError=function(e,t,n){try{t.call(this._context,n)}catch(r){return e.syncErrorValue=r,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parent;this._context=null,this._parent=null,e.unsubscribe()},t}(s)},function(e,t){"use strict";function n(e){return"function"==typeof e}t.isFunction=n},function(e,t,n){"use strict";var r=n(265),o=n(266),i=n(263),a=n(267),u=n(268),s=n(269),c=function(){function e(e){this.isUnsubscribed=!1,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.isUnsubscribed){this.isUnsubscribed=!0;var n=this,c=n._unsubscribe,l=n._subscriptions;if(this._subscriptions=null,i.isFunction(c)){var f=a.tryCatch(c).call(this);f===u.errorObject&&(t=!0,(e=e||[]).push(u.errorObject.e))}if(r.isArray(l))for(var p=-1,h=l.length;++p<h;){var d=l[p];if(o.isObject(d)){var f=a.tryCatch(d.unsubscribe).call(d);if(f===u.errorObject){t=!0,e=e||[];var v=u.errorObject.e;v instanceof s.UnsubscriptionError?e=e.concat(v.errors):e.push(v)}}}if(t)throw new s.UnsubscriptionError(e)}},e.prototype.add=function(t){if(t&&t!==this&&t!==e.EMPTY){var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.isUnsubscribed||"function"!=typeof n.unsubscribe)break;this.isUnsubscribed?n.unsubscribe():(this._subscriptions||(this._subscriptions=[])).push(n);break;default:throw new Error("Unrecognized teardown "+t+" added to Subscription.")}return n}},e.prototype.remove=function(t){if(null!=t&&t!==this&&t!==e.EMPTY){var n=this._subscriptions;if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},e.EMPTY=function(e){return e.isUnsubscribed=!0,e}(new e),e}();t.Subscription=c},function(e,t){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t){"use strict";function n(e){return null!=e&&"object"==typeof e}t.isObject=n},function(e,t,n){"use strict";function r(){try{return i.apply(this,arguments)}catch(e){return a.errorObject.e=e,a.errorObject}}function o(e){return i=e,r}var i,a=n(268);t.tryCatch=o},function(e,t){"use strict";t.errorObject={e:{}}},function(e,t){"use strict";var n=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=function(e){function t(t){e.call(this),this.errors=t,this.name="UnsubscriptionError",this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n"):""}return n(t,e),t}(Error);t.UnsubscriptionError=r},function(e,t){"use strict";t.empty={isUnsubscribed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,n){"use strict";var r=n(260),o=r.root.Symbol;t.$$rxSubscriber="function"==typeof o&&"function"==typeof o["for"]?o["for"]("rxSubscriber"):"@@rxSubscriber"},function(e,t,n){(function(t){"use strict";e.exports=n(273)(t||window||this)}).call(t,function(){return this}())},function(e,t){"use strict";e.exports=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}},function(e,t,n){"use strict";function r(e){var t=this;if(e||(o.root.Rx&&o.root.Rx.config&&o.root.Rx.config.Promise?e=o.root.Rx.config.Promise:o.root.Promise&&(e=o.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}var o=n(260);t.toPromise=r},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncOperation=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(153),c=n(9),l=n(256),f=r(l),p=n(252),h=n(141),d=r(h),v=n(12),y=n(146),m=r(y),g=n(215),b=r(g),w=n(35),_=r(w),x=n(276),E=r(x),k=n(282),O=r(k),j=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",R=e.env.KINVEY_SYNC_COLLECTION_NAME||"kinvey_sync",S=e.env.KINVEY_ID_ATTRIBUTE||"_id",T={Create:s.RequestMethod.POST,Update:s.RequestMethod.PUT,Delete:s.RequestMethod.DELETE};Object.freeze(T),t.SyncOperation=T;var I=function(){function e(){i(this,e),this.client=d["default"].sharedInstance()}return u(e,[{key:"count",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=[],r=new f["default"]({method:s.RequestMethod.GET,url:m["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:o.properties,query:e,timeout:o.timeout,client:this.client}),n.next=4,r.execute().then(function(e){return e.data});case 4:return t=n.sent,t=(0,E["default"])(t,"key",["desc"]),t=(0,O["default"])(t,function(e){return e.entity[S]}),n.abrupt("return",t.length);case 8:case"end":return n.stop()}},n,this)}));return e}()},{key:"addCreateOperation",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.addOperation(T.Create,e,t,r));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"addUpdateOperation",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.addOperation(T.Update,e,t,r));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"addDeleteOperation",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.addOperation(T.Delete,e,t,r));case 1:case"end":return n.stop()}},n,this)}));return e}()},{key:"addOperation",value:function(){function e(e,n,r,o){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){var e,t=arguments.length<=0||void 0===arguments[0]?T.Create:arguments[0],r=arguments[1],i=this,a=arguments[2],u=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=!1,r){n.next=3;break}throw new c.SyncError("A name for a collection must be provided to add entities to the sync table.");case 3:return(0,_["default"])(a)||(e=!0,a=[a]),n.next=6,Promise.all((0,b["default"])(a,function(){var e=o(regeneratorRuntime.mark(function n(e){var o,a,l,p,h,d,y,g;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",null);case 2:if(o=e[S]){n.next=5;break}throw new c.SyncError("An entity is missing an _id. All entities must have an _id in order to be added to the sync table.",e);case 5:return a=(new v.Query).equalTo("entity._id",o),l=new s.KinveyRequestConfig({method:s.RequestMethod.GET,url:m["default"].format({protocol:i.client.protocol,host:i.client.host,pathname:i.pathname}),properties:u.properties,query:a,timeout:u.timeout}),p=new f["default"](l),n.next=10,p.execute();case 10:return h=n.sent,d=h.data,y=1===d.length?d[0]:{collection:r,state:{}},y.state=y.state||{},y.state.method=t,y.entity=e,g=new f["default"]({method:s.RequestMethod.PUT,url:m["default"].format({protocol:i.client.protocol,host:i.client.host,pathname:i.pathname}),properties:u.properties,body:y,timeout:u.timeout}),n.abrupt("return",g.execute());case 18:case"end":return n.stop()}},n,i)}));return function(t){return e.apply(this,arguments)}}()));case 6:return n.abrupt("return",e?a[0]:a);case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"push",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,i,u,l,h,d=this,v=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=100,r=0,i=new f["default"]({method:s.RequestMethod.GET,url:m["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:v.properties,query:e,timeout:v.timeout}),n.next=5,i.execute();case 5:if(u=n.sent,l=u.data,!(l.length>0)){n.next=11;break}if(h=function(){l=(0,E["default"])(l,"key",["desc"]),l=(0,O["default"])(l,function(e){return e.entity[S]});var e=function(){var n=o(regeneratorRuntime.mark(function i(n){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Promise(function(){var i=o(regeneratorRuntime.mark(function a(i){var u,h;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return u=l.slice(r,r+t),r+=t,a.next=4,Promise.all((0,b["default"])(u,function(e){var t=e.collection,n=e.entity,r=n[S],i=e.state.method;if(i===s.RequestMethod.DELETE){var a=new p.NetworkRequest({method:s.RequestMethod.DELETE,authType:s.AuthType.Default,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,client:d.client});return a.execute().then(function(){var t=new s.KinveyRequestConfig({method:s.RequestMethod.DELETE,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:d.pathname+"/"+e[S]}),properties:v.properties,timeout:v.timeout}),n=new f["default"](t);return n.execute()}).then(function(){var e={_id:r,entity:n};return e})["catch"](function(){var e=o(regeneratorRuntime.mark(function i(e){var o,a,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(e instanceof c.InsufficientCredentialsError)){i.next=13;break}return i.prev=1,o=new p.NetworkRequest({method:s.RequestMethod.GET,authType:s.AuthType.Default,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,client:d.client}),i.next=5,o.execute().then(function(e){return e.data});case 5:return a=i.sent,u=new f["default"]({method:s.RequestMethod.PUT,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,body:a}),i.next=9,u.execute();case 9:i.next=13;break;case 11:i.prev=11,i.t0=i["catch"](1);case 13:return i.abrupt("return",{_id:r,entity:n,error:e});case 14:case"end":return i.stop()}},i,d,[[1,11]])}));return function(t){return e.apply(this,arguments)}}())}if(i===s.RequestMethod.POST||i===s.RequestMethod.PUT){var u=new p.NetworkRequest({method:i,authType:s.AuthType.Default,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,body:n,client:d.client});return i===s.RequestMethod.POST&&(delete n[S],u.method=s.RequestMethod.POST,u.url=m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t}),u.body=n),u.execute().then(function(e){return e.data}).then(function(){var n=o(regeneratorRuntime.mark(function a(n){var o,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=new s.KinveyRequestConfig({method:s.RequestMethod.DELETE,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:d.pathname+"/"+e[S]}),properties:v.properties,timeout:v.timeout}),u=new f["default"](o),a.next=4,u.execute();case 4:return c=new f["default"]({method:s.RequestMethod.PUT,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+n[S]}),properties:v.properties,timeout:v.timeout,body:n}),a.next=7,c.execute().then(function(e){return e.data});case 7:if(n=a.sent,i!==s.RequestMethod.POST){a.next=12;break}return l=new f["default"]({method:s.RequestMethod.DELETE,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout}),a.next=12,l.execute();case 12:return a.abrupt("return",{_id:r,entity:n});case 13:case"end":return a.stop()}},a,d)}));return function(e){return n.apply(this,arguments)}}())["catch"](function(){var e=o(regeneratorRuntime.mark(function a(e){var o,u,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e instanceof c.InsufficientCredentialsError)){a.next=14;break}if(a.prev=1,i===s.RequestMethod.POST){a.next=10;break}return o=new p.NetworkRequest({method:s.RequestMethod.GET,authType:s.AuthType.Default,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,client:d.client}),a.next=6,o.execute().then(function(e){return e.data});case 6:return u=a.sent,l=new f["default"]({method:s.RequestMethod.PUT,url:m["default"].format({protocol:d.client.protocol,host:d.client.host,pathname:"/"+j+"/"+d.client.appKey+"/"+t+"/"+r}),properties:v.properties,timeout:v.timeout,body:u}),a.next=10,l.execute();case 10:a.next=14;break;case 12:a.prev=12,a.t0=a["catch"](1);case 14:return a.abrupt("return",{_id:r,entity:n,error:e});case 15:case"end":return a.stop()}},a,d,[[1,12]])}));return function(t){return e.apply(this,arguments)}}())}return{_id:r,entity:n,error:new c.SyncError("Unable to sync the entity since the method was not recognized.",e)}}));case 4:if(h=a.sent,n=n.concat(h),!(r<l.length)){a.next=8;break}return a.abrupt("return",i(e(n)));case 8:return a.abrupt("return",i(n));case 9:case"end":return a.stop()}},a,d)}));return function(e){return i.apply(this,arguments)}}()),i.abrupt("return",a);case 2:case"end":return i.stop()}},i,d)}));return function(e){return n.apply(this,arguments)}}();return{v:e([])}}(),"object"!==("undefined"==typeof h?"undefined":a(h))){n.next=11;break}return n.abrupt("return",h.v);case 11:return n.abrupt("return",[]);case 12:case"end":return n.stop()}},n,this)}));return e}()},{key:"clear",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=new f["default"]({method:s.RequestMethod.DELETE,url:m["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:t.properties,query:e,timeout:t.timeout});return n.execute()}},{key:"pathname",get:function(){return"/"+j+"/"+this.client.appKey+"/"+R}}]),e}();t["default"]=I}).call(t,n(2))},function(e,t,n){function r(e,t,n,r){return null==e?[]:(i(t)||(t=null==t?[]:[t]),n=r?void 0:n,i(n)||(n=null==n?[]:[n]),o(e,t,n))}var o=n(277),i=n(35);e.exports=r},function(e,t,n){function r(e,t,n){var r=-1;t=o(t.length?t:[l],s(i));var f=a(e,function(e,n,i){var a=o(t,function(t){return t(e)});return{criteria:a,index:++r,value:e}});return u(f,function(e,t){return c(e,t,n)})}var o=n(207),i=n(40),a=n(216),u=n(278),s=n(279),c=n(280),l=n(118);e.exports=r},function(e,t){function n(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}e.exports=n},function(e,t){function n(e){return function(t){return e(t)}}e.exports=n},function(e,t,n){function r(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,u=i.length,s=n.length;++r<u;){var c=o(i[r],a[r]);if(c){if(r>=s)return c;var l=n[r];return c*("desc"==l?-1:1)}}return e.index-t.index}var o=n(281);e.exports=r},function(e,t,n){function r(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e===e,a=o(e),u=void 0!==t,s=null===t,c=t===t,l=o(t);if(!s&&!l&&!a&&e>t||a&&u&&c&&!s&&!l||r&&u&&c||!n&&c||!i)return 1;if(!r&&!a&&!l&&t>e||l&&n&&i&&!r&&!a||s&&n&&i||!u&&i||!c)return-1}return 0}var o=n(112);e.exports=r},function(e,t,n){function r(e,t){return e&&e.length?i(e,o(t)):[]}var o=n(40),i=n(283);e.exports=r},function(e,t,n){function r(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var u=e[n],s=t?t(u):u;if(!n||!o(s,c)){var c=s;a[i++]=0===u?0:u}}return a}var o=n(48);e.exports=r},function(e,t,n){var r=n(285),o=n(291),i=n(40),a=n(27),u=n(293),s=n(127),c=s(function(e,t){var n=u(t);return a(n)&&(n=void 0),a(e)?r(e,o(t,1,a,!0),i(n)):[]});e.exports=c},function(e,t,n){function r(e,t,n,r){var f=-1,p=i,h=!0,d=e.length,v=[],y=t.length;if(!d)return v;n&&(t=u(t,s(n))),r?(p=a,h=!1):t.length>=l&&(p=c,h=!1,t=new o(t));e:for(;++f<d;){var m=e[f],g=n?n(m):m;if(m=r||0!==m?m:0,h&&g===g){for(var b=y;b--;)if(t[b]===g)continue e;v.push(m)}else p(t,g,r)||v.push(m)}return v}var o=n(85),i=n(286),a=n(289),u=n(207),s=n(279),c=n(290),l=200;e.exports=r},function(e,t,n){function r(e,t){var n=e?e.length:0;return!!n&&o(e,t,0)>-1}var o=n(287);e.exports=r},function(e,t,n){function r(e,t,n){if(t!==t)return o(e,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var o=n(288);e.exports=r},function(e,t){function n(e,t,n){for(var r=e.length,o=t+(n?1:-1);n?o--:++o<r;){var i=e[o];if(i!==i)return o}return-1}e.exports=n},function(e,t){function n(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}e.exports=n},function(e,t){function n(e,t){return e.has(t)}e.exports=n},function(e,t,n){function r(e,t,n,a,u){var s=-1,c=e.length;for(n||(n=i),u||(u=[]);++s<c;){var l=e[s];t>0&&n(l)?t>1?r(l,t-1,n,a,u):o(u,l):a||(u[u.length]=l)}return u}var o=n(184),i=n(292);e.exports=r},function(e,t,n){function r(e){return i(e)||o(e)}var o=n(26),i=n(35);e.exports=r},function(e,t){function n(e){var t=e?e.length:0;return t?e[t-1]:void 0}e.exports=n},function(e,t,n){function r(e,t){var n=u(e)?o:i;return n(e,a(t,3))}var o=n(295),i=n(296),a=n(40),u=n(35);e.exports=r},function(e,t){function n(e,t){for(var n=-1,r=e?e.length:0,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}e.exports=n},function(e,t,n){function r(e,t){var n=[];return o(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}var o=n(16);e.exports=r},function(e,t,n){var r=n(295),o=n(298),i=n(27),a=n(293),u=n(127),s=u(function(e){var t=a(e);return i(t)&&(t=void 0),o(r(e,i),void 0,t)});e.exports=s},function(e,t,n){function r(e,t,n){for(var r=-1,u=e.length;++r<u;)var s=s?o(i(s,e[r],t,n),i(e[r],s,t,n)):e[r];return s&&s.length?a(s,t,n):[]}var o=n(184),i=n(285),a=n(299);e.exports=r},function(e,t,n){function r(e,t,n){var r=-1,f=i,p=e.length,h=!0,d=[],v=d;if(n)h=!1,f=a;else if(p>=l){var y=t?null:s(e);if(y)return c(y);h=!1,f=u,v=new o}else v=t?[]:d;e:for(;++r<p;){var m=e[r],g=t?t(m):m;if(m=n||0!==m?m:0,h&&g===g){for(var b=v.length;b--;)if(v[b]===g)continue e;t&&v.push(g),d.push(m)}else f(v,g,n)||(v!==d&&v.push(g),d.push(m))}return d}var o=n(85),i=n(286),a=n(289),u=n(290),s=n(300),c=n(93),l=200;e.exports=r},function(e,t,n){var r=n(98),o=n(301),i=n(93),a=1/0,u=r&&1/i(new r([,-0]))[1]==a?function(e){return new r(e)}:o;e.exports=u},function(e,t){function n(){}e.exports=n},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FileStore=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function b(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:b(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=n(252),f=n(153),p=n(255),h=n(146),d=r(h),v=n(215),y=r(v),m=e.env.KINVEY_ID_ATTRIBUTE||"_id",g=e.env.KINVEY_FILES_NAMESPACE||"blob";t.FileStore=function(e){function t(){i(this,t);var e=a(this,Object.getPrototypeOf(t).call(this));return e.disableCache(),e}return u(t,e),s(t,[{key:"enableCache",value:function(){}},{key:"offline",value:function(){}},{key:"find",value:function(){function e(e,t){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(e){var n,o,i=this,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a.query=a.query||{},a.query.tls=a.tls===!0,a.ttl_in_seconds=a.ttl,n=c(Object.getPrototypeOf(t.prototype),"find",this).call(this,e,a),r.next=6,n.toPromise();case 6:if(o=r.sent,a.download!==!0){r.next=9;break}return r.abrupt("return",Promise.all((0,y["default"])(o,function(e){return i.downloadByUrl(e._downloadURL,a)})));case 9:return r.abrupt("return",o);case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(e,t){return this.download(e,t)}},{key:"download",value:function(){function e(e,t){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(e){var n,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i.query=i.query||{},i.query.tls=i.tls===!0,i.ttl_in_seconds=i.ttl,n=c(Object.getPrototypeOf(t.prototype),"findById",this).call(this,e,i),r.next=6,n.toPromise();case 6:if(o=r.sent,i.stream!==!0){r.next=9;break}return r.abrupt("return",o);case 9:return r.abrupt("return",this.downloadByUrl(o._downloadURL,i));case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"downloadByUrl",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=new f.KinveyRequestConfig({method:f.RequestMethod.GET,url:e,timeout:i.timeout}),t.headers.set("Accept",i.mimeType||"application-octet-stream"),t.headers.remove("Content-Type"),t.headers.remove("X-Kinvey-Api-Version"),r=new l.NetworkRequest(t),n.next=7,r.execute();case 7:return o=n.sent,n.abrupt("return",o.data);case 9:case"end":return n.stop()}},n,this)}));return e}()},{key:"stream",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.stream=!0,this.download(e,t)}},{key:"upload",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o,i,a,u,s,c,p=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return p._filename=p._filename||e._filename||e.name,p.size=p.size||e.size||e.length,p.mimeType=p.mimeType||e.mimeType||e.type||"application/octet-stream",h["public"]===!0&&(p._public=!0),t=new f.KinveyRequestConfig({method:f.RequestMethod.POST,authType:f.AuthType.Default,url:d["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:h.properties,timeout:h.timeout,data:p,client:this.client}),t.headers.set("X-Kinvey-Content-Type",p.mimeType),r=new l.NetworkRequest(t),p[m]&&(r.method=f.RequestMethod.PUT,r.url=d["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/"+p._id,query:h.query})),n.next=10,r.execute();case 10:return o=n.sent,i=o.data,a=i._uploadURL,u=i._requiredHeaders||{},u["Content-Type"]=p.mimeType,u["Content-Length"]=p.size,delete i._expiresAt,delete i._requiredHeaders,delete i._uploadURL,s=new f.KinveyRequestConfig({method:f.RequestMethod.PUT,url:a,data:e}),s.headers.clear(),s.headers.add(u),c=new l.NetworkRequest(s),n.next=25,c.execute();case 25:return i._data=e,n.abrupt("return",i);case 27:case"end":return n.stop()}},n,this)}));return e}()},{key:"create",value:function(e,t,n){return this.upload(e,t,n)}},{key:"update",value:function(e,t,n){return this.upload(e,t,n)}},{key:"pathname",get:function(){return"/"+g+"/"+this.client.appKey}}]),t}(p.DataStore)}).call(t,n(2))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=t.User=void 0;var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function F(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:F(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(141),p=r(f),h=n(12),d=n(304),v=n(253),y=n(9),m=n(305),g=n(153),b=n(255),w=n(252),_=n(142),x=n(146),E=r(x),k=n(122),O=r(k),j=n(140),R=r(j),S=n(32),T=r(S),I=n(35),A=r(I),P=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",q=e.env.KINVEY_USERS_NAMESPACE||"user",C=e.env.KINVEY_RPC_NAMESPACE||"rpc",D=e.env.KINVEY_ID_ATTRIBUTE||"_id",N=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",M=e.env.KINVEY_SOCIAL_IDENTITY_ATTRIBUTE||"_socialIdentity",B=e.env.KINVEY_USERNAME_ATTRIBUTE||"username",K=e.env.KINVEY_EMAIL_ATTRIBUTE||"email",L=["facebook","google","linkedIn"],U=void 0;"undefined"!=typeof window&&(U=n(307));t.User=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];u(this,e),this.data=t,this.client=p["default"].sharedInstance()}return l(e,[{key:"isActive",value:function(){var t=e.getActiveUser(this.client);return!(!t||t[D]!==this[D])}},{key:"login",value:function(t,n){var r=this,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,T["default"])(t)||(t={username:t,password:n}),t[M]||(t.username&&(t.username=String(t.username).trim()),t.password&&(t.password=String(t.password).trim()));var i=this.isActive();if(i)return Promise.reject(new y.ActiveUserError("This user is already the active user."));var a=e.getActiveUser(this.client);if(a)return Promise.reject(new y.ActiveUserError("An active user already exists. Please logout the active user before you login."));if(!(t.username&&""!==t.username&&t.password&&""!==t.password||t[M]))return Promise.reject(new y.KinveyError("Username and/or password missing. Please provide both a username and password to login."));var u=new g.KinveyRequestConfig({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/login"}),body:t,properties:o.properties,timeout:o.timeout}),s=new w.NetworkRequest(u);s.automaticallyRefreshAuthToken=!1;var c=s.execute().then(function(t){return r.data=t.data,(0,_.setActiveUser)(r.client,r.data),e.getActiveUser(r.client)});return c}},{key:"loginWithIdentity",value:function(e,t,n){var r={};return r[M]={},r[M][e]=t,this.login(r,n)}},{key:"loginWithMIC",value:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=new m.MobileIdentityConnect(this.client);return o.login(e,t,r).then(function(t){return r.redirectUri=e,r.micClient=(0,R["default"])(o.client,"toJSON",o.client),n.connect(m.MobileIdentityConnect.identity,t,r)})}},{key:"logout",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=this.isActive();if(!n)return Promise.resolve();var r=new w.NetworkRequest({method:g.RequestMethod.POST,authType:g.AuthType.Session,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+q+"/"+this.client.appKey+"/_logout"}),properties:t.properties,timeout:t.timeout});r.automaticallyRefreshAuthToken=!1;var o=r.execute()["catch"](function(){return null}).then(function(){var t=e.isActive();return t&&(0,_.setActiveUser)(e.client,null),null}).then(function(){return b.DataStore.clear({client:e.client})}).then(function(){return e});return o}},{key:"connectWithIdentity",value:function(t){var n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r=(0,O["default"])({collectionName:"identities"},r);var o=Promise.resolve().then(function(){if(!t)throw new y.KinveyError("An identity is required to connect the user.");if(!e.isIdentitySupported(t))throw new y.KinveyError("Identity "+t+" is not supported on this platform.");var o=(new h.Query).equalTo("identity",t),i=new w.NetworkRequest({method:g.RequestMethod.GET,authType:g.AuthType.None,url:E["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:"/"+P+"/"+n.client.appKey+"/"+r.collectionName}),query:o,properties:r.properties,timeout:r.timeout});return i.execute()});return o=o.then(function(e){if(1===e.data.length){var n={};return n[t]=e.data[0].key||e.data[0].appId||e.data[0].clientId,U.init(n),U(t).login()}throw new y.KinveyError("Unsupported identity.")}).then(function(){var e=U(t).getAuthResponse();return n.connect(t,e,r)})}},{key:"connect",value:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=this.data,i=o[M]||{};i[e]=t,o[M]=i,this.data=o;var a=Promise.resolve().then(function(){var t=n.isActive();return t?(r._identity=e,n.update(o,r)):n.login(o,null,r)})["catch"](function(i){if(i instanceof y.NotFoundError)return n.signup(o,r).then(function(){
return n.connect(e,t,r)});throw i}).then(function(){return(0,_.setActiveSocialIdentity)(n.client,{identity:e,token:n[M][e],redirectUri:r.redirectUri,client:r.micClient}),n});return a}},{key:"disconnect",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=this.data,o=r[M]||{};delete o[e],r[M]=o,this.data=r;var i=Promise.resolve().then(function(){return t[D]?t.update(r,n):t}).then(function(){var n=t.client.activeSocialIdentity;return n.identity===e&&(0,_.setActiveSocialIdentity)(t.client,null),t});return i}},{key:"signup",value:function(t){var n=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r=(0,O["default"])({state:!0},r);var o=Promise.resolve().then(function(){if(r.state===!0){var t=e.getActiveUser(n.client);if(t)throw new y.ActiveUserError("An active user already exists. Please logout the active user before you login.")}}).then(function(){var e=new w.NetworkRequest({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:"/"+q+"/"+n.client.appKey}),data:(0,R["default"])(t,"toJSON",t),properties:r.properties,timeout:r.timeout});return e.execute()}).then(function(e){return n.data=e.data,r.state===!0&&(0,_.setActiveUser)(n.client,n.data),n});return o}},{key:"signupWithIdentity",value:function(e,t,n){var r={};return r[M]={},r[M][e]=t,this.signup(r,n)}},{key:"update",value:function(e,t){var n=this,r=b.DataStore.getInstance(null,b.DataStoreType.User);return r.save(e,t).then(function(e){return n.data=e,n.isActive()&&(0,_.setActiveUser)(n.client,n.data),n})}},{key:"me",value:function(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=new w.NetworkRequest({method:g.RequestMethod.GET,authType:g.AuthType.Session,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+q+"/"+this.client.appKey+"/_me"}),properties:n.properties,timeout:n.timeout}),o=r.execute().then(function(n){if(t.data=n.data,!t.authtoken){var r=e.getActiveUser(t.client);r&&(t.authtoken=r.authtoken)}return(0,_.setActiveUser)(t.client,t.data),t});return o}},{key:"isEmailVerified",value:function(){var e=this.metadata.emailVerification;return"confirmed"===e}},{key:"verifyEmail",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=new w.NetworkRequest({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+C+"/"+this.client.appKey+"/"+this.username+"/user-email-verification-initiate"}),properties:e.properties,timeout:e.timeout,client:this.client}),n=t.execute().then(function(e){return e.data});return n}},{key:"forgotUsername",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=new w.NetworkRequest({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+C+"/"+this.client.appKey+"/user-forgot-username"}),properties:e.properties,data:{email:this.email},timeout:e.timeout,client:this.client}),n=t.execute().then(function(e){return e.data});return n}},{key:"resetPassword",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=new w.NetworkRequest({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+C+"/"+this.client.appKey+"/"+this.username+"/user-password-reset-initiate"}),properties:e.properties,timeout:e.timeout,client:this.client}),n=t.execute().then(function(e){return e.data});return n}},{key:"toJSON",value:function(){return this.data}},{key:"_id",get:function(){return this.data[D]}},{key:"_acl",get:function(){return new d.Acl(this.data)}},{key:"metadata",get:function(){return new v.Metadata(this.data)},set:function(e){this.data[N]=(0,R["default"])(e,"toJSON",e)}},{key:"_kmd",get:function(){return this.metadata},set:function(e){this.metadata=e}},{key:"_socialIdentity",get:function(){return this.data[M]}},{key:"authtoken",get:function(){return this.metadata.authtoken},set:function(e){var t=this.metadata;t.authtoken=e,this.metadata=t}},{key:"username",get:function(){return this.data[B]}},{key:"email",get:function(){return this.data[K]}},{key:"pathname",get:function(){return"/"+q+"/"+this.client.appKey}}],[{key:"getActiveUser",value:function(){var t=arguments.length<=0||void 0===arguments[0]?p["default"].sharedInstance():arguments[0],n=t.activeUser,r=null;return n&&(r=new e(n),r.client=t),r}},{key:"login",value:function(t,n,r){var o=new e;return o.login(t,n,r)}},{key:"loginWithIdentity",value:function(t,n,r){var o=new e;return o.loginWithIdentity(t,n,r)}},{key:"loginWithMIC",value:function(t,n,r){var o=new e;return o.loginWithMIC(t,n,r)}},{key:"isIdentitySupported",value:function(e){return"undefined"!=typeof U&&-1!==L.indexOf(e)}},{key:"connectWithFacebook",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return e.connectWithIdentity(m.SocialIdentity.Facebook,t)}},{key:"connectWithGoogle",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return e.connectWithIdentity(m.SocialIdentity.Google,t)}},{key:"connectWithLinkedIn",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return e.connectWithIdentity(m.SocialIdentity.LinkedIn,t)}},{key:"connectWithIdentity",value:function(t,n){var r=new e;return r.connectWithIdentity(t,n)}},{key:"signup",value:function(t,n){var r=new e;return r.signup(t,n)}},{key:"signupWithIdentity",value:function(t,n,r){var o=new e;return o.signupWithIdentity(t,n,r)}}]),e}(),t.UserStore=function(e){function t(){u(this,t);var e=i(this,Object.getPrototypeOf(t).call(this));return e.disableCache(),e}return a(t,e),l(t,[{key:"enableCache",value:function(){}},{key:"offline",value:function(){}},{key:"create",value:function(){function e(){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new y.KinveyError("Please use `User.signup()` to create a user.");case 1:case"end":return e.stop()}},n,this)}));return e}()},{key:"update",value:function(){function e(e,t){return n.apply(this,arguments)}var n=o(regeneratorRuntime.mark(function r(e){var n,o,i,a,u,l,f,p,h=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}throw new y.KinveyError("No user was provided to be updated.");case 2:if(!(0,A["default"])(e)){r.next=4;break}throw new y.KinveyError("Only one user can be updated at one time.",e);case 4:if(e[D]){r.next=6;break}throw new y.KinveyError("User must have an _id.");case 6:if(!h._identity){r.next=28;break}if(n=e[M],!n){r.next=28;break}for(o=!0,i=!1,a=void 0,r.prev=12,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)f=s(l.value,1),p=f[0],n[p]&&h._identity!==p&&delete n[p];r.next=20;break;case 16:r.prev=16,r.t0=r["catch"](12),i=!0,a=r.t0;case 20:r.prev=20,r.prev=21,!o&&u["return"]&&u["return"]();case 23:if(r.prev=23,!i){r.next=26;break}throw a;case 26:return r.finish(23);case 27:return r.finish(20);case 28:return r.abrupt("return",c(Object.getPrototypeOf(t.prototype),"update",this).call(this,e,h));case 29:case"end":return r.stop()}},r,this,[[12,16,20,28],[21,,23,27]])}));return e}()},{key:"exists",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e,t){var r,o,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=new g.KinveyRequestConfig({method:g.RequestMethod.POST,authType:g.AuthType.App,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+C+"/"+this.client.appKey+"/check-username-exists"}),properties:t.properties,data:{username:e},timeout:t.timeout,client:this.client}),o=new w.NetworkRequest(r),n.next=4,o.execute();case 4:return i=n.sent,a=i.data||{},n.abrupt("return",!!a.usernameExists);case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"restore",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=new g.KinveyRequestConfig({method:g.RequestMethod.POST,authType:g.AuthType.Master,url:E["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/"+e}),properties:i.properties,timeout:i.timeout,client:this.client}),r=new w.NetworkRequest(t),n.next=4,r.execute();case 4:return o=n.sent,n.abrupt("return",o.data);case 6:case"end":return n.stop()}},n,this)}));return e}()},{key:"pathname",get:function(){return"/"+q+"/"+this.client.appKey}}]),t}(b.DataStore)}).call(t,n(2))},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Acl=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=n(254),s=r(u),c=n(199),l=r(c),f=e.env.KINVEY_ACL_ATTRIBUTE||"_acl";t.Acl=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),!(0,l["default"])(t))throw new a.KinveyError("entity argument must be an object");this.acl=(0,s["default"])(t[f])}return i(e,[{key:"addReader",value:function(e){var t=this.acl.r||[];return-1===t.indexOf(e)&&t.push(e),this.acl.r=t,this}},{key:"addReaderGroup",value:function(e){var t=this.acl.groups||{},n=t.r||[];return-1===n.indexOf(e)&&n.push(e),t.r=n,this.acl.groups=t,this}},{key:"addWriter",value:function(e){var t=this.acl.w||[];return-1===t.indexOf(e)&&t.push(e),this.acl.w=t,this}},{key:"addWriterGroup",value:function(e){var t=this.acl.groups||{},n=t.w||[];return-1===n.indexOf(e)&&n.push(e),t.w=n,this.acl.groups=t,this}},{key:"isGloballyReadable",value:function(){return this.acl.gr||!1}},{key:"isGloballyWritable",value:function(){return this.acl.gw||!1}},{key:"removeReader",value:function(e){var t=this.acl.r||[],n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.acl.r=t,this}},{key:"removeReaderGroup",value:function(e){var t=this.acl.groups||{},n=t.r||[],r=n.indexOf(e);return-1!==r&&n.splice(r,1),t.r=n,this.acl.groups=t,this}},{key:"removeWriter",value:function(e){var t=this.acl.w||[],n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.acl.w=t,this}},{key:"removeWriterGroup",value:function(e){var t=this.acl.groups||{},n=t.w||[],r=n.indexOf(e);return-1!==r&&n.splice(r,1),t.w=n,this.acl.groups=t,this}},{key:"toJSON",value:function(){return this.acl}},{key:"creator",get:function(){return this.acl.creator}},{key:"readers",get:function(){return this.acl.r||[]}},{key:"writers",get:function(){return this.acl.w||[]}},{key:"readerGroups",get:function(){return this.acl.groups?this.acl.groups.r:[]}},{key:"writerGroups",get:function(){return this.acl.groups?this.acl.groups.w:[]}},{key:"globallyReadable",set:function(e){this.acl.gr=e||!1}},{key:"globallyWritable",set:function(e){this.acl.gw=e||!1}}]),e}()}).call(t,n(2))},function(e,t,n){(function(e,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnect=t.SocialIdentity=t.AuthorizationGrant=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(9),s=n(252),c=n(153),l=n(141),f=o(l),p=n(306),h=o(p),d=n(146),v=o(d),y=n(36),m=o(y),g=e.env.KINVEY_MIC_AUTH_PATHNAME||"/oauth/auth",b=e.env.KINVEY_MIC_TOKEN_PATHNAME||"/oauth/token",w={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(w),t.AuthorizationGrant=w;var _={Facebook:"facebook",Google:"google",LinkedIn:"linkedin"};Object.freeze(_),t.SocialIdentity=_;t.MobileIdentityConnect=function(){function t(){var n=arguments.length<=0||void 0===arguments[0]?f["default"].sharedInstance():arguments[0];i(this,t),this.client=new f["default"]({protocol:e.env.KINVEY_MIC_PROTOCOL||"https:",host:e.env.KINVEY_MIC_HOST||"auth.kinvey.com",appKey:n.appKey,appSecret:n.appSecret,masterSecret:n.masterSecret,encryptionKey:n.encryptionKey})}return a(t,[{key:"login",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?w.AuthorizationCodeLoginPage:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=this.client.appKey,i=Promise.resolve().then(function(){if(n===w.AuthorizationCodeLoginPage)return t.requestCodeWithPopup(o,e,r);if(n===w.AuthorizationCodeAPI)return t.requestTempLoginUrl(o,e,r).then(function(n){return t.requestCodeWithUrl(n,o,e,r)});throw new u.KinveyError("The authorization grant "+n+" is unsupported. Please use a supported authorization grant.")}).then(function(n){return t.requestToken(n,o,e,r)});return i}},{key:"requestTempLoginUrl",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r="/";if(n.version){var o=n.version;(0,m["default"])(o)||(o=String(o)),r=h["default"].join(r,0===o.indexOf("v")?o:"v"+o)}var i=new c.KinveyRequestConfig({method:c.RequestMethod.POST,url:v["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:h["default"].join(r,g)}),properties:n.properties,body:{client_id:e,redirect_uri:t,response_type:"code"}});i.headers.set("Content-Type","application/x-www-form-urlencoded");var a=new s.NetworkRequest(i);return a.execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function(e,t){var n=this,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=Promise.resolve().then(function(){var i="/";if(o.version){var a=o.version;(0,m["default"])(a)||(a=String(a)),i=h["default"].join(i,0===a.indexOf("v")?a:"v"+a)}if(r.KinveyPopup){var s=new r.KinveyPopup;return s.open(v["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:h["default"].join(i,g),query:{client_id:e,redirect_uri:t,response_type:"code"}}))}throw new u.KinveyError("KinveyPopup is undefined."+(" Unable to login authorization grant "+w.AuthorizationCodeLoginPage+"."))}).then(function(e){var n=new Promise(function(n,r){function o(r){0===r.indexOf(t)&&(u=!0,e.removeAllListeners(),e.close(),n(v["default"].parse(r,!0).query.code))}function i(t){e.removeAllListeners(),e.close(),r(new Error(t))}function a(){e.removeAllListeners(),u||r(new Error("Login has been cancelled."))}var u=!1;e.on("loaded",o),e.on("error",i),e.on("closed",a)});return n});return i}},{key:"requestCodeWithUrl",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=Promise.resolve().then(function(){var o=new c.KinveyRequestConfig({method:c.RequestMethod.POST,url:e,properties:r.properties,body:{client_id:t,redirect_uri:n,response_type:"code",username:r.username,password:r.password},followRedirect:!1});o.headers.set("Content-Type","application/x-www-form-urlencoded");var i=new s.NetworkRequest(o);return i.execute()}).then(function(e){var t=e.getHeader("location");if(t)return v["default"].parse(t,!0).query.code;throw new u.KinveyError("Unable to authorize user with username "+r.username+".","A location header was not provided with a code to exchange for an auth token.")});return o}},{key:"requestToken",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=new c.KinveyRequestConfig({method:c.RequestMethod.POST,authType:c.AuthType.App,url:v["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:b}),properties:r.properties,body:{grant_type:"authorization_code",client_id:t,redirect_uri:n,code:e}});o.headers.set("Content-Type","application/x-www-form-urlencoded");var i=new s.NetworkRequest(o);i.automaticallyRefreshAuthToken=!1;var a=i.execute().then(function(e){return e.data});return a}}],[{key:"identity",get:function(){return e.env.KINVEY_MIC_IDENTITY||"kinveyAuth"}}]),t}()}).call(t,n(2),function(){return this}())},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,o="/"===a.charAt(0))}return t=n(r(t.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+t||"."},t.normalize=function(e){var o=t.isAbsolute(e),i="/"===a(e,-1);return e=n(r(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var o=r(e.split("/")),i=r(n.split("/")),a=Math.min(o.length,i.length),u=a,s=0;a>s;s++)if(o[s]!==i[s]){u=s;break}for(var c=[],s=u;s<o.length;s++)c.push("..");return c=c.concat(i.slice(u)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},t.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}}).call(t,n(2))},function(e,t,n){var r;(function(o,i){Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,n){n=[];for(t in e)n.hasOwnProperty.call(e,t)&&n.push(t);return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)o in t&&e.call(r,t[o],o,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var n=[];return this.forEach(function(r,o,i){e.call(t||void 0,r,o,i)&&n.push(r)}),n}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=[];return this.forEach(function(r,o,i){n.push(e.call(t||void 0,r,o,i))}),n}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){function t(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=[].slice,r=n.call(arguments,1),o=this,i=function(){return o.apply(this instanceof t?this:e||window,r.concat(n.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});var a=function(e){return a.use(e)};a.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(Array.isArray(e)&&Array.isArray(t))Array.prototype.push.apply(e,t);else if(e instanceof Object&&t instanceof Object&&e!==t)for(var n in t)e[n]=a.utils.extend(e[n],t[n]);else Array.isArray(t)&&(t=t.slice(0)),e=t}),e}},a.utils.extend(a,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var n=this.utils;if(!e)return this.services;for(var r in e)e.hasOwnProperty(r)&&"object"!=typeof e[r]&&(e[r]={id:e[r]});return n.extend(this.services,e),t&&(n.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=n.url(t.redirect_uri).href)),this},login:function(){function e(e,t){a.emit(e,t)}function t(e){return e}function n(e){return!!e}var r,o=this,i=o.utils,u=i.error,s=i.Promise(),c=i.args({network:"s",options:"o",callback:"f"},arguments),l=i.diffKey(c.options,o.settings),f=c.options=i.merge(o.settings,c.options||{});if(f.popup=i.merge(o.settings.popup,c.options.popup||{}),c.network=c.network||o.settings.default_service,s.proxy.then(c.callback,c.callback),s.proxy.then(e.bind(this,"auth.login auth"),e.bind(this,"auth.failed auth")),"string"!=typeof c.network||!(c.network in o.services))return s.reject(u("invalid_network","The provided network was not recognized"));var p=o.services[c.network],h=i.globalEvent(function(e){var t;t=e?JSON.parse(e):u("cancelled","The authentication was not completed"),t.error?s.reject(t):(i.store(t.network,t),s.fulfill({network:t.network,authResponse:t}))}),d=i.url(f.redirect_uri).href,v=p.oauth.response_type||f.response_type;/\bcode\b/.test(v)&&!p.oauth.grant&&(v=v.replace(/\bcode\b/,"token")),c.qs=i.merge(l,{client_id:encodeURIComponent(p.id),response_type:encodeURIComponent(v),redirect_uri:encodeURIComponent(d),state:{client_id:p.id,network:c.network,display:f.display,callback:h,state:f.state,redirect_uri:d}});var y=i.store(c.network),m=/[,\s]+/,g=o.settings.scope?[o.settings.scope.toString()]:[],b=i.merge(o.settings.scope_map,p.scope||{});if(f.scope&&g.push(f.scope.toString()),y&&"scope"in y&&y.scope instanceof String&&g.push(y.scope),g=g.join(",").split(m),g=i.unique(g).filter(n),c.qs.state.scope=g.join(","),g=g.map(function(e){return e in b?b[e]:e}),g=g.join(",").split(m),g=i.unique(g).filter(n),c.qs.scope=g.join(p.scope_delim||","),f.force===!1&&y&&"access_token"in y&&y.access_token&&"expires"in y&&y.expires>(new Date).getTime()/1e3){var w=i.diff((y.scope||"").split(m),(c.qs.state.scope||"").split(m));if(0===w.length)return s.fulfill({unchanged:!0,network:c.network,authResponse:y}),s}if("page"===f.display&&f.page_uri&&(c.qs.state.page_uri=i.url(f.page_uri).href),"login"in p&&"function"==typeof p.login&&p.login(c),(!/\btoken\b/.test(v)||parseInt(p.oauth.version,10)<2||"none"===f.display&&p.oauth.grant&&y&&y.refresh_token)&&(c.qs.state.oauth=p.oauth,c.qs.state.oauth_proxy=f.oauth_proxy),c.qs.state=encodeURIComponent(JSON.stringify(c.qs.state)),1===parseInt(p.oauth.version,10)?r=i.qs(f.oauth_proxy,c.qs,t):"none"===f.display&&p.oauth.grant&&y&&y.refresh_token?(c.qs.refresh_token=y.refresh_token,r=i.qs(f.oauth_proxy,c.qs,t)):r=i.qs(p.oauth.auth,c.qs,t),e("auth.init",c),"none"===f.display)i.iframe(r,d);else if("popup"===f.display)var _=i.popup(r,d,f.popup),x=setInterval(function(){if((!_||_.closed)&&(clearInterval(x),!s.state)){var e=u("cancelled","Login has been cancelled");_||(e=u("blocked","Popup was blocked")),e.network=c.network,s.reject(e)}},100);else window.location=r;return s.proxy},logout:function(){function e(e,t){a.emit(e,t)}var t=this,n=t.utils,r=n.error,o=n.Promise(),i=n.args({name:"s",options:"o",callback:"f"},arguments);if(i.options=i.options||{},o.proxy.then(i.callback,i.callback),o.proxy.then(e.bind(this,"auth.logout auth"),e.bind(this,"error")),i.name=i.name||this.settings.default_service,i.authResponse=n.store(i.name),!i.name||i.name in t.services)if(i.name&&i.authResponse){var u=function(e){n.store(i.name,null),o.fulfill(a.utils.merge({network:i.name},e||{}))},s={};if(i.options.force){var c=t.services[i.name].logout;if(c)if("function"==typeof c&&(c=c(u,i)),"string"==typeof c)n.iframe(c),s.force=null,s.message="Logout success on providers site was indeterminate";else if(void 0===c)return o.proxy}u(s)}else o.reject(r("invalid_session","There was no session to remove"));else o.reject(r("invalid_network","The network was unrecognized"));return o.proxy},getAuthResponse:function(e){return e=e||this.settings.default_service,e&&e in this.services?this.utils.store(e)||null:null},events:{}}),a.utils.extend(a.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,n){if(t){n=n||encodeURIComponent;for(var r in t){var o="([\\?\\&])"+r+"=[^\\&]*",i=new RegExp(o);e.match(i)&&(e=e.replace(i,"$1"+r+"="+n(t[r])),delete t[r])}}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,n)},param:function(e,t){var n,r,o={};if("string"==typeof e){if(t=t||decodeURIComponent,r=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<r.length;i++)n=r[i].match(/([^=]+)=(.*)/),o[n[1]]=t(n[2]);return o}t=t||encodeURIComponent;var a=e;o=[];for(var u in a)a.hasOwnProperty(u)&&a.hasOwnProperty(u)&&o.push([u,"?"===a[u]?"?":t(a[u])].join("="));return o.join("&")},store:function(){function e(){var e={};try{e=JSON.parse(n.getItem("hello"))||{}}catch(t){}return e}function t(e){n.setItem("hello",JSON.stringify(e))}for(var n,r=["localStorage","sessionStorage"],o=-1,i="test";r[++o];)try{n=window[r[o]],n.setItem(i+o,o),n.removeItem(i+o);break}catch(a){n=null}if(!n){var u=null;n={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].replace(/(^\s+|\s+$)/,"");if(r&&0===r.indexOf(e))return r.substr(e.length)}return u},setItem:function(e,t){u=t,document.cookie=e+"="+t}},u=n.getItem("hello")}return function(n,r,o){var i=e();if(n&&void 0===r)return i[n]||null;if(n&&null===r)try{delete i[n]}catch(a){i[n]=null}else{if(!n)return i;i[n]=r}return t(i),i||null}}(),append:function(e,t,n){var r="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)n=t;else for(var o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(var i in t[o])t[o].hasOwnProperty(i)&&(r[o][i]=t[o][i]);else"html"===o?r.innerHTML=t[o]:/^on/.test(o)?r[o]=t[o]:r.setAttribute(o,t[o]);return"body"===n?!function a(){document.body?document.body.appendChild(r):setTimeout(a,16)}():"object"==typeof n?n.appendChild(r):"string"==typeof n&&document.getElementsByTagName(n)[0].appendChild(r),r},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var n={},r=0,o=null,i=null;for(i in e)if(e.hasOwnProperty(i))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[i])for(i in t[0])if(e.hasOwnProperty(i)&&i in e)return t[0];for(i in e)if(e.hasOwnProperty(i))if(o=typeof t[r],"function"==typeof e[i]&&e[i].test(t[r])||"string"==typeof e[i]&&(e[i].indexOf("s")>-1&&"string"===o||e[i].indexOf("o")>-1&&"object"===o||e[i].indexOf("i")>-1&&"number"===o||e[i].indexOf("a")>-1&&"object"===o||e[i].indexOf("f")>-1&&"function"===o))n[i]=t[r++];else if("string"==typeof e[i]&&e[i].indexOf("!")>-1)return!1;return n},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter(function(t){return-1===e.indexOf(t)})},diffKey:function(e,t){if(e||!t){var n={};for(var r in e)r in t||(n[r]=e[r]);return n}return e},unique:function(e){return Array.isArray(e)?e.filter(function(t,n){return e.indexOf(t)===n}):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var e=0,t=1,n=2,r=function(t){return this instanceof r?(this.id="Thenable/1.0.6",this.state=e,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new r(t)};r.prototype={fulfill:function(e){return a(this,t,"fulfillValue",e)},reject:function(e){return a(this,n,"rejectReason",e)},then:function(e,t){var n=this,o=new r;return n.onFulfilled.push(c(e,o,"fulfill")),n.onRejected.push(c(t,o,"reject")),u(n),o.proxy}};var a=function(t,n,r,o){return t.state===e&&(t.state=n,t[r]=o,u(t)),t},u=function(e){e.state===t?s(e,"onFulfilled",e.fulfillValue):e.state===n&&s(e,"onRejected",e.rejectReason)},s=function(e,t,n){if(0!==e[t].length){var r=e[t];e[t]=[];var a=function(){for(var e=0;e<r.length;e++)r[e](n)};"object"==typeof o&&"function"==typeof o.nextTick?o.nextTick(a):"function"==typeof i?i(a):setTimeout(a,0)}},c=function(e,t,n){return function(r){if("function"!=typeof e)t[n].call(t,r);else{var o;try{o=e(r)}catch(i){return void t.reject(i)}l(t,o)}}},l=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var n;if("object"==typeof t&&null!==t||"function"==typeof t)try{n=t.then}catch(r){return void e.reject(r)}if("function"!=typeof n)e.fulfill(t);else{var o=!1;try{n.call(t,function(n){o||(o=!0,n===t?e.reject(new TypeError("circular thenable chain")):l(e,n))},function(t){o||(o=!0,e.reject(t))})}catch(r){o||e.reject(r)}}};return r}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,n){if(n&&"function"==typeof n)for(var r=t.split(e),o=0;o<r.length;o++)this.events[r[o]]=[n].concat(this.events[r[o]]||[]);return this},this.off=function(e,t){return this.findEvents(e,function(e,n){t&&this.events[e][n]!==t||(this.events[e][n]=null)}),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var n=function(n,r){t[t.length-1]="*"===n?e:n,this.events[n][r].apply(this,t)},r=this;r&&r.findEvents;)r.findEvents(e+",*",n),r=r.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(t,n){var r=t.split(e);for(var o in this.events)if(this.events.hasOwnProperty(o)&&r.indexOf(o)>-1)for(var i=0;i<this.events[o].length;i++)this.events[o][i]&&n.call(this,o,i)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(n){console.error(n)}},t},popup:function(e,t,n){var r=document.documentElement;if(n.height){var o=void 0!==window.screenTop?window.screenTop:screen.top,i=screen.height||window.innerHeight||r.clientHeight;n.top=parseInt((i-n.height)/2,10)+o}if(n.width){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,u=screen.width||window.innerWidth||r.clientWidth;n.left=parseInt((u-n.width)/2,10)+a}var s=[];Object.keys(n).forEach(function(e){var t=n[e];s.push(e+(null!==t?"="+t:""))}),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e)));var c=window.open(e,"_blank",s.join(","));
return c&&c.focus&&c.focus(),c},responseHandler:function(e,t){function n(e,t,n){var o=e.callback,a=e.network;if(i.store(a,e),!("display"in e&&"page"===e.display)){if(n&&o&&o in n){try{delete e.callback}catch(u){}i.store(a,e);var s=JSON.stringify(e);try{n[o](s)}catch(u){}}r()}}function r(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(n){}e.addEventListener&&e.addEventListener("load",function(){e.close()})}}var o,i=this,a=e.location;if(o=i.param(a.search),o&&o.state&&(o.code||o.oauth_token)){var u=JSON.parse(o.state);o.redirect_uri=u.redirect_uri||a.href.replace(/[\?\#].*$/,"");var s=u.oauth_proxy+"?"+i.param(o);return void a.assign(s)}if(o=i.merge(i.param(a.search||""),i.param(a.hash||"")),o&&"state"in o){try{var c=JSON.parse(o.state);i.extend(o,c)}catch(l){console.error("Could not decode state parameter")}if("access_token"in o&&o.access_token&&o.network)o.expires_in&&0!==parseInt(o.expires_in,10)||(o.expires_in=0),o.expires_in=parseInt(o.expires_in,10),o.expires=(new Date).getTime()/1e3+(o.expires_in||31536e3),n(o,e,t);else if("error"in o&&o.error&&o.network)o.error={code:o.error,message:o.error_message||o.error_description},n(o,e,t);else if(o.callback&&o.callback in t){var f="result"in o&&o.result?JSON.parse(o.result):!1;t[o.callback](f),r()}o.page_uri&&a.assign(o.page_uri)}else if("oauth_redirect"in o)return void a.assign(decodeURIComponent(o.oauth_redirect))}}),a.utils.Event.call(a),function(e){var t={},n={};e.on("auth.login, auth.logout",function(n){n&&"object"==typeof n&&n.network&&(t[n.network]=e.utils.store(n.network)||{})}),function r(){var o=(new Date).getTime()/1e3,i=function(t){e.emit("auth."+t,{network:a,authResponse:u})};for(var a in e.services)if(e.services.hasOwnProperty(a)){if(!e.services[a].id)continue;var u=e.utils.store(a)||{},s=e.services[a],c=t[a]||{};if(u&&"callback"in u){var l=u.callback;try{delete u.callback}catch(f){}e.utils.store(a,u);try{window[l](u)}catch(f){}}if(u&&"expires"in u&&u.expires<o){var p=s.refresh||u.refresh_token;!p||a in n&&!(n[a]<o)?p||a in n||(i("expired"),n[a]=!0):(e.emit("notice",a+" has expired trying to resignin"),e.login(a,{display:"none",force:!1}),n[a]=o+600);continue}if(c.access_token===u.access_token&&c.expires===u.expires)continue;!u.access_token&&c.access_token?i("logout"):u.access_token&&!c.access_token?i("login"):u.expires!==c.expires&&i("update"),t[a]=u,a in n&&delete n[a]}setTimeout(r,1e3)}()}(a),a.api=function(){function e(e){e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(e,t,n){var a=n?n.replace(/^\|/,""):"";return t in i.query?(a=i.query[t],delete i.query[t]):i.data&&t in i.data?(a=i.data[t],delete i.data[t]):n||o.reject(r("missing_attribute","The attribute "+t+" is missing from the request")),a}),e.match(/^https?:\/\//)||(e=c.base+e),i.url=e,n.request(i,function(e,t){if(!i.formatResponse)return void(("object"==typeof t?t.statusCode>=400:"object"==typeof e&&"error"in e)?o.reject(e):o.fulfill(e));if(e===!0?e={success:!0}:e||(e={}),"delete"===i.method&&(e=!e||n.isEmpty(e)?{success:!0}:e),c.wrap&&(i.path in c.wrap||"default"in c.wrap)){var r=i.path in c.wrap?i.path:"default",a=((new Date).getTime(),c.wrap[r](e,t,i));a&&(e=a)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=i.path+e.paging.next:e.paging.next+="#"+i.path),!e||"error"in e?o.reject(e):o.fulfill(e)})}var t=this,n=t.utils,r=n.error,o=n.Promise(),i=n.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);i.method=(i.method||"get").toLowerCase(),i.headers=i.headers||{},i.query=i.query||{},"get"!==i.method&&"delete"!==i.method||(n.extend(i.query,i.data),i.data={});var a=i.data=i.data||{};if(o.then(i.callback,i.callback),!i.path)return o.reject(r("invalid_path","Missing the path parameter from the request"));i.path=i.path.replace(/^\/+/,"");var u=(i.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(u in t.services){i.network=u;var s=new RegExp("^"+u+":?/?");i.path=i.path.replace(s,"")}i.network=t.settings.default_service=i.network||t.settings.default_service;var c=t.services[i.network];if(!c)return o.reject(r("invalid_network","Could not match the service requested: "+i.network));if(i.method in c&&i.path in c[i.method]&&c[i.method][i.path]===!1)return o.reject(r("invalid_path","The provided path is not available on the selected network"));i.oauth_proxy||(i.oauth_proxy=t.settings.oauth_proxy),"proxy"in i||(i.proxy=i.oauth_proxy&&c.oauth&&1===parseInt(c.oauth.version,10)),"timeout"in i||(i.timeout=t.settings.timeout),"formatResponse"in i||(i.formatResponse=!0),i.authResponse=t.getAuthResponse(i.network),i.authResponse&&i.authResponse.access_token&&(i.query.access_token=i.authResponse.access_token);var l,f=i.path;i.options=n.clone(i.query),i.data=n.clone(a);var p=c[{"delete":"del"}[i.method]||i.method]||{};if("get"===i.method){var h=f.split(/[\?#]/)[1];h&&(n.extend(i.query,n.param(h)),f=f.replace(/\?.*?(#|$)/,"$1"))}return(l=f.match(/#(.+)/,""))?(f=f.split("#")[0],i.path=l[1]):f in p?(i.path=f,f=p[f]):"default"in p&&(f=p["default"]),i.redirect_uri=t.settings.redirect_uri,i.xhr=c.xhr,i.jsonp=c.jsonp,i.form=c.form,"function"==typeof f?f(i,e):e(f),o.proxy},a.utils.extend(a.utils,{request:function(e,t){function n(e,t){var n;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(r.extend(e.query,e.data),e.data=null);var o=r.qs(e.url,e.query);e.proxy&&(o=r.qs(e.oauth_proxy,{path:o,access_token:n||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:!0})),t(o)}var r=this,o=r.error;r.isEmpty(e.data)||"FileList"in window||!r.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1);var i=this.request_cors(function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))});if(i)return void n(e,function(n){var o=r.xhr(e.method,n,e.headers,e.data,t);o.onprogress=e.onprogress||null,o.upload&&e.onuploadprogress&&(o.upload.onprogress=e.onuploadprogress)});var a=e.query;if(e.query=r.clone(e.query),e.callbackID=r.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void n(e,function(n){r.jsonp(n,t,e.callbackID,e.timeout)});e.query=a}if(e.form!==!1){e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID});var u;if("function"==typeof e.form&&(u=e.form(e,e.query)),"post"===e.method&&u!==!1)return void n(e,function(n){r.post(n,e.data,u,t,e.callbackID,e.timeout)})}t(o("invalid_request","There was no mechanism for handling this request"))},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var n="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return t?window[n]?t instanceof window[n]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e:!1},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var n in e)t[n]=this.clone(e[n]);return t},xhr:function(e,t,n,r,o){function i(e){for(var t,n={},r=/([a-z\-]+):\s?(.*);?/gi;t=r.exec(e);)n[t[1]]=t[2];return n}var a=new XMLHttpRequest,u=this.error,s=!1;"blob"===e&&(s=e,e="GET"),e=e.toUpperCase(),a.onload=function(t){var n=a.response;try{n=JSON.parse(a.responseText)}catch(r){401===a.status&&(n=u("access_denied",a.statusText))}var s=i(a.getAllResponseHeaders());s.statusCode=a.status,o(n||("GET"===e?u("empty_response","Could not get resource"):{}),s)},a.onerror=function(e){var t=a.responseText;try{t=JSON.parse(a.responseText)}catch(n){}o(t||u("access_denied","Could not get resource"))};var c;if("GET"===e||"DELETE"===e)r=null;else if(r&&"string"!=typeof r&&!(r instanceof FormData)&&!(r instanceof File)&&!(r instanceof Blob)){var l=new FormData;for(c in r)r.hasOwnProperty(c)&&(r[c]instanceof HTMLInputElement?"files"in r[c]&&r[c].files.length>0&&l.append(c,r[c].files[0]):r[c]instanceof Blob?l.append(c,r[c],r.name):l.append(c,r[c]));r=l}if(a.open(e,t,!0),s&&("responseType"in a?a.responseType=s:a.overrideMimeType("text/plain; charset=x-user-defined")),n)for(c in n)a.setRequestHeader(c,n[c]);return a.send(r),a},jsonp:function(e,t,n,r){var o,i=this,a=i.error,u=0,s=document.getElementsByTagName("head")[0],c=a("server_error","server_error"),l=function(){u++||window.setTimeout(function(){t(c),s.removeChild(f)},0)};n=i.globalEvent(function(e){return c=e,!0},n),e=e.replace(new RegExp("=\\?(&|$)"),"="+n+"$1");var f=i.append("script",{id:n,name:n,src:e,async:!0,onload:l,onerror:l,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&l()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(o=i.append("script",{text:"document.getElementById('"+n+"').onerror();"}),f.async=!1),r&&window.setTimeout(function(){c=a("timeout","timeout"),l()},r),s.appendChild(f),o&&s.appendChild(o)},post:function(e,t,n,r,o,i){var a,u=this,s=u.error,c=document,l=null,f=[],p=0,h=null,d=0,v=function(e){d++||r(e)};u.globalEvent(v,o);var y;try{y=c.createElement('<iframe name="'+o+'">')}catch(m){y=c.createElement("iframe")}if(y.name=o,y.id=o,y.style.display="none",n&&n.callbackonload&&(y.onload=function(){v({response:"posted",message:"Content was posted"})}),i&&setTimeout(function(){v(s("timeout","The post operation timed out"))},i),c.body.appendChild(y),u.domInstance("form",t)){for(l=t.form,p=0;p<l.elements.length;p++)l.elements[p]!==t&&l.elements[p].setAttribute("disabled",!0);t=l}if(u.domInstance("form",t))for(l=t,p=0;p<l.elements.length;p++)l.elements[p].disabled||"file"!==l.elements[p].type||(l.encoding=l.enctype="multipart/form-data",l.elements[p].setAttribute("name","file"));else{for(h in t)t.hasOwnProperty(h)&&u.domInstance("input",t[h])&&"file"===t[h].type&&(l=t[h].form,l.encoding=l.enctype="multipart/form-data");l||(l=c.createElement("form"),c.body.appendChild(l),a=l);var g;for(h in t)if(t.hasOwnProperty(h)){var b=u.domInstance("input",t[h])||u.domInstance("textArea",t[h])||u.domInstance("select",t[h]);if(b&&t[h].form===l)b&&t[h].name!==h&&(t[h].setAttribute("name",h),t[h].name=h);else{var w=l.elements[h];if(g)for(w instanceof NodeList||(w=[w]),p=0;p<w.length;p++)w[p].parentNode.removeChild(w[p]);g=c.createElement("input"),g.setAttribute("type","hidden"),g.setAttribute("name",h),b?g.value=t[h].value:u.domInstance(null,t[h])?g.value=t[h].innerHTML||t[h].innerText:g.value=t[h],l.appendChild(g)}}for(p=0;p<l.elements.length;p++)g=l.elements[p],g.name in t||g.getAttribute("disabled")===!0||(g.setAttribute("disabled",!0),f.push(g))}l.setAttribute("method","POST"),l.setAttribute("target",o),l.target=o,l.setAttribute("action",e),setTimeout(function(){l.submit(),setTimeout(function(){try{a&&a.parentNode.removeChild(a)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(t){}}for(var n=0;n<f.length;n++)f[n]&&(f[n].setAttribute("disabled",!1),f[n].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,n=e.match(t);if(!n)return e;for(var r=atob(e.replace(t,"")),o=[],i=0;i<r.length;i++)o.push(r.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:n[1]})}}),function(e){var t=e.api,n=e.utils;n.extend(n,{dataToJSON:function(e){var t=this,n=window,r=e.data;if(t.domInstance("form",r)?r=t.nodeListToJSON(r.elements):"NodeList"in n&&r instanceof NodeList?r=t.nodeListToJSON(r):t.domInstance("input",r)&&(r=t.nodeListToJSON([r])),("File"in n&&r instanceof n.File||"Blob"in n&&r instanceof n.Blob||"FileList"in n&&r instanceof n.FileList)&&(r={file:r}),!("FormData"in n&&r instanceof n.FormData))for(var o in r)if(r.hasOwnProperty(o))if("FileList"in n&&r[o]instanceof n.FileList)1===r[o].length&&(r[o]=r[o][0]);else{if(t.domInstance("input",r[o])&&"file"===r[o].type)continue;t.domInstance("input",r[o])||t.domInstance("select",r[o])||t.domInstance("textArea",r[o])?r[o]=r[o].value:t.domInstance(null,r[o])&&(r[o]=r[o].innerHTML||r[o].innerText)}return e.data=r,r},nodeListToJSON:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];!r.disabled&&r.name&&("file"===r.type?t[r.name]=r:t[r.name]=r.value||r.innerHTML)}return t}}),e.api=function(){var e=n.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&n.dataToJSON(e),t.call(this,e)}}(a),a.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function e(t,n){var r={closed:!1};return chrome.identity.launchWebAuthFlow({url:t,interactive:n},function(t){if(void 0===t)return void(r.closed=!0);var n=a.utils.url(t),o={location:{assign:function(t){e(t,!1)},search:n.search,hash:n.hash,href:n.href},close:function(){}};a.utils.responseHandler(o,window)}),r}a.utils.popup=function(t){return e(t,!0)},a.utils.iframe=function(t){e(t,!1)},a.utils.request_cors=function(e){return e(),!0};var t={};chrome.storage.local.get("hello",function(e){t=e.hello||{}}),a.utils.store=function(e,n){return 0===arguments.length?t:1===arguments.length?t[e]||null:n?(t[e]=n,chrome.storage.local.set({hello:t}),n):null===n?(delete t[e],chrome.storage.local.set({hello:t}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){a.utils.iframe=function(e,t){a.utils.popup(e,t,{hidden:"yes"})};var e=a.utils.popup;a.utils.popup=function(t,n,r){var o=e.call(this,t,n,r);try{if(o&&o.addEventListener){var i=a.utils.url(n),u=i.origin||i.protocol+"//"+i.hostname;o.addEventListener("loadstart",function(e){var t=e.url;if(0===t.indexOf(u)){var n=a.utils.url(t),r={location:{assign:function(e){o.executeScript({code:'window.location.href = "'+e+';"'})},search:n.search,hash:n.hash,href:n.href},close:function(){if(o.close){o.close();try{o.closed=!0}catch(e){}}}};a.utils.responseHandler(r,window)}})}}catch(s){}return o}}}(),function(e){function t(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function n(t,n,r){if(!("object"!=typeof t||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var o=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");o=o.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=r.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+o+"?format=jpeg&size=m")+"&access_token="+r.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=o.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+o)+"&access_token="+r.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+o),t.id||(t.id=t.path.replace(/^\//,""))}}function r(e){return function(t,n){delete t.query.limit,n(e)}}var o={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},i={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};e.init({dropbox:{name:"Dropbox",oauth:i,login:function(t){t.qs.scope="";var n=decodeURIComponent(t.qs.redirect_uri);0===n.indexOf("http:")&&0!==n.indexOf("http://localhost/")?e.services.dropbox.oauth=o:e.services.dropbox.oauth=i,t.options.popup.width=1e3,t.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":r("metadata/auto/@{parent|}"),"me/folder":r("metadata/auto/@{id}"),"me/folders":r("metadata/auto/"),"default":function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,n){var r=t.data.parent,o=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),n("https://api-content.dropbox.com/1/files_put/auto/"+r+"/"+o)},"me/folders":function(t,n){var r=t.data.name;t.data={},n("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:r}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(t(e),!e.uid)return e;e.name=e.display_name;var n=e.name.split(" ");return e.first_name=n.shift(),e.last_name=n.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},"default":function(e,r,o){return t(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach(function(t){t.root=e.root,n(t,r,o)})),n(e,r,o),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(a),function(e){function t(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function n(e){return"data"in e&&e.data.forEach(t),e}function r(e,t,n){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var r=n.query.access_token;if(!(e.data instanceof Array)){var i=e.data;delete e.data,e.data=[i]}e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort(function(e,t){return e.width-t.width}),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=o+e.cover_photo.id+"/picture?access_token="+r),"album"===e.type&&(e.files=e.photos=o+e.id+"/photos"),e.can_upload&&(e.upload_location=o+e.id+"/photos")})}return e}e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!0,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.options.popup.width=580,e.options.popup.height=400},logout:function(t,n){var r=e.utils.globalEvent(t),o=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:r,result:JSON.stringify({force:!0}),state:"{}"})),i=(n.authResponse||{}).access_token;return e.utils.iframe("https://www.facebook.com/logout.php?next="+o+"&access_token="+i),i?void 0:!1},base:"https://graph.facebook.com/v2.4/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:t,"me/friends":n,"me/following":n,"me/followers":n,"me/albums":r,"me/photos":r,"me/files":r,"default":r},xhr:function(t,n){return"get"!==t.method&&"post"!==t.method||(n.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,n){var r=t.method;"get"===r||e.utils.hasBinary(t.data)?"delete"===t.method&&(n.method="delete",t.method="post"):(t.data.method=r,t.method="get")},form:function(e){return{callbackonload:!0}}}});var o="https://graph.facebook.com/"}(a),function(e){function t(t,n,r){var o=(r?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var i in n)n.hasOwnProperty(i)&&(o+="&"+i+"="+n[i]);return o}function n(t){var n=e.getAuthResponse("flickr");t(n&&n.user_nsid?n.user_nsid:null)}function r(e,r){return r||(r={}),function(o,i){n(function(n){r.user_id=n,i(t(e,r,!0))})}}function o(e,t){var n="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(n="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),n}function i(e,t,n,r,o){return o=o?"_"+o:"","https://farm"+t+".staticflickr.com/"+n+"/"+e+"_"+r+o+".jpg"}function a(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function u(e){if(e.photoset||e.photos){var t="photoset"in e?"photoset":"photos";e=c(e,t),f(e),e.data=e.photo,delete e.photo;for(var n=0;n<e.data.length;n++){var r=e.data[n];r.name=r.title,r.picture=i(r.id,r.farm,r.server,r.secret,""),r.pictures=s(r.id,r.farm,r.server,r.secret),r.source=i(r.id,r.farm,r.server,r.secret,"b"),r.thumbnail=i(r.id,r.farm,r.server,r.secret,"m")}}return e}function s(e,t,n,r){var o=2048,a=[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:o}];return a.map(function(o){return{source:i(e,t,n,r,o.id),width:o.max,height:o.max}})}function c(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function l(e){if(a(e),e.contacts){e=c(e,"contacts"),f(e),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var n=e.data[t];n.id=n.nsid,n.name=n.realname||n.username,n.thumbnail=o(n,"m")}}return e}function f(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:r("flickr.people.getInfo"),"me/friends":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":r("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":r("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":r("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(a(e),e=c(e,"person"),e.id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=o(e,"l"),e.picture=o(e,"l")}return e},"me/friends":l,"me/followers":l,"me/following":l,"me/albums":function(e){return a(e),e=c(e,"photosets"),f(e),e.photoset&&(e.data=e.photoset,e.data.forEach(function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)}),delete e.photoset),e},"me/photos":function(e){return a(e),u(e)},"default":function(e){return a(e),u(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(a),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function n(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function r(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&(e=e.response.user,n(e)),e},"default":function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(n),delete e.response),e}},xhr:r,jsonp:r}})}(a),function(e){function t(e,t){var n=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;401!==n&&403!==n||(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function n(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}function r(e,t,n){if(e.data&&e.data.length&&t&&t.Link){var r=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);r&&(e.paging={next:r[1]})}}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,r){return t(e,r),n(e),e},"default":function(e,o,i){return t(e,o),Array.isArray(e)&&(e={data:e}),e.data&&(r(e,o,i),e.data.forEach(n)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(a),function(e){function t(e){return parseInt(e,10)}function n(e){return l(e),e.data=e.items,delete e.items,e}function r(e){return e.error?void 0:(e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e)}function o(e){return{source:e.url,width:e.width,height:e.height}}function i(e){e.data=e.feed.entry.map(c),delete e.feed}function a(e){if(l(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(c),delete e.feed;else{if("entry"in e)return c(e.entry);"items"in e?(e.data=e.items.map(r),delete e.items):r(e)}return e}function u(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function s(e,t,n){l(e);if("feed"in e&&"entry"in e.feed){for(var r=n.query.access_token,o=0;o<e.feed.entry.length;o++){var i=e.feed.entry[o];if(i.id=i.id.$t,i.name=i.title.$t,delete i.title,i.gd$email&&(i.email=i.gd$email&&i.gd$email.length>0?i.gd$email[0].address:null,i.emails=i.gd$email,delete i.gd$email),i.updated&&(i.updated=i.updated.$t),i.link){var a=i.link.length>0?i.link[0].href:null;a&&i.link[0].gd$etag&&(a+=(a.indexOf("?")>-1?"&":"?")+"access_token="+r,i.picture=a,i.thumbnail=a),delete i.link}i.category&&delete i.category}e.data=e.feed.entry,delete e.feed}return e}function c(e){var t,n=e.media$group,r=n.media$content.length?n.media$content[0]:{},i=n.media$content||[],a=n.media$thumbnail||[],u=i.concat(a).map(o).sort(function(e,t){return e.width-t.width}),s=0,c={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:r?r.url:null,pictures:u,images:[],thumbnail:r?r.url:null,width:r.width,height:r.height};if("link"in e)for(s=0;s<e.link.length;s++){var l=e.link[s];if(l.rel.match(/\#feed$/)){c.upload_location=c.files=c.photos=l.href;break}}if("category"in e&&e.category.length)for(t=e.category,s=0;s<t.length;s++)t[s].scheme&&t[s].scheme.match(/\#kind$/)&&(c.type=t[s].term.replace(/^.*?\#/,""));return"media$thumbnail"in n&&n.media$thumbnail.length&&(t=n.media$thumbnail,c.thumbnail=t[0].url,c.images=t.map(o)),t=n.media$content,t&&t.length&&c.images.push(o(t[0])),c}function l(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var n=t(e.feed.openSearch$itemsPerPage.$t),r=t(e.feed.openSearch$startIndex.$t),o=t(e.feed.openSearch$totalResults.$t);o>r+n&&(e.paging={next:"?start="+(r+n)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function f(){function e(e){var n=new FileReader;n.onload=function(n){t(btoa(n.target.result),e.type+i+"Content-Transfer-Encoding: base64")},n.readAsBinaryString(e)}function t(e,t){n.push(i+"Content-Type: "+t+i+i+e),o--,u()}var n=[],r=(1e10*Math.random()).toString(32),o=0,i="\r\n",a=i+"--"+r,u=function(){},s=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(n,r){"string"!=typeof n&&"length"in Object(n)||(n=[n]);for(var a=0;a<n.length;a++){o++;var u=n[a];if("undefined"!=typeof File&&u instanceof File||"undefined"!=typeof Blob&&u instanceof Blob)e(u);else if("string"==typeof u&&u.match(s)){var c=u.match(s);t(u.replace(s,""),c[1]+i+"Content-Transfer-Encoding: base64")}else t(u,r)}},this.onready=function(e){(u=function(){0===o&&(n.unshift(""),n.push("--"),e(n.join(a),r),n=[])})()}}function p(e,t){var n={};e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(n=e.data,e.data={},n.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),n.file&&(e.data.file=n.file),n.name&&(e.data.title=n.name));var r;if("file"in e.data&&(r=e.data.file,delete e.data.file,"object"==typeof r&&"files"in r&&(r=r.files),!r||!r.length))return void t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var o=new f;o.append(JSON.stringify(e.data),"application/json"),r&&o.append(r),o.onready(function(r,o){e.headers["content-type"]='multipart/related; boundary="'+o+'"',e.data=r,t("upload/drive/v2/files"+(n.id?"/"+n.id:"")+"?uploadType=multipart")})}function h(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}var d="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";e.init({google:{name:"Google Plus",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"code"===e.qs.response_type&&(e.qs.access_type="offline"),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":d,"me/followers":d,"me/contacts":d,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var n=e.query.id;delete e.query.id,t(n.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"
},post:{"me/files":p,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":p},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),u(e)),e},"me/friends":function(e){return e.items&&(l(e),e.data=e.items,e.data.forEach(u),delete e.items),e},"me/contacts":s,"me/followers":s,"me/following":s,"me/share":n,"me/feed":n,"me/albums":a,"me/photos":i,"default":a},xhr:function(t){return"post"===t.method||"put"===t.method?h(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(a),function(e){function t(e){return{source:e.url,width:e.width,height:e.height}}function n(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function r(e){return i(e),e&&"data"in e&&e.data.forEach(o),e}function o(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function i(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var n=e.data.id;e.data={},t("media/"+n+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return n(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":r,"me/following":r,"me/followers":r,"me/photos":function(e){return n(e),i(e),"data"in e&&(e.data=e.data.filter(function(e){return"image"===e.type}),e.data.forEach(function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map(function(n){var r=e.images[n];return t(r)}).sort(function(e,t){return e.width-t.width})})),e},"default":function(e){return e=n(e),i(e),e}},xhr:function(e,t){var n=e.method,r="get"!==n;return r&&("post"!==n&&"put"!==n||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=r),r},form:!1}})}(a),function(e){function t(e,t){var n,o;return e&&"Message"in e&&(o=e.Message,delete e.Message,"ErrorCode"in e?(n=e.ErrorCode,delete e.ErrorCode):n=r(t),e.error={code:n,message:o,details:e}),e}function n(e,t){var n=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+n,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),"put"===e.method&&(e.method="patch"),!0}function r(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:return"server_error";default:return"server_error"}}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var n=e.data.meetingId;e.data={},t("meetings/"+n+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,n){return t(e,n),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},"default":function(e,n){return t(e,n),e}},xhr:n}})}(a),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function n(e){return e.error?void 0:(e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e)}function r(e){return t(e),o(e),e.values&&(e.data=e.values.map(n),delete e.values),e}function o(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function i(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}function a(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function u(e,t){e.headers["x-li-format"]="json";var n=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+n+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var n={visibility:{code:"anyone"}};e.data.id?n.attribution={share:{id:e.data.id}}:(n.comment=e.data.message,e.data.picture&&e.data.link&&(n.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(n),t("people/~/shares?format=json")},"me/like":u},del:{"me/like":u},wrap:{me:function(e){return t(e),n(e),e},"me/friends":r,"me/following":r,"me/followers":r,"me/share":function(e){return t(e),o(e),e.values&&(e.data=e.values.map(n),e.data.forEach(function(e){e.message=e.headline}),delete e.values),e},"default":function(e,n){t(e),i(e,n),o(e)}},jsonp:function(e,t){a(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method?(a(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0):!1}}})}(a),function(e){function t(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t["_status_code_map[302]"]=200,!0}function n(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}function r(e){"next_href"in e&&(e.paging={next:e.next_href})}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json","default":function(e,t){t(e.path+".json")}},wrap:{me:function(e){return n(e),e},"default":function(e){return Array.isArray(e)&&(e={data:e.map(n)}),r(e),e}},xhr:t,jsonp:t}})}(a),function(e){function t(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function n(e){return r(e),o(e),e.users&&(e.data=e.users.map(t),delete e.users),e}function r(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function o(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}function i(e){return Array.isArray(e)?{data:e}:e}var a="https://api.twitter.com/";e.init({twitter:{oauth:{version:"1.0a",auth:a+"oauth/authenticate",request:a+"oauth/request_token",token:a+"oauth/access_token"},login:function(e){var t="?force_login=true";this.oauth.auth=this.oauth.auth.replace(t,"")+(e.options.force?t:"")},base:a+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,n){var r=t.data;t.data=null;var o=[];r.message&&(o.push(r.message),delete r.message),r.link&&(o.push(r.link),delete r.link),r.picture&&(o.push(r.picture),delete r.picture),o.length&&(r.status=o.join(" ")),r.file?(r["media[]"]=r.file,delete r.file,t.data=r,n("statuses/update_with_media.json")):"id"in r?n("statuses/retweet/"+r.id+".json"):(e.utils.extend(t.query,r),n("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var n=e.data.id;e.data=null,t("favorites/create.json?id="+n)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return r(e),t(e),e},"me/friends":n,"me/followers":n,"me/following":n,"me/share":function(e){return r(e),o(e),!e.error&&"length"in e?{data:e}:e},"default":function(e){return e=i(e),o(e),e}},xhr:function(e){return"get"!==e.method}}})}(a),function(e){function t(e,t){return null!==e&&"response"in e&&null!==e.response&&e.response.length&&(e=e.response[0],e.id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email)),e}function n(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,r,o){return n(e),t(e,o)}},xhr:!1,jsonp:!0,form:!1}})}(a),function(e){function t(e){return"data"in e&&e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(n).sort(function(e,t){return e.width-t.width}))}),e}function n(e){return{width:e.width,height:e.height,source:e.source}}function r(e){return"data"in e&&e.data.forEach(function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}),e}function o(e,t,n){if(e.id){var r=n.query.access_token;if(e.emails&&(e.email=e.emails.preferred),e.is_friend!==!1){var o=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+o+"/picture?access_token="+r}}return e}function i(e,t,n){return"data"in e&&e.data.forEach(function(e){o(e,t,n)}),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:o,"me/friends":i,"me/contacts":i,"me/followers":i,"me/following":i,"me/albums":r,"me/photos":t,"default":t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(a),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function n(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){e=e.query.results.profile,e.id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var n=[];e.first_name&&n.push(e.first_name),e.last_name&&n.push(e.last_name),e.name=n.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e}function r(e,n,r){t(e),i(e,n,r);return e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(o)),e}function o(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach(function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)})}function i(e,t,n){return e.query&&e.query.count&&n.options&&(e.paging={next:"?start="+(e.query.count+(+n.options.start||1))}),e}function a(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:a("select * from social.profile(0) where guid=me"),"me/friends":a("select * from social.contacts(0) where guid=me"),"me/following":a("select * from social.contacts(0) where guid=me")},wrap:{me:n,"me/friends":r,"me/following":r,"default":i}}})}(a),r=function(){return a}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)),"object"==typeof e&&e.exports&&(e.exports=a)}).call(t,n(2),n(308).setImmediate)},function(e,t,n){(function(e,r){function o(e,t){this._id=e,this._clearFn=t}var i=n(2).nextTick,a=Function.prototype.apply,u=Array.prototype.slice,s={},c=0;t.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=c++,r=arguments.length<2?!1:u.call(arguments,1);return s[n]=!0,i(function(){s[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(t,n(308).setImmediate,n(308).clearImmediate)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Html5HttpMiddleware=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function p(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:p(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=n(159),l=n(310),f=r(l);t.Html5HttpMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Kinvey HTML5 Http Middleware":arguments[0];return o(this,t),i(this,Object.getPrototypeOf(t).call(this,e))}return a(t,e),u(t,[{key:"handle",value:function(e){return s(Object.getPrototypeOf(t.prototype),"handle",this).call(this,e).then(function(){var t=new Promise(function(t,n){var r=e.url,o=e.method,i=e.headers,a=e.body,u=new XMLHttpRequest;u.open(o,r);var s=Object.keys(i.toJSON()),c=!0,l=!1,p=void 0;try{for(var h,d=s[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var v=h.value;u.setRequestHeader(v,i.get(v))}}catch(y){l=!0,p=y}finally{try{!c&&d["return"]&&d["return"]()}finally{if(l)throw p}}u.onload=u.ontimeout=u.onabort=u.onerror=function(){var r=u.status,o=u.response||null;return u.response&&(o=u.responseText||null),e.response={statusCode:r,headers:(0,f["default"])(u.getAllResponseHeaders()),data:o},r>=200&&300>r||304===r?t(e):n(e)},u.send(a)});return t})}}]),t}(c.KinveyMiddleware)},function(e,t,n){var r=n(311),o=n(312),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return o(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),a=r(e.slice(n+1));"undefined"==typeof t[o]?t[o]=a:i(t[o])?t[o].push(a):t[o]=[t[o],a]}),t}},function(e,t){function n(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=n,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){function r(e,t,n){if(!u(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===s.call(e)?o(e,t,n):"string"==typeof e?i(e,t,n):a(e,t,n)}function o(e,t,n){for(var r=0,o=e.length;o>r;r++)c.call(e,r)&&t.call(n,e[r],r,e)}function i(e,t,n){for(var r=0,o=e.length;o>r;r++)t.call(n,e.charAt(r),r,e)}function a(e,t,n){for(var r in e)c.call(e,r)&&t.call(n,e[r],r,e)}var u=n(313);e.exports=r;var s=Object.prototype.toString,c=Object.prototype.hasOwnProperty},function(e,t){function n(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=n;var r=Object.prototype.toString}]);