/**
 * kinvey-html5-sdk v3.1.0
 * Kinvey JavaScript SDK for HTML5.
 * http://www.kinvey.com
 *
 * Copyright (c) 2016, Kinvey.
 * All rights reserved.
 *
 * Released under the Apache-2.0 license.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Kinvey=t():e.Kinvey=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";var n=r(2);e.exports=n.Kinvey},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Kinvey=void 0;var n=r(3),o=r(131),i=r(317),a=r(319),u=r(210);o.CacheRequest.rack=new n.CacheRack,o.NetworkRequest.rack=new n.NetworkRack,o.Kinvey.Device=i.Device,o.Kinvey.Popup=a.Popup,o.Kinvey.Promise=u.Promise,o.Kinvey.CacheMiddleware=n.CacheMiddleware,o.Kinvey.HttpMiddleware=n.XHRMiddleware,o.Kinvey.ParseMiddleware=n.ParseMiddleware,o.Kinvey.SerializeMiddleware=n.SerializeMiddleware,t.Kinvey=o.Kinvey},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(316);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(309);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(314);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(315);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheMiddleware=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(6),l=r(129),f=r(131),p=r(9),h=n(p),d=r(218),v=n(d),y={};t.CacheMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Cache Middleware":arguments[0];return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),s(t,[{key:"openDatabase",value:function(e){if(!e)throw new f.KinveyError("A name is required to open a database.");var t=y[e];return t||(t=new l.DB(e)),t}},{key:"handle",value:function(){function e(e){return t.apply(this,arguments)}var t=o(h["default"].mark(function r(e){var t,n,o,i,a,u,s,c;return h["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.method,n=e.body,o=e.appKey,i=e.collection,a=e.entityId,u=this.openDatabase(o),s=void 0,"GET"!==t){r.next=19;break}if(!a){r.next=14;break}return r.next=11,u.findById(i,a);case 11:s=r.sent,r.next=17;break;case 14:return r.next=16,u.find(i);case 16:s=r.sent;case 17:r.next=41;break;case 19:if("POST"!==t&&"PUT"!==t){r.next=25;break}return r.next=22,u.save(i,n);case 22:s=r.sent,r.next=41;break;case 25:if("DELETE"!==t){r.next=41;break}if(!i||!a){r.next=32;break}return r.next=29,u.removeById(i,a);case 29:s=r.sent,r.next=41;break;case 32:if(i){r.next=38;break}return r.next=35,u.clear();case 35:s=r.sent,r.next=41;break;case 38:return r.next=40,u.remove(i,n);case 40:s=r.sent;case 41:return c={statusCode:"POST"===t?201:200,headers:{},data:s},s&&!(0,v["default"])(s)||(c.statusCode=204),r.abrupt("return",{response:c});case 44:case"end":return r.stop()}},r,this)}));return e}()}]),t}(c.Middleware)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7);Object.keys(n).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(8);Object.keys(o).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(12);Object.keys(i).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t){"use strict";function r(e,t){if(0===e.level)return e.value;for(var r="\r\n",s=t?a:o,c=1;c<e.level;c++)r=""+r+(n[c]?" ":u),r+="  ";return""+r+s+i+" "+e.value}Object.defineProperty(t,"__esModule",{value:!0});var n=[],o=String.fromCharCode(9500),i=String.fromCharCode(9472),a=String.fromCharCode(9492),u=String.fromCharCode(9474);t.AsciiTree={generate:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],o=arguments[1],i=r(t,o);return t.nodes.length>0&&!function(){var r=t.nodes.length-1;t.nodes.forEach(function(t,o){n[t.level]=o===r,i+=e.generate(t,o===r)})}(),i}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Middleware=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(7),s=r(9),c=n(s);t.Middleware=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"Middleware":arguments[0];i(this,e),this.name=t}return a(e,[{key:"handle",value:function(){function e(){return t.apply(this,arguments)}var t=o(c["default"].mark(function r(){return c["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("A subclass middleware must override the handle function.");case 1:case"end":return e.stop()}},r,this)}));return e}()},{key:"generateTree",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t={value:this.name,level:e,nodes:[]};return t}},{key:"toString",value:function(){var e=this.generateTree();return u.AsciiTree.generate(e)}}]),e}()},function(e,t,r){(function(t){var n="object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this,o=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,i=o&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=r(10),o)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(a){n.regeneratorRuntime=void 0}}).call(t,function(){return this}())},function(e,t,r){(function(t,r){!function(t){"use strict";function n(e,t,r,n){var o=Object.create((t||i).prototype),a=new d(n||[]);return o._invoke=f(e,r,a),o}function o(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}function i(){}function a(){}function u(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(e){this.arg=e}function l(e){function t(r,n,i,a){var u=o(e[r],e,n);if("throw"!==u.type){var s=u.arg,l=s.value;return l instanceof c?Promise.resolve(l.arg).then(function(e){t("next",e,i,a)},function(e){t("throw",e,i,a)}):Promise.resolve(l).then(function(e){s.value=e,i(s)},a)}a(u.arg)}function n(e,r){function n(){return new Promise(function(n,o){t(e,r,n,o)})}return i=i?i.then(n,n):n()}"object"==typeof r&&r.domain&&(t=r.domain.bind(t));var i;this._invoke=n}function f(e,t,r){var n=O;return function(i,a){if(n===E)throw new Error("Generator is already running");if(n===P){if("throw"===i)throw a;return y()}for(;;){var u=r.delegate;if(u){if("return"===i||"throw"===i&&u.iterator[i]===m){r.delegate=null;var s=u.iterator["return"];if(s){var c=o(s,u.iterator,a);if("throw"===c.type){i="throw",a=c.arg;continue}}if("return"===i)continue}var c=o(u.iterator[i],u.iterator,a);if("throw"===c.type){r.delegate=null,i="throw",a=c.arg;continue}i="next",a=m;var l=c.arg;if(!l.done)return n=j,l;r[u.resultName]=l.value,r.next=u.nextLoc,r.delegate=null}if("next"===i)r.sent=r._sent=a;else if("throw"===i){if(n===O)throw n=P,a;r.dispatchException(a)&&(i="next",a=m)}else"return"===i&&r.abrupt("return",a);n=E;var c=o(e,t,r);if("normal"===c.type){n=r.done?P:j;var l={value:c.arg,done:r.done};if(c.arg!==S)return l;r.delegate&&"next"===i&&(a=m)}else"throw"===c.type&&(n=P,i="throw",a=c.arg)}}}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function h(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}function v(e){if(e){var t=e[w];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function o(){for(;++r<e.length;)if(b.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=m,o.done=!0,o};return n.next=n}}return{next:y}}function y(){return{value:m,done:!0}}var m,b=Object.prototype.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},w=g.iterator||"@@iterator",_=g.toStringTag||"@@toStringTag",x="object"==typeof e,k=t.regeneratorRuntime;if(k)return void(x&&(e.exports=k));k=t.regeneratorRuntime=x?e.exports:{},k.wrap=n;var O="suspendedStart",j="suspendedYield",E="executing",P="completed",S={},T=u.prototype=i.prototype;a.prototype=T.constructor=u,u.constructor=a,u[_]=a.displayName="GeneratorFunction",k.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},k.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_ in e||(e[_]="GeneratorFunction")),e.prototype=Object.create(T),e},k.awrap=function(e){return new c(e)},s(l.prototype),k.async=function(e,t,r,o){var i=new l(n(e,t,r,o));return k.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},s(T),T[w]=function(){return this},T[_]="Generator",T.toString=function(){return"[object Generator]"},k.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},k.values=v,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!e)for(var t in this)"t"===t.charAt(0)&&b.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,n){return i.type="throw",i.arg=e,r.next=t,!!n}if(this.done)throw e;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=b.call(o,"catchLoc"),u=b.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&b.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?this.next=o.finallyLoc:this.complete(i),S},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),h(r),S}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;h(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:v(e),resultName:t,nextLoc:r},S}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}(),r(11))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&h&&(v=!1,h.length?d=h.concat(d):y=-1,d.length&&u())}function u(){if(!v){var e=o(a);v=!0;for(var t=d.length;t;){for(h=d,d=[];++y<t;)h&&h[y].run();y=-1,t=d.length}h=null,v=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var l,f,p=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var h,d=[],v=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new s(e,t)),1!==d.length||v||o(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rack=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function m(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},l=r(8),f=r(9),p=n(f),h=r(13),d=n(h),v=r(121),y=n(v);t.Rack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Rack":arguments[0];i(this,t);var r=a(this,Object.getPrototypeOf(t).call(this,e));return r.middlewares=[],r.canceled=!1,r}return u(t,e),s(t,[{key:"getMiddleware",value:function(){var e=arguments.length<=0||void 0===arguments[0]?-1:arguments[0],t=this.middlewares;if(e<-1||e>=t.length)throw new Error("Index "+e+" is out of bounds.");return t[e]}},{key:"use",value:function(e){if(e){if(e instanceof l.Middleware)return void this.middlewares.push(e);throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"useBefore",value:function(e,t){if(t){if(t instanceof l.Middleware){var r=this.middlewares,n=(0,d["default"])(r,function(t){return t instanceof e});return void(n>-1&&(r.splice(n,0,t),this.middlewares=r))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"useAfter",value:function(e,t){if(t){if(t instanceof l.Middleware){var r=this.middlewares,n=(0,d["default"])(r,function(t){return t instanceof e});return void(n>-1&&(r.splice(n+1,0,t),this.middlewares=r))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"swap",value:function(e,t){if(t){if(t instanceof l.Middleware){var r=this.middlewares,n=(0,d["default"])(r,function(t){return t instanceof e});return void(n>-1&&(r.splice(n,1,t),this.middlewares=r))}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"remove",value:function(e){var t=this.middlewares,r=(0,d["default"])(t,function(t){return t instanceof e});r>-1&&(t.splice(r,1),this.middlewares=t,this.remove(e))}},{key:"reset",value:function(){this.middlewares=[]}},{key:"execute",value:function(){function e(e){return t.apply(this,arguments)}var t=o(p["default"].mark(function r(e){return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Request is null. Please provide a valid request.");case 2:return t.abrupt("return",(0,y["default"])(this.middlewares,function(t,r){return t=t.then(function(t){var n=t.req,o=t.response;return n||(n=e),r.handle(n,o)})},Promise.resolve({request:e,response:void 0})));case 3:case"end":return t.stop()}},r,this)}));return e}()},{key:"cancel",value:function(){this.canceled=!0}},{key:"handle",value:function(e){return this.execute(e)}},{key:"generateTree",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],r=c(Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,e),n=this.middlewares;return n.forEach(function(t){r.nodes.push(t.generateTree(e+1))}),r}}]),t}(l.Middleware)},function(e,t,r){function n(e,t,r){var n=e?e.length:0;if(!n)return-1;var s=null==r?0:a(r);return s<0&&(s=u(n+s,0)),o(e,i(t,3),s)}var o=r(14),i=r(15),a=r(118),u=Math.max;e.exports=n},function(e,t){function r(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}e.exports=r},function(e,t,r){function n(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?u(e)?i(e[0],e[1]):o(e):s(e)}var o=r(16),i=r(100),a=r(114),u=r(80),s=r(115);e.exports=n},function(e,t,r){function n(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(r){return r===e||o(r,e,t)}}var o=r(17),i=r(97),a=r(99);e.exports=n},function(e,t,r){function n(e,t,r,n){var s=r.length,c=s,l=!n;if(null==e)return!c;for(e=Object(e);s--;){var f=r[s];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++s<c;){f=r[s];var p=f[0],h=e[p],d=f[1];if(l&&f[2]){if(void 0===h&&!(p in e))return!1}else{var v=new o;if(n)var y=n(h,d,p,e,t,v);if(!(void 0===y?i(d,h,n,a|u,v):y))return!1}}return!0}var o=r(18),i=r(59),a=1,u=2;e.exports=n},function(e,t,r){function n(e){this.__data__=new o(e)}var o=r(19),i=r(27),a=r(28),u=r(29),s=r(30),c=r(31);n.prototype.clear=i,n.prototype["delete"]=a,n.prototype.get=u,n.prototype.has=s,n.prototype.set=c,e.exports=n},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(20),i=r(21),a=r(24),u=r(25),s=r(26);n.prototype.clear=o,n.prototype["delete"]=i,n.prototype.get=a,n.prototype.has=u,n.prototype.set=s,e.exports=n},function(e,t){function r(){this.__data__=[]}e.exports=r},function(e,t,r){function n(e){var t=this.__data__,r=o(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():a.call(t,r,1),!0}var o=r(22),i=Array.prototype,a=i.splice;e.exports=n},function(e,t,r){function n(e,t){for(var r=e.length;r--;)if(o(e[r][0],t))return r;return-1}var o=r(23);e.exports=n},function(e,t){function r(e,t){return e===t||e!==e&&t!==t}e.exports=r},function(e,t,r){function n(e){var t=this.__data__,r=o(t,e);return r<0?void 0:t[r][1]}var o=r(22);e.exports=n},function(e,t,r){function n(e){return o(this.__data__,e)>-1}var o=r(22);e.exports=n},function(e,t,r){function n(e,t){var r=this.__data__,n=o(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}var o=r(22);e.exports=n},function(e,t,r){function n(){this.__data__=new o}var o=r(19);e.exports=n},function(e,t){function r(e){return this.__data__["delete"](e)}e.exports=r},function(e,t){function r(e){return this.__data__.get(e)}e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){function n(e,t){var r=this.__data__;if(r instanceof o){var n=r.__data__;if(!i||n.length<u-1)return n.push([e,t]),this;r=this.__data__=new a(n)}return r.set(e,t),this}var o=r(19),i=r(32),a=r(44),u=200;e.exports=n},function(e,t,r){var n=r(33),o=r(40),i=n(o,"Map");e.exports=i},function(e,t,r){function n(e,t){var r=i(e,t);return o(r)?r:void 0}var o=r(34),i=r(43);e.exports=n},function(e,t,r){function n(e){if(!u(e)||a(e))return!1;var t=o(e)||i(e)?v:l;return t.test(s(e))}var o=r(35),i=r(37),a=r(38),u=r(36),s=r(42),c=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,f=Function.prototype,p=Object.prototype,h=f.toString,d=p.hasOwnProperty,v=RegExp("^"+h.call(d).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=n},function(e,t,r){function n(e){var t=o(e)?s.call(e):"";return t==i||t==a}var o=r(36),i="[object Function]",a="[object GeneratorFunction]",u=Object.prototype,s=u.toString;e.exports=n},function(e,t){function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=r},function(e,t){function r(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}e.exports=r},function(e,t,r){function n(e){return!!i&&i in e}var o=r(39),i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=n},function(e,t,r){var n=r(40),o=n["__core-js_shared__"];e.exports=o},function(e,t,r){var n=r(41),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},function(e,t){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(t,function(){return this}())},function(e,t){function r(e){if(null!=e){try{return o.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var n=Function.prototype,o=n.toString;e.exports=r},function(e,t){function r(e,t){return null==e?void 0:e[t]}e.exports=r},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(45),i=r(53),a=r(56),u=r(57),s=r(58);n.prototype.clear=o,n.prototype["delete"]=i,n.prototype.get=a,n.prototype.has=u,n.prototype.set=s,e.exports=n},function(e,t,r){function n(){this.__data__={hash:new o,map:new(a||i),string:new o}}var o=r(46),i=r(19),a=r(32);e.exports=n},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(47),i=r(49),a=r(50),u=r(51),s=r(52);n.prototype.clear=o,n.prototype["delete"]=i,n.prototype.get=a,n.prototype.has=u,n.prototype.set=s,e.exports=n},function(e,t,r){function n(){this.__data__=o?o(null):{}}var o=r(48);e.exports=n},function(e,t,r){var n=r(33),o=n(Object,"create");e.exports=o},function(e,t){function r(e){return this.has(e)&&delete this.__data__[e]}e.exports=r},function(e,t,r){function n(e){var t=this.__data__;if(o){var r=t[e];return r===i?void 0:r}return u.call(t,e)?t[e]:void 0}var o=r(48),i="__lodash_hash_undefined__",a=Object.prototype,u=a.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){var t=this.__data__;return o?void 0!==t[e]:a.call(t,e)}var o=r(48),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t){var r=this.__data__;return r[e]=o&&void 0===t?i:t,this}var o=r(48),i="__lodash_hash_undefined__";e.exports=n},function(e,t,r){function n(e){return o(this,e)["delete"](e)}var o=r(54);e.exports=n},function(e,t,r){function n(e,t){var r=e.__data__;return o(t)?r["string"==typeof t?"string":"hash"]:r.map}var o=r(55);e.exports=n},function(e,t){function r(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=r},function(e,t,r){function n(e){return o(this,e).get(e)}var o=r(54);e.exports=n},function(e,t,r){function n(e){return o(this,e).has(e)}var o=r(54);e.exports=n},function(e,t,r){function n(e,t){return o(this,e).set(e,t),this}var o=r(54);e.exports=n},function(e,t,r){function n(e,t,r,u,s){return e===t||(null==e||null==t||!i(e)&&!a(t)?e!==e&&t!==t:o(e,t,n,r,u,s))}var o=r(60),i=r(36),a=r(79);e.exports=n},function(e,t,r){function n(e,t,r,n,y,b){var g=c(e),w=c(t),_=d,x=d;g||(_=s(e),_=_==h?v:_),w||(x=s(t),x=x==h?v:x);var k=_==v&&!l(e),O=x==v&&!l(t),j=_==x;if(j&&!k)return b||(b=new o),g||f(e)?i(e,t,r,n,y,b):a(e,t,_,r,n,y,b);if(!(y&p)){var E=k&&m.call(e,"__wrapped__"),P=O&&m.call(t,"__wrapped__");if(E||P){var S=E?e.value():e,T=P?t.value():t;return b||(b=new o),r(S,T,n,y,b)}}return!!j&&(b||(b=new o),u(e,t,r,n,y,b))}var o=r(18),i=r(61),a=r(66),u=r(71),s=r(86),c=r(80),l=r(37),f=r(92),p=2,h="[object Arguments]",d="[object Array]",v="[object Object]",y=Object.prototype,m=y.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t,r,n,s,c){var l=s&u,f=e.length,p=t.length;if(f!=p&&!(l&&p>f))return!1;var h=c.get(e);if(h&&c.get(t))return h==t;var d=-1,v=!0,y=s&a?new o:void 0;for(c.set(e,t),c.set(t,e);++d<f;){var m=e[d],b=t[d];if(n)var g=l?n(b,m,d,t,e,c):n(m,b,d,e,t,c);if(void 0!==g){if(g)continue;v=!1;break}if(y){if(!i(t,function(e,t){if(!y.has(t)&&(m===e||r(m,e,n,s,c)))return y.add(t)})){v=!1;break}}else if(m!==b&&!r(m,b,n,s,c)){v=!1;break}}return c["delete"](e),c["delete"](t),v}var o=r(62),i=r(65),a=1,u=2;e.exports=n},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.__data__=new o;++t<r;)this.add(e[t])}var o=r(44),i=r(63),a=r(64);n.prototype.add=n.prototype.push=i,n.prototype.has=a,e.exports=n},function(e,t){function r(e){return this.__data__.set(e,n),this}var n="__lodash_hash_undefined__";e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}e.exports=r},function(e,t,r){function n(e,t,r,n,o,k,j){switch(r){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!n(new i(e),new i(t)));case p:case h:case y:return a(+e,+t);case d:return e.name==t.name&&e.message==t.message;case m:case g:return e==t+"";case v:var E=s;case b:var P=k&f;if(E||(E=c),e.size!=t.size&&!P)return!1;var S=j.get(e);if(S)return S==t;k|=l,j.set(e,t);var T=u(E(e),E(t),n,o,k,j);return j["delete"](e),T;case w:if(O)return O.call(e)==O.call(t)}return!1}var o=r(67),i=r(68),a=r(23),u=r(61),s=r(69),c=r(70),l=1,f=2,p="[object Boolean]",h="[object Date]",d="[object Error]",v="[object Map]",y="[object Number]",m="[object RegExp]",b="[object Set]",g="[object String]",w="[object Symbol]",_="[object ArrayBuffer]",x="[object DataView]",k=o?o.prototype:void 0,O=k?k.valueOf:void 0;e.exports=n},function(e,t,r){var n=r(40),o=n.Symbol;e.exports=o},function(e,t,r){var n=r(40),o=n.Uint8Array;e.exports=o},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}e.exports=r},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}e.exports=r},function(e,t,r){function n(e,t,r,n,a,s){var c=a&i,l=o(e),f=l.length,p=o(t),h=p.length;if(f!=h&&!c)return!1;for(var d=f;d--;){var v=l[d];if(!(c?v in t:u.call(t,v)))return!1}var y=s.get(e);if(y&&s.get(t))return y==t;var m=!0;s.set(e,t),s.set(t,e);for(var b=c;++d<f;){v=l[d];var g=e[v],w=t[v];if(n)var _=c?n(w,g,v,t,e,s):n(g,w,v,e,t,s);if(!(void 0===_?g===w||r(g,w,n,a,s):_)){m=!1;break}b||(b="constructor"==v)}if(m&&!b){var x=e.constructor,k=t.constructor;x!=k&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof k&&k instanceof k)&&(m=!1)}return s["delete"](e),s["delete"](t),m}var o=r(72),i=2,a=Object.prototype,u=a.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){return a(e)?o(e):i(e)}var o=r(73),i=r(82),a=r(77);e.exports=n},function(e,t,r){function n(e,t){var r=a(e)||i(e)?o(e.length,String):[],n=r.length,s=!!n;for(var l in e)!t&&!c.call(e,l)||s&&("length"==l||u(l,n))||r.push(l);return r}var o=r(74),i=r(75),a=r(80),u=r(81),s=Object.prototype,c=s.hasOwnProperty;e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}e.exports=r},function(e,t,r){function n(e){return o(e)&&u.call(e,"callee")&&(!c.call(e,"callee")||s.call(e)==i)}var o=r(76),i="[object Arguments]",a=Object.prototype,u=a.hasOwnProperty,s=a.toString,c=a.propertyIsEnumerable;e.exports=n},function(e,t,r){function n(e){return i(e)&&o(e)}var o=r(77),i=r(79);e.exports=n},function(e,t,r){function n(e){return null!=e&&i(e.length)&&!o(e)}var o=r(35),i=r(78);e.exports=n},function(e,t){function r(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}var n=9007199254740991;e.exports=r},function(e,t){function r(e){return!!e&&"object"==typeof e}e.exports=r},function(e,t){var r=Array.isArray;e.exports=r},function(e,t){function r(e,t){return t=null==t?n:t,!!t&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}var n=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=r},function(e,t,r){function n(e){if(!o(e))return i(e);var t=[];for(var r in Object(e))u.call(e,r)&&"constructor"!=r&&t.push(r);return t}var o=r(83),i=r(84),a=Object.prototype,u=a.hasOwnProperty;e.exports=n},function(e,t){function r(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||n;return e===r}var n=Object.prototype;e.exports=r},function(e,t,r){var n=r(85),o=n(Object.keys,Object);e.exports=o},function(e,t){function r(e,t){return function(r){return e(t(r))}}e.exports=r},function(e,t,r){var n=r(87),o=r(32),i=r(88),a=r(89),u=r(90),s=r(91),c=r(42),l="[object Map]",f="[object Object]",p="[object Promise]",h="[object Set]",d="[object WeakMap]",v="[object DataView]",y=Object.prototype,m=y.toString,b=c(n),g=c(o),w=c(i),_=c(a),x=c(u),k=s;(n&&k(new n(new ArrayBuffer(1)))!=v||o&&k(new o)!=l||i&&k(i.resolve())!=p||a&&k(new a)!=h||u&&k(new u)!=d)&&(k=function(e){var t=m.call(e),r=t==f?e.constructor:void 0,n=r?c(r):void 0;if(n)switch(n){case b:return v;case g:return l;case w:return p;case _:return h;case x:return d}return t}),e.exports=k},function(e,t,r){var n=r(33),o=r(40),i=n(o,"DataView");e.exports=i},function(e,t,r){var n=r(33),o=r(40),i=n(o,"Promise");
e.exports=i},function(e,t,r){var n=r(33),o=r(40),i=n(o,"Set");e.exports=i},function(e,t,r){var n=r(33),o=r(40),i=n(o,"WeakMap");e.exports=i},function(e,t){function r(e){return o.call(e)}var n=Object.prototype,o=n.toString;e.exports=r},function(e,t,r){var n=r(93),o=r(94),i=r(95),a=i&&i.isTypedArray,u=a?o(a):n;e.exports=u},function(e,t,r){function n(e){return i(e)&&o(e.length)&&!!A[I.call(e)]}var o=r(78),i=r(79),a="[object Arguments]",u="[object Array]",s="[object Boolean]",c="[object Date]",l="[object Error]",f="[object Function]",p="[object Map]",h="[object Number]",d="[object Object]",v="[object RegExp]",y="[object Set]",m="[object String]",b="[object WeakMap]",g="[object ArrayBuffer]",w="[object DataView]",_="[object Float32Array]",x="[object Float64Array]",k="[object Int8Array]",O="[object Int16Array]",j="[object Int32Array]",E="[object Uint8Array]",P="[object Uint8ClampedArray]",S="[object Uint16Array]",T="[object Uint32Array]",A={};A[_]=A[x]=A[k]=A[O]=A[j]=A[E]=A[P]=A[S]=A[T]=!0,A[a]=A[u]=A[g]=A[s]=A[w]=A[c]=A[l]=A[f]=A[p]=A[h]=A[d]=A[v]=A[y]=A[m]=A[b]=!1;var R=Object.prototype,I=R.toString;e.exports=n},function(e,t){function r(e){return function(t){return e(t)}}e.exports=r},function(e,t,r){(function(e){var n=r(41),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o,u=a&&n.process,s=function(){try{return u&&u.binding("util")}catch(e){}}();e.exports=s}).call(t,r(96)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,r){function n(e){for(var t=i(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,o(a)]}return t}var o=r(98),i=r(72);e.exports=n},function(e,t,r){function n(e){return e===e&&!o(e)}var o=r(36);e.exports=n},function(e,t){function r(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}e.exports=r},function(e,t,r){function n(e,t){return u(e)&&s(t)?c(l(e),t):function(r){var n=i(r,e);return void 0===n&&n===t?a(r,e):o(t,n,void 0,f|p)}}var o=r(59),i=r(101),a=r(111),u=r(109),s=r(98),c=r(99),l=r(110),f=1,p=2;e.exports=n},function(e,t,r){function n(e,t,r){var n=null==e?void 0:o(e,t);return void 0===n?r:n}var o=r(102);e.exports=n},function(e,t,r){function n(e,t){t=i(t,e)?[t]:o(t);for(var r=0,n=t.length;null!=e&&r<n;)e=e[a(t[r++])];return r&&r==n?e:void 0}var o=r(103),i=r(109),a=r(110);e.exports=n},function(e,t,r){function n(e){return o(e)?e:i(e)}var o=r(80),i=r(104);e.exports=n},function(e,t,r){var n=r(105),o=r(106),i=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g,s=n(function(e){e=o(e);var t=[];return i.test(e)&&t.push(""),e.replace(a,function(e,r,n,o){t.push(n?o.replace(u,"$1"):r||e)}),t});e.exports=s},function(e,t,r){function n(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(i);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(n.Cache||o),r}var o=r(44),i="Expected a function";n.Cache=o,e.exports=n},function(e,t,r){function n(e){return null==e?"":o(e)}var o=r(107);e.exports=n},function(e,t,r){function n(e){if("string"==typeof e)return e;if(i(e))return s?s.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}var o=r(67),i=r(108),a=1/0,u=o?o.prototype:void 0,s=u?u.toString:void 0;e.exports=n},function(e,t,r){function n(e){return"symbol"==typeof e||o(e)&&u.call(e)==i}var o=r(79),i="[object Symbol]",a=Object.prototype,u=a.toString;e.exports=n},function(e,t,r){function n(e,t){if(o(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||(u.test(e)||!a.test(e)||null!=t&&e in Object(t))}var o=r(80),i=r(108),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=n},function(e,t,r){function n(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}var o=r(108),i=1/0;e.exports=n},function(e,t,r){function n(e,t){return null!=e&&i(e,t,o)}var o=r(112),i=r(113);e.exports=n},function(e,t){function r(e,t){return null!=e&&t in Object(e)}e.exports=r},function(e,t,r){function n(e,t,r){t=s(t,e)?[t]:o(t);for(var n,f=-1,p=t.length;++f<p;){var h=l(t[f]);if(!(n=null!=e&&r(e,h)))break;e=e[h]}if(n)return n;var p=e?e.length:0;return!!p&&c(p)&&u(h,p)&&(a(e)||i(e))}var o=r(103),i=r(75),a=r(80),u=r(81),s=r(109),c=r(78),l=r(110);e.exports=n},function(e,t){function r(e){return e}e.exports=r},function(e,t,r){function n(e){return a(e)?o(u(e)):i(e)}var o=r(116),i=r(117),a=r(109),u=r(110);e.exports=n},function(e,t){function r(e){return function(t){return null==t?void 0:t[e]}}e.exports=r},function(e,t,r){function n(e){return function(t){return o(t,e)}}var o=r(102);e.exports=n},function(e,t,r){function n(e){var t=o(e),r=t%1;return t===t?r?t-r:t:0}var o=r(119);e.exports=n},function(e,t,r){function n(e){if(!e)return 0===e?e:0;if(e=o(e),e===i||e===-i){var t=e<0?-1:1;return t*a}return e===e?e:0}var o=r(120),i=1/0,a=1.7976931348623157e308;e.exports=n},function(e,t,r){function n(e){if("number"==typeof e)return e;if(i(e))return a;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var r=c.test(e);return r||l.test(e)?f(e.slice(2),r?2:8):s.test(e)?a:+e}var o=r(36),i=r(108),a=NaN,u=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;e.exports=n},function(e,t,r){function n(e,t,r){var n=s(e)?o:u,c=arguments.length<3;return n(e,a(t,4),r,c,i)}var o=r(122),i=r(123),a=r(15),u=r(128),s=r(80);e.exports=n},function(e,t){function r(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}e.exports=r},function(e,t,r){var n=r(124),o=r(127),i=o(n);e.exports=i},function(e,t,r){function n(e,t){return e&&o(e,t,i)}var o=r(125),i=r(72);e.exports=n},function(e,t,r){var n=r(126),o=n();e.exports=o},function(e,t){function r(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),u=a.length;u--;){var s=a[e?u:++o];if(r(i[s],s,i)===!1)break}return t}}e.exports=r},function(e,t,r){function n(e,t){return function(r,n){if(null==r)return r;if(!o(r))return e(r,n);for(var i=r.length,a=t?i:-1,u=Object(r);(t?a--:++a<i)&&n(u[a],a,u)!==!1;);return r}}var o=r(77);e.exports=n},function(e,t){function r(e,t,r,n,o){return o(e,function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)}),r}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(130);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new p.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):p.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DB=t.StorageAdapter=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(131),s=r(291),c=r(302),l=r(303),f=r(304),p=r(210),h=r(306),d=n(h),v=r(9),y=n(v),m=r(235),b=n(m),g=r(121),w=n(g),_=r(156),x=n(_),k=r(158),O=n(k),j=r(80),E=n(j),P=e.env.KINVEY_ID_ATTRIBUTE||"_id",S=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd";d["default"].configure(p.Promise);var T=new d["default"](1,1/0),A={IndexedDB:"IndexedDB",LocalStorage:"LocalStorage",Memory:"Memory",SessionStorage:"SessionStorage",WebSQL:"WebSQL"};Object.freeze(A),t.StorageAdapter=A;t.DB=function(){function e(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?[A.WebSQL,A.IndexedDB,A.LocalStorage,A.SessionStorage,A.Memory]:arguments[1];if(i(this,e),!t)throw new u.KinveyError("Unable to create a DB instance without a name.");if(!(0,O["default"])(t))throw new u.KinveyError("The name is not a string. A name must be a string to create a DB instance.");(0,E["default"])(n)||(n=[n]),(0,x["default"])(n,function(e){switch(e){case A.IndexedDB:if(c.IndexedDB.isSupported())return r.adapter=new c.IndexedDB(t),!1;break;case A.LocalStorage:if(s.LocalStorage.isSupported())return r.adapter=new s.LocalStorage(t),!1;break;case A.SessionStorage:if(s.SessionStorage.isSupported())return r.adapter=new s.SessionStorage(t),!1;break;case A.WebSQL:if(l.WebSQL.isSupported())return r.adapter=new l.WebSQL(t),!1;break;case A.Memory:if(f.Memory.isSupported())return r.adapter=new f.Memory(t),!1;break;default:u.Log.warn("The "+e+" adapter is is not recognized.")}return!0})}return a(e,[{key:"generateObjectId",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?24:arguments[0],t="abcdef0123456789",r="",n=0,o=t.length;n<e;n++){var i=Math.floor(Math.random()*o);r+=t.substring(i,i+1)}return r}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=o(y["default"].mark(function r(e){var t;return y["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.adapter.find(e);case 3:if(t=r.sent){r.next=6;break}return r.abrupt("return",[]);case 6:return r.abrupt("return",t);case 9:if(r.prev=9,r.t0=r["catch"](0),!(r.t0 instanceof u.NotFoundError)){r.next=13;break}return r.abrupt("return",[]);case 13:throw r.t0;case 14:case"end":return r.stop()}},r,this,[[0,9]])}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(y["default"].mark(function r(e,t){return y["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((0,O["default"])(t)){r.next=2;break}throw new u.KinveyError("id must be a string",t);case 2:return r.abrupt("return",this.adapter.findById(e,t));case 3:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return T.add(o(y["default"].mark(function n(){var o;return y["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=!1,r){n.next=3;break}return n.abrupt("return",null);case 3:return(0,E["default"])(r)||(o=!0,r=[r]),r=(0,b["default"])(r,function(e){var r=e[P],n=e[S]||{};return r||(r=t.generateObjectId(),n.local=!0),e[P]=r,e[S]=n,e}),n.next=7,t.adapter.save(e,r);case 7:if(r=n.sent,!(o&&r.length>0)){n.next=10;break}return n.abrupt("return",r[0]);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n,t)})))}},{key:"remove",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(y["default"].mark(function r(e){var t,n=this,o=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return y["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.Promise.all(o.map(function(t){return n.removeById(e,t[P])}));case 2:return t=r.sent,r.abrupt("return",(0,w["default"])(t,function(e,t){return e.push(t),e},[]));case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(e,t){var r=this;return T.add(function(){if(t){if(!(0,O["default"])(t))throw new u.KinveyError("id must be a string",t);return r.adapter.removeById(e,t)}})}},{key:"clear",value:function(){var e=this;return T.add(function(){return e.adapter.clear()})}}]),e}()}).call(t,r(11))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(132);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(238);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(135);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(204);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=r(166);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=r(288);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=r(165);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=r(289);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var f=r(162);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var p=r(290);Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})});var h=r(221);Object.keys(h).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(133);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(284);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(286);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(134);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=r(237);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=r(285);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=r(287);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})})},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheStore=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function C(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:C(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},l=r(134),f=r(135),p=r(162),h=r(221),d=r(237),v=r(238),y=r(166),m=r(9),b=n(m),g=r(266),w=n(g),_=r(227),x=n(_),k=r(147),O=n(k),j=r(276),E=n(j),P=r(235),S=n(P),T=r(279),A=n(T),R=r(80),I=n(R),q=e.env.KINVEY_ID_ATTRIBUTE||"_id";t.CacheStore=function(e){function t(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n.ttl=r.ttl||void 0,n.syncManager=new d.SyncManager(n.collection,r),n}return u(t,e),s(t,[{key:"find",value:function(e){var r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=y.KinveyObservable.create(function(){var i=o(b["default"].mark(function a(o){var i,u,s,l,d,v,y,m,g;return b["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,i=[],a.prev=2,!e||e instanceof h.Query){a.next=5;break}throw new p.KinveyError("Invalid query. It must be an instance of the Query class.");case 5:return u=new f.CacheRequest({method:f.RequestMethod.GET,url:O["default"].format({protocol:r.client.protocol,host:r.client.host,pathname:r.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),a.next=8,u.execute();case 8:s=a.sent,i=s.data,o.next(i),a.next=15;break;case 13:a.prev=13,a.t0=a["catch"](2);case 15:if(r.syncAutomatically!==!0){a.next=39;break}return a.next=18,r.pendingSyncCount(null,n);case 18:if(l=a.sent,!(l>0)){a.next=25;break}return a.next=22,r.push(null,n);case 22:return a.next=24,r.pendingSyncCount(null,n);case 24:l=a.sent;case 25:if(!(l>0)){a.next=27;break}throw new p.KinveyError("Unable to load data from the network."+(" There are "+l+" entities that need")+" to be synced before data is loaded from the network.");case 27:return a.next=29,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",r).call(r,e,n).toPromise();case 29:return d=a.sent,v=(0,w["default"])(i,d,q),y=Object.keys((0,x["default"])(v,q)),m=(new h.Query).contains(q,y),a.next=35,r.clear(m,n);case 35:return g=new f.CacheRequest({method:f.RequestMethod.PUT,url:O["default"].format({protocol:r.client.protocol,host:r.client.host,pathname:r.pathname,query:n.query}),properties:n.properties,body:d,timeout:n.timeout}),a.next=38,g.execute();case 38:o.next(d);case 39:a.next=44;break;case 41:return a.prev=41,a.t1=a["catch"](0),a.abrupt("return",o.error(a.t1));case 44:return a.abrupt("return",o.complete());case 45:case"end":return a.stop()}},a,r,[[0,41],[2,13]])}));return function(e){return i.apply(this,arguments)}}());return i}},{key:"findById",value:function(e){var r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=y.KinveyObservable.create(function(){var i=o(b["default"].mark(function a(o){var i,u,s,l,h,d;return b["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,e){a.next=5;break}o.next(void 0),a.next=35;break;case 5:return a.prev=5,i=new f.CacheRequest({method:f.RequestMethod.GET,url:O["default"].format({protocol:r.client.protocol,host:r.client.host,pathname:r.pathname+"/"+e,query:n.query}),properties:n.properties,timeout:n.timeout}),a.next=9,i.execute();case 9:u=a.sent,s=u.data,o.next(s),a.next=16;break;case 14:a.prev=14,a.t0=a["catch"](5);case 16:if(r.syncAutomatically!==!0){a.next=35;break}return a.next=19,r.pendingSyncCount(null,n);case 19:if(l=a.sent,!(l>0)){a.next=26;break}return a.next=23,r.push(null,n);case 23:return a.next=25,r.pendingSyncCount(null,n);case 25:l=a.sent;case 26:if(!(l>0)){a.next=28;break}throw new p.KinveyError("Unable to load data from the network."+(" There are "+l+" entities that need")+" to be synced before data is loaded from the network.");case 28:return a.next=30,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",r).call(r,e,n).toPromise();case 30:return h=a.sent,d=new f.CacheRequest({method:f.RequestMethod.PUT,url:O["default"].format({protocol:r.client.protocol,host:r.client.host,pathname:r.pathname,query:n.query}),properties:n.properties,body:h,timeout:n.timeout}),a.next=34,d.execute();case 34:o.next(h);case 35:a.next=40;break;case 37:return a.prev=37,a.t1=a["catch"](0),a.abrupt("return",o.error(a.t1));case 40:return a.abrupt("return",o.complete());case 41:case"end":return a.stop()}},a,r,[[0,37],[5,14]])}));return function(e){return i.apply(this,arguments)}}());return i}},{key:"count",value:function(e){var r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=y.KinveyObservable.create(function(){var i=o(b["default"].mark(function a(o){var i,u,s,l,d;return b["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e||e instanceof h.Query){a.next=3;break}throw new p.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return a.prev=3,i=new f.CacheRequest({method:f.RequestMethod.GET,url:O["default"].format({protocol:r.client.protocol,host:r.client.host,pathname:r.pathname,query:n.query}),properties:n.properties,query:e,timeout:n.timeout}),a.next=7,i.execute();case 7:u=a.sent,s=u.data,o.next(s?s.length:0),a.next=14;break;case 12:a.prev=12,a.t0=a["catch"](3);case 14:if(r.syncAutomatically!==!0){a.next=30;break}return a.next=17,r.pendingSyncCount(null,n);case 17:if(l=a.sent,!(l>0)){a.next=24;break}return a.next=21,r.push(null,n);case 21:return a.next=23,r.pendingSyncCount(null,n);case 23:l=a.sent;case 24:if(!(l>0)){a.next=26;break}throw new p.KinveyError("Unable to load data from the network."+(" There are "+l+" entities that need")+" to be synced before data is loaded from the network.");case 26:return a.next=28,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"count",r).call(r,e,n).toPromise();case 28:d=a.sent,o.next(d);case 30:a.next=35;break;case 32:return a.prev=32,a.t1=a["catch"](0),a.abrupt("return",o.error(a.t1));case 35:return a.abrupt("return",o.complete());case 36:case"end":return a.stop()}},a,r,[[0,32],[3,12]])}));return function(e){return i.apply(this,arguments)}}());return i}},{key:"create",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=y.KinveyObservable.create(function(){var n=o(b["default"].mark(function i(n){var o,a,u,s,c,l,p;return b["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}n.next(null),i.next=25;break;case 5:return o=!1,(0,I["default"])(e)||(o=!0,e=[e]),a=new f.CacheRequest({method:f.RequestMethod.POST,url:O["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,body:e,timeout:r.timeout}),i.next=10,a.execute();case 10:return u=i.sent,e=u.data,i.next=14,t.syncManager.addCreateOperation(e,r);case 14:if(t.syncAutomatically!==!0){i.next=24;break}return s=Object.keys((0,x["default"])(e,q)),c=(new h.Query).contains("entityId",s),i.next=19,t.push(c,r);case 19:l=i.sent,p=(0,S["default"])(l,function(e){return e.entity}),n.next(o?p[0]:p),i.next=25;break;case 24:n.next(o?e[0]:e);case 25:i.next=30;break;case 27:return i.prev=27,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 30:return i.abrupt("return",n.complete());case 31:case"end":return i.stop()}},i,t,[[0,27]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"update",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=y.KinveyObservable.create(function(){var n=o(b["default"].mark(function i(n){var o,a,u,s,c,l,p;return b["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}n.next(null),i.next=25;break;case 5:return o=!1,(0,I["default"])(e)||(o=!0,e=[e]),a=new f.CacheRequest({method:f.RequestMethod.PUT,url:O["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,body:e,timeout:r.timeout}),i.next=10,a.execute();case 10:return u=i.sent,e=u.data,i.next=14,t.syncManager.addUpdateOperation(e,r);case 14:if(t.syncAutomatically!==!0){i.next=24;break}return s=Object.keys((0,x["default"])(e,q)),c=(new h.Query).contains("entityId",s),i.next=19,t.push(c,r);case 19:l=i.sent,p=(0,S["default"])(l,function(e){return e.entity}),n.next(o?p[0]:p),i.next=25;break;case 24:n.next(o?e[0]:e);case 25:i.next=30;break;case 27:return i.prev=27,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 30:return i.abrupt("return",n.complete());case 31:case"end":return i.stop()}},i,t,[[0,27]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"remove",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=y.KinveyObservable.create(function(){var n=o(b["default"].mark(function i(n){var o,a,u,s,c,l,d,y,m,g;return b["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof h.Query){i.next=3;break}throw new p.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return o=new f.CacheRequest({method:f.RequestMethod.GET,url:O["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,query:e,timeout:r.timeout}),i.next=6,o.execute();case 6:return a=i.sent,u=a.data,s=new f.CacheRequest({method:f.RequestMethod.DELETE,url:O["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,body:u,timeout:r.timeout}),i.next=11,s.execute();case 11:if(c=i.sent,u=c.data,!(u&&u.length>0)){i.next=21;break}return l=(0,E["default"])(u,function(e){var t=new v.Metadata(e);return t.isLocal()}),d=(new h.Query).contains("entityId",Object.keys((0,x["default"])(l,q))),i.next=18,t.clearSync(d,r);case 18:return y=(0,A["default"])(u,l,function(e,t){return e[q]===t[q]}),i.next=21,t.syncManager.addDeleteOperation(y,r);case 21:if(t.syncAutomatically!==!0){i.next=26;break}return m=Object.keys((0,x["default"])(u,q)),g=(new h.Query).contains("entityId",m),i.next=26,t.push(g,r);case 26:n.next(u),i.next=32;break;case 29:return i.prev=29,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 32:return i.abrupt("return",n.complete());case 33:case"end":return i.stop()}},i,t,[[0,29]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"removeById",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=y.KinveyObservable.create(function(){var n=o(b["default"].mark(function i(n){var o,a,u,s,c,l;return b["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,o=new f.CacheRequest({method:f.RequestMethod.DELETE,url:O["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:r.query}),properties:r.properties,authType:f.AuthType.Default,timeout:r.timeout}),i.next=4,o.execute();case 4:if(a=i.sent,u=a.data,!u){i.next=17;break}if(s=new v.Metadata(u),!s.isLocal()){i.next=15;break}return c=new h.Query,c.equalTo("entityId",u[q]),i.next=13,t.clearSync(c,r);case 13:i.next=17;break;case 15:return i.next=17,t.syncManager.addDeleteOperation(u,r);case 17:if(t.syncAutomatically!==!0){i.next=21;break}return l=(new h.Query).equalTo("entityId",u[q]),i.next=21,t.push(l,r);case 21:n.next(u),i.next=27;break;case 24:return i.prev=24,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 27:return i.abrupt("return",n.complete());case 28:case"end":return i.stop()}},i,t,[[0,24]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"clear",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=y.KinveyObservable.create(function(){var n=o(b["default"].mark(function i(n){var o,a;return b["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof h.Query){i.next=5;break}throw new p.KinveyError("Invalid query. It must be an instance of the Query class.");case 5:return i.next=7,t.remove(e,r);case 7:if(o=i.sent,e){i.next=13;break}return i.next=11,t.clearSync(null,r);case 11:i.next=17;break;case 13:if(!(o&&o.length>0)){i.next=17;break}return a=(new h.Query).contains("entityId",Object.keys((0,x["default"])(o,q))),i.next=17,t.clearSync(a,r);case 17:n.next(o);case 18:i.next=23;break;case 20:return i.prev=20,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 23:return i.abrupt("return",n.complete());case 24:case"end":return i.stop()}},i,t,[[0,20]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"pendingSyncCount",value:function(e,t){return this.syncManager.count(e,t)}},{key:"syncCount",value:function(e,t){return this.pendingSyncCount(e,t)}},{key:"pendingSyncEntities",value:function(e,t){return this.syncManager.find(e,t)}},{key:"push",value:function(e,t){return this.syncManager.push(e,t)}},{key:"pull",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(b["default"].mark(function r(e){var t,n,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return b["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.syncManager.pull(e,o);case 2:return t=r.sent,r.next=5,this.clear(e,o);case 5:return n=new f.CacheRequest({method:f.RequestMethod.PUT,url:O["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname,query:o.query}),properties:o.properties,body:t,timeout:o.timeout}),r.next=8,n.execute();case 8:return r.abrupt("return",t);case 9:case"end":return r.stop()}},r,this)}));return e}()},{key:"sync",value:function(e,t){return this.syncManager.sync(e,t)}},{key:"clearSync",value:function(e,t){return this.syncManager.clear(e,t)}},{key:"purge",value:function(e,t){return this.clearSync(e,t)}},{key:"syncAutomatically",get:function(){return!0}}]),t}(l.NetworkStore)}).call(t,r(11))},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new f.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):f.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkStore=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(135),s=r(162),c=r(221),l=r(165),f=r(210),p=r(166),h=r(9),d=n(h),v=r(158),y=n(v),m=r(147),b=n(m),g=r(235),w=n(g),_=r(80),x=n(_),k=e.env.KINVEY_ID_ATTRIBUTE||"_id",O=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata";t.NetworkStore=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(i(this,e),t&&!(0,y["default"])(t))throw new s.KinveyError("Collection must be a string.");this.collection=t,this.client=r.client||l.Client.sharedInstance(),this.useDeltaFetch=r.useDeltaFetch===!0}return a(e,[{key:"find",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.useDeltaFetch||this.useDeltaFetch,i=p.KinveyObservable.create(function(){var i=o(d["default"].mark(function a(o){var i,l,f;return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e||e instanceof c.Query){a.next=3;break}throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return i={method:u.RequestMethod.GET,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,query:e,timeout:r.timeout,client:t.client},l=new u.KinveyRequest(i),n===!0&&(l=new u.DeltaFetchRequest(i)),a.next=8,l.execute();case 8:f=a.sent,o.next(f.data),a.next=15;break;case 12:return a.prev=12,a.t0=a["catch"](0),a.abrupt("return",o.error(a.t0));case 15:return a.abrupt("return",o.complete());case 16:case"end":return a.stop()}},a,t,[[0,12]])}));return function(e){
return i.apply(this,arguments)}}());return i}},{key:"findById",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.useDeltaFetch||this.useDeltaFetch,i=p.KinveyObservable.create(function(){var i=o(d["default"].mark(function a(o){var i,s,c,l;return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,e){a.next=5;break}o.next(void 0),a.next=13;break;case 5:return i={method:u.RequestMethod.GET,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:r.query}),properties:r.properties,timeout:r.timeout,client:t.client},s=new u.KinveyRequest(i),n===!0&&(s=new u.DeltaFetchRequest(i)),a.next=10,s.execute();case 10:c=a.sent,l=c.data,o.next(l);case 13:a.next=18;break;case 15:return a.prev=15,a.t0=a["catch"](0),a.abrupt("return",o.error(a.t0));case 18:return a.abrupt("return",o.complete());case 19:case"end":return a.stop()}},a,t,[[0,15]])}));return function(e){return i.apply(this,arguments)}}());return i}},{key:"count",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=p.KinveyObservable.create(function(){var n=o(d["default"].mark(function i(n){var o,a,l;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof c.Query){i.next=3;break}throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return o=new u.KinveyRequest({method:u.RequestMethod.GET,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/_count",query:r.query}),properties:r.properties,query:e,timeout:r.timeout,client:t.client}),i.next=6,o.execute();case 6:a=i.sent,l=a.data,n.next(l?l.count:0),i.next=14;break;case 11:return i.prev=11,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 14:return i.abrupt("return",n.complete());case 15:case"end":return i.stop()}},i,t,[[0,11]])}));return function(e){return n.apply(this,arguments)}}());return n}},{key:"create",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=p.KinveyObservable.create(function(){var n=o(d["default"].mark(function i(n){var o,a;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}n.next(null),i.next=12;break;case 5:return o=!1,(0,x["default"])(e)||(o=!0,e=[e]),i.next=9,f.Promise.all((0,w["default"])(e,function(e){var n=new u.KinveyRequest({method:u.RequestMethod.POST,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,data:e,timeout:r.timeout,client:t.client});return n.execute()}));case 9:a=i.sent,e=(0,w["default"])(a,function(e){return e.data}),n.next(o?e[0]:e);case 12:i.next=17;break;case 14:return i.prev=14,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 17:return i.abrupt("return",n.complete());case 18:case"end":return i.stop()}},i,t,[[0,14]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"update",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=p.KinveyObservable.create(function(){var n=o(d["default"].mark(function i(n){var o,a;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}n.next(null),i.next=12;break;case 5:return o=!1,(0,x["default"])(e)||(o=!0,e=[e]),i.next=9,f.Promise.all((0,w["default"])(e,function(e){var n=new u.KinveyRequest({method:u.RequestMethod.PUT,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e[k],query:r.query}),properties:r.properties,data:e,timeout:r.timeout,client:t.client});return n.execute()}));case 9:a=i.sent,e=(0,w["default"])(a,function(e){return e.data}),n.next(o?e[0]:e);case 12:i.next=17;break;case 14:return i.prev=14,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 17:return i.abrupt("return",n.complete());case 18:case"end":return i.stop()}},i,t,[[0,14]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"save",value:function(e,t){return e[k]?this.update(e,t):this.create(e,t)}},{key:"remove",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=p.KinveyObservable.create(function(){var n=o(d["default"].mark(function i(n){var o,a;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof c.Query){i.next=3;break}throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return o=new u.KinveyRequest({method:u.RequestMethod.DELETE,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,query:e,timeout:r.timeout,client:t.client}),i.next=6,o.execute();case 6:a=i.sent,n.next(a.data),i.next=13;break;case 10:return i.prev=10,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 13:return i.abrupt("return",n.complete());case 14:case"end":return i.stop()}},i,t,[[0,10]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"removeById",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=p.KinveyObservable.create(function(){var n=o(d["default"].mark(function i(n){var o,a;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,e){i.next=5;break}n.next(void 0),i.next=10;break;case 5:return o=new u.KinveyRequest({method:u.RequestMethod.DELETE,authType:u.AuthType.Default,url:b["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:r.query}),properties:r.properties,timeout:r.timeout}),i.next=8,o.execute();case 8:a=i.sent,n.next(a.data);case 10:i.next=15;break;case 12:return i.prev=12,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 15:return i.abrupt("return",n.complete());case 16:case"end":return i.stop()}},i,t,[[0,12]])}));return function(e){return n.apply(this,arguments)}}());return n.toPromise()}},{key:"subscribe",value:function(e,t,r){return this.liveStream.subscribe(e,t,r)}},{key:"pathname",get:function(){var e="/"+O+"/"+this.client.appKey;return this.collection&&(e=e+"/"+this.collection),e}},{key:"liveStream",get:function(){var e=this;if("undefined"==typeof EventSource)throw new s.KinveyError("Your environment does not support server-sent events.");return this._liveStream||!function(){var t=new EventSource(b["default"].format({protocol:e.client.liveServiceProtocol,host:e.client.liveServiceHost,pathname:e.pathname}));e._liveStream=p.KinveyObservable.create(function(){var r=o(d["default"].mark(function n(r){return d["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.onopen=function(e){p.Log.info("Subscription to Kinvey Live Service is now open at "+t.url+"."),p.Log.info(e)},t.onmessage=function(e){try{r.next(JSON.parse(e.data))}catch(t){r.error(t)}},t.onerror=function(e){r.error(e)},e.abrupt("return",function(){r.complete()});case 4:case"end":return e.stop()}},n,e)}));return function(e){return r.apply(this,arguments)}}())["finally"](function(){t.close(),delete e._liveStream})}(),this._liveStream}}]),e}()}).call(t,r(11))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(136);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(196);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(197);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(203);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=r(202);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=r(137);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=r(164);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})})},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheRequest=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function O(e,t,r,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&O(i,t,r,n)}else if("value"in o&&o.writable)o.value=r;else{var a=o.set;void 0!==a&&a.call(n,r)}return r},l=function j(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:j(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},f=r(137),p=r(162),h=r(164),d=r(165),v=r(6),y=r(194),m=n(y),b=r(147),g=n(b),w=r(149),_=n(w),x=r(9),k=n(x);t.CacheRequest=function(t){function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,r);var t=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return e=(0,_["default"])({query:null,client:d.Client.sharedInstance()},e),t.query=e.query,t.client=e.client,t.rack=r.rack,t}return u(r,t),s(r,[{key:"execute",value:function(){function e(){return t.apply(this,arguments)}var t=o(k["default"].mark(function r(){var e;return k["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.rack){t.next=2;break}throw new p.KinveyError("Unable to execute the request. Please provide a rack to execute the request.");case 2:return t.next=4,this.rack.execute(this);case 4:if(e=t.sent,this.executing=!1,e){t.next=8;break}throw new p.NoResponseError;case 8:if(e instanceof h.Response||(e=new h.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})),e.isSuccess()){t.next=11;break}throw e.error;case 11:return this.query&&(e.data=this.query.process(e.data)),t.abrupt("return",e);case 13:case"end":return t.stop()}},r,this)}));return e}()},{key:"cancel",value:function(){function e(){return t.apply(this,arguments)}var t=o(k["default"].mark(function n(){return k["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"cancel",this).call(this);case 2:return e.abrupt("return",this.rack.cancel());case 3:case"end":return e.stop()}},n,this)}));return e}()},{key:"toPlainObject",value:function(){var e=l(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toPlainObject",this).call(this);return e.appKey=this.appKey,e.collection=this.collection,e.entityId=this.entityId,e.encryptionKey=this.client?this.client.encryptionKey:void 0,e}},{key:"url",get:function(){return l(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",this)},set:function(t){c(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",t,this);var n=e.escape(g["default"].parse(t).pathname),o=new m["default"]("(/:namespace)(/)(:appKey)(/)(:collection)(/)(:entityId)(/)"),i=o.match(n)||{},a=i.appKey,u=i.collection,s=i.entityId;this.appKey=a,this.collection=u,this.entityId=s}},{key:"client",get:function(){return this._client},set:function(e){if(e&&!(e instanceof d.Client))throw new p.KinveyError("client must be an instance of the Client class.");this._client=e}}],[{key:"rack",get:function(){return r._rack},set:function(e){if(!(e&&e instanceof v.Rack))throw new p.KinveyError("Unable to set the rack of a CacheRequest. It must be an instance of a Rack");r._rack=e}}]),r}(f.Request)}).call(t,function(){return this}())},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.Headers=t.RequestMethod=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(9),s=n(u),c=r(138),l=n(c),f=r(142),p=n(f),h=r(149),d=n(h),v=r(156),y=n(v),m=r(158),b=n(m),g=r(159),w=n(g),_=r(160),x=n(_),k=e.env.KINVEY_DEFAULT_TIMEOUT||30,O={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(O),t.RequestMethod=O;var j=t.Headers=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this.headers={},this.addAll(t)}return a(e,[{key:"get",value:function(e){if(e){(0,b["default"])(e)||(e=String(e));var t=this.headers;return t[e.toLowerCase()]}}},{key:"set",value:function(e,t){if(void 0===e||null===e||void 0===t||null===t)throw new Error("A name and value must be provided to set a header.");(0,b["default"])(e)||(e=String(e));var r=this.headers;return e=e.toLowerCase(),(0,b["default"])(t)?r[e]=t:r[e]=JSON.stringify(t),this.headers=r,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.set(e.name,e.value)}},{key:"addAll",value:function(){var t=this,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(r instanceof e&&(r=r.toPlainObject()),!(0,x["default"])(r))throw new Error("Headers argument must be an object.");var n=Object.keys(r);return(0,y["default"])(n,function(e){var n=r[e];t.set(e,n)}),this}},{key:"remove",value:function(e){if(e){(0,b["default"])(e)||(e=String(e));var t=this.headers;delete t[e.toLowerCase()],this.headers=t}return this}},{key:"clear",value:function(){return this.headers={},this}},{key:"toPlainObject",value:function(){return this.headers}},{key:"toString",value:function(){return JSON.stringify(this.toPlainObject())}}]),e}();t.Request=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),t=(0,d["default"])({method:O.GET,headers:new j,url:"",body:null,timeout:k,followRedirect:!0,cache:!1},t),this.method=t.method,this.headers=t.headers,this.url=t.url,this.body=t.body||t.data,this.timeout=t.timeout,this.followRedirect=t.followRedirect,this.cache=t.cache,this.executing=!1}return a(e,[{key:"isExecuting",value:function(){return!!this.executing}},{key:"execute",value:function(){function e(){return t.apply(this,arguments)}var t=o(s["default"].mark(function r(){return s["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},r,this)}));return e}()},{key:"toPlainObject",value:function(){return{method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect}}},{key:"method",get:function(){return this._method},set:function(e){switch((0,b["default"])(e)||(e=String(e)),e=e.toUpperCase()){case O.GET:case O.POST:case O.PATCH:case O.PUT:case O.DELETE:this._method=e;break;default:throw new Error("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof j||(e=new j(e)),this._headers=e}},{key:"url",get:function(){return this.cache===!0?(0,p["default"])(this._url,l["default"].stringify({_:Math.random().toString(36).substr(2)})):this._url},set:function(e){this._url=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}},{key:"timeout",get:function(){return this._timeout},set:function(e){this._timeout=(0,w["default"])(e)?e:k}},{key:"followRedirect",get:function(){return this._followRedirect},set:function(e){this._followRedirect=!!e}},{key:"cache",get:function(){return this._cache},set:function(e){this._cache=!!e}}]),e}()}).call(t,r(11))},function(e,t,r){"use strict";var n=r(139),o=r(141);e.exports={stringify:n,parse:o}},function(e,t,r){"use strict";var n=r(140),o={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},i={delimiter:"&",strictNullHandling:!1,skipNulls:!1,encode:!0,encoder:n.encode},a=function u(e,t,r,o,i,a,s,c,l){var f=e;if("function"==typeof s)f=s(t,f);else if(f instanceof Date)f=f.toISOString();else if(null===f){if(o)return a?a(t):t;f=""}if("string"==typeof f||"number"==typeof f||"boolean"==typeof f||n.isBuffer(f))return a?[a(t)+"="+a(f)]:[t+"="+String(f)];var p=[];if("undefined"==typeof f)return p;var h;if(Array.isArray(s))h=s;else{var d=Object.keys(f);h=c?d.sort(c):d}for(var v=0;v<h.length;++v){var y=h[v];i&&null===f[y]||(p=Array.isArray(f)?p.concat(u(f[y],r(t,y),r,o,i,a,s,c,l)):p.concat(u(f[y],t+(l?"."+y:"["+y+"]"),r,o,i,a,s,c,l)))}return p};e.exports=function(e,t){var r,n,u=e,s=t||{},c="undefined"==typeof s.delimiter?i.delimiter:s.delimiter,l="boolean"==typeof s.strictNullHandling?s.strictNullHandling:i.strictNullHandling,f="boolean"==typeof s.skipNulls?s.skipNulls:i.skipNulls,p="boolean"==typeof s.encode?s.encode:i.encode,h=p?"function"==typeof s.encoder?s.encoder:i.encoder:null,d="function"==typeof s.sort?s.sort:null,v="undefined"!=typeof s.allowDots&&s.allowDots;if(null!==s.encoder&&void 0!==s.encoder&&"function"!=typeof s.encoder)throw new TypeError("Encoder has to be a function.");"function"==typeof s.filter?(n=s.filter,u=n("",u)):Array.isArray(s.filter)&&(r=n=s.filter);var y=[];if("object"!=typeof u||null===u)return"";var m;m=s.arrayFormat in o?s.arrayFormat:"indices"in s?s.indices?"indices":"repeat":"indices";var b=o[m];r||(r=Object.keys(u)),d&&r.sort(d);for(var g=0;g<r.length;++g){var w=r[g];f&&null===u[w]||(y=y.concat(a(u[w],w,b,l,f,h,n,d,v)))}return y.join(c)}},function(e,t){"use strict";var r=function(){for(var e=new Array(256),t=0;t<256;++t)e[t]="%"+((t<16?"0":"")+t.toString(16)).toUpperCase();return e}();t.arrayToObject=function(e,t){for(var r=t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!=typeof e[n]&&(r[n]=e[n]);return r},t.merge=function(e,r,n){if(!r)return e;if("object"!=typeof r){if(Array.isArray(e))e.push(r);else{if("object"!=typeof e)return[e,r];e[r]=!0}return e}if("object"!=typeof e)return[e].concat(r);var o=e;return Array.isArray(e)&&!Array.isArray(r)&&(o=t.arrayToObject(e,n)),Object.keys(r).reduce(function(e,o){var i=r[o];return Object.prototype.hasOwnProperty.call(e,o)?e[o]=t.merge(e[o],i,n):e[o]=i,e},o)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",o=0;o<t.length;++o){var i=t.charCodeAt(o);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(o):i<128?n+=r[i]:i<2048?n+=r[192|i>>6]+r[128|63&i]:i<55296||i>=57344?n+=r[224|i>>12]+r[128|i>>6&63]+r[128|63&i]:(o+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(o)),n+=r[240|i>>18]+r[128|i>>12&63]+r[128|i>>6&63]+r[128|63&i])}return n},t.compact=function(e,r){if("object"!=typeof e||null===e)return e;var n=r||[],o=n.indexOf(e);if(o!==-1)return n[o];if(n.push(e),Array.isArray(e)){for(var i=[],a=0;a<e.length;++a)e[a]&&"object"==typeof e[a]?i.push(t.compact(e[a],n)):"undefined"!=typeof e[a]&&i.push(e[a]);return i}for(var u=Object.keys(e),s=0;s<u.length;++s){var c=u[s];e[c]=t.compact(e[c],n)}return e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&"undefined"!=typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,r){"use strict";var n=r(140),o=Object.prototype.hasOwnProperty,i={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3,strictNullHandling:!1,plainObjects:!1,allowPrototypes:!1,allowDots:!1,decoder:n.decode},a=function(e,t){for(var r={},n=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),i=0;i<n.length;++i){var a,u,s=n[i],c=s.indexOf("]=")===-1?s.indexOf("="):s.indexOf("]=")+1;c===-1?(a=t.decoder(s),u=t.strictNullHandling?null:""):(a=t.decoder(s.slice(0,c)),u=t.decoder(s.slice(c+1))),o.call(r,a)?r[a]=[].concat(r[a]).concat(u):r[a]=u}return r},u=function c(e,t,r){if(!e.length)return t;var n,o=e.shift();if("[]"===o)n=[],n=n.concat(c(e,t,r));else{n=r.plainObjects?Object.create(null):{};var i="["===o[0]&&"]"===o[o.length-1]?o.slice(1,o.length-1):o,a=parseInt(i,10);!isNaN(a)&&o!==i&&String(a)===i&&a>=0&&r.parseArrays&&a<=r.arrayLimit?(n=[],n[a]=c(e,t,r)):n[i]=c(e,t,r)}return n},s=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^\.\[]+)/g,"[$1]"):e,i=/^([^\[\]]*)/,a=/(\[[^\[\]]*\])/g,s=i.exec(n),c=[];if(s[1]){if(!r.plainObjects&&o.call(Object.prototype,s[1])&&!r.allowPrototypes)return;c.push(s[1])}for(var l=0;null!==(s=a.exec(n))&&l<r.depth;)l+=1,(r.plainObjects||!o.call(Object.prototype,s[1].replace(/\[|\]/g,""))||r.allowPrototypes)&&c.push(s[1]);return s&&c.push("["+n.slice(s.index)+"]"),u(c,t,r)}};e.exports=function(e,t){var r=t||{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.delimiter="string"==typeof r.delimiter||n.isRegExp(r.delimiter)?r.delimiter:i.delimiter,r.depth="number"==typeof r.depth?r.depth:i.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:i.arrayLimit,r.parseArrays=r.parseArrays!==!1,r.decoder="function"==typeof r.decoder?r.decoder:i.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:i.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:i.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:i.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:i.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:i.strictNullHandling,""===e||null===e||"undefined"==typeof e)return r.plainObjects?Object.create(null):{};for(var o="string"==typeof e?a(e,r):e,u=r.plainObjects?Object.create(null):{},c=Object.keys(o),l=0;l<c.length;++l){var f=c[l],p=s(f,o[f],r);u=n.merge(u,p,r)}return n.compact(u)}},function(e,t,r){function n(e,t){var r=[],o=!1;return Array.isArray(e)&&t&&(o=!0),Object.keys(e).forEach(function(i){var a,u,s=e[i];a=t?t+"["+(o?"":i)+"]":i,u="object"==typeof s?n(s,a):encodeURIComponent(a)+"="+encodeURIComponent(s),r.push(u)}),r.join("&")}var o=r(143),i=r(146),a=r(147);e.exports=function(e,t){var r=a.parse(e,!0),u=i(!0,{},r.query,"string"==typeof t?o.parse(t):t);return r.search="?"+n(u),a.format(r)}},function(e,t,r){"use strict";t.decode=t.parse=r(144),t.encode=t.stringify=r(145)},function(e,t){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var a=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var c=0;c<s;++c){var l,f,p,h,d=e[c].replace(a,"%20"),v=d.indexOf(n);v>=0?(l=d.substr(0,v),f=d.substr(v+1)):(l=d,f=""),p=decodeURIComponent(l),h=decodeURIComponent(f),r(i,p)?Array.isArray(i[p])?i[p].push(h):i[p]=[i[p],h]:i[p]=h}return i}},function(e,t){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,o){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(o){var i=encodeURIComponent(r(o))+n;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(r(e))}).join(t):i+encodeURIComponent(r(e[o]))}).join(t):o?encodeURIComponent(r(o))+n+encodeURIComponent(r(e)):""}},function(e,t){var r,n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=function(e){"use strict";if(!e||"[object Object]"!==o.call(e)||e.nodeType||e.setInterval)return!1;var t=n.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;var a;for(a in e);return a===r||n.call(e,a)};e.exports=function a(){"use strict";var e,t,n,o,u,s,c=arguments[0],l=1,f=arguments.length,p=!1;for("boolean"==typeof c?(p=c,c=arguments[1]||{},l=2):("object"!=typeof c&&"function"!=typeof c||c==r)&&(c={});l<f;++l)if(null!=(e=arguments[l]))for(t in e)n=c[t],o=e[t],c!==o&&(p&&o&&(i(o)||(u=Array.isArray(o)))?(u?(u=!1,s=n&&Array.isArray(n)?n:[]):s=n&&i(n)?n:{},c[t]=a(p,s,o)):o!==r&&(c[t]=o));return c}},function(e,t,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,r){if(e&&c(e)&&e instanceof n)return e;var o=new n;return o.parse(e,t,r),o}function i(e){return s(e)&&(e=o(e)),e instanceof n?e.format():n.prototype.format.call(e)}function a(e,t){return o(e,!1,!0).resolve(t)}function u(e,t){return e?o(e,!1,!0).resolveObject(t):t}function s(e){return"string"==typeof e}function c(e){return"object"==typeof e&&null!==e}function l(e){return null===e}function f(e){return null==e}var p=r(148);t.parse=o,t.resolve=a,t.resolveObject=u,t.format=i,t.Url=n;var h=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,v=["<",">",'"',"`"," ","\r","\n","\t"],y=["{","}","|","\\","^","`"].concat(v),m=["'"].concat(y),b=["%","/","?",";","#"].concat(m),g=["/","?","#"],w=255,_=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,k={javascript:!0,"javascript:":!0},O={javascript:!0,"javascript:":!0},j={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=r(143);n.prototype.parse=function(e,t,r){if(!s(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e;n=n.trim();var o=h.exec(n);if(o){o=o[0];var i=o.toLowerCase();this.protocol=i,n=n.substr(o.length)}if(r||o||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===n.substr(0,2);!a||o&&O[o]||(n=n.substr(2),this.slashes=!0)}if(!O[o]&&(a||o&&!j[o])){for(var u=-1,c=0;c<g.length;c++){var l=n.indexOf(g[c]);l!==-1&&(u===-1||l<u)&&(u=l)}var f,d;d=u===-1?n.lastIndexOf("@"):n.lastIndexOf("@",u),d!==-1&&(f=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(f)),u=-1;for(var c=0;c<b.length;c++){var l=n.indexOf(b[c]);l!==-1&&(u===-1||l<u)&&(u=l)}u===-1&&(u=n.length),this.host=n.slice(0,u),n=n.slice(u),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var y=this.hostname.split(/\./),c=0,P=y.length;c<P;c++){var S=y[c];if(S&&!S.match(_)){for(var T="",A=0,R=S.length;A<R;A++)T+=S.charCodeAt(A)>127?"x":S[A];if(!T.match(_)){var I=y.slice(0,c),q=y.slice(c+1),C=S.match(x);C&&(I.push(C[1]),q.unshift(C[2])),q.length&&(n="/"+q.join(".")+n),this.hostname=I.join(".");break}}}if(this.hostname.length>w?this.hostname="":this.hostname=this.hostname.toLowerCase(),!v){for(var M=this.hostname.split("."),N=[],c=0;c<M.length;++c){var L=M[c];N.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+p.encode(L):L)}this.hostname=N.join(".")}var K=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+K,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!k[i])for(var c=0,P=m.length;c<P;c++){var D=m[c],B=encodeURIComponent(D);B===D&&(B=escape(D)),n=n.split(D).join(B)}var F=n.indexOf("#");F!==-1&&(this.hash=n.substr(F),n=n.slice(0,F));var $=n.indexOf("?");if($!==-1?(this.search=n.substr($),this.query=n.substr($+1),t&&(this.query=E.parse(this.query)),n=n.slice(0,$)):t&&(this.search="",this.query={}),n&&(this.pathname=n),j[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var K=this.pathname||"",L=this.search||"";this.path=K+L}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(i=E.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||j[t])&&o!==!1?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+o+r+a+n},n.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(s(e)){var t=new n;t.parse(e,!1,!0),e=t}var r=new n;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(r[t]=e[t])}),j[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!j[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||O[e.protocol])r.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var i=r.pathname||"",a=r.search||"";r.path=i+a}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var u=r.pathname&&"/"===r.pathname.charAt(0),c=e.host||e.pathname&&"/"===e.pathname.charAt(0),p=c||u||r.host&&e.pathname,h=p,d=r.pathname&&r.pathname.split("/")||[],o=e.pathname&&e.pathname.split("/")||[],v=r.protocol&&!j[r.protocol];if(v&&(r.hostname="",r.port=null,r.host&&(""===d[0]?d[0]=r.host:d.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),p=p&&(""===o[0]||""===d[0])),c)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=o;else if(o.length)d||(d=[]),d.pop(),d=d.concat(o),r.search=e.search,r.query=e.query;else if(!f(e.search)){if(v){r.hostname=r.host=d.shift();var y=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");y&&(r.auth=y.shift(),r.host=r.hostname=y.shift())}return r.search=e.search,r.query=e.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),
r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var m=d.slice(-1)[0],b=(r.host||e.host)&&("."===m||".."===m)||""===m,g=0,w=d.length;w>=0;w--)m=d[w],"."==m?d.splice(w,1):".."===m?(d.splice(w,1),g++):g&&(d.splice(w,1),g--);if(!p&&!h)for(;g--;g)d.unshift("..");!p||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),b&&"/"!==d.join("/").substr(-1)&&d.push("");var _=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(v){r.hostname=r.host=_?"":d.length?d.shift():"";var y=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");y&&(r.auth=y.shift(),r.host=r.hostname=y.shift())}return p=p||r.host&&d.length,p&&!_&&d.unshift(""),d.length?r.pathname=d.join("/"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){var n;(function(e,o){!function(i){function a(e){throw RangeError(I[e])}function u(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(R,".");var o=e.split("."),i=u(o,t).join(".");return n+i}function c(e){for(var t,r,n=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(r=e.charCodeAt(o++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--)):n.push(t);return n}function l(e){return u(e,function(e){var t="";return e>65535&&(e-=65536,t+=M(e>>>10&1023|55296),e=56320|1023&e),t+=M(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:_}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,r){var n=0;for(e=r?C(e/j):e>>1,e+=C(e/t);e>q*k>>1;n+=_)e=C(e/q);return C(n+(q+1)*e/(e+O))}function d(e){var t,r,n,o,i,u,s,c,p,d,v=[],y=e.length,m=0,b=P,g=E;for(r=e.lastIndexOf(S),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&a("not-basic"),v.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<y;){for(i=m,u=1,s=_;o>=y&&a("invalid-input"),c=f(e.charCodeAt(o++)),(c>=_||c>C((w-m)/u))&&a("overflow"),m+=c*u,p=s<=g?x:s>=g+k?k:s-g,!(c<p);s+=_)d=_-p,u>C(w/d)&&a("overflow"),u*=d;t=v.length+1,g=h(m-i,t,0==i),C(m/t)>w-b&&a("overflow"),b+=C(m/t),m%=t,v.splice(m++,0,b)}return l(v)}function v(e){var t,r,n,o,i,u,s,l,f,d,v,y,m,b,g,O=[];for(e=c(e),y=e.length,t=P,r=0,i=E,u=0;u<y;++u)v=e[u],v<128&&O.push(M(v));for(n=o=O.length,o&&O.push(S);n<y;){for(s=w,u=0;u<y;++u)v=e[u],v>=t&&v<s&&(s=v);for(m=n+1,s-t>C((w-r)/m)&&a("overflow"),r+=(s-t)*m,t=s,u=0;u<y;++u)if(v=e[u],v<t&&++r>w&&a("overflow"),v==t){for(l=r,f=_;d=f<=i?x:f>=i+k?k:f-i,!(l<d);f+=_)g=l-d,b=_-d,O.push(M(p(d+g%b,0))),l=C(g/b);O.push(M(p(l,0))),i=h(r,m,n==o),r=0,++n}++r,++t}return O.join("")}function y(e){return s(e,function(e){return T.test(e)?d(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return A.test(e)?"xn--"+v(e):e})}var b=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof o&&o);b.global!==b&&b.window!==b&&b.self!==b||(i=b);var g,w=2147483647,_=36,x=1,k=26,O=38,j=700,E=72,P=128,S="-",T=/^xn--/,A=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},q=_-x,C=Math.floor,M=String.fromCharCode;g={version:"1.3.2",ucs2:{decode:c,encode:l},decode:d,encode:v,toASCII:m,toUnicode:y},n=function(){return g}.call(t,r,t,e),!(void 0!==n&&(e.exports=n))}(this)}).call(t,r(96)(e),function(){return this}())},function(e,t,r){var n=r(150),o=r(151),i=r(152),a=r(77),u=r(83),s=r(72),c=Object.prototype,l=c.hasOwnProperty,f=c.propertyIsEnumerable,p=!f.call({valueOf:1},"valueOf"),h=i(function(e,t){if(p||u(t)||a(t))return void o(t,s(t),e);for(var r in t)l.call(t,r)&&n(e,r,t[r])});e.exports=h},function(e,t,r){function n(e,t,r){var n=e[t];a.call(e,t)&&o(n,r)&&(void 0!==r||t in e)||(e[t]=r)}var o=r(23),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t,r,n){r||(r={});for(var i=-1,a=t.length;++i<a;){var u=t[i],s=n?n(r[u],e[u],u,r,e):void 0;o(r,u,void 0===s?e[u]:s)}return r}var o=r(150);e.exports=n},function(e,t,r){function n(e){return o(function(t,r){var n=-1,o=r.length,a=o>1?r[o-1]:void 0,u=o>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,u&&i(r[0],r[1],u)&&(a=o<3?void 0:a,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,a)}return t})}var o=r(153),i=r(155);e.exports=n},function(e,t,r){function n(e,t){return t=i(void 0===t?e.length-1:t,0),function(){for(var r=arguments,n=-1,a=i(r.length-t,0),u=Array(a);++n<a;)u[n]=r[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=r[n];return s[t]=u,o(e,this,s)}}var o=r(154),i=Math.max;e.exports=n},function(e,t){function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}e.exports=r},function(e,t,r){function n(e,t,r){if(!u(r))return!1;var n=typeof t;return!!("number"==n?i(r)&&a(t,r.length):"string"==n&&t in r)&&o(r[t],e)}var o=r(23),i=r(77),a=r(81),u=r(36);e.exports=n},function(e,t,r){function n(e,t){var r=u(e)?o:i;return r(e,a(t,3))}var o=r(157),i=r(123),a=r(15),u=r(80);e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}e.exports=r},function(e,t,r){function n(e){return"string"==typeof e||!o(e)&&i(e)&&s.call(e)==a}var o=r(80),i=r(79),a="[object String]",u=Object.prototype,s=u.toString;e.exports=n},function(e,t,r){function n(e){return"number"==typeof e||o(e)&&u.call(e)==i}var o=r(79),i="[object Number]",a=Object.prototype,u=a.toString;e.exports=n},function(e,t,r){function n(e){if(!a(e)||h.call(e)!=u||i(e))return!1;var t=o(e);if(null===t)return!0;var r=f.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==p}var o=r(161),i=r(37),a=r(79),u="[object Object]",s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,p=l.call(Object),h=c.toString;e.exports=n},function(e,t,r){var n=r(85),o=n(Object.getPrototypeOf,Object);e.exports=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncError=t.ServerError=t.QueryError=t.ParameterValueOutOfRangeError=t.NoResponseError=t.NotFoundError=t.NoActiveUserError=t.NoNetworkConnectionError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.ActiveUserError=t.KinveyError=void 0;var u=r(163),s=n(u),c=t.KinveyError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error has occurred.":arguments[0],r=arguments.length<=1||void 0===arguments[1]?"":arguments[1],n=arguments.length<=2||void 0===arguments[2]?-1:arguments[2];o(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.debug=r,a.code=n,a}return a(t,e),t}(s["default"]);t.ActiveUserError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An active user already exists.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.FeatureUnavailableError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Requested functionality is unavailable in this API version.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.IncompleteRequestBodyError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?" The request body is either missing or incomplete.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.InsufficientCredentialsError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.InvalidCredentialsError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?" Invalid credentials. Please retry your request with correct credentials.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.InvalidIdentifierError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"One of more identifier names in the request has an invalid format.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.InvalidQuerySyntaxError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The query string in the request has an invalid syntax.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.JSONParseError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Unable to parse the JSON in the request.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.MissingQueryError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The request is missing a query string.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.MissingRequestHeaderError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The request is missing a required header.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.MissingRequestParameterError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"A required parameter is missing from the request.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.NoNetworkConnectionError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"You do not have a network connect.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.NoActiveUserError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"There is not an active user.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.NotFoundError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The item was not found.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.NoResponseError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"No response was provided.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.ParameterValueOutOfRangeError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"The value specified for one of the request parameters is out of range.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.QueryError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error occurred on the query.":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.ServerError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error occurred on the server":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c),t.SyncError=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"An error occurred during sync":arguments[0],r=arguments[1];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return a(t,e),t}(c)},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];r(this,t);var o=n(this,Object.getPrototypeOf(t).call(this,e));return Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"name",{configurable:!0,enumerable:!1,value:o.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(o,o.constructor),n(o)):(Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),o)}return o(t,e),t}(i(Error));t["default"]=a,e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Response=t.StatusCode=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(137),u=r(162),s=r(149),c=n(s),l={Ok:200,Created:201,Empty:204,RedirectTemporarily:301,RedirectPermanently:302,NotModified:304,ResumeIncomplete:308,NotFound:404,ServerError:500};Object.freeze(l),t.StatusCode=l;t.Response=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e),t=(0,c["default"])({statusCode:l.Empty,headers:new a.Headers,data:null},t),this.statusCode=t.statusCode,this.headers=t.headers,this.data=t.data}return i(e,[{key:"isSuccess",value:function(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===l.RedirectPermanently||this.statusCode===l.NotModified}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof a.Headers||(e=new a.Headers(e)),this._headers=e}},{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},t=e.message||e.description,r=e.debug,n=this.statusCode;return new u.KinveyError(t,r,n)}}]),e}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(162),u=r(166),s=r(147),c=n(s),l=r(149),f=n(l),p=r(158),h=n(p),d=null;t.Client=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),t=(0,f["default"])({apiHostname:"https://baas.kinvey.com",micHostname:"https://auth.kinvey.com",liveServiceHostname:"https://kls.kinvey.com"},t),t.apiHostname&&(0,h["default"])(t.apiHostname)){var r=c["default"].parse(t.apiHostname);t.apiProtocol=r.protocol,t.apiHost=r.host}if(t.micHostname&&(0,h["default"])(t.micHostname)){var n=c["default"].parse(t.micHostname);t.micProtocol=n.protocol,t.micHost=n.host}if(t.liveServiceHostname&&(0,h["default"])(t.liveServiceHostname)){var i=c["default"].parse(t.liveServiceHostname);t.liveServiceProtocol=i.protocol,t.liveServiceHost=i.host}this.apiProtocol=t.apiProtocol,this.apiHost=t.apiHost,this.micProtocol=t.micProtocol,this.micHost=t.micHost,this.liveServiceProtocol=t.liveServiceProtocol,this.liveServiceHost=t.liveServiceHost,this.appKey=t.appKey,this.appSecret=t.appSecret,this.masterSecret=t.masterSecret,this.encryptionKey=t.encryptionKey,this.appVersion=t.appVersion}return i(e,[{key:"toPlainObject",value:function(){return{apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,liveServiceHostname:this.liveServiceHostname,liveServiceHost:this.liveServiceHost,liveServiceProtocol:this.liveServiceProtocol,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion}}},{key:"apiHostname",get:function(){return c["default"].format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"baseUrl",get:function(){return this.apiHostname}},{key:"protocol",get:function(){return this.apiProtocol}},{key:"host",get:function(){return this.apiHost}},{key:"micHostname",get:function(){return c["default"].format({protocol:this.micProtocol,host:this.micHost})}},{key:"liveServiceHostname",get:function(){return c["default"].format({protocol:this.liveServiceProtocol,host:this.liveServiceHost})}},{key:"activeUser",get:function(){return(0,u.getActiveUser)(this)}},{key:"appVersion",get:function(){return this._appVersion},set:function(e){e&&!(0,h["default"])(e)&&(e=String(e)),this._appVersion=e}}],[{key:"init",value:function(t){var r=new e(t);return d=r,r}},{key:"sharedInstance",value:function(){if(!d)throw new a.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return d}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(167);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(169);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(171);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(172);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=r(188);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=r(192);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,r){(function(e,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){e=e.toLowerCase();var t=/(chrome)\/([\w]+)/,r=/(firefox)\/([\w.]+)/,n=/(msie) ([\w.]+)/i,o=/(opera)(?:.*version)?[ \/]([\w.]+)/,i=/(safari)\/([\w.]+)/;return t.exec(e)||r.exec(e)||n.exec(e)||o.exec(e)||i.exec(e)||[]}function u(){var t=void 0,r=void 0,o=void 0,i=void 0,u=void 0,s=[];if(void 0!==e.cordova&&void 0!==e.device){var c=e.device;s.push("phonegap/"+c.cordova),r=c.platform,o=c.version,i=c.model,u=c.uuid}else void 0!==e.Titanium?(s.push("titanium/"+e.Titanium.getVersion()),"mobileweb"===e.Titanium.Platform.getName()?(t=a(e.Titanium.Platform.getModel()),r=t[1],o=t[2],i=e.Titanium.Platform.getOstype()):(r=e.Titanium.Platform.getOsname(),o=e.Titanium.Platform.getVersion(),i=e.Titanium.Platform.getManufacturer()),u=e.Titanium.Platform.getId()):void 0!==e.forge?(s.push("triggerio/"+(e.forge.config.platform_version||"")),u=e.forge.config.uuid):void 0!==n&&(r=n.title,o=n.version,i=n.platform);void 0!==e.angular&&s.push("angularjs/"+e.angular.version.full),void 0!==e.Backbone&&s.push("backbonejs/"+e.Backbone.VERSION),void 0!==e.Ember&&s.push("emberjs/"+e.Ember.VERSION),void 0!==e.jQuery&&s.push("jquery/"+e.jQuery.fn.jquery),void 0!==e.ko&&s.push("knockout/"+e.ko.version),void 0!==e.Zepto&&s.push("zeptojs"),null!==r&&void 0!==r||!e.navigator||(t=a(e.navigator.userAgent),r=t[1],o=t[2],i=e.navigator.platform);var f=["js-"+l["default"].name+"/"+l["default"].version];return 0!==s.length&&f.push("("+s.sort().join(", ")+")"),f.concat([r,o,i,u]).map(function(e){return e?e.toString().replace(/\s/g,"_").toLowerCase():"unknown"}).join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.Device=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(168),l=o(c);t.Device=function(){function e(){i(this,e)}return s(e,null,[{key:"toString",value:function(){return u()}}]),e}()}).call(t,function(){return this}(),r(11))},function(e,t){e.exports={_args:[[{raw:"kinvey-javascript-sdk-core@^3.0.0",scope:null,escapedName:"kinvey-javascript-sdk-core",name:"kinvey-javascript-sdk-core",rawSpec:"^3.0.0",spec:">=3.0.0 <4.0.0",type:"range"},"/Users/Thomas/Documents/Kinvey/Development/SDKs/JavaScript/HTML5/SDK"]],_from:"kinvey-javascript-sdk-core@>=3.0.0 <4.0.0",_id:"kinvey-javascript-sdk-core@3.1.0",_inCache:!0,_installable:!0,_location:"/kinvey-javascript-sdk-core",_nodeVersion:"5.9.0",_npmOperationalInternal:{host:"packages-12-west.internal.npmjs.com",tmp:"tmp/kinvey-javascript-sdk-core-3.1.0.tgz_1473450407854_0.7726616486907005"},_npmUser:{name:"kinvey",email:"opensource@kinvey.com"},_npmVersion:"3.8.5",_phantomChildren:{},_requested:{raw:"kinvey-javascript-sdk-core@^3.0.0",scope:null,escapedName:"kinvey-javascript-sdk-core",name:"kinvey-javascript-sdk-core",rawSpec:"^3.0.0",spec:">=3.0.0 <4.0.0",type:"range"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/kinvey-javascript-sdk-core/-/kinvey-javascript-sdk-core-3.1.0.tgz",_shasum:"fdd16a61a2742e8e429776c124a66c3de0072c5e",_shrinkwrap:null,_spec:"kinvey-javascript-sdk-core@^3.0.0",_where:"/Users/Thomas/Documents/Kinvey/Development/SDKs/JavaScript/HTML5/SDK",author:{name:"Kinvey, Inc."},bugs:{url:"https://github.com/Kinvey/javascript-sdk-core/issues"},dependencies:{"append-query":"^1.1.0","es6-error":"^3.0.0","es6-promise":"^3.2.1","fast-memory-cache":"^2.0.4",hellojs:"^1.13.1","kinvey-javascript-rack":"^1.0.0","local-storage":"^1.4.2",lodash:"^4.12.0",loglevel:"^1.4.1",qs:"^6.2.0","regenerator-runtime":"^0.9.5",rxjs:"^5.0.0-beta.7",sift:"^3.0.0",uid:"0.0.2","url-pattern":"^1.0.0"},description:"Kinvey JavaScript SDK Core",devDependencies:{"babel-core":"^6.13.2","babel-eslint":"^6.0.4","babel-loader":"^6.2.4","babel-polyfill":"^6.9.1","babel-preset-es2015":"^6.13.2","babel-preset-stage-2":"^6.5.0",del:"^2.2.0",esdoc:"^0.4.7","esdoc-es7-plugin":"0.0.3",eslint:"^2.13.1","eslint-config-airbnb":"^9.0.1","eslint-plugin-import":"^1.10.2","eslint-plugin-jsx-a11y":"^1.5.5","eslint-plugin-react":"^5.2.2",expect:"^1.20.2",gulp:"^3.9.1","gulp-babel":"^6.1.2","gulp-bump":"^2.1.0","gulp-env":"^0.4.0","gulp-eslint":"^2.0.0","gulp-sourcemaps":"^1.6.0","gulp-tag-version":"^1.3.0","gulp-util":"^3.0.7",istanbul:"^1.0.0-alpha.2","json-loader":"^0.5.4",mocha:"^2.4.5",nock:"^8.0.0","parse-headers":"^2.0.1","promise-queue":"^2.2.3",request:"^2.72.0",semver:"^5.1.0",sinon:"^1.17.4","sinon-chai":"^2.8.0",webpack:"^1.13.2",yargs:"^4.7.1"},directories:{},dist:{shasum:"fdd16a61a2742e8e429776c124a66c3de0072c5e",tarball:"https://registry.npmjs.org/kinvey-javascript-sdk-core/-/kinvey-javascript-sdk-core-3.1.0.tgz"},gitHead:"1d4372d287bc543fd52866ba27229d8205002f04",homepage:"https://github.com/Kinvey/javascript-sdk-core#readme",license:"Apache-2.0",main:"./dist/export.js",maintainers:[{name:"kinvey",email:"opensource@kinvey.com"},{name:"thomas.conner",email:"thomas.conner@me.com"}],name:"kinvey-javascript-sdk-core",optionalDependencies:{},peerDependencies:{"kinvey-javascript-rack":"^1.0.0"},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/Kinvey/javascript-sdk-core.git"},scripts:{build:"BABEL_ENV=production gulp build",clean:"gulp clean",docs:"esdoc -c esdoc.json",lint:"gulp lint",test:"npm run test:mocha","test:jenkins":"istanbul cover _mocha -- --reporter tap --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit > test.tap && istanbul report clover","test:mocha":"mocha --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit","test:watch":"mocha -w --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit"},version:"3.1.0"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var o=r(170),i=n(o),a=i["default"].methodFactory;i["default"].methodFactory=function(e,t,r){var n=a(e,t,r);return function(e){e="Kinvey: "+e;for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];r.length>0?n(e,r):n(e)}},i["default"].setDefaultLevel(i["default"].levels.SILENT),t.Log=i["default"]},function(e,t,r){var n,o;!function(i,a){"use strict";n=a,o="function"==typeof n?n.call(t,r,t,e):n,!(void 0!==o&&(e.exports=o))}(this,function(){"use strict";function e(e){return typeof console!==u&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):a)}function t(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(n){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function r(e,t,r){return function(){typeof console!==u&&(n.call(this,t,r),this[e].apply(this,arguments))}}function n(e,t){for(var r=0;r<s.length;r++){var n=s[r];this[n]=r<e?a:this.methodFactory(n,e,t)}}function o(t,n,o){return e(t)||r.apply(this,arguments)}function i(e,t,r){function i(e){var t=(s[e]||"silent").toUpperCase();try{return void(window.localStorage[f]=t)}catch(r){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(r){}}function a(){var e;try{e=window.localStorage[f]}catch(t){}if(typeof e===u)try{var r=window.document.cookie,n=r.indexOf(encodeURIComponent(f)+"=");n&&(e=/^([^;]+)/.exec(r.slice(n))[1])}catch(t){}return void 0===l.levels[e]&&(e=void 0),e}var c,l=this,f="loglevel";e&&(f+=":"+e),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=r||o,l.getLevel=function(){return c},l.setLevel=function(t,r){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(c=t,r!==!1&&i(t),n.call(l,t,e),typeof console===u&&t<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){a()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var p=a();null==p&&(p=null==t?"WARN":t),l.setLevel(p,!1)}var a=function(){},u="undefined",s=["trace","debug","info","warn","error"],c=new i,l={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==u?window.log:void 0;return c.noConflict=function(){return typeof window!==u&&window.log===c&&(window.log=f),c},c})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,r){if(!t)return e=r?r:e;for(var n=t.split("."),o=n.shift();o&&e;)e=e[o],o=n.shift();return r?r:e}function i(e){return void 0!==e&&null!==e}function a(e){return function(){var t=this,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(0,s["default"])(e,function(e){(0,l["default"])(r[e])&&(t.prototype[e]=function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return r[e].apply(this,n)})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.nested=o,t.isDefined=i,t.use=a;var u=r(156),s=n(u),c=r(35),l=n(c)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyObservable=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(173),s=r(187);t.KinveyObservable=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"toPromise",value:function(){return s.toPromise.call(this)}}],[{key:"create",value:function(e){return new t(e)}}]),t}(u.Observable)},function(e,t,r){"use strict";var n=r(174),o=r(175),i=r(186),a=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,i=o.toSubscriber(e,t,r);if(n?n.call(i,this):i.add(this._subscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype.forEach=function(e,t){var r=this;if(t||(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise?t=n.root.Rx.config.Promise:n.root.Promise&&(t=n.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,n){var o=r.subscribe(function(t){if(o)try{e(t)}catch(r){n(r),o.unsubscribe()}else e(t)},n,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[i.$$observable]=function(){return this},e.create=function(t){return new e(t)},e}();t.Observable=a},function(e,t){(function(e){"use strict";var r={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};t.root=r[typeof self]&&self||r[typeof window]&&window;var n=r[typeof e]&&e;!n||n.global!==n&&n.window!==n||(t.root=n)}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e,t,r){if(e){if(e instanceof o.Subscriber)return e;if(e[i.$$rxSubscriber])return e[i.$$rxSubscriber]();
}return e||t||r?new o.Subscriber(e,t,r):new o.Subscriber}var o=r(176),i=r(185);t.toSubscriber=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(177),i=r(178),a=r(184),u=r(185),s=function(e){function t(r,n,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!r){this.destination=a.empty;break}if("object"==typeof r){r instanceof t?(this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,r,n,o)}}return n(t,e),t.prototype[u.$$rxSubscriber]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t}(i.Subscription);t.Subscriber=s;var c=function(e){function t(t,r,n,i){e.call(this),this._parent=t;var a,u=this;o.isFunction(r)?a=r:r&&(u=r,a=r.next,n=r.error,i=r.complete,o.isFunction(u.unsubscribe)&&this.add(u.unsubscribe.bind(u)),u.unsubscribe=this.unsubscribe.bind(this)),this._context=u,this._next=a,this._error=n,this._complete=i}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parent;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parent;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){if(!this.isStopped){var e=this._parent;this._complete?e.syncErrorThrowable?(this.__tryOrSetError(e,this._complete),this.unsubscribe()):(this.__tryOrUnsub(this._complete),this.unsubscribe()):this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(r){throw this.unsubscribe(),r}},t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(n){return e.syncErrorValue=n,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parent;this._context=null,this._parent=null,e.unsubscribe()},t}(s)},function(e,t){"use strict";function r(e){return"function"==typeof e}t.isFunction=r},function(e,t,r){"use strict";var n=r(179),o=r(180),i=r(177),a=r(181),u=r(182),s=r(183),c=function(){function e(e){this.closed=!1,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){this.closed=!0;var r=this,c=r._unsubscribe,l=r._subscriptions;if(this._subscriptions=null,i.isFunction(c)){var f=a.tryCatch(c).call(this);f===u.errorObject&&(t=!0,(e=e||[]).push(u.errorObject.e))}if(n.isArray(l))for(var p=-1,h=l.length;++p<h;){var d=l[p];if(o.isObject(d)){var f=a.tryCatch(d.unsubscribe).call(d);if(f===u.errorObject){t=!0,e=e||[];var v=u.errorObject.e;v instanceof s.UnsubscriptionError?e=e.concat(v.errors):e.push(v)}}}if(t)throw new s.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||"function"!=typeof r.unsubscribe)break;this.closed?r.unsubscribe():(this._subscriptions||(this._subscriptions=[])).push(r);break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return r},e.prototype.remove=function(t){if(null!=t&&t!==this&&t!==e.EMPTY){var r=this._subscriptions;if(r){var n=r.indexOf(t);n!==-1&&r.splice(n,1)}}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();t.Subscription=c},function(e,t){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t){"use strict";function r(e){return null!=e&&"object"==typeof e}t.isObject=r},function(e,t,r){"use strict";function n(){try{return i.apply(this,arguments)}catch(e){return a.errorObject.e=e,a.errorObject}}function o(e){return i=e,n}var i,a=r(182);t.tryCatch=o},function(e,t){"use strict";t.errorObject={e:{}}},function(e,t){"use strict";var r=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},n=function(e){function t(t){e.call(this),this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return r(t,e),t}(Error);t.UnsubscriptionError=n},function(e,t){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,r){"use strict";var n=r(174),o=n.root.Symbol;t.$$rxSubscriber="function"==typeof o&&"function"==typeof o["for"]?o["for"]("rxSubscriber"):"@@rxSubscriber"},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}var o=r(174);t.getSymbolObservable=n,t.$$observable=n(o.root)},function(e,t,r){"use strict";function n(e){var t=this;if(e||(o.root.Rx&&o.root.Rx.config&&o.root.Rx.config.Promise?e=o.root.Rx.config.Promise:o.root.Promise&&(e=o.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})}var o=r(174);t.toPromise=n},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return c["default"].get(""+e.appKey+l)}function i(e,t){if(t)try{return c["default"].set(""+e.appKey+l,t)}catch(r){return!1}return c["default"].remove(""+e.appKey+l)}function a(e,t){return c["default"].get(""+e.appKey+t)}function u(e,t,r){if(r)try{return c["default"].set(""+e.appKey+t,r)}catch(n){return!1}return c["default"].remove(""+e.appKey+t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveUser=o,t.setActiveUser=i,t.getIdentitySession=a,t.setIdentitySession=u;var s=r(189),c=n(s),l=e.env.KINVEY_USER_COLLECTION_NAME||"kinvey_user"}).call(t,r(11))},function(e,t,r){(function(t){"use strict";function n(e,t){return 1===arguments.length?o(e):i(e,t)}function o(e){return JSON.parse(l.getItem(e))}function i(e,t){try{return l.setItem(e,JSON.stringify(t)),!0}catch(r){return!1}}function a(e){return l.removeItem(e)}function u(){return l.clear()}var s=r(190),c=r(191),l="localStorage"in t&&t.localStorage?t.localStorage:s;n.set=i,n.get=o,n.remove=a,n.clear=u,n.on=c.on,n.off=c.off,e.exports=n}).call(t,function(){return this}())},function(e,t){"use strict";function r(e){return e in a?a[e]:null}function n(e,t){return a[e]=t,!0}function o(e){var t=e in a;return!!t&&delete a[e]}function i(){return a={},!0}var a={};e.exports={getItem:r,setItem:n,removeItem:o,clear:i}},function(e,t){(function(t){"use strict";function r(){t.addEventListener?t.addEventListener("storage",n,!1):t.attachEvent?t.attachEvent("onstorage",n):t.onstorage=n}function n(e){function r(t){t(JSON.parse(e.newValue),JSON.parse(e.oldValue),e.url||e.uri)}e||(e=t.event);var n=a[e.key];n&&n.forEach(r)}function o(e,t){a[e]?a[e].push(t):a[e]=[t],u===!1&&r()}function i(e,t){var r=a[e];r.length>1?r.splice(r.indexOf(t),1):a[e]=[]}var a={},u=!1;e.exports={on:o,off:i}}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return""+t+(0,a["default"])(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=o;var i=r(193),a=n(i)},function(e,t){function r(e){return e=e||7,Math.random().toString(35).substr(2,e)}e.exports=r},function(e,t,r){var n,o,i,a=[].slice;!function(a,u){return null!=r(195)?(o=[],n=u,i="function"==typeof n?n.apply(t,o):n,!(void 0!==i&&(e.exports=i))):"undefined"!=typeof t&&null!==t?e.exports=u():a.UrlPattern=u()}(this,function(){var e,t,r,n,o,i,u,s,c,l,f,p,h,d,v;return c=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},u=function(e,t){var r,n,o;for(o=[],r=-1,n=e.length;++r<n;)o=o.concat(t(e[r]));return o},d=function(e,t){var r,n,o;for(o="",r=-1,n=e.length;++r<n;)o+=t(e[r]);return o},h=function(e){return new RegExp(e.toString()+"|").exec("").length-1},f=function(e,t){var r,n,o,i,a;for(i={},r=-1,o=e.length;++r<o;)n=e[r],a=t[r],null!=a&&(null!=i[n]?(Array.isArray(i[n])||(i[n]=[i[n]]),i[n].push(a)):i[n]=a);return i},e={},e.Result=function(e,t){this.value=e,this.rest=t},e.Tagged=function(e,t){this.tag=e,this.value=t},e.tag=function(t,r){return function(n){var o,i;if(o=r(n),null!=o)return i=new e.Tagged(t,o.value),new e.Result(i,o.rest)}},e.regex=function(t){return function(r){var n,o;if(n=t.exec(r),null!=n)return o=n[0],new e.Result(o,r.slice(o.length))}},e.sequence=function(){var t;return t=1<=arguments.length?a.call(arguments,0):[],function(r){var n,o,i,a,u,s;for(n=-1,o=t.length,s=[],a=r;++n<o;){if(i=t[n],u=i(a),null==u)return;s.push(u.value),a=u.rest}return new e.Result(s,a)}},e.pick=function(){var t,r;return t=arguments[0],r=2<=arguments.length?a.call(arguments,1):[],function(n){var o,i;if(i=e.sequence.apply(e,r)(n),null!=i)return o=i.value,i.value=o[t],i}},e.string=function(t){var r;return r=t.length,function(n){if(n.slice(0,r)===t)return new e.Result(t,n.slice(r))}},e.lazy=function(e){var t;return t=null,function(r){return null==t&&(t=e()),t(r)}},e.baseMany=function(t,r,n,o,i){var a,u,s,c;for(s=i,c=n?"":[];;){if(null!=r&&(a=r(s),null!=a))break;if(u=t(s),null==u)break;n?c+=u.value:c.push(u.value),s=u.rest}if(!o||0!==c.length)return new e.Result(c,s)},e.many1=function(t){return function(r){return e.baseMany(t,null,!1,!0,r)}},e.concatMany1Till=function(t,r){return function(n){return e.baseMany(t,r,!0,!0,n)}},e.firstChoice=function(){var e;return e=1<=arguments.length?a.call(arguments,0):[],function(t){var r,n,o,i;for(r=-1,n=e.length;++r<n;)if(o=e[r],i=o(t),null!=i)return i}},p=function(t){var r;return r={},r.wildcard=e.tag("wildcard",e.string(t.wildcardChar)),r.optional=e.tag("optional",e.pick(1,e.string(t.optionalSegmentStartChar),e.lazy(function(){return r.pattern}),e.string(t.optionalSegmentEndChar))),r.name=e.regex(new RegExp("^["+t.segmentNameCharset+"]+")),r.named=e.tag("named",e.pick(1,e.string(t.segmentNameStartChar),e.lazy(function(){return r.name}))),r.escapedChar=e.pick(1,e.string(t.escapeChar),e.regex(/^./)),r["static"]=e.tag("static",e.concatMany1Till(e.firstChoice(e.lazy(function(){return r.escapedChar}),e.regex(/^./)),e.firstChoice(e.string(t.segmentNameStartChar),e.string(t.optionalSegmentStartChar),e.string(t.optionalSegmentEndChar),r.wildcard))),r.token=e.lazy(function(){return e.firstChoice(r.wildcard,r.optional,r.named,r["static"])}),r.pattern=e.many1(e.lazy(function(){return r.token})),r},s={escapeChar:"\\",segmentNameStartChar:":",segmentValueCharset:"a-zA-Z0-9-_~ %",segmentNameCharset:"a-zA-Z0-9",optionalSegmentStartChar:"(",optionalSegmentEndChar:")",wildcardChar:"*"},i=function(e,t){if(Array.isArray(e))return d(e,function(e){return i(e,t)});switch(e.tag){case"wildcard":return"(.*?)";case"named":return"(["+t+"]+)";case"static":return c(e.value);case"optional":return"(?:"+i(e.value,t)+")?"}},o=function(e,t){return null==t&&(t=s.segmentValueCharset),"^"+i(e,t)+"$"},n=function(e){if(Array.isArray(e))return u(e,n);switch(e.tag){case"wildcard":return["_"];case"named":return[e.value];case"static":return[];case"optional":return n(e.value)}},l=function(e,t,r,n){var o,i,a,u;if(null==n&&(n=!1),u=e[t],null!=u){if(o=r[t]||0,i=Array.isArray(u)?u.length-1:0,!(o>i))return a=Array.isArray(u)?u[o]:u,n&&(r[t]=o+1),a;if(n)throw new Error("too few values provided for key `"+t+"`")}else if(n)throw new Error("no values provided for key `"+t+"`")},r=function(e,t,n){var o,i;if(Array.isArray(e)){for(o=-1,i=e.length;++o<i;)if(r(e[o],t,n))return!0;return!1}switch(e.tag){case"wildcard":return null!=l(t,"_",n,!1);case"named":return null!=l(t,e.value,n,!1);case"static":return!1;case"optional":return r(e.value,t,n)}},v=function(e,t,n){if(Array.isArray(e))return d(e,function(e){return v(e,t,n)});switch(e.tag){case"wildcard":return l(t,"_",n,!0);case"named":return l(t,e.value,n,!0);case"static":return e.value;case"optional":return r(e.value,t,n)?v(e.value,t,n):""}},t=function(e,r){var i,a,u,c,l;if(e instanceof t)return this.isRegex=e.isRegex,this.regex=e.regex,this.ast=e.ast,void(this.names=e.names);if(this.isRegex=e instanceof RegExp,"string"!=typeof e&&!this.isRegex)throw new TypeError("argument must be a regex or a string");if(this.isRegex){if(this.regex=e,null!=r){if(!Array.isArray(r))throw new Error("if first argument is a regex the second argument may be an array of group names but you provided something else");if(i=h(this.regex),r.length!==i)throw new Error("regex contains "+i+" groups but array of group names contains "+r.length);this.names=r}}else{if(""===e)throw new Error("argument must not be the empty string");if(l=e.replace(/\s+/g,""),l!==e)throw new Error("argument must not contain whitespace");if(a={escapeChar:(null!=r?r.escapeChar:void 0)||s.escapeChar,segmentNameStartChar:(null!=r?r.segmentNameStartChar:void 0)||s.segmentNameStartChar,segmentNameCharset:(null!=r?r.segmentNameCharset:void 0)||s.segmentNameCharset,segmentValueCharset:(null!=r?r.segmentValueCharset:void 0)||s.segmentValueCharset,optionalSegmentStartChar:(null!=r?r.optionalSegmentStartChar:void 0)||s.optionalSegmentStartChar,optionalSegmentEndChar:(null!=r?r.optionalSegmentEndChar:void 0)||s.optionalSegmentEndChar,wildcardChar:(null!=r?r.wildcardChar:void 0)||s.wildcardChar},c=p(a),u=c.pattern(e),null==u)throw new Error("couldn't parse pattern");if(""!==u.rest)throw new Error("could only partially parse pattern");this.ast=u.value,this.regex=new RegExp(o(this.ast,a.segmentValueCharset)),this.names=n(this.ast)}},t.prototype.match=function(e){var t,r;return r=this.regex.exec(e),null==r?null:(t=r.slice(1),this.names?f(this.names,t):t)},t.prototype.stringify=function(e){if(null==e&&(e={}),this.isRegex)throw new Error("can't stringify patterns generated from a regex");if(e!==Object(e))throw new Error("argument must be an object or undefined");return v(this.ast,e,{})},t.escapeForRegex=c,t.concatMap=u,t.stringConcatMap=d,t.regexGroupCount=h,t.keysAndValuesToObject=f,t.P=e,t.newParser=p,t.defaultOptions=s,t.astNodeToRegexString=o,t.astNodeToNames=n,t.getParam=l,t.astNodeContainsSegmentsForProvidedParams=r,t.stringify=v,t})},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new b.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):b.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFetchRequest=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=function K(e,t,r,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&K(i,t,r,n)}else if("value"in o&&o.writable)o.value=r;else{var a=o.set;void 0!==a&&a.call(n,r)}return r},f=function U(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:U(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},p=r(197),h=r(137),d=r(136),v=r(164),y=r(162),m=r(221),b=r(210),g=r(9),w=n(g),_=r(227),x=n(_),k=r(121),O=n(k),j=r(231),E=n(j),P=r(232),S=n(P),T=r(156),A=n(T),R=r(80),I=n(R),q=r(158),C=n(q),M=e.env.KINVEY_ID_ATTRIBUTE||"_id",N=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",L=200;t.DeltaFetchRequest=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,[{key:"execute",value:function(){function e(){return r.apply(this,arguments)}var r=o(w["default"].mark(function n(){var e,r,o,i,a=this;return w["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=[],n.next=3,f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this);case 3:return n.prev=3,r=new d.CacheRequest({method:h.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client}),n.next=7,r.execute().then(function(e){return e.data});case 7:e=n.sent,n.next=15;break;case 10:if(n.prev=10,n.t0=n["catch"](3),n.t0 instanceof y.NotFoundError){n.next=14;break}throw n.t0;case 14:e=[];case 15:if(!((0,I["default"])(e)&&e.length>0)){n.next=20;break}return n.delegateYield(w["default"].mark(function u(){var t,r,n,o,i,s,c,l,f,d,y,g,_,k,j,P,T;return w["default"].wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=(0,x["default"])(e,M),r=new m.Query((0,E["default"])(a.query,"toJSON",a.query)),r.fields=[M,N+".lmt"],n=new p.KinveyRequest({method:h.RequestMethod.GET,url:a.url,headers:a.headers,auth:a.auth,query:r,timeout:a.timeout,client:a.client}),u.next=6,n.execute().then(function(e){return e.data});case 6:for(o=u.sent,i=(0,x["default"])(o,M),s=i,c=Object.keys(t),(0,A["default"])(c,function(e){var r=t[e],n=i[e];n&&n[N]&&r[N]&&n[N].lmt===r[N].lmt?delete s[e]:delete t[e]}),l=Object.keys(s),f=[],d=0;d<l.length;)y=new m.Query((0,E["default"])(a.query,"toJSON",a.query)),g=l.slice(d,l.length>L+d?L:l.length),y.contains(M,g),_=new p.KinveyRequest({method:h.RequestMethod.GET,url:a.url,headers:a.headers,auth:a.auth,query:y,timeout:a.timeout,client:a.client}),k=_.execute(),f.push(k),d+=L;return u.next=17,b.Promise.all(f);case 17:return j=u.sent,P=(0,O["default"])(j,function(e,t){if(t.isSuccess()){var r=e.headers;r.addHeaders(t.headers),e.headers=r,e.data=e.data.concat(t.data)}return e},new v.Response({statusCode:v.StatusCode.Ok,data:[]})),P.data=P.data.concat((0,S["default"])(t)),a.query&&(T=new m.Query((0,E["default"])(a.query,"toJSON",a.query)),T.skip(0).limit(0),P.data=T.process(P.data)),u.abrupt("return",{v:P});case 22:case"end":return u.stop()}},u,a)})(),"t1",17);case 17:if(o=n.t1,"object"!==("undefined"==typeof o?"undefined":s(o))){n.next=20;break}return n.abrupt("return",o.v);case 20:return i=new p.KinveyRequest({method:h.RequestMethod.GET,url:this.url,headers:this.headers,auth:this.auth,query:this.query,timeout:this.timeout,client:this.client}),n.abrupt("return",i.execute());case 22:case"end":return n.stop()}},n,this,[[3,10]])}));return e}()},{key:"method",get:function(){return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",this)},set:function(e){switch((0,C["default"])(e)||(e=String(e)),e=e.toUpperCase()){case h.RequestMethod.GET:l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",e,this);break;case h.RequestMethod.POST:case h.RequestMethod.PATCH:case h.RequestMethod.PUT:case h.RequestMethod.DELETE:default:throw new Error("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]),t}(p.KinveyRequest)}).call(t,r(11))},function(e,t,r){(function(e,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e){if(e){var t=0,r=e.length;e=String(e||"");for(var n=0;n<r;n++){var o=encodeURI(e[n]).split("%").length;t+=1===o?1:o-1}return t}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyRequest=t.Properties=t.AuthType=void 0;var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=function $(e,t,r,n){var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var i=Object.getPrototypeOf(e);null!==i&&$(i,t,r,n)}else if("value"in o&&o.writable)o.value=r;else{var a=o.set;void 0!==a&&a.call(n,r)}return r},p=function H(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:H(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},h=r(137),d=r(202),v=r(203),y=r(162),m=r(165),b=r(204),g=r(166),w=r(9),_=o(w),x=r(147),k=o(x),O=r(138),j=o(O),E=r(142),P=o(E),S=r(149),T=o(S),A=r(159),R=o(A),I=r(218),q=o(I),C=e.env.KINVEY_SOCIAL_IDENTITY_ATTRIBUTE||"_socialIdentity",M=e.env.KINVEY_MIC_TOKEN_PATHNAME||"/oauth/token",N=e.env.KINVEY_USERS_NAMESPACE||"user",L=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",K=e.env.KINVEY_DEFAULT_API_VERSION||4,U=e.env.KINVEY_MAX_HEADER_BYTES||2e3,D={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(D),t.AuthType=D;var B={all:function(e){try{return B.session(e)}catch(t){return B.basic(e)}},app:function(e){if(!e.appKey||!e.appSecret)throw new Error("Missing client appKey and/or appSecret. Use Kinvey.init() to set the appKey and appSecret for the client.");return{scheme:"Basic",username:e.appKey,password:e.appSecret}},basic:function(e){try{return B.master(e)}catch(t){return B.app(e)}},master:function(e){if(!e.appKey||!e.masterSecret)throw new Error("Missing client appKey and/or appSecret. Use Kinvey.init() to set the appKey and appSecret for the client.");return{scheme:"Basic",username:e.appKey,password:e.masterSecret}},none:function(){return null},session:function(e){var t=e.activeUser;if(!t)throw new y.NoActiveUserError("There is not an active user. Please login a user and retry the request.");return{scheme:"Kinvey",credentials:t[L].authtoken}}},F=t.Properties=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),t}(h.Headers);t.KinveyRequest=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e=(0,T["default"])({authType:D.None,query:null,apiVersion:K,properties:new F,skipBL:!1,trace:!1,client:m.Client.sharedInstance()},e),r.authType=e.authType,r.query=e.query,r.apiVersion=e.apiVersion,r.properties=e.properties,r.client=e.client,r.skipBL=e.skipBL,r.trace=e.trace,r}return s(t,e),l(t,[{key:"execute",value:function(){function e(e){return r.apply(this,arguments)}var r=i(_["default"].mark(function n(){var e,r,o,i,a,u,s,c=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];return _["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this);case 3:if(e=n.sent,e instanceof v.KinveyResponse||(e=new v.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})),c!==!1||e.isSuccess()!==!1){n.next=7;break}throw e.error;case 7:return n.abrupt("return",e);case 10:if(n.prev=10,n.t0=n["catch"](0),!(n.t0 instanceof y.InvalidCredentialsError)){n.next=30;break}if(r=(0,g.getIdentitySession)(this.client,b.SocialIdentity.MobileIdentityConnect),!r){n.next=30;break}return o=new t({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:D.App,url:k["default"].format({protocol:r.protocol||this.client.micProtocol,host:r.host||this.client.micHost,pathname:M}),body:{grant_type:"refresh_token",client_id:r.client_id,redirect_uri:r.redirect_uri,refresh_token:r.refresh_token},timeout:this.timeout,properties:this.properties}),n.next=18,o.execute().then(function(e){return e.data});case 18:return i=n.sent,r=(0,T["default"])(r,i),a={},a[C]={},a[C][b.SocialIdentity.MobileIdentityConnect]=r,u=new t({method:h.RequestMethod.POST,authType:D.App,url:k["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+N+"/"+this.client.appKey+"/login"}),properties:this.properties,body:a,timeout:this.timeout,client:this.client}),n.next=26,u.execute().then(function(e){return e.data});case 26:return s=n.sent,(0,g.setActiveUser)(this.client,s),(0,g.setIdentitySession)(this.client,b.SocialIdentity.MobileIdentityConnect,r),n.abrupt("return",this.execute(c));case 30:throw n.t0;case 31:case"end":return n.stop()}},n,this,[[0,10]])}));return e}()},{key:"headers",get:function(){var e=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(e.has("Accept")||e.set("Accept","application/json; charset=utf-8"),e.has("Content-Type")||e.set("Content-Type","application/json; charset=utf-8"),e.has("X-Kinvey-Api-Version")||e.set("X-Kinvey-Api-Version",this.apiVersion),this.skipBL===!0?e.set("X-Kinvey-Skip-Business-Logic",!0):e.remove("X-Kinvey-Skip-Business-Logic"),this.trace===!0?(e.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id"),e.set("X-Kinvey-ResponseWrapper",!0)):(e.remove("X-Kinvey-Include-Headers-In-Response"),e.remove("X-Kinvey-ResponseWrapper")),this.appVersion?e.set("X-Kinvey-Client-App-Version",this.appVersion):e.remove("X-Kinvey-Client-App-Version"),this.properties){var r=this.properties.toString();if((0,q["default"])(r))e.remove("X-Kinvey-Custom-Request-Properties");else{var o=c(r);if(o>=U)throw new Error("The custom properties are "+o+" bytes."+("It must be less then "+U+" bytes."),"Please remove some custom properties.");e.set("X-Kinvey-Custom-Request-Properties",r)}}else e.remove("X-Kinvey-Custom-Request-Properties");if(e.set("X-Kinvey-Device-Information",g.Device.toString()),this.authType){var i=void 0;switch(this.authType){case D.All:i=B.all(this.client);break;case D.App:i=B.app(this.client);break;case D.Basic:i=B.basic(this.client);break;case D.Master:i=B.master(this.client);break;case D.None:i=B.none(this.client);break;case D.Session:i=B.session(this.client);break;default:try{i=B.session(this.client)}catch(a){try{i=B.master(this.client)}catch(u){throw a}}}if(i){var s=i.credentials;i.username&&(s=new n(i.username+":"+i.password).toString("base64")),e.set("Authorization",i.scheme+" "+s)}}else e.remove("Authorization");return e},set:function(e){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",e,this)}},{key:"url",get:function(){var e=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this),r=this.query?this.query.toQueryString():{};return(0,q["default"])(r)?e:(0,P["default"])(e,j["default"].stringify(r))},set:function(e){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",e,this)}},{key:"apiVersion",get:function(){return this._apiVersion},set:function(e){this._apiVersion=(0,R["default"])(e)?e:K}},{key:"properties",get:function(){return this._properties},set:function(e){!e||e instanceof F||(e=new F(e)),this._properties=e}},{key:"client",get:function(){return this._client},set:function(e){if(e){if(!(e instanceof m.Client))throw new y.KinveyError("client must be an instance of the Client class.");this.appVersion=e.appVersion}this._client=e}}]),t}(d.NetworkRequest)}).call(t,r(11),r(198).Buffer)},function(e,t,r){(function(e,n){"use strict";function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function i(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,r){if(i()<r)throw new RangeError("Invalid typed array length");return e.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r),t.__proto__=e.prototype):(null===t&&(t=new e(r)),t.length=r),t}function e(t,r,n){if(!(e.TYPED_ARRAY_SUPPORT||this instanceof e))return new e(t,r,n);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return u(this,t,r,n)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,n):"string"==typeof t?f(e,t,r):d(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,r,n){return s(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}function l(t,r){if(s(r),t=a(t,r<0?0:0|v(r)),!e.TYPED_ARRAY_SUPPORT)for(var n=0;n<r;++n)t[n]=0;return t}function f(t,r,n){if("string"==typeof n&&""!==n||(n="utf8"),!e.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|m(r,n);t=a(t,o);var i=t.write(r,n);return i!==o&&(t=t.slice(0,i)),t}function p(e,t){var r=t.length<0?0:0|v(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(t,r,n,o){if(r.byteLength,n<0||r.byteLength<n)throw new RangeError("'offset' is out of bounds");if(r.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return r=void 0===n&&void 0===o?new Uint8Array(r):void 0===o?new Uint8Array(r,n):new Uint8Array(r,n,o),e.TYPED_ARRAY_SUPPORT?(t=r,t.__proto__=e.prototype):t=p(t,r),t}function d(t,r){if(e.isBuffer(r)){var n=0|v(r.length);return t=a(t,n),0===t.length?t:(r.copy(t,0,0,n),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||J(r.length)?a(t,0):p(t,r);if("Buffer"===r.type&&Z(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function y(t){return+t!=t&&(t=0),e.alloc(+t)}function m(t,r){
if(e.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var o=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(t).length;default:if(o)return Y(t).length;r=(""+r).toLowerCase(),o=!0}}function b(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return q(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function w(t,r,n,o,i){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof r&&(r=e.from(r,o)),e.isBuffer(r))return 0===r.length?-1:_(t,r,n,o,i);if("number"==typeof r)return r=255&r,e.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):_(t,[r],n,o,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,r,n,o){function i(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,u=e.length,s=t.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,r/=2}var c;if(o){var l=-1;for(c=r;c<u;c++)if(i(e,c)===i(t,l===-1?0:c-l)){if(l===-1&&(l=c),c-l+1===s)return l*a}else l!==-1&&(c-=c-l),l=-1}else for(r+s>u&&(r=u-s),c=r;c>=0;c--){for(var f=!0,p=0;p<s;p++)if(i(e,c+p)!==i(t,p)){f=!1;break}if(f)return c}return-1}function x(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n),n>o&&(n=o)):n=o;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[r+a]=u}return a}function k(e,t,r,n){return G(Y(t,e.length-r),e,r,n)}function O(e,t,r,n){return G(V(t),e,r,n)}function j(e,t,r,n){return O(e,t,r,n)}function E(e,t,r,n){return G(Q(t),e,r,n)}function P(e,t,r,n){return G(z(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?W.fromByteArray(e):W.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i=e[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(o+u<=r){var s,c,l,f;switch(u){case 1:i<128&&(a=i);break;case 2:s=e[o+1],128===(192&s)&&(f=(31&i)<<6|63&s,f>127&&(a=f));break;case 3:s=e[o+1],c=e[o+2],128===(192&s)&&128===(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128===(192&s)&&128===(192&c)&&128===(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l,f>65535&&f<1114112&&(a=f))}}null===a?(a=65533,u=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),o+=u}return A(n)}function A(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ee));return r}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function q(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=H(e[i]);return o}function C(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function M(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(t,r,n,o,i,a){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<a)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function L(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function K(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function U(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(e,t,r,n,o){return o||U(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,o){return o||U(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(e,t,r,n,52,8),r+8}function F(e){if(e=$(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function $(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var r,n=e.length,o=null,i=[],a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function V(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function z(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}function Q(e){return W.toByteArray(F(e))}function G(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function J(e){return e!==e}var W=r(199),X=r(200),Z=r(201);t.Buffer=e,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50,e.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:o(),t.kMaxLength=i(),e.poolSize=8192,e._augment=function(t){return t.__proto__=e.prototype,t},e.from=function(e,t,r){return u(null,e,t,r)},e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0})),e.alloc=function(e,t,r){return c(null,e,t,r)},e.allocUnsafe=function(e){return l(null,e)},e.allocUnsafeSlow=function(e){return l(null,e)},e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var n=t.length,o=r.length,i=0,a=Math.min(n,o);i<a;++i)if(t[i]!==r[i]){n=t[i],o=r[i];break}return n<o?-1:o<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Z(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var o=e.allocUnsafe(r),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!e.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(o,i),i+=a.length}return o},e.byteLength=m,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):b.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t,r,n,o,i){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),r<0||n>t.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&r>=n)return 0;if(o>=i)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,o>>>=0,i>>>=0,this===t)return 0;for(var a=i-o,u=n-r,s=Math.min(a,u),c=this.slice(o,i),l=t.slice(r,n),f=0;f<s;++f)if(c[f]!==l[f]){a=c[f],u=l[f];break}return a<u?-1:u<a?1:0},e.prototype.includes=function(e,t,r){return this.indexOf(e,t,r)!==-1},e.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},e.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return x(this,e,t,r);case"utf8":case"utf-8":return k(this,e,t,r);case"ascii":return O(this,e,t,r);case"latin1":case"binary":return j(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;e.prototype.slice=function(t,r){var n=this.length;t=~~t,r=void 0===r?n:~~r,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<t&&(r=t);var o;if(e.TYPED_ARRAY_SUPPORT)o=this.subarray(t,r),o.__proto__=e.prototype;else{var i=r-t;o=new e(i,(void 0));for(var a=0;a<i;++a)o[a]=this[a+t]}return o},e.prototype.readUIntLE=function(e,t,r){e=0|e,t=0|t,r||M(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},e.prototype.readUIntBE=function(e,t,r){e=0|e,t=0|t,r||M(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},e.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e=0|e,t=0|t,r||M(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e=0|e,t=0|t,r||M(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},e.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),X.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),X.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),X.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),X.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t=0|t,r=0|r,!n){var o=Math.pow(2,8*r)-1;N(this,e,t,r,o,0)}var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t=0|t,r=0|r,!n){var o=Math.pow(2,8*r)-1;N(this,e,t,r,o,0)}var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},e.prototype.writeUInt8=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},e.prototype.writeUInt16LE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):L(this,t,r,!0),r+2},e.prototype.writeUInt16BE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):L(this,t,r,!1),r+2},e.prototype.writeUInt32LE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):K(this,t,r,!0),r+4},e.prototype.writeUInt32BE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):K(this,t,r,!1),r+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*r-1);N(this,e,t,r,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t=0|t,!n){var o=Math.pow(2,8*r-1);N(this,e,t,r,o-1,-o)}var i=r-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+r},e.prototype.writeInt8=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},e.prototype.writeInt16LE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):L(this,t,r,!0),r+2},e.prototype.writeInt16BE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):L(this,t,r,!1),r+2},e.prototype.writeInt32LE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):K(this,t,r,!0),r+4},e.prototype.writeInt32BE=function(t,r,n){return t=+t,r=0|r,n||N(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):K(this,t,r,!1),r+4},e.prototype.writeFloatLE=function(e,t,r){return D(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return D(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,o){if(n||(n=0),o||0===o||(o=this.length),r>=t.length&&(r=t.length),r||(r=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-r<o-n&&(o=t.length-r+n);var i,a=o-n;if(this===t&&n<r&&r<o)for(i=a-1;i>=0;--i)t[i+r]=this[i+n];else if(a<1e3||!e.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+r]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),r);return a},e.prototype.fill=function(t,r,n,o){if("string"==typeof t){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!e.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t=255&t);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var a;if("number"==typeof t)for(a=r;a<n;++a)this[a]=t;else{var u=e.isBuffer(t)?t:Y(new e(t,o).toString()),s=u.length;for(a=0;a<n-r;++a)this[a+r]=u[a%s]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(t,r(198).Buffer,function(){return this}())},function(e,t){"use strict";function r(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)u[t]=e[t],s[e.charCodeAt(t)]=t;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}function n(e){var t,r,n,o,i,a,u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[u-2]?2:"="===e[u-1]?1:0,a=new c(3*u/4-i),n=i>0?u-4:u;var l=0;for(t=0,r=0;t<n;t+=4,r+=3)o=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],a[l++]=o>>16&255,a[l++]=o>>8&255,a[l++]=255&o;return 2===i?(o=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,a[l++]=255&o):1===i&&(o=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,a[l++]=o>>8&255,a[l++]=255&o),a}function o(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function i(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(n));return i.join("")}function a(e){for(var t,r=e.length,n=r%3,o="",a=[],s=16383,c=0,l=r-n;c<l;c+=s)a.push(i(e,c,c+s>l?l:c+s));return 1===n?(t=e[r-1],o+=u[t>>2],o+=u[t<<4&63],o+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],o+=u[t>>10],o+=u[t>>4&63],o+=u[t<<2&63],o+="="),a.push(o),a.join("")}t.toByteArray=n,t.fromByteArray=a;var u=[],s=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array;r()},function(e,t){t.read=function(e,t,r,n,o){var i,a,u=8*o-n-1,s=(1<<u)-1,c=s>>1,l=-7,f=r?o-1:0,p=r?-1:1,h=e[t+f];for(f+=p,i=h&(1<<-l)-1,h>>=-l,l+=u;l>0;i=256*i+e[t+f],f+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=p,l-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:(h?-1:1)*(1/0);a+=Math.pow(2,n),i-=c}return(h?-1:1)*a*Math.pow(2,i-n)},t.write=function(e,t,r,n,o,i){var a,u,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),t+=a+f>=1?p/s:p*Math.pow(2,1-f),t*s>=2&&(a++,s/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(t*s-1)*Math.pow(2,o),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&u,h+=d,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;e[r+h]=255&a,h+=d,a/=256,c-=8);e[r+h-d]|=128*v}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRequest=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function y(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:y(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},l=r(137),f=r(162),p=r(164),h=r(6),d=r(9),v=n(d);t.NetworkRequest=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.rack=t.rack,r}return u(t,e),s(t,[{key:"execute",value:function(){function e(){return t.apply(this,arguments)}var t=o(v["default"].mark(function r(){var e;return v["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.rack){t.next=2;break}throw new f.KinveyError("Unable to execute the request. Please provide a rack to execute the request.");case 2:return t.next=4,this.rack.execute(this);case 4:if(e=t.sent,this.executing=!1,e){t.next=8;break}throw new f.NoResponseError;case 8:return e instanceof p.Response||(e=new p.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})),t.abrupt("return",e);case 10:case"end":return t.stop()}},r,this)}));return e}()},{key:"cancel",value:function(){var e=this,r=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"cancel",this).call(this).then(function(){return e.rack.cancel()});return r}}],[{key:"rack",get:function(){return t._rack},set:function(e){if(!(e&&e instanceof h.Rack))throw new f.KinveyError("Unable to set the rack of a NetworkRequest. It must be an instance of a Rack");t._rack=e}}]),t}(l.Request)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyResponse=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function l(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:l(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},s=r(162),c=r(164);t.KinveyResponse=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},r=e.name||e.error,n=e.message||e.description,o=e.debug,i=this.statusCode;return"FeatureUnavailableError"===r?new s.FeatureUnavailableError(n,o,i):"IncompleteRequestBodyError"===r?new s.IncompleteRequestBodyError(n,o,i):"InsufficientCredentials"===r?new s.InsufficientCredentialsError(n,o,i):"InvalidCredentials"===r?new s.InvalidCredentialsError(n,o,i):"InvalidIdentifierError"===r?new s.InvalidIdentifierError(n,o,i):"InvalidQuerySyntaxError"===r?new s.InvalidQuerySyntaxError(n,o,i):"JSONParseError"===r?new s.JSONParseError(n,o,i):"MissingQueryError"===r?new s.MissingQueryError(n,o,i):"MissingRequestHeaderError"===r?new s.MissingRequestHeaderError(n,o,i):"MissingRequestParameterError"===r?new s.MissingRequestParameterError(n,o,i):"EntityNotFound"===r||"CollectionNotFound"===r||"AppNotFound"===r||"UserNotFound"===r||"BlobNotFound"===r||"DocumentNotFound"===r||i===c.StatusCode.NotFound?new s.NotFoundError(n,o,i):"ParameterValueOutOfRangeError"===r?new s.ParameterValueOutOfRangeError(n,o,i):"ServerError"===r||i===c.StatusCode.ServerError?new s.ServerError(n,o,i):u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this)}}]),t}(c.Response)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(205);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(206);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(213);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=r(214);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=r(215);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=r(217);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,r){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Facebook:"facebook",Google:"google",Kinvey:e.env.KINVEY_IDENTITY||"kinvey",LinkedIn:"linkedin",MobileIdentityConnect:e.env.KINVEY_MIC_IDENTITY||"kinveyAuth",Windows:"windows"};Object.freeze(r),t.SocialIdentity=r}).call(t,r(11))},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new f.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):f.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Facebook=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(207),l=r(205),f=r(210),p=r(162),h=r(166),d=r(9),v=n(d),y=r(149),m=n(y),b=r(143),g=n(b),w=r(147),_=n(w);t.Facebook=function(t){function r(){return i(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return u(r,t),s(r,[{key:"isSupported",value:function(){return!!e.Kinvey.Popup}},{key:"login",value:function(){function t(e,t){return r.apply(this,arguments)}var r=o(v["default"].mark(function n(t){var r,o,i=this,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return v["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(0,m["default"])({force:!1,scope:"public_profile"},a),this.isSupported()){n.next=3;break}throw new p.KinveyError("Unable to login with "+this.identity+". It is not supported on this platform.");case 3:if(r=this.session,!r||!this.isOnline(r)){n.next=6;break}return n.abrupt("return",r);case 6:if(t){n.next=8;break}throw new p.KinveyError("Unable to login with "+this.identity+".  No client id was provided.");case 8:return o=new f.Promise(function(r,n){function o(e){var t=e.url;try{t&&0===t.indexOf(c)&&d===!1&&(d=!0,f.removeAllListeners(),f.close(),v(t))}catch(r){}}function u(e){var t=e.url;try{t&&0===t.indexOf(c)&&d===!1?(d=!0,f.removeAllListeners(),f.close(),v(t)):d===!1&&(f.removeAllListeners(),f.close(),n(new p.KinveyError(e.message,"",e.code)))}catch(r){}}function s(){d===!1&&(f.removeAllListeners(),n(new p.KinveyError("Facebook login has been cancelled.")))}var c=a.redirectUri||e.location.href,l=(0,h.randomString)(),f=new e.Kinvey.Popup,d=!1,v=function(e){var o=_["default"].parse(e),a=o.hash,u=g["default"].parse(a.substring(1)),s=u.access_token,c=u.expires_in,f=u.error,p=u.error_description,h=u.error_reason,d=u.state,v=parseInt(c,10),y=(new Date).getTime()/1e3+(v||31536e3);if(d===l)if(s){var m={access_token:s,expires_in:v,expires:y,client_id:t};i.session=m,r(m)}else f?(i.session=null,n({reason:h,error:f,description:p})):(i.session=null,n({reason:"not_authorized",error:"access_denied",description:"Your app is not authorized."}));else i.session=null,n({reason:"state_mismatch",error:"access_denied",description:"The state did not match."})};f.on("loadstart",o),f.on("loadstop",o),f.on("error",u),f.on("closed",s),f.open(_["default"].format({protocol:"https:",host:"www.facebook.com",pathname:"/dialog/oauth",query:{client_id:t,redirect_uri:c,response_type:"token",scope:a.scope,auth_type:a.force===!0?"rerequest":null,state:l}}))}),n.abrupt("return",o);case 10:case"end":return n.stop()}},n,this)}));return t}()},{key:"logout",value:function(){function e(){return t.apply(this,arguments)}var t=o(v["default"].mark(function r(){return v["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.session=null;case 1:case"end":return e.stop()}},r,this)}));return e}()},{key:"identity",get:function(){return l.SocialIdentity.Facebook}}],[{key:"identity",get:function(){return l.SocialIdentity.Facebook}}]),r}(c.Social)}).call(t,function(){return this}())},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Social=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(165),s=r(162),c=r(189),l=n(c),f=r(9),p=n(f),h=r(149),d=n(h),v=void 0;"undefined"!=typeof window&&(v=r(208));t.Social=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,t),this.client=e.client||u.Client.sharedInstance()}return a(t,[{key:"isSupported",value:function(){return!!v}},{key:"isOnline",value:function(e){var t=(new Date).getTime()/1e3;return e&&e.access_token&&e.expires>t}},{key:"login",value:function(){function t(e,t){return r.apply(this,arguments)}var r=o(p["default"].mark(function n(t){
var r,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return p["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(0,d["default"])({redirectUri:e.location.href,scope:null,force:null},i),this.isSupported()){n.next=3;break}throw new s.KinveyError("Unable to login with "+this.identity+". It is not supported on this platform.");case 3:if(r=this.session,!r||!this.isOnline(r)){n.next=6;break}return n.abrupt("return",r);case 6:if(t){n.next=8;break}throw new s.KinveyError("Unable to login with "+this.identity+".  No client id was provided.");case 8:return o={},o[this.identity]=t,v.init(o),n.next=13,v(this.identity).login({redirect_uri:i.redirectUri,scope:i.scope,force:i.force});case 13:return r=v(this.identity).getAuthResponse(),r.clientId=t,this.session=r,n.abrupt("return",r);case 17:case"end":return n.stop()}},n,this)}));return t}()},{key:"logout",value:function(){function e(){return t.apply(this,arguments)}var t=o(p["default"].mark(function r(){var e;return p["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isSupported()){t.next=6;break}return e={},e[this.identity]=this.session.clientId,v.init(e),t.next=6,v(this.identity).logout();case 6:this.session=null;case 7:case"end":return t.stop()}},r,this)}));return e}()},{key:"identity",get:function(){throw new s.KinveyError("A subclass must override this property.")}},{key:"session",get:function(){return l["default"].get(""+this.client.appKey+this.identity)},set:function(e){e?l["default"].set(""+this.client.appKey+this.identity,e):l["default"].remove(""+this.client.appKey+this.identity)}}],[{key:"login",value:function(e,t){var r=new this(t);return r.login(e,t)}},{key:"logout",value:function(e,t){var r=new this;return r.logout(e,t)}},{key:"identity",get:function(){throw new s.KinveyError("A subclass must override this property.")}}]),t}()}).call(t,function(){return this}())},function(e,t,r){var n;(function(o,i){Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,r){r=[];for(t in e)r.hasOwnProperty.call(e,t)&&r.push(t);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;o<r;o++)o in t&&e.call(n,t[o],o,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var r=[];return this.forEach(function(n,o,i){e.call(t||void 0,n,o,i)&&r.push(n)}),r}),Array.prototype.map||(Array.prototype.map=function(e,t){var r=[];return this.forEach(function(n,o,i){r.push(e.call(t||void 0,n,o,i))}),r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){function t(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=[].slice,n=r.call(arguments,1),o=this,i=function(){return o.apply(this instanceof t?this:e||window,n.concat(r.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});var a=function(e){return a.use(e)};a.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(Array.isArray(e)&&Array.isArray(t))Array.prototype.push.apply(e,t);else if(e instanceof Object&&t instanceof Object&&e!==t)for(var r in t)e[r]=a.utils.extend(e[r],t[r]);else Array.isArray(t)&&(t=t.slice(0)),e=t}),e}},a.utils.extend(a,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var r=this.utils;if(!e)return this.services;for(var n in e)e.hasOwnProperty(n)&&"object"!=typeof e[n]&&(e[n]={id:e[n]});return r.extend(this.services,e),t&&(r.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=r.url(t.redirect_uri).href)),this},login:function(){function e(e,t){a.emit(e,t)}function t(e){return e}function r(e){return!!e}var n,o=this,i=o.utils,u=i.error,s=i.Promise(),c=i.args({network:"s",options:"o",callback:"f"},arguments),l=i.diffKey(c.options,o.settings),f=c.options=i.merge(o.settings,c.options||{});if(f.popup=i.merge(o.settings.popup,c.options.popup||{}),c.network=c.network||o.settings.default_service,s.proxy.then(c.callback,c.callback),s.proxy.then(e.bind(this,"auth.login auth"),e.bind(this,"auth.failed auth")),"string"!=typeof c.network||!(c.network in o.services))return s.reject(u("invalid_network","The provided network was not recognized"));var p=o.services[c.network],h=i.globalEvent(function(e){var t;t=e?JSON.parse(e):u("cancelled","The authentication was not completed"),t.error?s.reject(t):(i.store(t.network,t),s.fulfill({network:t.network,authResponse:t}))}),d=i.url(f.redirect_uri).href,v=p.oauth.response_type||f.response_type;/\bcode\b/.test(v)&&!p.oauth.grant&&(v=v.replace(/\bcode\b/,"token")),c.qs=i.merge(l,{client_id:encodeURIComponent(p.id),response_type:encodeURIComponent(v),redirect_uri:encodeURIComponent(d),state:{client_id:p.id,network:c.network,display:f.display,callback:h,state:f.state,redirect_uri:d}});var y=i.store(c.network),m=/[,\s]+/,b=o.settings.scope?[o.settings.scope.toString()]:[],g=i.merge(o.settings.scope_map,p.scope||{});if(f.scope&&b.push(f.scope.toString()),y&&"scope"in y&&y.scope instanceof String&&b.push(y.scope),b=b.join(",").split(m),b=i.unique(b).filter(r),c.qs.state.scope=b.join(","),b=b.map(function(e){return e in g?g[e]:e}),b=b.join(",").split(m),b=i.unique(b).filter(r),c.qs.scope=b.join(p.scope_delim||","),f.force===!1&&y&&"access_token"in y&&y.access_token&&"expires"in y&&y.expires>(new Date).getTime()/1e3){var w=i.diff((y.scope||"").split(m),(c.qs.state.scope||"").split(m));if(0===w.length)return s.fulfill({unchanged:!0,network:c.network,authResponse:y}),s}if("page"===f.display&&f.page_uri&&(c.qs.state.page_uri=i.url(f.page_uri).href),"login"in p&&"function"==typeof p.login&&p.login(c),(!/\btoken\b/.test(v)||parseInt(p.oauth.version,10)<2||"none"===f.display&&p.oauth.grant&&y&&y.refresh_token)&&(c.qs.state.oauth=p.oauth,c.qs.state.oauth_proxy=f.oauth_proxy),c.qs.state=encodeURIComponent(JSON.stringify(c.qs.state)),1===parseInt(p.oauth.version,10)?n=i.qs(f.oauth_proxy,c.qs,t):"none"===f.display&&p.oauth.grant&&y&&y.refresh_token?(c.qs.refresh_token=y.refresh_token,n=i.qs(f.oauth_proxy,c.qs,t)):n=i.qs(p.oauth.auth,c.qs,t),e("auth.init",c),"none"===f.display)i.iframe(n,d);else if("popup"===f.display)var _=i.popup(n,d,f.popup),x=setInterval(function(){if((!_||_.closed)&&(clearInterval(x),!s.state)){var e=u("cancelled","Login has been cancelled");_||(e=u("blocked","Popup was blocked")),e.network=c.network,s.reject(e)}},100);else window.location=n;return s.proxy},logout:function(){function e(e,t){a.emit(e,t)}var t=this,r=t.utils,n=r.error,o=r.Promise(),i=r.args({name:"s",options:"o",callback:"f"},arguments);if(i.options=i.options||{},o.proxy.then(i.callback,i.callback),o.proxy.then(e.bind(this,"auth.logout auth"),e.bind(this,"error")),i.name=i.name||this.settings.default_service,i.authResponse=r.store(i.name),!i.name||i.name in t.services)if(i.name&&i.authResponse){var u=function(e){r.store(i.name,null),o.fulfill(a.utils.merge({network:i.name},e||{}))},s={};if(i.options.force){var c=t.services[i.name].logout;if(c)if("function"==typeof c&&(c=c(u,i)),"string"==typeof c)r.iframe(c),s.force=null,s.message="Logout success on providers site was indeterminate";else if(void 0===c)return o.proxy}u(s)}else o.reject(n("invalid_session","There was no session to remove"));else o.reject(n("invalid_network","The network was unrecognized"));return o.proxy},getAuthResponse:function(e){return e=e||this.settings.default_service,e&&e in this.services?this.utils.store(e)||null:null},events:{}}),a.utils.extend(a.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,r){if(t){r=r||encodeURIComponent;for(var n in t){var o="([\\?\\&])"+n+"=[^\\&]*",i=new RegExp(o);e.match(i)&&(e=e.replace(i,"$1"+n+"="+r(t[n])),delete t[n])}}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,r)},param:function(e,t){var r,n,o={};if("string"==typeof e){if(t=t||decodeURIComponent,n=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<n.length;i++)r=n[i].match(/([^=]+)=(.*)/),o[r[1]]=t(r[2]);return o}t=t||encodeURIComponent;var a=e;o=[];for(var u in a)a.hasOwnProperty(u)&&a.hasOwnProperty(u)&&o.push([u,"?"===a[u]?"?":t(a[u])].join("="));return o.join("&")},store:function(){function e(){var e={};try{e=JSON.parse(r.getItem("hello"))||{}}catch(t){}return e}function t(e){r.setItem("hello",JSON.stringify(e))}for(var r,n=["localStorage","sessionStorage"],o=-1,i="test";n[++o];)try{r=window[n[o]],r.setItem(i+o,o),r.removeItem(i+o);break}catch(a){r=null}if(!r){var u=null;r={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var n=t[r].replace(/(^\s+|\s+$)/,"");if(n&&0===n.indexOf(e))return n.substr(e.length)}return u},setItem:function(e,t){u=t,document.cookie=e+"="+t}},u=r.getItem("hello")}return function(r,n,o){var i=e();if(r&&void 0===n)return i[r]||null;if(r&&null===n)try{delete i[r]}catch(a){i[r]=null}else{if(!r)return i;i[r]=n}return t(i),i||null}}(),append:function(e,t,r){var n="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)r=t;else for(var o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(var i in t[o])t[o].hasOwnProperty(i)&&(n[o][i]=t[o][i]);else"html"===o?n.innerHTML=t[o]:/^on/.test(o)?n[o]=t[o]:n.setAttribute(o,t[o]);return"body"===r?!function a(){document.body?document.body.appendChild(n):setTimeout(a,16)}():"object"==typeof r?r.appendChild(n):"string"==typeof r&&document.getElementsByTagName(r)[0].appendChild(n),n},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var r={},n=0,o=null,i=null;for(i in e)if(e.hasOwnProperty(i))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[i])for(i in t[0])if(e.hasOwnProperty(i)&&i in e)return t[0];for(i in e)if(e.hasOwnProperty(i))if(o=typeof t[n],"function"==typeof e[i]&&e[i].test(t[n])||"string"==typeof e[i]&&(e[i].indexOf("s")>-1&&"string"===o||e[i].indexOf("o")>-1&&"object"===o||e[i].indexOf("i")>-1&&"number"===o||e[i].indexOf("a")>-1&&"object"===o||e[i].indexOf("f")>-1&&"function"===o))r[i]=t[n++];else if("string"==typeof e[i]&&e[i].indexOf("!")>-1)return!1;return r},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter(function(t){return e.indexOf(t)===-1})},diffKey:function(e,t){if(e||!t){var r={};for(var n in e)n in t||(r[n]=e[n]);return r}return e},unique:function(e){return Array.isArray(e)?e.filter(function(t,r){return e.indexOf(t)===r}):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var e=0,t=1,r=2,n=function(t){return this instanceof n?(this.id="Thenable/1.0.6",this.state=e,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new n(t)};n.prototype={fulfill:function(e){return a(this,t,"fulfillValue",e)},reject:function(e){return a(this,r,"rejectReason",e)},then:function(e,t){var r=this,o=new n;return r.onFulfilled.push(c(e,o,"fulfill")),r.onRejected.push(c(t,o,"reject")),u(r),o.proxy}};var a=function(t,r,n,o){return t.state===e&&(t.state=r,t[n]=o,u(t)),t},u=function(e){e.state===t?s(e,"onFulfilled",e.fulfillValue):e.state===r&&s(e,"onRejected",e.rejectReason)},s=function(e,t,r){if(0!==e[t].length){var n=e[t];e[t]=[];var a=function(){for(var e=0;e<n.length;e++)n[e](r)};"object"==typeof o&&"function"==typeof o.nextTick?o.nextTick(a):"function"==typeof i?i(a):setTimeout(a,0)}},c=function(e,t,r){return function(n){if("function"!=typeof e)t[r].call(t,n);else{var o;try{o=e(n)}catch(i){return void t.reject(i)}l(t,o)}}},l=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var r;if("object"==typeof t&&null!==t||"function"==typeof t)try{r=t.then}catch(n){return void e.reject(n)}if("function"!=typeof r)e.fulfill(t);else{var o=!1;try{r.call(t,function(r){o||(o=!0,r===t?e.reject(new TypeError("circular thenable chain")):l(e,r))},function(t){o||(o=!0,e.reject(t))})}catch(n){o||e.reject(n)}}};return n}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,r){if(r&&"function"==typeof r)for(var n=t.split(e),o=0;o<n.length;o++)this.events[n[o]]=[r].concat(this.events[n[o]]||[]);return this},this.off=function(e,t){return this.findEvents(e,function(e,r){t&&this.events[e][r]!==t||(this.events[e][r]=null)}),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var r=function(r,n){t[t.length-1]="*"===r?e:r,this.events[r][n].apply(this,t)},n=this;n&&n.findEvents;)n.findEvents(e+",*",r),n=n.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},0),this},this.findEvents=function(t,r){var n=t.split(e);for(var o in this.events)if(this.events.hasOwnProperty(o)&&n.indexOf(o)>-1)for(var i=0;i<this.events[o].length;i++)this.events[o][i]&&r.call(this,o,i)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(r){console.error(r)}},t},popup:function(e,t,r){var n=document.documentElement;if(r.height){var o=void 0!==window.screenTop?window.screenTop:screen.top,i=screen.height||window.innerHeight||n.clientHeight;r.top=parseInt((i-r.height)/2,10)+o}if(r.width){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,u=screen.width||window.innerWidth||n.clientWidth;r.left=parseInt((u-r.width)/2,10)+a}var s=[];Object.keys(r).forEach(function(e){var t=r[e];s.push(e+(null!==t?"="+t:""))}),navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e)));var c=window.open(e,"_blank",s.join(","));return c&&c.focus&&c.focus(),c},responseHandler:function(e,t){function r(e,t,r){var i=e.callback,u=e.network;if(a.store(u,e),!("display"in e&&"page"===e.display)){if(r&&i&&i in r){try{delete e.callback}catch(s){}a.store(u,e);var c=JSON.stringify(e);try{n(r,i)(c)}catch(s){}}o()}}function n(e,t){return 0!==t.indexOf("_hellojs_")?function(){throw"Could not execute callback "+t}:e[t]}function o(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(r){}e.addEventListener&&e.addEventListener("load",function(){e.close()})}}var i,a=this,u=e.location;if(i=a.param(u.search),i&&i.state&&(i.code||i.oauth_token)){var s=JSON.parse(i.state);i.redirect_uri=s.redirect_uri||u.href.replace(/[\?\#].*$/,"");var c=s.oauth_proxy+"?"+a.param(i);return void u.assign(c)}if(i=a.merge(a.param(u.search||""),a.param(u.hash||"")),i&&"state"in i){try{var l=JSON.parse(i.state);a.extend(i,l)}catch(f){console.error("Could not decode state parameter")}if("access_token"in i&&i.access_token&&i.network)i.expires_in&&0!==parseInt(i.expires_in,10)||(i.expires_in=0),i.expires_in=parseInt(i.expires_in,10),i.expires=(new Date).getTime()/1e3+(i.expires_in||31536e3),r(i,e,t);else if("error"in i&&i.error&&i.network)i.error={code:i.error,message:i.error_message||i.error_description},r(i,e,t);else if(i.callback&&i.callback in t){var p=!!("result"in i&&i.result)&&JSON.parse(i.result);n(t,i.callback)(p),o()}i.page_uri&&u.assign(i.page_uri)}else if("oauth_redirect"in i)return void u.assign(decodeURIComponent(i.oauth_redirect))}}),a.utils.Event.call(a),function(e){var t={},r={};e.on("auth.login, auth.logout",function(r){r&&"object"==typeof r&&r.network&&(t[r.network]=e.utils.store(r.network)||{})}),function n(){var o=(new Date).getTime()/1e3,i=function(t){e.emit("auth."+t,{network:a,authResponse:u})};for(var a in e.services)if(e.services.hasOwnProperty(a)){if(!e.services[a].id)continue;var u=e.utils.store(a)||{},s=e.services[a],c=t[a]||{};if(u&&"callback"in u){var l=u.callback;try{delete u.callback}catch(f){}e.utils.store(a,u);try{window[l](u)}catch(f){}}if(u&&"expires"in u&&u.expires<o){var p=s.refresh||u.refresh_token;!p||a in r&&!(r[a]<o)?p||a in r||(i("expired"),r[a]=!0):(e.emit("notice",a+" has expired trying to resignin"),e.login(a,{display:"none",force:!1}),r[a]=o+600);continue}if(c.access_token===u.access_token&&c.expires===u.expires)continue;!u.access_token&&c.access_token?i("logout"):u.access_token&&!c.access_token?i("login"):u.expires!==c.expires&&i("update"),t[a]=u,a in r&&delete r[a]}setTimeout(n,1e3)}()}(a),a.api=function(){function e(e){e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(e,t,r){var a=r?r.replace(/^\|/,""):"";return t in i.query?(a=i.query[t],delete i.query[t]):i.data&&t in i.data?(a=i.data[t],delete i.data[t]):r||o.reject(n("missing_attribute","The attribute "+t+" is missing from the request")),a}),e.match(/^https?:\/\//)||(e=c.base+e),i.url=e,r.request(i,function(e,t){if(!i.formatResponse)return void(("object"==typeof t?t.statusCode>=400:"object"==typeof e&&"error"in e)?o.reject(e):o.fulfill(e));if(e===!0?e={success:!0}:e||(e={}),"delete"===i.method&&(e=!e||r.isEmpty(e)?{success:!0}:e),c.wrap&&(i.path in c.wrap||"default"in c.wrap)){var n=i.path in c.wrap?i.path:"default",a=((new Date).getTime(),c.wrap[n](e,t,i));a&&(e=a)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=i.path+e.paging.next:e.paging.next+="#"+i.path),!e||"error"in e?o.reject(e):o.fulfill(e)})}var t=this,r=t.utils,n=r.error,o=r.Promise(),i=r.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);i.method=(i.method||"get").toLowerCase(),i.headers=i.headers||{},i.query=i.query||{},"get"!==i.method&&"delete"!==i.method||(r.extend(i.query,i.data),i.data={});var a=i.data=i.data||{};if(o.then(i.callback,i.callback),!i.path)return o.reject(n("invalid_path","Missing the path parameter from the request"));i.path=i.path.replace(/^\/+/,"");var u=(i.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(u in t.services){i.network=u;var s=new RegExp("^"+u+":?/?");i.path=i.path.replace(s,"")}i.network=t.settings.default_service=i.network||t.settings.default_service;var c=t.services[i.network];if(!c)return o.reject(n("invalid_network","Could not match the service requested: "+i.network));if(i.method in c&&i.path in c[i.method]&&c[i.method][i.path]===!1)return o.reject(n("invalid_path","The provided path is not available on the selected network"));i.oauth_proxy||(i.oauth_proxy=t.settings.oauth_proxy),"proxy"in i||(i.proxy=i.oauth_proxy&&c.oauth&&1===parseInt(c.oauth.version,10)),"timeout"in i||(i.timeout=t.settings.timeout),"formatResponse"in i||(i.formatResponse=!0),i.authResponse=t.getAuthResponse(i.network),i.authResponse&&i.authResponse.access_token&&(i.query.access_token=i.authResponse.access_token);var l,f=i.path;i.options=r.clone(i.query),i.data=r.clone(a);var p=c[{"delete":"del"}[i.method]||i.method]||{};if("get"===i.method){var h=f.split(/[\?#]/)[1];h&&(r.extend(i.query,r.param(h)),f=f.replace(/\?.*?(#|$)/,"$1"))}return(l=f.match(/#(.+)/,""))?(f=f.split("#")[0],i.path=l[1]):f in p?(i.path=f,f=p[f]):"default"in p&&(f=p["default"]),i.redirect_uri=t.settings.redirect_uri,i.xhr=c.xhr,i.jsonp=c.jsonp,i.form=c.form,"function"==typeof f?f(i,e):e(f),o.proxy},a.utils.extend(a.utils,{request:function(e,t){function r(e,t){var r;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(r=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(n.extend(e.query,e.data),e.data=null);var o=n.qs(e.url,e.query);e.proxy&&(o=n.qs(e.oauth_proxy,{path:o,access_token:r||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:!0})),t(o)}var n=this,o=n.error;n.isEmpty(e.data)||"FileList"in window||!n.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1);var i=this.request_cors(function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))});if(i)return void r(e,function(r){var o=n.xhr(e.method,r,e.headers,e.data,t);o.onprogress=e.onprogress||null,o.upload&&e.onuploadprogress&&(o.upload.onprogress=e.onuploadprogress)});var a=e.query;if(e.query=n.clone(e.query),e.callbackID=n.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void r(e,function(r){n.jsonp(r,t,e.callbackID,e.timeout)});e.query=a}if(e.form!==!1){e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID});var u;if("function"==typeof e.form&&(u=e.form(e,e.query)),"post"===e.method&&u!==!1)return void r(e,function(r){n.post(r,e.data,u,t,e.callbackID,e.timeout)})}t(o("invalid_request","There was no mechanism for handling this request"))},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var r="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return!!t&&(window[r]?t instanceof window[r]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e)},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var r in e)t[r]=this.clone(e[r]);return t},xhr:function(e,t,r,n,o){function i(e){for(var t,r={},n=/([a-z\-]+):\s?(.*);?/gi;t=n.exec(e);)r[t[1]]=t[2];return r}var a=new XMLHttpRequest,u=this.error,s=!1;"blob"===e&&(s=e,e="GET"),e=e.toUpperCase(),a.onload=function(t){var r=a.response;try{r=JSON.parse(a.responseText)}catch(n){401===a.status&&(r=u("access_denied",a.statusText))}var s=i(a.getAllResponseHeaders());s.statusCode=a.status,o(r||("GET"===e?u("empty_response","Could not get resource"):{}),s)},a.onerror=function(e){var t=a.responseText;try{t=JSON.parse(a.responseText)}catch(r){}o(t||u("access_denied","Could not get resource"))};var c;if("GET"===e||"DELETE"===e)n=null;else if(n&&"string"!=typeof n&&!(n instanceof FormData)&&!(n instanceof File)&&!(n instanceof Blob)){var l=new FormData;for(c in n)n.hasOwnProperty(c)&&(n[c]instanceof HTMLInputElement?"files"in n[c]&&n[c].files.length>0&&l.append(c,n[c].files[0]):n[c]instanceof Blob?l.append(c,n[c],n.name):l.append(c,n[c]));n=l}if(a.open(e,t,!0),s&&("responseType"in a?a.responseType=s:a.overrideMimeType("text/plain; charset=x-user-defined")),r)for(c in r)a.setRequestHeader(c,r[c]);return a.send(n),a},jsonp:function(e,t,r,n){var o,i=this,a=i.error,u=0,s=document.getElementsByTagName("head")[0],c=a("server_error","server_error"),l=function(){u++||window.setTimeout(function(){t(c),s.removeChild(f)},0)};r=i.globalEvent(function(e){return c=e,!0},r),e=e.replace(new RegExp("=\\?(&|$)"),"="+r+"$1");var f=i.append("script",{id:r,name:r,src:e,async:!0,onload:l,onerror:l,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&l()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(o=i.append("script",{text:"document.getElementById('"+r+"').onerror();"}),f.async=!1),n&&window.setTimeout(function(){c=a("timeout","timeout"),l()},n),s.appendChild(f),o&&s.appendChild(o)},post:function(e,t,r,n,o,i){var a,u=this,s=u.error,c=document,l=null,f=[],p=0,h=null,d=0,v=function(e){d++||n(e)};u.globalEvent(v,o);var y;try{y=c.createElement('<iframe name="'+o+'">')}catch(m){y=c.createElement("iframe")}if(y.name=o,y.id=o,y.style.display="none",r&&r.callbackonload&&(y.onload=function(){v({response:"posted",message:"Content was posted"})}),i&&setTimeout(function(){v(s("timeout","The post operation timed out"))},i),c.body.appendChild(y),u.domInstance("form",t)){for(l=t.form,p=0;p<l.elements.length;p++)l.elements[p]!==t&&l.elements[p].setAttribute("disabled",!0);t=l}if(u.domInstance("form",t))for(l=t,p=0;p<l.elements.length;p++)l.elements[p].disabled||"file"!==l.elements[p].type||(l.encoding=l.enctype="multipart/form-data",l.elements[p].setAttribute("name","file"));else{for(h in t)t.hasOwnProperty(h)&&u.domInstance("input",t[h])&&"file"===t[h].type&&(l=t[h].form,l.encoding=l.enctype="multipart/form-data");l||(l=c.createElement("form"),c.body.appendChild(l),a=l);var b;for(h in t)if(t.hasOwnProperty(h)){var g=u.domInstance("input",t[h])||u.domInstance("textArea",t[h])||u.domInstance("select",t[h]);if(g&&t[h].form===l)g&&t[h].name!==h&&(t[h].setAttribute("name",h),t[h].name=h);else{var w=l.elements[h];if(b)for(w instanceof NodeList||(w=[w]),p=0;p<w.length;p++)w[p].parentNode.removeChild(w[p]);b=c.createElement("input"),b.setAttribute("type","hidden"),b.setAttribute("name",h),g?b.value=t[h].value:u.domInstance(null,t[h])?b.value=t[h].innerHTML||t[h].innerText:b.value=t[h],l.appendChild(b)}}for(p=0;p<l.elements.length;p++)b=l.elements[p],b.name in t||b.getAttribute("disabled")===!0||(b.setAttribute("disabled",!0),f.push(b))}l.setAttribute("method","POST"),l.setAttribute("target",o),l.target=o,l.setAttribute("action",e),setTimeout(function(){l.submit(),setTimeout(function(){try{a&&a.parentNode.removeChild(a)}catch(e){try{console.error("HelloJS: could not remove iframe")}catch(t){}}for(var r=0;r<f.length;r++)f[r]&&(f[r].setAttribute("disabled",!1),f[r].disabled=!1)},0)},100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,r=e.match(t);if(!r)return e;for(var n=atob(e.replace(t,"")),o=[],i=0;i<n.length;i++)o.push(n.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:r[1]})}}),function(e){var t=e.api,r=e.utils;r.extend(r,{dataToJSON:function(e){var t=this,r=window,n=e.data;if(t.domInstance("form",n)?n=t.nodeListToJSON(n.elements):"NodeList"in r&&n instanceof NodeList?n=t.nodeListToJSON(n):t.domInstance("input",n)&&(n=t.nodeListToJSON([n])),("File"in r&&n instanceof r.File||"Blob"in r&&n instanceof r.Blob||"FileList"in r&&n instanceof r.FileList)&&(n={file:n}),!("FormData"in r&&n instanceof r.FormData))for(var o in n)if(n.hasOwnProperty(o))if("FileList"in r&&n[o]instanceof r.FileList)1===n[o].length&&(n[o]=n[o][0]);else{if(t.domInstance("input",n[o])&&"file"===n[o].type)continue;t.domInstance("input",n[o])||t.domInstance("select",n[o])||t.domInstance("textArea",n[o])?n[o]=n[o].value:t.domInstance(null,n[o])&&(n[o]=n[o].innerHTML||n[o].innerText)}return e.data=n,n},nodeListToJSON:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];!n.disabled&&n.name&&("file"===n.type?t[n.name]=n:t[n.name]=n.value||n.innerHTML)}return t}}),e.api=function(){var e=r.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&r.dataToJSON(e),t.call(this,e)}}(a),a.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function e(t,r){var n={closed:!1};return chrome.identity.launchWebAuthFlow({url:t,interactive:r},function(t){if(void 0===t)return void(n.closed=!0);var r=a.utils.url(t),o={location:{assign:function(t){e(t,!1)},search:r.search,hash:r.hash,href:r.href},close:function(){}};a.utils.responseHandler(o,window)}),n}a.utils.popup=function(t){return e(t,!0)},a.utils.iframe=function(t){e(t,!1)},a.utils.request_cors=function(e){return e(),!0};var t={};chrome.storage.local.get("hello",function(e){t=e.hello||{}}),a.utils.store=function(e,r){return 0===arguments.length?t:1===arguments.length?t[e]||null:r?(t[e]=r,chrome.storage.local.set({hello:t}),r):null===r?(delete t[e],chrome.storage.local.set({hello:t}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){a.utils.iframe=function(e,t){a.utils.popup(e,t,{hidden:"yes"})};var e=a.utils.popup;a.utils.popup=function(t,r,n){var o=e.call(this,t,r,n);try{if(o&&o.addEventListener){var i=a.utils.url(r),u=i.origin||i.protocol+"//"+i.hostname;o.addEventListener("loadstart",function(e){var t=e.url;if(0===t.indexOf(u)){var r=a.utils.url(t),n={location:{assign:function(e){o.executeScript({code:'window.location.href = "'+e+';"'})},search:r.search,hash:r.hash,href:r.href},close:function(){if(o.close){o.close();try{o.closed=!0}catch(e){}}}};a.utils.responseHandler(n,window)}})}}catch(s){}return o}}}(),function(e){function t(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function r(t,r,n){if(!("object"!=typeof t||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var o=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");o=o.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=n.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+o+"?format=jpeg&size=m")+"&access_token="+n.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=o.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+o)+"&access_token="+n.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+o),t.id||(t.id=t.path.replace(/^\//,""))}}function n(e){return function(t,r){delete t.query.limit,r(e)}}var o={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},i={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};e.init({dropbox:{name:"Dropbox",oauth:i,login:function(t){t.qs.scope="";var r=decodeURIComponent(t.qs.redirect_uri);0===r.indexOf("http:")&&0!==r.indexOf("http://localhost/")?e.services.dropbox.oauth=o:e.services.dropbox.oauth=i,t.options.popup.width=1e3,t.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":n("metadata/auto/@{parent|}"),"me/folder":n("metadata/auto/@{id}"),"me/folders":n("metadata/auto/"),"default":function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,r){var n=t.data.parent,o=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),r("https://api-content.dropbox.com/1/files_put/auto/"+n+"/"+o);
},"me/folders":function(t,r){var n=t.data.name;t.data={},r("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:n}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(t(e),!e.uid)return e;e.name=e.display_name;var r=e.name.split(" ");return e.first_name=r.shift(),e.last_name=r.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},"default":function(e,n,o){return t(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach(function(t){t.root=e.root,r(t,n,o)})),r(e,n,o),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(a),function(e){function t(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function r(e){return"data"in e&&e.data.forEach(t),e}function n(e,t,r){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var n=r.query.access_token;if(!(e.data instanceof Array)){var i=e.data;delete e.data,e.data=[i]}e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort(function(e,t){return e.width-t.width}),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=o+e.cover_photo.id+"/picture?access_token="+n),"album"===e.type&&(e.files=e.photos=o+e.id+"/photos"),e.can_upload&&(e.upload_location=o+e.id+"/photos")})}return e}e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!0,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.qs.display=e.options.display||"popup"},logout:function(t,r){var n=e.utils.globalEvent(t),o=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:n,result:JSON.stringify({force:!0}),state:"{}"})),i=(r.authResponse||{}).access_token;if(e.utils.iframe("https://www.facebook.com/logout.php?next="+o+"&access_token="+i),!i)return!1},base:"https://graph.facebook.com/v2.4/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:t,"me/friends":r,"me/following":r,"me/followers":r,"me/albums":n,"me/photos":n,"me/files":n,"default":n},xhr:function(t,r){return"get"!==t.method&&"post"!==t.method||(r.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,r){var n=t.method;"get"===n||e.utils.hasBinary(t.data)?"delete"===t.method&&(r.method="delete",t.method="post"):(t.data.method=n,t.method="get")},form:function(e){return{callbackonload:!0}}}});var o="https://graph.facebook.com/"}(a),function(e){function t(t,r,n){var o=(n?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var i in r)r.hasOwnProperty(i)&&(o+="&"+i+"="+r[i]);return o}function r(t){var r=e.getAuthResponse("flickr");t(r&&r.user_nsid?r.user_nsid:null)}function n(e,n){return n||(n={}),function(o,i){r(function(r){n.user_id=r,i(t(e,n,!0))})}}function o(e,t){var r="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(r="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),r}function i(e,t,r,n,o){return o=o?"_"+o:"","https://farm"+t+".staticflickr.com/"+r+"/"+e+"_"+n+o+".jpg"}function a(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function u(e){if(e.photoset||e.photos){var t="photoset"in e?"photoset":"photos";e=c(e,t),f(e),e.data=e.photo,delete e.photo;for(var r=0;r<e.data.length;r++){var n=e.data[r];n.name=n.title,n.picture=i(n.id,n.farm,n.server,n.secret,""),n.pictures=s(n.id,n.farm,n.server,n.secret),n.source=i(n.id,n.farm,n.server,n.secret,"b"),n.thumbnail=i(n.id,n.farm,n.server,n.secret,"m")}}return e}function s(e,t,r,n){var o=2048,a=[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:o}];return a.map(function(o){return{source:i(e,t,r,n,o.id),width:o.max,height:o.max}})}function c(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function l(e){if(a(e),e.contacts){e=c(e,"contacts"),f(e),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var r=e.data[t];r.id=r.nsid,r.name=r.realname||r.username,r.thumbnail=o(r,"m")}}return e}function f(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:n("flickr.people.getInfo"),"me/friends":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":n("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":n("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":n("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(a(e),e=c(e,"person"),e.id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=o(e,"l"),e.picture=o(e,"l")}return e},"me/friends":l,"me/followers":l,"me/following":l,"me/albums":function(e){return a(e),e=c(e,"photosets"),f(e),e.photoset&&(e.data=e.photoset,e.data.forEach(function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)}),delete e.photoset),e},"me/photos":function(e){return a(e),u(e)},"default":function(e){return a(e),u(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(a),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function r(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function n(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&(e=e.response.user,r(e)),e},"default":function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(r),delete e.response),e}},xhr:n,jsonp:n}})}(a),function(e){function t(e,t){var r=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;401!==r&&403!==r||(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function r(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}function n(e,t,r){if(e.data&&e.data.length&&t&&t.Link){var n=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);n&&(e.paging={next:n[1]})}}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,n){return t(e,n),r(e),e},"default":function(e,o,i){return t(e,o),Array.isArray(e)&&(e={data:e}),e.data&&(n(e,o,i),e.data.forEach(r)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(a),function(e){function t(e){return parseInt(e,10)}function r(e){return l(e),e.data=e.items,delete e.items,e}function n(e){if(!e.error)return e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e}function o(e){return{source:e.url,width:e.width,height:e.height}}function i(e){e.data=e.feed.entry.map(c),delete e.feed}function a(e){if(l(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(c),delete e.feed;else{if("entry"in e)return c(e.entry);"items"in e?(e.data=e.items.map(n),delete e.items):n(e)}return e}function u(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function s(e,t,r){l(e);if("feed"in e&&"entry"in e.feed){for(var n=r.query.access_token,o=0;o<e.feed.entry.length;o++){var i=e.feed.entry[o];if(i.id=i.id.$t,i.name=i.title.$t,delete i.title,i.gd$email&&(i.email=i.gd$email&&i.gd$email.length>0?i.gd$email[0].address:null,i.emails=i.gd$email,delete i.gd$email),i.updated&&(i.updated=i.updated.$t),i.link){var a=i.link.length>0?i.link[0].href:null;a&&i.link[0].gd$etag&&(a+=(a.indexOf("?")>-1?"&":"?")+"access_token="+n,i.picture=a,i.thumbnail=a),delete i.link}i.category&&delete i.category}e.data=e.feed.entry,delete e.feed}return e}function c(e){var t,r=e.media$group,n=r.media$content.length?r.media$content[0]:{},i=r.media$content||[],a=r.media$thumbnail||[],u=i.concat(a).map(o).sort(function(e,t){return e.width-t.width}),s=0,c={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:n?n.url:null,pictures:u,images:[],thumbnail:n?n.url:null,width:n.width,height:n.height};if("link"in e)for(s=0;s<e.link.length;s++){var l=e.link[s];if(l.rel.match(/\#feed$/)){c.upload_location=c.files=c.photos=l.href;break}}if("category"in e&&e.category.length)for(t=e.category,s=0;s<t.length;s++)t[s].scheme&&t[s].scheme.match(/\#kind$/)&&(c.type=t[s].term.replace(/^.*?\#/,""));return"media$thumbnail"in r&&r.media$thumbnail.length&&(t=r.media$thumbnail,c.thumbnail=t[0].url,c.images=t.map(o)),t=r.media$content,t&&t.length&&c.images.push(o(t[0])),c}function l(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var r=t(e.feed.openSearch$itemsPerPage.$t),n=t(e.feed.openSearch$startIndex.$t),o=t(e.feed.openSearch$totalResults.$t);n+r<o&&(e.paging={next:"?start="+(n+r)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function f(){function e(e){var r=new FileReader;r.onload=function(r){t(btoa(r.target.result),e.type+i+"Content-Transfer-Encoding: base64")},r.readAsBinaryString(e)}function t(e,t){r.push(i+"Content-Type: "+t+i+i+e),o--,u()}var r=[],n=(1e10*Math.random()).toString(32),o=0,i="\r\n",a=i+"--"+n,u=function(){},s=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;this.append=function(r,n){"string"!=typeof r&&"length"in Object(r)||(r=[r]);for(var a=0;a<r.length;a++){o++;var u=r[a];if("undefined"!=typeof File&&u instanceof File||"undefined"!=typeof Blob&&u instanceof Blob)e(u);else if("string"==typeof u&&u.match(s)){var c=u.match(s);t(u.replace(s,""),c[1]+i+"Content-Transfer-Encoding: base64")}else t(u,n)}},this.onready=function(e){(u=function(){0===o&&(r.unshift(""),r.push("--"),e(r.join(a),n),r=[])})()}}function p(e,t){var r={};e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(r=e.data,e.data={},r.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),r.file&&(e.data.file=r.file),r.name&&(e.data.title=r.name));var n;if("file"in e.data&&(n=e.data.file,delete e.data.file,"object"==typeof n&&"files"in n&&(n=n.files),!n||!n.length))return void t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}});var o=new f;o.append(JSON.stringify(e.data),"application/json"),n&&o.append(n),o.onready(function(n,o){e.headers["content-type"]='multipart/related; boundary="'+o+'"',e.data=n,t("upload/drive/v2/files"+(r.id?"/"+r.id:"")+"?uploadType=multipart")})}function h(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}var d="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";e.init({google:{name:"Google Plus",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},scope:{basic:"https://www.googleapis.com/auth/plus.me profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",friends:"https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"code"===e.qs.response_type&&(e.qs.access_type="offline"),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"plus/v1/people/me","me/friends":"plus/v1/people/me/people/visible?maxResults=@{limit|100}","me/following":d,"me/followers":d,"me/contacts":d,"me/share":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/feed":"plus/v1/people/me/activities/public?maxResults=@{limit|100}","me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var r=e.query.id;delete e.query.id,t(r.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":p,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":p},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),u(e)),e},"me/friends":function(e){return e.items&&(l(e),e.data=e.items,e.data.forEach(u),delete e.items),e},"me/contacts":s,"me/followers":s,"me/following":s,"me/share":r,"me/feed":r,"me/albums":a,"me/photos":i,"default":a},xhr:function(t){return"post"===t.method||"put"===t.method?h(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(a),function(e){function t(e){return{source:e.url,width:e.width,height:e.height}}function r(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function n(e){return i(e),e&&"data"in e&&e.data.forEach(o),e}function o(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function i(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var r=e.data.id;e.data={},t("media/"+r+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return r(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":n,"me/following":n,"me/followers":n,"me/photos":function(e){return r(e),i(e),"data"in e&&(e.data=e.data.filter(function(e){return"image"===e.type}),e.data.forEach(function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map(function(r){var n=e.images[r];return t(n)}).sort(function(e,t){return e.width-t.width})})),e},"default":function(e){return e=r(e),i(e),e}},xhr:function(e,t){var r=e.method,n="get"!==r;return n&&("post"!==r&&"put"!==r||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=n),n},form:!1}})}(a),function(e){function t(e,t){var r,o;return e&&"Message"in e&&(o=e.Message,delete e.Message,"ErrorCode"in e?(r=e.ErrorCode,delete e.ErrorCode):r=n(t),e.error={code:r,message:o,details:e}),e}function r(e,t){var r=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+r,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),"put"===e.method&&(e.method="patch"),!0}function n(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:return"server_error";default:return"server_error"}}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var r=e.data.meetingId;e.data={},t("meetings/"+r+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,r){return t(e,r),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},"default":function(e,r){return t(e,r),e}},xhr:r}})}(a),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function r(e){if(!e.error)return e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e}function n(e){return t(e),o(e),e.values&&(e.data=e.values.map(r),delete e.values),e}function o(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function i(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}function a(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function u(e,t){e.headers["x-li-format"]="json";var r=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+r+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var r={visibility:{code:"anyone"}};e.data.id?r.attribution={share:{id:e.data.id}}:(r.comment=e.data.message,e.data.picture&&e.data.link&&(r.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(r),t("people/~/shares?format=json")},"me/like":u},del:{"me/like":u},wrap:{me:function(e){return t(e),r(e),e},"me/friends":n,"me/following":n,"me/followers":n,"me/share":function(e){return t(e),o(e),e.values&&(e.data=e.values.map(r),e.data.forEach(function(e){e.message=e.headline}),delete e.values),e},"default":function(e,r){t(e),i(e,r),o(e)}},jsonp:function(e,t){a(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method&&(a(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0)}}})}(a),function(e){function t(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t["_status_code_map[302]"]=200,!0}function r(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}function n(e){"next_href"in e&&(e.paging={next:e.next_href})}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json","default":function(e,t){t(e.path+".json")}},wrap:{me:function(e){return r(e),e},"default":function(e){return Array.isArray(e)&&(e={data:e.map(r)}),n(e),e}},xhr:t,jsonp:t}})}(a),function(e){function t(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function r(e){return n(e),o(e),e.users&&(e.data=e.users.map(t),delete e.users),e}function n(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function o(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}function i(e){return Array.isArray(e)?{data:e}:e}var a="https://api.twitter.com/";e.init({twitter:{oauth:{version:"1.0a",auth:a+"oauth/authenticate",request:a+"oauth/request_token",token:a+"oauth/access_token"},login:function(e){var t="?force_login=true";this.oauth.auth=this.oauth.auth.replace(t,"")+(e.options.force?t:"")},base:a+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,r){var n=t.data;t.data=null;var o=[];n.message&&(o.push(n.message),delete n.message),n.link&&(o.push(n.link),delete n.link),n.picture&&(o.push(n.picture),delete n.picture),o.length&&(n.status=o.join(" ")),n.file?(n["media[]"]=n.file,delete n.file,t.data=n,r("statuses/update_with_media.json")):"id"in n?r("statuses/retweet/"+n.id+".json"):(e.utils.extend(t.query,n),r("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var r=e.data.id;e.data=null,t("favorites/create.json?id="+r)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return n(e),t(e),e},"me/friends":r,"me/followers":r,"me/following":r,"me/share":function(e){return n(e),o(e),!e.error&&"length"in e?{data:e}:e},"default":function(e){return e=i(e),o(e),e}},xhr:function(e){return"get"!==e.method}}})}(a),function(e){function t(e,t){return null!==e&&"response"in e&&null!==e.response&&e.response.length&&(e=e.response[0],e.id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email)),e}function r(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,n,o){return r(e),t(e,o)}},xhr:!1,jsonp:!0,form:!1}})}(a),function(e){function t(e){return"data"in e&&e.data.forEach(function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(r).sort(function(e,t){return e.width-t.width}))}),e}function r(e){return{width:e.width,height:e.height,source:e.source}}function n(e){return"data"in e&&e.data.forEach(function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}),e}function o(e,t,r){if(e.id){var n=r.query.access_token;if(e.emails&&(e.email=e.emails.preferred),e.is_friend!==!1){var o=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+o+"/picture?access_token="+n}}return e}function i(e,t,r){return"data"in e&&e.data.forEach(function(e){o(e,t,r)}),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:o,"me/friends":i,"me/contacts":i,"me/followers":i,"me/following":i,"me/albums":n,"me/photos":t,"default":t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(a),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function r(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){e=e.query.results.profile,e.id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var r=[];e.first_name&&r.push(e.first_name),e.last_name&&r.push(e.last_name),e.name=r.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e}function n(e,r,n){t(e),i(e,r,n);return e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(o)),e}function o(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach(function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)})}function i(e,t,r){return e.query&&e.query.count&&r.options&&(e.paging={next:"?start="+(e.query.count+(+r.options.start||1))}),e}function a(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:a("select * from social.profile(0) where guid=me"),"me/friends":a("select * from social.contacts(0) where guid=me"),"me/following":a("select * from social.contacts(0) where guid=me")},wrap:{me:r,"me/friends":n,"me/following":n,"default":i}}})}(a),n=function(){return a}.call(t,r,t,e),!(void 0!==n&&(e.exports=n)),"object"==typeof e&&e.exports&&(e.exports=a)}).call(t,r(11),r(209).setImmediate)},function(e,t,r){(function(e,n){function o(e,t){this._id=e,this._clearFn=t}var i=r(11).nextTick,a=Function.prototype.apply,u=Array.prototype.slice,s={},c=0;t.setTimeout=function(){return new o(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var r=c++,n=!(arguments.length<2)&&u.call(arguments,1);return s[r]=!0,i(function(){s[r]&&(n?e.apply(null,n):e.call(null),t.clearImmediate(r))}),r},t.clearImmediate="function"==typeof n?n:function(e){delete s[e]}}).call(t,r(209).setImmediate,r(209).clearImmediate)},function(e,t,r){var n;(function(e,o,i){(function(){"use strict";function a(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function s(e){J=e}function c(e){ee=e}function l(){return function(){
e.nextTick(v)}}function f(){return function(){G(v)}}function p(){var e=0,t=new ne(v),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function h(){var e=new MessageChannel;return e.port1.onmessage=v,function(){e.port2.postMessage(0)}}function d(){return function(){setTimeout(v,1)}}function v(){for(var e=0;e<Z;e+=2){var t=ae[e],r=ae[e+1];t(r),ae[e]=void 0,ae[e+1]=void 0}Z=0}function y(){try{var e=r(211);return G=e.runOnLoop||e.runOnContext,f()}catch(t){return d()}}function m(e,t){var r=this,n=new this.constructor(g);void 0===n[ce]&&K(n);var o=r._state;if(o){var i=arguments[o-1];ee(function(){M(o,n,i,r._result)})}else R(r,n,e,t);return n}function b(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(g);return P(r,e),r}function g(){}function w(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function x(e){try{return e.then}catch(t){return he.error=t,he}}function k(e,t,r,n){try{e.call(t,r,n)}catch(o){return o}}function O(e,t,r){ee(function(e){var n=!1,o=k(r,t,function(r){n||(n=!0,t!==r?P(e,r):T(e,r))},function(t){n||(n=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&o&&(n=!0,A(e,o))},e)}function j(e,t){t._state===fe?T(e,t._result):t._state===pe?A(e,t._result):R(t,void 0,function(t){P(e,t)},function(t){A(e,t)})}function E(e,t,r){t.constructor===e.constructor&&r===ue&&constructor.resolve===se?j(e,t):r===he?A(e,he.error):void 0===r?T(e,t):u(r)?O(e,t,r):T(e,t)}function P(e,t){e===t?A(e,w()):a(t)?E(e,t,x(t)):T(e,t)}function S(e){e._onerror&&e._onerror(e._result),I(e)}function T(e,t){e._state===le&&(e._result=t,e._state=fe,0!==e._subscribers.length&&ee(I,e))}function A(e,t){e._state===le&&(e._state=pe,e._result=t,ee(S,e))}function R(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+fe]=r,o[i+pe]=n,0===i&&e._state&&ee(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,o,i=e._result,a=0;a<t.length;a+=3)n=t[a],o=t[a+r],n?M(r,n,o,i):o(i);e._subscribers.length=0}}function q(){this.error=null}function C(e,t){try{return e(t)}catch(r){return de.error=r,de}}function M(e,t,r,n){var o,i,a,s,c=u(r);if(c){if(o=C(r,n),o===de?(s=!0,i=o.error,o=null):a=!0,t===o)return void A(t,_())}else o=n,a=!0;t._state!==le||(c&&a?P(t,o):s?A(t,i):e===fe?T(t,o):e===pe&&A(t,o))}function N(e,t){try{t(function(t){P(e,t)},function(t){A(e,t)})}catch(r){A(e,r)}}function L(){return ve++}function K(e){e[ce]=ve++,e._state=void 0,e._result=void 0,e._subscribers=[]}function U(e){return new we(this,e).promise}function D(e){var t=this;return new t(X(e)?function(r,n){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(r,n)}:function(e,t){t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,r=new t(g);return A(r,e),r}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function $(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(e){this[ce]=L(),this._result=this._state=void 0,this._subscribers=[],g!==e&&("function"!=typeof e&&F(),this instanceof H?N(this,e):$())}function Y(e,t){this._instanceConstructor=e,this.promise=new e(g),this.promise[ce]||K(this.promise),X(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):A(this.promise,V())}function V(){return new Error("Array Methods must be provided an Array")}function z(){var e;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=e.Promise;r&&"[object Promise]"===Object.prototype.toString.call(r.resolve())&&!r.cast||(e.Promise=ge)}var Q;Q=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G,J,W,X=Q,Z=0,ee=function(e,t){ae[Z]=e,ae[Z+1]=t,Z+=2,2===Z&&(J?J(v):W())},te="undefined"!=typeof window?window:void 0,re=te||{},ne=re.MutationObserver||re.WebKitMutationObserver,oe="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),ie="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ae=new Array(1e3);W=oe?l():ne?p():ie?h():void 0===te?y():d();var ue=m,se=b,ce=Math.random().toString(36).substring(16),le=void 0,fe=1,pe=2,he=new q,de=new q,ve=0,ye=U,me=D,be=B,ge=H;H.all=ye,H.race=me,H.resolve=se,H.reject=be,H._setScheduler=s,H._setAsap=c,H._asap=ee,H.prototype={constructor:H,then:ue,"catch":function(e){return this.then(null,e)}};var we=Y;Y.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===le&&r<e;r++)this._eachEntry(t[r],r)},Y.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===se){var o=x(e);if(o===ue&&e._state!==le)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===ge){var i=new r(g);E(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){t(e)}),t)}else this._willSettleAt(n(e),t)},Y.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===le&&(this._remaining--,e===pe?A(n,r):this._result[t]=r),0===this._remaining&&T(n,this._result)},Y.prototype._willSettleAt=function(e,t){var r=this;R(e,void 0,function(e){r._settledAt(fe,t,e)},function(e){r._settledAt(pe,t,e)})};var _e=z,xe={Promise:ge,polyfill:_e};r(212).amd?(n=function(){return xe}.call(t,r,t,i),!(void 0!==n&&(i.exports=n))):"undefined"!=typeof i&&i.exports?i.exports=xe:"undefined"!=typeof this&&(this.ES6Promise=xe),_e()}).call(this)}).call(t,r(11),function(){return this}(),r(96)(e))},function(e,t){},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Google=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(207),s=r(205);t.Google=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"identity",get:function(){return s.SocialIdentity.Google}}],[{key:"identity",get:function(){return s.SocialIdentity.Google}}]),t}(u.Social)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedIn=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(207),s=r(205);t.LinkedIn=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"identity",get:function(){return s.SocialIdentity.LinkedIn}}],[{key:"identity",get:function(){return s.SocialIdentity.LinkedIn}}]),t}(u.Social)},function(e,t,r){(function(e,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new d.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):d.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnect=t.AuthorizationGrant=void 0;var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(207),f=r(205),p=r(135),h=r(162),d=r(210),v=r(9),y=o(v),m=r(216),b=o(m),g=r(147),w=o(g),_=r(158),x=o(_),k=e.env.KINVEY_MIC_AUTH_PATHNAME||"/oauth/auth",O=e.env.KINVEY_MIC_TOKEN_PATHNAME||"/oauth/token",j=e.env.KINVEY_MIC_INVALIDATE_PATHNAME||"/oauth/invalidate",E={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(E),t.AuthorizationGrant=E;t.MobileIdentityConnect=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"login",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?E.AuthorizationCodeLoginPage:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],o=this.client.appKey,i=d.Promise.resolve().then(function(){if(r===E.AuthorizationCodeLoginPage)return t.requestCodeWithPopup(o,e,n);if(r===E.AuthorizationCodeAPI)return t.requestTempLoginUrl(o,e,n).then(function(r){return t.requestCodeWithUrl(r,o,e,n)});throw new h.KinveyError("The authorization grant "+r+" is unsupported. Please use a supported authorization grant.")}).then(function(r){return t.requestToken(r,o,e,n)}).then(function(r){return r.client_id=o,r.redirect_uri=e,r.protocol=t.client.micProtocol,r.host=t.client.micHost,r});return i}},{key:"requestTempLoginUrl",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n="/";if(r.version){var o=r.version;(0,x["default"])(o)||(o=String(o)),n=b["default"].join(n,0===o.indexOf("v")?o:"v"+o)}var i=new p.KinveyRequest({method:p.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:w["default"].format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:b["default"].join(n,k)}),properties:r.properties,body:{client_id:e,redirect_uri:t,response_type:"code"}});return i.execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function(e,t){var r=this,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],i=d.Promise.resolve().then(function(){var i="/";if(o.version){var a=o.version;(0,x["default"])(a)||(a=String(a)),i=b["default"].join(i,0===a.indexOf("v")?a:"v"+a)}if(n.Kinvey.Popup){var u=new n.Kinvey.Popup;return u.open(w["default"].format({protocol:r.client.micProtocol,host:r.client.micHost,pathname:b["default"].join(i,k),query:{client_id:e,redirect_uri:t,response_type:"code"}}))}throw new h.KinveyError("Kinvey.Popup is undefined."+(" Unable to login using authorization grant "+E.AuthorizationCodeLoginPage+"."))}).then(function(e){var r=new d.Promise(function(r,n){function o(n){try{n.url&&0===n.url.indexOf(t)&&u===!1&&(u=!0,e.removeAllListeners(),e.close(),r(w["default"].parse(n.url,!0).query.code))}catch(o){}}function i(o){try{o.url&&0===o.url.indexOf(t)&&u===!1?(u=!0,e.removeAllListeners(),e.close(),r(w["default"].parse(o.url,!0).query.code)):u===!1&&(e.removeAllListeners(),e.close(),n(new h.KinveyError(o.message,"",o.code)))}catch(i){}}function a(){u===!1&&(e.removeAllListeners(),n(new h.KinveyError("Login has been cancelled.")))}var u=!1;e.on("loadstart",o),e.on("loadstop",o),e.on("error",i),e.on("closed",a)});return r});return i}},{key:"requestCodeWithUrl",value:function(e,t,r){var n=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=d.Promise.resolve().then(function(){var o=new p.KinveyRequest({method:p.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:e,properties:n.properties,body:{client_id:t,redirect_uri:r,response_type:"code",username:n.username,password:n.password},followRedirect:!1});return o.execute()}).then(function(e){var t=e.getHeader("location");if(t)return w["default"].parse(t,!0).query.code;throw new h.KinveyError("Unable to authorize user with username "+n.username+".","A location header was not provided with a code to exchange for an auth token.")});return o}},{key:"requestToken",value:function(e,t,r){var n=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],o=new p.KinveyRequest({method:p.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:p.AuthType.App,url:w["default"].format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:O}),properties:n.properties,body:{grant_type:"authorization_code",client_id:t,redirect_uri:r,code:e}}),i=o.execute().then(function(e){return e.data});return i}},{key:"logout",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(y["default"].mark(function r(e){var t,n,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return y["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=new p.KinveyRequest({method:p.RequestMethod.GET,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:p.AuthType.App,url:w["default"].format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:j,query:{user:e._id}}),properties:o.properties}),r.next=3,t.execute();case 3:return n=r.sent,r.abrupt("return",n.data);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"identity",get:function(){return f.SocialIdentity.MobileIdentityConnect}}],[{key:"identity",get:function(){return f.SocialIdentity.MobileIdentityConnect}}]),t}(l.Social)}).call(t,r(11),function(){return this}())},function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,o="/"===a.charAt(0))}return t=r(n(t.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+t||"."},t.normalize=function(e){var o=t.isAbsolute(e),i="/"===a(e,-1);return e=r(n(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var o=n(e.split("/")),i=n(r.split("/")),a=Math.min(o.length,i.length),u=a,s=0;s<a;s++)if(o[s]!==i[s]){u=s;break}for(var c=[],s=u;s<o.length;s++)c.push("..");return c=c.concat(i.slice(u)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(t,r(11))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Windows=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(207),s=r(205);t.Windows=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"identity",get:function(){return s.SocialIdentity.Windows}}],[{key:"identity",get:function(){return s.SocialIdentity.Windows}}]),t}(u.Social)},function(e,t,r){function n(e){if(u(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||i(e)))return!e.length;var t=o(e);if(t==f||t==p)return!e.size;if(y||c(e))return!l(e).length;for(var r in e)if(d.call(e,r))return!1;return!0}var o=r(86),i=r(75),a=r(80),u=r(77),s=r(219),c=r(83),l=r(84),f="[object Map]",p="[object Set]",h=Object.prototype,d=h.hasOwnProperty,v=h.propertyIsEnumerable,y=!v.call({valueOf:1},"valueOf");e.exports=n},function(e,t,r){(function(e){var n=r(40),o=r(220),i="object"==typeof t&&t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,u=a&&a.exports===i,s=u?n.Buffer:void 0,c=s?s.isBuffer:void 0,l=c||o;e.exports=l}).call(t,r(96)(e))},function(e,t){function r(){return!1}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Query=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(162),s=r(166),c=r(222),l=n(c),f=r(149),p=n(f),h=r(80),d=n(h),v=r(159),y=n(v),m=r(158),b=n(m),g=r(36),w=n(g),_=r(223),x=n(_),k=r(218),O=n(k),j=r(156),E=n(j),P=r(225),S=n(P),T=["$nearSphere"],A=function(){function e(t){o(this,e),t=(0,p["default"])({fields:[],filter:{},sort:{},limit:null,skip:0},t),this.fields=t.fields,this.filter=t.filter,this.sort=t.sort,this.limit=t.limit,this.skip=t.skip,this._parent=null}return a(e,[{key:"isSupportedOffline",value:function(){var e=this,t=!0;return(0,E["default"])(T,function(r){return t=!(0,S["default"])(e.filter,r)}),t}},{key:"equalTo",value:function(e,t){return this.addFilter(e,"$eq",t)}},{key:"contains",value:function(e,t){return(0,d["default"])(t)||(t=[t]),this.addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){return(0,d["default"])(t)||(t=[t]),this.addFilter(e,"$all",t)}},{key:"greaterThan",value:function(e,t){if(!(0,y["default"])(t)&&!(0,b["default"])(t))throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){if(!(0,y["default"])(t)&&!(0,b["default"])(t))throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){if(!(0,y["default"])(t)&&!(0,b["default"])(t))throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){if(!(0,y["default"])(t)&&!(0,b["default"])(t))throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$lte",t)}},{key:"notEqualTo",value:function(e,t){return this.addFilter(e,"$ne",t)}},{key:"notContainedIn",value:function(e,t){return(0,d["default"])(t)||(t=[t]),this.addFilter(e,"$nin",t)}},{key:"and",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.join("$and",t)}},{key:"nor",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._parent&&this._parent.filter.$and?this._parent.nor.apply(this._parent,t):this.join("$nor",t)}},{key:"or",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._parent?this._parent.or.apply(this._parent,t):this.join("$or",t)}},{key:"exists",value:function(e,t){return t="undefined"==typeof t||(t||!1),this.addFilter(e,"$exists",t)}},{key:"mod",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];if((0,b["default"])(t)&&(t=parseFloat(t)),(0,b["default"])(r)&&(r=parseFloat(r)),!(0,y["default"])(t))throw new u.QueryError("divisor must be a number");if(!(0,y["default"])(r))throw new u.QueryError("remainder must be a number");return this.addFilter(e,"$mod",[t,r])}},{key:"matches",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if((0,x["default"])(t)||(t=new RegExp(t)),(t.ignoreCase||r.ignoreCase)&&r.ignoreCase!==!1)throw new u.QueryError("ignoreCase glag is not supported.");if(0!==t.source.indexOf("^"))throw new u.QueryError("regExp must have `^` at the beginning of the expression to make it an anchored expression.");var n=[];(t.multiline||r.multiline)&&r.multiline!==!1&&n.push("m"),r.extended&&n.push("x"),r.dotMatchesAll&&n.push("s");var o=this.addFilter(e,"$regex",t.source);return n.length&&this.addFilter(e,"$options",n.join("")),o}},{key:"near",value:function(e,t,r){if(!(0,d["default"])(t)||!(0,y["default"])(t[0])||!(0,y["default"])(t[1]))throw new u.QueryError("coord must be a [number, number]");var n=this.addFilter(e,"$nearSphere",[t[0],t[1]]);return r&&this.addFilter(e,"$maxDistance",r),n}},{key:"withinBox",value:function(e,t,r){if(!(0,d["default"])(t)||!t[0]||!t[1])throw new u.QueryError("bottomLeftCoord must be a [number, number]");if(!(0,d["default"])(r)||!r[0]||!r[1])throw new u.QueryError("upperRightCoord must be a [number, number]");t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1]);var n=[[t[0],t[1]],[r[0],r[1]]];return this.addFilter(e,"$within",{$box:n})}},{key:"withinPolygon",value:function(e,t){if(!(0,d["default"])(t)||t.length>3)throw new u.QueryError("coords must be [[number, number]]");return t=t.map(function(e){if(!e[0]||!e[1])throw new u.QueryError("coords argument must be [number, number]");return[parseFloat(e[0]),parseFloat(e[1])]}),this.addFilter(e,"$within",{$polygon:t})}},{key:"size",value:function(e,t){if((0,b["default"])(t)&&(t=parseFloat(t)),!(0,y["default"])(t))throw new u.QueryError("size must be a number");return this.addFilter(e,"$size",t)}},{key:"ascending",value:function(e){return this._parent?this._parent.ascending(e):this.sort[e]=1,this}},{key:"descending",value:function(e){return this._parent?this._parent.descending(e):this.sort[e]=-1,this}},{key:"addFilter",value:function(e,t,r){return(0,w["default"])(this.filter[e])||(this.filter[e]={}),this.filter[e][t]=r,this}},{key:"join",value:function(t,r){var n=this,o=this,i={};r=r.map(function(t){if(!(t instanceof e)){if(!(0,w["default"])(t))throw new u.QueryError("query argument must be of type: Kinvey.Query[] or Object[].");t=new e(t)}return t.toJSON().filter}),0===r.length&&(o=new e,r=[o.toJSON().filter],o.parent=this);var a=Object.keys(this.filter);return(0,E["default"])(a,function(e){i[e]=n.filter[e],delete n.filter[e]}),this.filter[t]=[i].concat(r),o}},{key:"process",value:function(e){var t=this;if(this.isSupportedOffline()===!1&&!function(){var e="This query is not able to run locally. The following filters are not supported locally:";throw(0,E["default"])(T,function(t){e=e+" "+t}),new u.QueryError(e)}(),e){var r=function(){if(!(0,d["default"])(e))throw new u.QueryError("data argument must be of type: Array.");var r=t.toJSON();return e=(0,l["default"])(r.filter,e),r.fields&&r.fields.length>0&&(e=e.map(function(e){var t=Object.keys(e);return(0,E["default"])(t,function(t){r.fields.indexOf(t)===-1&&delete e[t]}),e})),e=e.sort(function(e,t){var n=Object.keys(r.sort);return(0,E["default"])(n,function(n){var o=(0,s.nested)(e,n),i=(0,s.nested)(t,n);if(o&&!i)return-1;if(i&&!o)return 1;if(o!==i){var a=r.sort[n];return(o<i?-1:1)*a}return 0}),0}),r.limit?{v:e.slice(r.skip,r.skip+r.limit)}:{v:e.slice(r.skip)}}();if("object"===("undefined"==typeof r?"undefined":i(r)))return r.v}return e}},{key:"toPlainObject",value:function(){if(this._parent)return this._parent.toPlainObject();var e={fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit};return e}},{key:"toJSON",value:function(){return this.toPlainObject()}},{key:"toQueryString",value:function(){var e={};(0,O["default"])(this.filter)||(e.query=this.filter),(0,O["default"])(this.fields)||(e.fields=this.fields.join(",")),this.limit&&(e.limit=this.limit),this.skip>0&&(e.skip=this.skip),(0,O["default"])(this.sort)||(e.sort=this.sort);var t=Object.keys(e);return(0,E["default"])(t,function(t){e[t]=(0,b["default"])(e[t])?e[t]:JSON.stringify(e[t])}),e}},{key:"toString",value:function(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function(){return this._fields},set:function(e){if(e=e||[],!(0,d["default"])(e))throw new u.QueryError("fields must be an Array");this._parent?this._parent.fields=e:this._fields=e}},{key:"filter",get:function(){return this._filter},set:function(e){this._filter=e}},{key:"sort",get:function(){return this._sort},set:function(e){if(e&&!(0,w["default"])(e))throw new u.QueryError("sort must an Object");this._parent?this._parent.sort(e):this._sort=e||{}}},{key:"limit",get:function(){return this._limit},set:function(e){if((0,b["default"])(e)&&(e=parseFloat(e)),e&&!(0,y["default"])(e))throw new u.QueryError("limit must be a number");this._parent?this._parent.limit=e:this._limit=e}},{key:"skip",get:function(){return this._skip},set:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if((0,b["default"])(e)&&(e=parseFloat(e)),!(0,y["default"])(e))throw new u.QueryError("skip must be a number");this._parent?this._parent.skip(e):this._skip=e}}]),e}();t.Query=A},function(e,t){!function(){"use strict";function t(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date?e.getTime():e instanceof Array?e.map(n):e}function o(e,t){return e.get?e.get(t):e[t]}function i(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var i=0,a=n.length;i<a;i++)if(e(t,o(n,i)))return!0;return!1}}function a(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var i=0,a=n.length;i<a;i++)if(!e(t,o(n,i)))return!1;return!0}}function u(e,t){return e.v(e.a,t)}function s(e,t){for(var r=0;r<e.length;r++)if(u(t,o(e,r)))return r;return-1}function c(e,t){return{a:e,v:t}}function l(e,t){var r=[];return f(t,e.k,0,r),1===r.length?u(e.nv,r[0]):!!~s(r,e.nv)}function f(e,t,n,i){if(n===t.length||void 0==e)return void i.push(e);var a=o(t,n);if(r(e)&&isNaN(Number(a)))for(var u=0,s=e.length;u<s;u++)f(o(e,u),t,n,i);else f(o(e,a),t,n+1,i)}function p(e,t){return{a:{k:e,nv:t},v:l}}function h(e){e=n(e),(!e||"Object"!==e.constructor.toString()&&"functionObject(){[nativecode]}"!==e.constructor.toString().replace(/\n/g,"").replace(/ /g,""))&&(e={$eq:e});var t=[];for(var r in e){var o=e[r];if("$options"!==r)if(y[r])m[r]&&(o=m[r](o,e)),t.push(c(n(o),y[r]));else{if(36===r.charCodeAt(0))throw new Error("Unknown operation "+r);t.push(p(r.split("."),h(o)))}}return 1===t.length?t[0]:c(t,y.$and)}function d(e,t){var r=h(e);return t&&(r={a:r,v:function(e,r){return u(e,t(r))}}),r}function v(e,r,n){function o(e){return u(i,e)}t(r)&&(n=r,r=void 0);var i=d(e,n);return r?r.filter(o):o}var y={$eq:i(function(e,t){return e(t)}),$ne:a(function(e,t){return!e(t)}),$or:function(e,t){for(var r=0,n=e.length;r<n;r++)if(u(o(e,r),t))return!0;return!1},$gt:i(function(e,t){return v.compare(n(t),e)>0}),$gte:i(function(e,t){return v.compare(n(t),e)>=0}),$lt:i(function(e,t){return v.compare(n(t),e)<0}),$lte:i(function(e,t){return v.compare(n(t),e)<=0}),$mod:i(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(!(t instanceof Array))return!!~e.indexOf(n(t));for(var r=t.length;r--;)if(~e.indexOf(n(o(t,r))))return!0;return!1},$nin:function(e,t){return!y.$in(e,t)},$not:function(e,t){return!u(e,t)},$type:function(e,t){return void 0!=t&&(t instanceof e||t.constructor==e)},$all:function(e,t){t||(t=[]);for(var r=e.length;r--;)if(!~n(t).indexOf(o(e,r)))return!1;return!0},$size:function(e,t){return!!t&&e===t.length},$nor:function(e,t){for(var r=0,n=e.length;r<n;r++)if(u(o(e,r),t))return!1;return!0},$and:function(e,t){for(var r=0,n=e.length;r<n;r++)if(!u(o(e,r),t))return!1;return!0},$regex:i(function(e,t){return"string"==typeof t&&e.test(t)}),$where:function(e,t){return e.call(t,t)},$elemMatch:function(e,t){return r(t)?!!~s(t,e):u(e,t)},$exists:function(e,t){return void 0!=t===e}},m={$eq:function(e){return e instanceof RegExp?function(t){return"string"==typeof t&&e.test(t)}:e instanceof Function?e:r(e)&&!e.length?function(e){return r(e)&&!e.length}:null===e?function(e){return null==e}:function(t){return 0===v.compare(n(t),e)}},$ne:function(e){return m.$eq(e)},$and:function(e){return e.map(h)},$or:function(e){return e.map(h)},$nor:function(e){return e.map(h)},$not:function(e){return h(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return"string"==typeof e?new Function("obj","return "+e):e},$elemMatch:function(e){return h(e)},$exists:function(e){return!!e}};v.use=function(e){if(t(e))return e(v);for(var r in e)36===r.charCodeAt(0)&&(y[r]=e[r])},v.indexOf=function(e,t,r){return s(t,d(e,r))},v.compare=function(e,t){if(e===t)return 0;if(typeof e==typeof t){if(e>t)return 1;if(e<t)return-1}},"undefined"!=typeof e&&"undefined"!=typeof e.exports&&(e.exports=v),"undefined"!=typeof window&&(window.sift=v)}()},function(e,t,r){var n=r(224),o=r(94),i=r(95),a=i&&i.isRegExp,u=a?o(a):n;e.exports=u},function(e,t,r){function n(e){return o(e)&&u.call(e)==i}var o=r(36),i="[object RegExp]",a=Object.prototype,u=a.toString;e.exports=n},function(e,t,r){function n(e,t){return o(e,a(t,3),i)}var o=r(226),i=r(124),a=r(15);e.exports=n},function(e,t){function r(e,t,r){var n;return r(e,function(e,r,o){if(t(e,r,o))return n=r,!1}),n}e.exports=r},function(e,t,r){var n=r(228),o=n(function(e,t,r){e[r]=t;
});e.exports=o},function(e,t,r){function n(e,t){return function(r,n){var s=u(r)?o:i,c=t?t():{};return s(r,e,a(n,2),c)}}var o=r(229),i=r(230),a=r(15),u=r(80);e.exports=n},function(e,t){function r(e,t,r,n){for(var o=-1,i=e?e.length:0;++o<i;){var a=e[o];t(n,a,r(a),e)}return n}e.exports=r},function(e,t,r){function n(e,t,r,n){return o(e,function(e,o,i){t(n,e,r(e),i)}),n}var o=r(123);e.exports=n},function(e,t,r){function n(e,t,r){t=a(t,e)?[t]:o(t);var n=-1,s=t.length;for(s||(e=void 0,s=1);++n<s;){var c=null==e?void 0:e[u(t[n])];void 0===c&&(n=s,c=r),e=i(c)?c.call(e):c}return e}var o=r(103),i=r(35),a=r(109),u=r(110);e.exports=n},function(e,t,r){function n(e){return e?o(e,i(e)):[]}var o=r(233),i=r(72);e.exports=n},function(e,t,r){function n(e,t){return o(t,function(t){return e[t]})}var o=r(234);e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}e.exports=r},function(e,t,r){function n(e,t){var r=u(e)?o:a;return r(e,i(t,3))}var o=r(234),i=r(15),a=r(236),u=r(80);e.exports=n},function(e,t,r){function n(e,t){var r=-1,n=i(e)?Array(e.length):[];return o(e,function(e,o,i){n[++r]=t(e,o,i)}),n}var o=r(123),i=r(77);e.exports=n},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new p.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):p.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncManager=t.SyncOperation=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(135),c=r(162),l=r(165),f=r(221),p=r(210),h=r(9),d=n(h),v=r(147),y=n(v),m=r(235),b=n(m),g=r(231),w=n(g),_=r(80),x=n(_),k=r(158),O=n(k),j=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",E=e.env.KINVEY_SYNC_COLLECTION_NAME||"kinvey_sync",P=e.env.KINVEY_ID_ATTRIBUTE||"_id",S={Create:s.RequestMethod.POST,Update:s.RequestMethod.PUT,Delete:s.RequestMethod.DELETE};Object.freeze(S),t.SyncOperation=S;t.SyncManager=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(i(this,e),!t)throw new c.SyncError("A collection is required.");if(!(0,O["default"])(t))throw new c.SyncError("Collection must be a string.");this.collection=t,this.client=r.client||l.Client.sharedInstance()}return u(e,[{key:"find",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){var e,t,n=arguments.length<=0||void 0===arguments[0]?new f.Query:arguments[0],o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],n instanceof f.Query||(n=new f.Query((0,w["default"])(n,"toJSON",n))),n.equalTo("collection",this.collection),t=new s.CacheRequest({method:s.RequestMethod.GET,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:o.properties,query:n,timeout:o.timeout,client:this.client}),r.next=6,t.execute().then(function(e){return e.data});case 6:return e=r.sent,r.abrupt("return",e);case 8:case"end":return r.stop()}},r,this)}));return e}()},{key:"count",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){var e,t=arguments.length<=0||void 0===arguments[0]?new f.Query:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(t,n);case 2:return e=r.sent,r.abrupt("return",e.length);case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"addCreateOperation",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.addOperation(S.Create,e,t));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"addUpdateOperation",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.addOperation(S.Update,e,t));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"addDeleteOperation",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.addOperation(S.Delete,e,t));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"addOperation",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){var e,t=arguments.length<=0||void 0===arguments[0]?S.Create:arguments[0],n=this,i=arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=!1,(0,x["default"])(i)||(e=!0,i=[i]),r.next=4,p.Promise.all((0,b["default"])(i,function(){var e=o(d["default"].mark(function r(e){var o,i,u,l,p,h,v;return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return",null);case 2:if(o=e[P]){r.next=5;break}throw new c.SyncError("An entity is missing an _id. All entities must have an _id in order to be added to the sync table.",e);case 5:return i=(new f.Query).equalTo("entityId",o),u=new s.CacheRequest({method:s.RequestMethod.GET,url:y["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:n.pathname}),properties:a.properties,query:i,timeout:a.timeout}),r.next=9,u.execute();case 9:return l=r.sent,p=l.data,h=1===p.length?p[0]:{collection:n.collection,state:{},entityId:o},h.state=h.state||{},h.state.method=t,v=new s.CacheRequest({method:s.RequestMethod.PUT,url:y["default"].format({protocol:n.client.protocol,host:n.client.host,pathname:n.pathname}),properties:a.properties,body:h,timeout:a.timeout}),r.abrupt("return",v.execute());case 16:case"end":return r.stop()}},r,n)}));return function(t){return e.apply(this,arguments)}}()));case 4:return r.abrupt("return",e?i[0]:i);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"pull",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t,n,o,i,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||e instanceof f.Query){r.next=2;break}throw new c.SyncError("Invalid query. It must be an instance of the Query class.");case 2:return r.next=4,this.count();case 4:if(t=r.sent,!(t>0)){r.next=11;break}return r.next=8,this.push();case 8:return r.next=10,this.count();case 10:t=r.sent;case 11:if(!(t>0)){r.next=13;break}throw new c.SyncError("Unable to pull data from the network."+(" There are "+t+" entities that need")+" to be synced before data is loaded from the network.");case 13:return n={method:s.RequestMethod.GET,authType:s.AuthType.Default,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.backendPathname,query:a.query}),properties:a.properties,query:e,timeout:a.timeout,client:this.client},o=new s.KinveyRequest(n),a.useDeltaFetch===!0&&(o=new s.DeltaFetchRequest(n)),r.next=18,o.execute();case 18:return i=r.sent,r.abrupt("return",i.data);case 20:case"end":return r.stop()}},r,this)}));return e}()},{key:"push",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t,n,i,u,l=this,f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=100,n=0,r.next=4,this.find(e);case 4:if(i=r.sent,!(i.length>0)){r.next=9;break}if(u=function(){var e=function(){var r=o(d["default"].mark(function a(r){var u;return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return u=new p.Promise(function(){var a=o(d["default"].mark(function u(a){var h,v;return d["default"].wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return h=i.slice(n,n+t),n+=t,u.next=4,p.Promise.all((0,b["default"])(h,function(e){var t=e.entityId,r=e.state,n=r.method;if(n===s.RequestMethod.DELETE){var i=new s.KinveyRequest({method:s.RequestMethod.DELETE,authType:s.AuthType.Default,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,client:l.client});return i.execute().then(function(){var t=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.pathname+"/"+e[P]}),properties:f.properties,timeout:f.timeout});return t.execute()}).then(function(){var e={_id:t};return e})["catch"](function(){var r=o(d["default"].mark(function n(r){var o,i,a,u;return d["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r instanceof c.InsufficientCredentialsError)){n.next=16;break}return n.prev=1,o=new s.KinveyRequest({method:s.RequestMethod.GET,authType:s.AuthType.Default,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,client:l.client}),n.next=5,o.execute().then(function(e){return e.data});case 5:return i=n.sent,a=new s.CacheRequest({method:s.RequestMethod.PUT,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,body:i}),n.next=9,a.execute();case 9:return u=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.pathname+"/"+e[P]}),properties:f.properties,timeout:f.timeout}),n.next=12,u.execute();case 12:n.next=16;break;case 14:n.prev=14,n.t0=n["catch"](1);case 16:return n.abrupt("return",{_id:t,error:r});case 17:case"end":return n.stop()}},n,l,[[1,14]])}));return function(e){return r.apply(this,arguments)}}())}if(n===s.RequestMethod.POST||n===s.RequestMethod.PUT){var a=new s.CacheRequest({method:s.RequestMethod.GET,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout});return a.execute().then(function(r){var i=r.data,a=new s.KinveyRequest({method:n,authType:s.AuthType.Default,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,body:i,client:l.client});return n===s.RequestMethod.POST&&(delete i[P],a.method=s.RequestMethod.POST,a.url=y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname}),a.body=i),a.execute().then(function(e){return e.data}).then(function(){var r=o(d["default"].mark(function i(r){var o,a,u;return d["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.pathname+"/"+e[P]}),properties:f.properties,timeout:f.timeout}),i.next=3,o.execute();case 3:return a=new s.CacheRequest({method:s.RequestMethod.PUT,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+r[P]}),properties:f.properties,timeout:f.timeout,body:r}),i.next=6,a.execute().then(function(e){return e.data});case 6:if(r=i.sent,n!==s.RequestMethod.POST){i.next=11;break}return u=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout}),i.next=11,u.execute();case 11:return i.abrupt("return",{_id:t,entity:r});case 12:case"end":return i.stop()}},i,l)}));return function(e){return r.apply(this,arguments)}}())["catch"](function(){var r=o(d["default"].mark(function a(r){var o,u,p,h;return d["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(r instanceof c.InsufficientCredentialsError)){a.next=17;break}if(a.prev=1,n===s.RequestMethod.POST){a.next=13;break}return o=new s.KinveyRequest({method:s.RequestMethod.GET,authType:s.AuthType.Default,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,client:l.client}),a.next=6,o.execute().then(function(e){return e.data});case 6:return u=a.sent,p=new s.CacheRequest({method:s.RequestMethod.PUT,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.backendPathname+"/"+t}),properties:f.properties,timeout:f.timeout,body:u}),a.next=10,p.execute();case 10:return h=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:l.client.protocol,host:l.client.host,pathname:l.pathname+"/"+e[P]}),properties:f.properties,timeout:f.timeout}),a.next=13,h.execute();case 13:a.next=17;break;case 15:a.prev=15,a.t0=a["catch"](1);case 17:return a.abrupt("return",{_id:t,entity:i,error:r});case 18:case"end":return a.stop()}},a,l,[[1,15]])}));return function(e){return r.apply(this,arguments)}}())})["catch"](function(e){return{_id:t,entity:void 0,error:e}})}return{_id:t,entity:void 0,error:new c.SyncError("Unable to sync the entity since the method was not recognized.",e)}}));case 4:if(v=u.sent,r=r.concat(v),!(n<i.length)){u.next=8;break}return u.abrupt("return",a(e(r)));case 8:return u.abrupt("return",a(r));case 9:case"end":return u.stop()}},u,l)}));return function(e){return a.apply(this,arguments)}}()),a.abrupt("return",u);case 2:case"end":return a.stop()}},a,l)}));return function(e){return r.apply(this,arguments)}}();return{v:e([])}}(),"object"!==("undefined"==typeof u?"undefined":a(u))){r.next=9;break}return r.abrupt("return",u.v);case 9:return r.abrupt("return",[]);case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"sync",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t,n,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.push(null,o);case 2:return t=r.sent,r.next=5,this.pull(e,o);case 5:return n=r.sent,r.abrupt("return",{push:t,pull:n});case 7:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){var e,t,n,o,i,a=arguments.length<=0||void 0===arguments[0]?new f.Query:arguments[0],u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a instanceof f.Query||(a=new f.Query(a)),a.equalTo("collection",this.collection),e=new s.CacheRequest({method:s.RequestMethod.GET,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:u.properties,query:a,timeout:u.timeout}),r.next=5,e.execute();case 5:return t=r.sent,n=t.data,o=new s.CacheRequest({method:s.RequestMethod.DELETE,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:u.properties,body:n,timeout:u.timeout}),r.next=10,o.execute();case 10:return i=r.sent,r.abrupt("return",i.data);case 12:case"end":return r.stop()}},r,this)}));return e}()},{key:"pathname",get:function(){return"/"+j+"/"+this.client.appKey+"/"+E}},{key:"backendPathname",get:function(){return"/"+j+"/"+this.client.appKey+"/"+this.collection}}]),e}()}).call(t,r(11))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(239);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var o=r(264);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=r(265);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Acl=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(162),u=r(240),s=n(u),c=r(160),l=n(c),f=e.env.KINVEY_ACL_ATTRIBUTE||"_acl";t.Acl=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),!(0,l["default"])(t))throw new a.KinveyError("entity argument must be an object");this.acl=(0,s["default"])(t[f])}return i(e,[{key:"addReader",value:function(e){var t=this.acl.r||[];return t.indexOf(e)===-1&&t.push(e),this.acl.r=t,this}},{key:"addReaderGroup",value:function(e){var t=this.acl.groups||{},r=t.r||[];return r.indexOf(e)===-1&&r.push(e),t.r=r,this.acl.groups=t,this}},{key:"addWriter",value:function(e){var t=this.acl.w||[];return t.indexOf(e)===-1&&t.push(e),this.acl.w=t,this}},{key:"addWriterGroup",value:function(e){var t=this.acl.groups||{},r=t.w||[];return r.indexOf(e)===-1&&r.push(e),t.w=r,this.acl.groups=t,this}},{key:"isGloballyReadable",value:function(){return this.acl.gr||!1}},{key:"isGloballyWritable",value:function(){return this.acl.gw||!1}},{key:"removeReader",value:function(e){var t=this.acl.r||[],r=t.indexOf(e);return r!==-1&&t.splice(r,1),this.acl.r=t,this}},{key:"removeReaderGroup",value:function(e){var t=this.acl.groups||{},r=t.r||[],n=r.indexOf(e);return n!==-1&&r.splice(n,1),t.r=r,this.acl.groups=t,this}},{key:"removeWriter",value:function(e){var t=this.acl.w||[],r=t.indexOf(e);return r!==-1&&t.splice(r,1),this.acl.w=t,this}},{key:"removeWriterGroup",value:function(e){var t=this.acl.groups||{},r=t.w||[],n=r.indexOf(e);return n!==-1&&r.splice(n,1),t.w=r,this.acl.groups=t,this}},{key:"toPlainObject",value:function(){return this.acl}},{key:"toJSON",value:function(){return this.toPlainObject()}},{key:"creator",get:function(){return this.acl.creator}},{key:"readers",get:function(){return this.acl.r||[]}},{key:"writers",get:function(){return this.acl.w||[]}},{key:"readerGroups",get:function(){return this.acl.groups?this.acl.groups.r:[]}},{key:"writerGroups",get:function(){return this.acl.groups?this.acl.groups.w:[]}},{key:"globallyReadable",set:function(e){this.acl.gr=e||!1}},{key:"globallyWritable",set:function(e){this.acl.gw=e||!1}}]),e}()}).call(t,r(11))},function(e,t,r){function n(e){return o(e,!1,!0)}var o=r(241);e.exports=n},function(e,t,r){function n(e,t,r,x,k,O,j){var S;if(x&&(S=O?x(e,k,O,j):x(e)),void 0!==S)return S;if(!g(e))return e;var T=y(e);if(T){if(S=h(e),!t)return c(e,S)}else{var R=p(e),I=R==E||R==P;if(m(e))return s(e,t);if(R==A||R==_||I&&!O){if(b(e))return O?e:{};if(S=v(I?{}:e),!t)return l(e,u(S,e))}else{if(!z[R])return O?e:{};S=d(e,R,n,t)}}j||(j=new o);var q=j.get(e);if(q)return q;if(j.set(e,S),!T)var C=r?f(e):w(e);return i(C||e,function(o,i){C&&(i=o,o=e[i]),a(S,i,n(o,t,r,x,i,e,j))}),S}var o=r(18),i=r(157),a=r(150),u=r(242),s=r(243),c=r(244),l=r(245),f=r(248),p=r(86),h=r(251),d=r(252),v=r(262),y=r(80),m=r(219),b=r(37),g=r(36),w=r(72),_="[object Arguments]",x="[object Array]",k="[object Boolean]",O="[object Date]",j="[object Error]",E="[object Function]",P="[object GeneratorFunction]",S="[object Map]",T="[object Number]",A="[object Object]",R="[object RegExp]",I="[object Set]",q="[object String]",C="[object Symbol]",M="[object WeakMap]",N="[object ArrayBuffer]",L="[object DataView]",K="[object Float32Array]",U="[object Float64Array]",D="[object Int8Array]",B="[object Int16Array]",F="[object Int32Array]",$="[object Uint8Array]",H="[object Uint8ClampedArray]",Y="[object Uint16Array]",V="[object Uint32Array]",z={};z[_]=z[x]=z[N]=z[L]=z[k]=z[O]=z[K]=z[U]=z[D]=z[B]=z[F]=z[S]=z[T]=z[A]=z[R]=z[I]=z[q]=z[C]=z[$]=z[H]=z[Y]=z[V]=!0,z[j]=z[E]=z[M]=!1,e.exports=n},function(e,t,r){function n(e,t){return e&&o(t,i(t),e)}var o=r(151),i=r(72);e.exports=n},function(e,t){function r(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}e.exports=r},function(e,t){function r(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}e.exports=r},function(e,t,r){function n(e,t){return o(e,i(e),t)}var o=r(151),i=r(246);e.exports=n},function(e,t,r){var n=r(85),o=r(247),i=Object.getOwnPropertySymbols,a=i?n(i,Object):o;e.exports=a},function(e,t){function r(){return[]}e.exports=r},function(e,t,r){function n(e){return o(e,a,i)}var o=r(249),i=r(246),a=r(72);e.exports=n},function(e,t,r){function n(e,t,r){var n=t(e);return i(e)?n:o(n,r(e))}var o=r(250),i=r(80);e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}e.exports=r},function(e,t){function r(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var n=Object.prototype,o=n.hasOwnProperty;e.exports=r},function(e,t,r){function n(e,t,r,n){var A=e.constructor;switch(t){case g:return o(e);case f:case p:return new A((+e));case w:return i(e,n);case _:case x:case k:case O:case j:case E:case P:case S:case T:return l(e,n);case h:return a(e,n,r);case d:case m:return new A(e);case v:return u(e);case y:return s(e,n,r);case b:return c(e)}}var o=r(253),i=r(254),a=r(255),u=r(257),s=r(258),c=r(260),l=r(261),f="[object Boolean]",p="[object Date]",h="[object Map]",d="[object Number]",v="[object RegExp]",y="[object Set]",m="[object String]",b="[object Symbol]",g="[object ArrayBuffer]",w="[object DataView]",_="[object Float32Array]",x="[object Float64Array]",k="[object Int8Array]",O="[object Int16Array]",j="[object Int32Array]",E="[object Uint8Array]",P="[object Uint8ClampedArray]",S="[object Uint16Array]",T="[object Uint32Array]";e.exports=n},function(e,t,r){function n(e){var t=new e.constructor(e.byteLength);return new o(t).set(new o(e)),t}var o=r(68);e.exports=n},function(e,t,r){function n(e,t){var r=t?o(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var o=r(253);e.exports=n},function(e,t,r){function n(e,t,r){var n=t?r(a(e),!0):a(e);return i(n,o,new e.constructor)}var o=r(256),i=r(122),a=r(69);e.exports=n},function(e,t){function r(e,t){return e.set(t[0],t[1]),e}e.exports=r},function(e,t){function r(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}var n=/\w*$/;e.exports=r},function(e,t,r){function n(e,t,r){var n=t?r(a(e),!0):a(e);return i(n,o,new e.constructor)}var o=r(259),i=r(122),a=r(70);e.exports=n},function(e,t){function r(e,t){return e.add(t),e}e.exports=r},function(e,t,r){function n(e){return a?Object(a.call(e)):{}}var o=r(67),i=o?o.prototype:void 0,a=i?i.valueOf:void 0;e.exports=n},function(e,t,r){function n(e,t){var r=t?o(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var o=r(253);e.exports=n},function(e,t,r){function n(e){return"function"!=typeof e.constructor||a(e)?{}:o(i(e))}var o=r(263),i=r(161),a=r(83);e.exports=n},function(e,t,r){function n(e){return o(e)?i(e):{}}var o=r(36),i=Object.create;e.exports=n},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(162),u=r(240),s=n(u),c=r(160),l=n(c),f=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd";t.Metadata=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(o(this,e),!(0,l["default"])(t))throw new a.KinveyError("entity argument must be an object");this.kmd=(0,s["default"])(t[f]||{})}return i(e,[{key:"isLocal",value:function(){return!!this.kmd.local}},{key:"toPlainObject",value:function(){return this.kmd}},{key:"toJSON",value:function(){return this.toPlainObject()}},{key:"createdAt",get:function(){if(this.kmd.ect)return Date.parse(this.kmd.ect)}},{key:"ect",get:function(){return this.createdAt}},{key:"emailVerification",get:function(){return this.kmd.emailVerification.status}},{key:"lastModified",get:function(){if(this.kmd.lmt)return Date.parse(this.kmd.lmt)}},{key:"lmt",get:function(){return this.lastModified}},{key:"authtoken",get:function(){return this.kmd.authtoken},set:function(e){this.kmd.authtoken=e}}]),e}()}).call(t,r(11))},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new h.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):h.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(165),s=r(239),c=r(264),l=r(135),f=r(162),p=r(132),h=r(210),d=r(204),v=r(166),y=r(9),m=n(y),b=r(147),g=n(b),w=r(149),_=n(w),x=r(231),k=n(x),O=r(158),j=n(O),E=r(36),P=n(E),S=r(218),T=n(S),A=e.env.KINVEY_USERS_NAMESPACE||"user",R=e.env.KINVEY_RPC_NAMESPACE||"rpc",I=e.env.KINVEY_ID_ATTRIBUTE||"_id",q=e.env.KINVEY_KMD_ATTRIBUTE||"_kmd",C=e.env.KINVEY_SOCIAL_IDENTITY_ATTRIBUTE||"_socialIdentity",M=e.env.KINVEY_USERNAME_ATTRIBUTE||"username",N=e.env.KINVEY_EMAIL_ATTRIBUTE||"email";t.User=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e),this.data=t,this.client=r.client||u.Client.sharedInstance()}return a(e,[{key:"isActive",value:function(){var t=e.getActiveUser(this.client);return!(!t||t[I]!==this[I])}},{key:"isEmailVerified",value:function(){var e=this.metadata.emailVerification;return"confirmed"===e}},{key:"login",value:function(){function t(e,t,n){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(t,r){var o,i,a,u,s,c,p=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=this.isActive(),!o){n.next=3;break}return n.abrupt("return",h.Promise.reject(new f.ActiveUserError("This user is already the active user.")));case 3:if(i=e.getActiveUser(this.client),!i){n.next=6;break}return n.abrupt("return",h.Promise.reject(new f.ActiveUserError("An active user already exists. Please logout the active user before you login.")));case 6:if(a=t,(0,P["default"])(a)?p=r:a={username:t,password:r},a[C]||(a.username&&(a.username=String(a.username).trim()),a.password&&(a.password=String(a.password).trim())),a.username&&""!==a.username&&a.password&&""!==a.password||a[C]){n.next=11;break}return n.abrupt("return",h.Promise.reject(new f.KinveyError("Username and/or password missing. Please provide both a username and password to login.")));case 11:return u=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.App,url:g["default"].format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:a,properties:p.properties,timeout:p.timeout,client:this.client}),n.next=14,u.execute();case 14:return s=n.sent,c=s.data,this.data=c,(0,v.setActiveUser)(this.client,this.data),n.abrupt("return",this);case 19:case"end":return n.stop()}},n,this)}));return t}()},{key:"loginWithMIC",value:function(){function t(e,t,n){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(t,r){var o,i,a,u,s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=this.isActive(),!o){n.next=3;break}return n.abrupt("return",h.Promise.reject(new f.ActiveUserError("This user is already the active user.")));case 3:if(i=e.getActiveUser(this.client),!i){n.next=6;break}return n.abrupt("return",h.Promise.reject(new f.ActiveUserError("An active user already exists. Please logout the active user before you login.")));case 6:return a=new d.MobileIdentityConnect({client:this.client}),n.next=9,a.login(t,r,s);case 9:return u=n.sent,n.abrupt("return",this.connectIdentity(d.MobileIdentityConnect.identity,u,s));case 11:case"end":return n.stop()}},n,this)}));return t}()},{key:"connectIdentity",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t,n){var o,i,a;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=this.data,i=o[C]||{},i[e]=t,o[C]=i,this.data=o,r.prev=5,a=this.isActive(),!a){r.next=9;break}return r.abrupt("return",this.update(o,n));case 9:return r.next=11,this.login(o,n);case 11:return(0,v.setIdentitySession)(this.client,e,t),r.abrupt("return",this);case 15:if(r.prev=15,r.t0=r["catch"](5),!(r.t0 instanceof f.NotFoundError)){r.next=21;break}return r.next=20,this.signup(o,n);case 20:return r.abrupt("return",this.connectIdentity(e,t,n));case 21:throw r.t0;case 22:case"end":return r.stop()}},r,this,[[5,15]])}));return e}()},{key:"connectWithIdentity",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t,n){return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.connectIdentity(e,t,n));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"connectFacebook",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t){var n,o;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=new d.Facebook({client:this.client}),r.next=3,n.login(e,t);case 3:return o=r.sent,r.abrupt("return",this.connectIdentity(d.Facebook.identity,o,t));case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"disconnectFacebook",value:function(){function e(e){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e){return m["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.disconnectIdentity(d.Facebook.identity,e));case 1:case"end":return t.stop()}},r,this)}));return e}()},{key:"connectGoogle",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t){var n,o;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=new d.Google({client:this.client}),r.next=3,n.login(e,t);case 3:return o=r.sent,r.abrupt("return",this.connectIdentity(d.Google.identity,o,t));case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"disconnectGoogle",value:function(){function e(e){return t.apply(this,arguments);
}var t=o(m["default"].mark(function r(e){return m["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.disconnectIdentity(d.Google.identity,e));case 1:case"end":return t.stop()}},r,this)}));return e}()},{key:"connectLinkedIn",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t){var n,o;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=new d.LinkedIn({client:this.client}),r.next=3,n.login(e,t);case 3:return o=r.sent,r.abrupt("return",this.connectIdentity(d.LinkedIn.identity,o,t));case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"disconnectLinkedIn",value:function(){function e(e){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e){return m["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.disconnectIdentity(d.LinkedIn.identity,e));case 1:case"end":return t.stop()}},r,this)}));return e}()},{key:"disconnectIdentity",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t){var n,o;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,e!==d.Facebook.identity){r.next=6;break}return r.next=4,d.Facebook.logout(this,t);case 4:r.next=19;break;case 6:if(e!==d.Google.identity){r.next=11;break}return r.next=9,d.Google.logout(this,t);case 9:r.next=19;break;case 11:if(e!==d.LinkedIn.identity){r.next=16;break}return r.next=14,d.LinkedIn.logout(this,t);case 14:r.next=19;break;case 16:if(e!==d.MobileIdentityConnect.identity){r.next=19;break}return r.next=19,d.MobileIdentityConnect.logout(this,t);case 19:(0,v.setIdentitySession)(this.client,e,null),r.next=25;break;case 22:r.prev=22,r.t0=r["catch"](0),v.Log.error(r.t0);case 25:if(n=this.data,o=n[C]||{},delete o[e],n[C]=o,this.data=n,this[I]){r.next=32;break}return r.abrupt("return",this);case 32:return r.next=34,this.update(n,t);case 34:return r.abrupt("return",this);case 35:case"end":return r.stop()}},r,this,[[0,22]])}));return e}()},{key:"logout",value:function(){function e(e){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(){var e,t,n,o=this,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.Session,url:g["default"].format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:i.properties,timeout:i.timeout,client:this.client}),r.next=4,e.execute();case 4:r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),v.Log.error(r.t0);case 9:return r.prev=9,t=Object.keys(this._socialIdentity||{}),n=t.map(function(e){return o.disconnectIdentity(e,i)}),r.next=14,h.Promise.all(n);case 14:r.next=19;break;case 16:r.prev=16,r.t1=r["catch"](9),v.Log.error(r.t1);case 19:return(0,v.setActiveUser)(this.client,null),r.next=22,p.DataStore.clearCache({client:this.client});case 22:return r.abrupt("return",this);case 23:case"end":return r.stop()}},r,this,[[0,6],[9,16]])}));return e}()},{key:"signup",value:function(){function t(e,t){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(t){var r,o,i,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=(0,_["default"])({state:!0},a),a.state!==!0){n.next=5;break}if(r=e.getActiveUser(this.client),!r){n.next=5;break}throw new f.ActiveUserError("An active user already exists. Please logout the active user before you login.");case 5:return t instanceof e&&(t=t.data),o=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.App,url:g["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),body:(0,T["default"])(t)?null:t,properties:a.properties,timeout:a.timeout,client:this.client}),n.next=9,o.execute();case 9:return i=n.sent,this.data=i.data,a.state===!0&&(0,v.setActiveUser)(this.client,this.data),n.abrupt("return",this);case 13:case"end":return n.stop()}},n,this)}));return t}()},{key:"signupWithIdentity",value:function(e,t,r){var n={};return n[C]={},n[C][e]=t,this.signup(n,r)}},{key:"update",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e,t){var n;return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=(0,_["default"])(this.data,e),n=new p.UserStore,r.next=4,n.update(e,t);case 4:return this.isActive()&&(0,v.setActiveUser)(this.client,this.data),r.abrupt("return",this);case 6:case"end":return r.stop()}},r,this)}));return e}()},{key:"me",value:function(){function t(e){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(){var t,r,o,i,a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=new l.KinveyRequest({method:l.RequestMethod.GET,authType:l.AuthType.Session,url:g["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/_me"}),properties:a.properties,timeout:a.timeout}),n.next=3,t.execute();case 3:return r=n.sent,o=r.data,this.data=o,this.authtoken||(i=e.getActiveUser(this.client),i&&(this.authtoken=i.authtoken)),(0,v.setActiveUser)(this.client,this.data),n.abrupt("return",this);case 9:case"end":return n.stop()}},n,this)}));return t}()},{key:"verifyEmail",value:function(){function e(e){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(){var e,t,n,o=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.App,url:g["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+R+"/"+this.client.appKey+"/"+this.username+"/user-email-verification-initiate"}),properties:o.properties,timeout:o.timeout,client:this.client}),r.next=3,e.execute();case 3:return t=r.sent,n=t.data,r.abrupt("return",n);case 6:case"end":return r.stop()}},r,this)}));return e}()},{key:"forgotUsername",value:function(){function e(e){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(){var e,t,n,o=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.App,url:g["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+R+"/"+this.client.appKey+"/user-forgot-username"}),properties:o.properties,data:{email:this.email},timeout:o.timeout,client:this.client}),r.next=3,e.execute();case 3:return t=r.sent,n=t.data,r.abrupt("return",n);case 6:case"end":return r.stop()}},r,this)}));return e}()},{key:"rc",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return t.client=this.client,e.resetPassword(this.username,t)}},{key:"_id",get:function(){return this.data[I]}},{key:"_acl",get:function(){return new s.Acl(this.data)}},{key:"metadata",get:function(){return new c.Metadata(this.data)},set:function(e){this.data[q]=(0,k["default"])(e,"toPlainObjecta",e)}},{key:"_kmd",get:function(){return this.metadata},set:function(e){this.metadata=e}},{key:"_socialIdentity",get:function(){return this.data[C]}},{key:"authtoken",get:function(){return this.metadata.authtoken},set:function(e){var t=this.metadata;t.authtoken=e,this.metadata=t}},{key:"username",get:function(){return this.data[M]}},{key:"email",get:function(){return this.data[N]}},{key:"pathname",get:function(){return"/"+A+"/"+this.client.appKey}}],[{key:"getActiveUser",value:function(){var e=arguments.length<=0||void 0===arguments[0]?u.Client.sharedInstance():arguments[0],t=e.activeUser,r=null;return t&&(r=new this(t),r.client=e),r}},{key:"login",value:function(e,t,r){var n=new this({},r);return n.login(e,t,r)}},{key:"loginWithMIC",value:function(e,t){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=new this({},r);return n.loginWithMIC(e,t,r)}},{key:"connectIdentity",value:function(e,t,r){var n=new this({},r);return n.connectIdentity(e,t,r)}},{key:"connectFacebook",value:function(e,t){var r=new this({},t);return r.connectFacebook(e,t)}},{key:"connectGoogle",value:function(e,t){var r=new this({},t);return r.connectGoogle(e,t)}},{key:"connectLinkedIn",value:function(e,t){var r=new this({},t);return r.connectLinkedIn(e,t)}},{key:"logout",value:function(){function t(e){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(){var t,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.getActiveUser(r.client),!t){n.next=3;break}return n.abrupt("return",t.logout(r));case 3:return n.abrupt("return",null);case 4:case"end":return n.stop()}},n,this)}));return t}()},{key:"signup",value:function(e,t){var r=new this({},t);return r.signup(e,t)}},{key:"signupWithIdentity",value:function(e,t,r){var n=new this({},r);return n.signupWithIdentity(e,t,r)}},{key:"update",value:function(){function t(e,t){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(t,r){var o;return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.getActiveUser(r.client),!o){n.next=3;break}return n.abrupt("return",o.update(t,r));case 3:return n.abrupt("return",null);case 4:case"end":return n.stop()}},n,this)}));return t}()},{key:"me",value:function(){function t(e){return r.apply(this,arguments)}var r=o(m["default"].mark(function n(t){var r;return m["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.getActiveUser(t.client),!r){n.next=3;break}return n.abrupt("return",r.me(t));case 3:return n.abrupt("return",null);case 4:case"end":return n.stop()}},n,this)}));return t}()},{key:"resetPassword",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(m["default"].mark(function r(e){var t,n,o,i,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return m["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}throw new f.KinveyError("A username was not provided.","Please provide a username for the user that you would like to reset their password.");case 2:if((0,j["default"])(e)){r.next=4;break}throw new f.KinveyError("The provided username is not a string.");case 4:return t=a.client||u.Client.sharedInstance(),n=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.App,url:g["default"].format({protocol:t.protocol,host:t.host,pathname:"/"+R+"/"+t.appKey+"/"+e+"/user-password-reset-initiate"}),properties:a.properties,timeout:a.timeout,client:t}),r.next=8,n.execute();case 8:return o=r.sent,i=o.data,r.abrupt("return",i);case 11:case"end":return r.stop()}},r,this)}));return e}()},{key:"exists",value:function(e,t){var r=new p.UserStore(t);return r.exists(e,t)}},{key:"restore",value:function(e,t){var r=new p.UserStore(t);return r.restore(e,t)}}]),e}()}).call(t,r(11))},function(e,t,r){var n=r(267),o=r(273),i=r(15),a=r(153),u=r(76),s=r(275),c=a(function(e,t){var r=s(t);return u(r)&&(r=void 0),u(e)?n(e,o(t,1,u,!0),i(r,2)):[]});e.exports=c},function(e,t,r){function n(e,t,r,n){var f=-1,p=i,h=!0,d=e.length,v=[],y=t.length;if(!d)return v;r&&(t=u(t,s(r))),n?(p=a,h=!1):t.length>=l&&(p=c,h=!1,t=new o(t));e:for(;++f<d;){var m=e[f],b=r?r(m):m;if(m=n||0!==m?m:0,h&&b===b){for(var g=y;g--;)if(t[g]===b)continue e;v.push(m)}else p(t,b,n)||v.push(m)}return v}var o=r(62),i=r(268),a=r(271),u=r(234),s=r(94),c=r(272),l=200;e.exports=n},function(e,t,r){function n(e,t){var r=e?e.length:0;return!!r&&o(e,t,0)>-1}var o=r(269);e.exports=n},function(e,t,r){function n(e,t,r){if(t!==t)return o(e,i,r);for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var o=r(14),i=r(270);e.exports=n},function(e,t){function r(e){return e!==e}e.exports=r},function(e,t){function r(e,t,r){for(var n=-1,o=e?e.length:0;++n<o;)if(r(t,e[n]))return!0;return!1}e.exports=r},function(e,t){function r(e,t){return e.has(t)}e.exports=r},function(e,t,r){function n(e,t,r,a,u){var s=-1,c=e.length;for(r||(r=i),u||(u=[]);++s<c;){var l=e[s];t>0&&r(l)?t>1?n(l,t-1,r,a,u):o(u,l):a||(u[u.length]=l)}return u}var o=r(250),i=r(274);e.exports=n},function(e,t,r){function n(e){return a(e)||i(e)||!!(u&&e&&e[u])}var o=r(67),i=r(75),a=r(80),u=o?o.isConcatSpreadable:void 0;e.exports=n},function(e,t){function r(e){var t=e?e.length:0;return t?e[t-1]:void 0}e.exports=r},function(e,t,r){function n(e,t){var r=u(e)?o:i;return r(e,a(t,3))}var o=r(277),i=r(278),a=r(15),u=r(80);e.exports=n},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}e.exports=r},function(e,t,r){function n(e,t){var r=[];return o(e,function(e,n,o){t(e,n,o)&&r.push(e)}),r}var o=r(123);e.exports=n},function(e,t,r){var n=r(277),o=r(153),i=r(280),a=r(76),u=r(275),s=o(function(e){var t=u(e);return a(t)&&(t=void 0),i(n(e,a),void 0,t)});e.exports=s},function(e,t,r){function n(e,t,r){for(var n=-1,u=e.length;++n<u;)var s=s?o(i(s,e[n],t,r),i(e[n],s,t,r)):e[n];return s&&s.length?a(s,t,r):[]}var o=r(250),i=r(267),a=r(281);e.exports=n},function(e,t,r){function n(e,t,r){var n=-1,f=i,p=e.length,h=!0,d=[],v=d;if(r)h=!1,f=a;else if(p>=l){var y=t?null:s(e);if(y)return c(y);h=!1,f=u,v=new o}else v=t?[]:d;e:for(;++n<p;){var m=e[n],b=t?t(m):m;if(m=r||0!==m?m:0,h&&b===b){for(var g=v.length;g--;)if(v[g]===b)continue e;t&&v.push(b),d.push(m)}else f(v,b,r)||(v!==d&&v.push(b),d.push(m))}return d}var o=r(62),i=r(268),a=r(271),u=r(272),s=r(282),c=r(70),l=200;e.exports=n},function(e,t,r){var n=r(89),o=r(283),i=r(70),a=1/0,u=n&&1/i(new n([,-0]))[1]==a?function(e){return new n(e)}:o;e.exports=u},function(e,t){function r(){}e.exports=r},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.DataStore=t.DataStoreType=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(135),s=r(162),c=r(165),l=r(134),f=r(133),p=r(285),h=r(9),d=n(h),v=r(147),y=n(v),m=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",b={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(b),t.DataStoreType=b;var g=function(){function e(){throw i(this,e),new s.KinveyError("Not allowed to construct a DataStore instance. Please use the collection() function to retrieve an instance of a DataStore instance.")}return a(e,null,[{key:"collection",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?b.Cache:arguments[1],r=arguments[2],n=void 0;if(!e)throw new s.KinveyError("A collection is required.");switch(t){case b.Network:n=new l.NetworkStore(e,r);break;case b.Sync:n=new p.SyncStore(e,r);break;case b.Cache:default:n=new f.CacheStore(e,r)}return n}},{key:"getInstance",value:function(e,t,r){return this.collection(e,t,r)}},{key:"clearCache",value:function(){function e(e){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){var e,t,n,o,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=i.client||c.Client.sharedInstance(),t="/"+m+"/"+e.appKey,n=new u.CacheRequest({method:u.RequestMethod.DELETE,url:y["default"].format({protocol:e.protocol,host:e.host,pathname:t,query:i.query}),properties:i.properties,timeout:i.timeout}),r.next=5,n.execute();case 5:return o=r.sent,r.abrupt("return",o.data);case 7:case"end":return r.stop()}},r,this)}));return e}()}]),e}();t.DataStore=g}).call(t,r(11))},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncStore=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(133),l=r(135),f=r(162),p=r(221),h=r(166),d=r(9),v=n(d),y=r(147),m=n(y);t.SyncStore=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),s(t,[{key:"find",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=h.KinveyObservable.create(function(){var n=o(v["default"].mark(function i(n){var o,a,u;return v["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,o=[],!e||e instanceof p.Query){i.next=4;break}throw new f.KinveyError("Invalid query. It must be an instance of the Query class.");case 4:return a=new l.CacheRequest({method:l.RequestMethod.GET,url:m["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,query:e,timeout:r.timeout}),i.next=7,a.execute();case 7:u=i.sent,o=u.data,n.next(o),i.next=15;break;case 12:i.prev=12,i.t0=i["catch"](0),n.error(i.t0);case 15:return i.abrupt("return",n.complete());case 16:case"end":return i.stop()}},i,t,[[0,12]])}));return function(e){return n.apply(this,arguments)}}());return n}},{key:"findById",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=h.KinveyObservable.create(function(){var n=o(v["default"].mark(function i(n){var o,a,u;return v["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,o=new l.CacheRequest({method:l.RequestMethod.GET,url:m["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname+"/"+e,query:r.query}),properties:r.properties,timeout:r.timeout}),i.next=4,o.execute();case 4:a=i.sent,u=a.data,n.next(u),i.next=12;break;case 9:i.prev=9,i.t0=i["catch"](0),n.error(i.t0);case 12:return i.abrupt("return",n.complete());case 13:case"end":return i.stop()}},i,t,[[0,9]])}));return function(e){return n.apply(this,arguments)}}());return n}},{key:"count",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=h.KinveyObservable.create(function(){var n=o(v["default"].mark(function i(n){var o,a,u;return v["default"].wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,!e||e instanceof p.Query){i.next=3;break}throw new f.KinveyError("Invalid query. It must be an instance of the Query class.");case 3:return o=new l.CacheRequest({method:l.RequestMethod.GET,url:m["default"].format({protocol:t.client.protocol,host:t.client.host,pathname:t.pathname,query:r.query}),properties:r.properties,query:e,timeout:r.timeout}),i.next=6,o.execute();case 6:a=i.sent,u=a.data,n.next(u?u.length:0),i.next=14;break;case 11:return i.prev=11,i.t0=i["catch"](0),i.abrupt("return",n.error(i.t0));case 14:return i.abrupt("return",n.complete());case 15:case"end":return i.stop()}},i,t,[[0,11]])}));return function(e){return n.apply(this,arguments)}}());return n}},{key:"syncAutomatically",get:function(){return!1}}]),t}(c.CacheStore)},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new y.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):y.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return Math.floor(Math.random()*(t-e))+e}function c(e,t){var r=e?parseInt(e.split("-")[1],10)+1:0;return r>=t?t-1:r}Object.defineProperty(t,"__esModule",{value:!0}),t.FileStore=void 0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},f=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),p=function q(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:q(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},h=r(135),d=r(162),v=r(134),y=r(210),m=r(166),b=r(9),g=n(b),w=r(147),_=n(w),x=r(235),k=n(x),O=r(149),j=n(O),E=r(35),P=n(E),S=r(159),T=n(S),A=e.env.KINVEY_ID_ATTRIBUTE||"_id",R=e.env.KINVEY_FILES_NAMESPACE||"blob",I=e.env.KINVEY_MAX_BACKOFF||32e3;t.FileStore=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),f(t,[{key:"find",value:function(){function e(e,t){return r.apply(this,arguments)}var r=o(g["default"].mark(function n(e){var r,o,i=this,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return g["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a.query=a.query||{},a.query.tls=a.tls===!0,(0,T["default"])(a.ttl)&&(a.query.ttl_in_seconds=a.ttl),r=p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",this).call(this,e,a),n.next=6,r.toPromise();case 6:if(o=n.sent,a.download!==!0){n.next=9;break}return n.abrupt("return",y.Promise.all((0,k["default"])(o,function(e){return i.downloadByUrl(e._downloadURL,a)})));case 9:return n.abrupt("return",o);case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"findById",value:function(e,t){return this.download(e,t)}},{key:"download",value:function(){function e(e,t){return r.apply(this,arguments)}var r=o(g["default"].mark(function n(e){var r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return g["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.query=o.query||{},o.query.tls=o.tls===!0,(0,T["default"])(o.ttl)&&(o.query.ttl_in_seconds=o.ttl),n.next=5,p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",this).call(this,e,o).toPromise();case 5:if(r=n.sent,o.stream!==!0){n.next=8;break}return n.abrupt("return",r);case 8:return o.mimeType=r.mimeType,n.abrupt("return",this.downloadByUrl(r._downloadURL,o));case 10:case"end":return n.stop()}},n,this)}));return e}()},{key:"downloadByUrl",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(g["default"].mark(function r(e){var t,n,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return g["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=new h.NetworkRequest({method:h.RequestMethod.GET,url:e,timeout:o.timeout}),r.next=3,t.execute();case 3:return n=r.sent,r.abrupt("return",n.data);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"stream",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.stream=!0,this.download(e,t)}},{key:"upload",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=o(g["default"].mark(function r(e){var t,n,o,i,a,u,s,l=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],f=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return g["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=(0,j["default"])({filename:e._filename||e.name,"public":!1,size:e.size||e.length,mimeType:e.mimeType||e.type||"application/octet-stream"},l),l._filename=l.filename,delete l.filename,l._public=l["public"],delete l["public"],t=new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.Default,url:_["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname}),properties:f.properties,timeout:f.timeout,body:l,client:this.client}),t.headers.set("X-Kinvey-Content-Type",l.mimeType),l[A]&&(t.method=h.RequestMethod.PUT,t.url=_["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/"+l._id,query:f.query})),r.next=10,t.execute();case 10:return n=r.sent,o=n.data,i=o._uploadURL,a=new h.Headers(o._requiredHeaders),a.set("content-type",l.mimeType),delete o._expiresAt,delete o._requiredHeaders,delete o._uploadURL,u=new h.NetworkRequest({method:h.RequestMethod.PUT,url:i,timeout:f.timeout}),u.headers.addAll(a.toPlainObject()),u.headers.set("Content-Length","0"),u.headers.set("Content-Range","bytes */"+l.size),r.next=24,u.execute(!0);case 24:if(s=r.sent,m.Log.debug("File upload status check response",s),s.isSuccess()!==!1){r.next=34;break}if(s.statusCode!==h.StatusCode.ResumeIncomplete){r.next=33;break}return f.start=c(s.headers.get("range"),l.size),r.next=31,this.uploadToGCS(i,a,e,l,f);case 31:r.next=34;break;case 33:throw s.error;case 34:return o._data=e,r.abrupt("return",o);case 36:case"end":return r.stop()}},r,this)}));return e}()},{key:"uploadToGCS",value:function(){function e(e,r,n,o,i){return t.apply(this,arguments)}var t=o(g["default"].mark(function r(e,t,n,o){var i,a,u,f,p,d=this,v=arguments.length<=4||void 0===arguments[4]?{}:arguments[4];return g["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return v=(0,j["default"])({count:0,start:0,maxBackoff:I},v),m.Log.debug("Start file upload"),m.Log.debug("File upload upload url",e),m.Log.debug("File upload headers",t.toPlainObject()),m.Log.debug("File upload file",n),m.Log.debug("File upload metadata",o),m.Log.debug("File upload options",v),i=(0,P["default"])(n.slice)?n.slice(v.start):n,a=i.size||i.length,u=new h.NetworkRequest({method:h.RequestMethod.PUT,url:e,body:i,timeout:v.timeout}),u.headers.addAll(t.toPlainObject()),u.headers.set("content-length",a),u.headers.set("content-range","bytes "+v.start+"-"+(o.size-1)+"/"+o.size),r.next=15,u.execute(!0);case 15:if(f=r.sent,m.Log.debug("File upload response",f),f.isSuccess()!==!1){r.next=29;break}if(f.statusCode!==h.StatusCode.ResumeIncomplete){r.next=24;break}return m.Log.debug("File upload was incomplete. Trying to upload the remaining protion of the file."),v.start=c(f.headers.get("range"),o.size),r.abrupt("return",this.uploadToGCS(e,t,n,o,v));case 24:if(!(f.statusCode>=500&&f.statusCode<600)){r.next=28;break}if(p=function(){m.Log.debug("File upload error.",f.statusCode);var r=Math.pow(2,v.count)+s(1e3,1);if(r>=v.maxBackoff)throw f.error;return m.Log.debug("File upload will try again in "+r+" seconds."),{v:new y.Promise(function(i){setTimeout(function(){v.count=v.count+1,i(d.uploadToGCS(e,t,n,o,v))},r)})}}(),"object"!==("undefined"==typeof p?"undefined":l(p))){r.next=28;break}return r.abrupt("return",p.v);case 28:throw f.error;case 29:return r.abrupt("return",f);case 30:case"end":return r.stop()}},r,this)}));return e}()},{key:"create",value:function(e,t,r){return this.upload(e,t,r)}},{key:"update",value:function(e,t,r){return this.upload(e,t,r)}},{key:"remove",value:function(){throw new d.KinveyError("Please use removeById() to remove files one by one.")}},{key:"pathname",get:function(){return"/"+R+"/"+this.client.appKey}}]),t}(v.NetworkStore)}).call(t,r(11))},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function x(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:x(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},l=r(135),f=r(162),p=r(134),h=r(9),d=n(h),v=r(147),y=n(v),m=r(80),b=n(m),g=e.env.KINVEY_USERS_NAMESPACE||"user",w=e.env.KINVEY_RPC_NAMESPACE||"rpc",_=e.env.KINVEY_ID_ATTRIBUTE||"_id";t.UserStore=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null,e))}return u(t,e),s(t,[{key:"create",value:function(){function e(){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(){return d["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:throw new f.KinveyError("Please use `User.signup()` to create a user.");case 1:case"end":return e.stop()}},r,this)}));return e}()},{key:"update",value:function(){function e(e,t){return r.apply(this,arguments)}var r=o(d["default"].mark(function n(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}throw new f.KinveyError("No user was provided to be updated.");case 2:if(!(0,b["default"])(e)){n.next=4;break}throw new f.KinveyError("Only one user can be updated at one time.",e);case 4:if(e[_]){n.next=6;break}throw new f.KinveyError("User must have an _id.");case 6:return n.abrupt("return",c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,r));case 7:case"end":return n.stop()}},n,this)}));return e}()},{key:"exists",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t,n,o,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=new l.KinveyRequest({
method:l.RequestMethod.POST,authType:l.AuthType.App,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:"/"+w+"/"+this.client.appKey+"/check-username-exists"}),properties:i.properties,data:{username:e},timeout:i.timeout,client:this.client}),r.next=3,t.execute();case 3:return n=r.sent,o=n.data||{},r.abrupt("return",o.usernameExists===!0);case 6:case"end":return r.stop()}},r,this)}));return e}()},{key:"restore",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(d["default"].mark(function r(e){var t,n,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.Master,url:y["default"].format({protocol:this.client.protocol,host:this.client.host,pathname:this.pathname+"/"+e}),properties:o.properties,timeout:o.timeout,client:this.client}),r.next=3,t.execute();case 3:return n=r.sent,r.abrupt("return",n.data);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"pathname",get:function(){return"/"+g+"/"+this.client.appKey}}]),t}(p.NetworkStore)}).call(t,r(11))},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregation=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(162),u=r(221),s=r(231),c=n(s),l=r(149),f=n(l),p=r(156),h=n(p),d=r(158),v=n(d),y=r(36),m=n(y),b=r(35),g=n(b);t.Aggregation=function(){function e(t){o(this,e),t=(0,f["default"])({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t),this.query=t.query,this.initial=t.initial,this.key=t.key,this.reduceFn=t.reduceFn}return i(e,[{key:"by",value:function(e){return this.key[e]=!0,this}},{key:"process",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t={},r=[],n=this.toJSON(),o=n.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");n.reduce=new Function(["doc","out"],o),this.query&&(e=this.query.process(e)),(0,h["default"])(e,function(e){var r={},o=Object.keys(e);(0,h["default"])(o,function(t){r[t]=e[t]});var i=JSON.stringify(r);if(!t[i]){t[i]=r;var a=Object.keys(n.initial);(0,h["default"])(a,function(e){t[i][e]=n.initial[e]})}n.reduce(e,t[i])});var i=Object.keys(t);return(0,h["default"])(i,function(e){r.push(t[e])}),r}},{key:"toJSON",value:function(){var e={key:this.key,initial:this.initial,reduceFn:this.reduceFn,condition:this.query?this.query.toJSON().filter:{},query:this.query?this.query.toJSON():null};return e}},{key:"initial",get:function(){return this.aggregationInitial},set:function(e){if(!(0,m["default"])(e))throw new a.KinveyError("initial must be an Object.");this.aggregationInitial=e}},{key:"query",get:function(){return this.aggregationQuery},set:function(e){!e||e instanceof u.Query||(e=new u.Query((0,c["default"])(e,"toJSON",e))),this.aggregationQuery=e}},{key:"reduceFn",get:function(){return this.aggregationReduceFn},set:function(e){if((0,g["default"])(e)&&(e=e.toString()),!(0,v["default"])(e))throw new a.KinveyError("fn argument must be of type function or string.");this.aggregationReduceFn=e}}],[{key:"count",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],r=new e;return t&&r.by(t),r.initial={result:0},r.reduceFn=function(e,t){return t.result+=1,t},r}},{key:"sum",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var r=new e;return r.initial={result:0},r.reduceFn=function(e,r){r.result+=e["'"+t+"'"]},r}},{key:"min",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var r=new e;return r.initial={result:1/0},r.reduceFn=function(e,r){r.result=Math.min(r.result,e["'"+t+"'"])},r}},{key:"max",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var r=new e;return r.initial={result:-(1/0)},r.reduceFn=function(e,r){r.result=Math.max(r.result,e["'"+t+"'"])},r}},{key:"average",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];t=t.replace("'","\\'");var r=new e;return r.initial={count:0,result:0},r.reduceFn=function(e,r){r.result=(r.result*r.count+e["'"+t+"'"])/(r.count+1),r.count+=1},r}}]),e}()},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEndpoint=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(165),s=r(135),c=r(162),l=r(9),f=n(l),p=r(147),h=n(p),d=r(149),v=n(d),y=r(158),m=n(y),b=e.env.KINVEY_RPC_NAMESPACE||"rpc";t.CustomEndpoint=function(){function e(){throw i(this,e),new c.KinveyError("Not allowed to create an instance of the `CustomEndpoint` class.","Please use `CustomEndpoint.execute()` function.")}return a(e,null,[{key:"execute",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=o(f["default"].mark(function r(e,t){var n,o,i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=(0,v["default"])({client:u.Client.sharedInstance()},i),e){r.next=3;break}throw new c.KinveyError("An endpoint argument is required.");case 3:if((0,m["default"])(e)){r.next=5;break}throw new c.KinveyError("The endpoint argument must be a string.");case 5:return n=new s.KinveyRequest({method:s.RequestMethod.POST,authType:s.AuthType.Default,url:h["default"].format({protocol:i.client.protocol,host:i.client.host,pathname:"/"+b+"/"+i.client.appKey+"/custom/"+e}),properties:i.properties,body:t,timeout:i.timeout,client:i.client}),r.next=8,n.execute();case 8:return o=r.sent,r.abrupt("return",o.data);case 10:case"end":return r.stop()}},r,this)}));return e}()}]),e}()}).call(t,r(11))},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Kinvey=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(165),s=r(289),c=r(166),l=r(221),f=r(288),p=r(132),h=r(238),d=r(204),v=r(135),y=r(162),m=r(9),b=n(m),g=r(147),w=n(g),_=e.env.KINVEY_DATASTORE_NAMESPACE||"appdata",x=function(){function e(){i(this,e)}return a(e,null,[{key:"init",value:function(e){if(!e.appKey)throw new y.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!e.appSecret&&!e.masterSecret)throw new y.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Key.");var t=u.Client.init(e);return this.CustomEndpoint=s.CustomEndpoint,this.DataStore=p.DataStore,this.Files=new p.FileStore,this.User=h.User,this.UserStore=h.UserStore,t}},{key:"ping",value:function(){function e(e){return t.apply(this,arguments)}var t=o(b["default"].mark(function r(){var e,t,n=arguments.length<=0||void 0===arguments[0]?u.Client.sharedInstance():arguments[0];return b["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=new v.KinveyRequest({method:v.RequestMethod.GET,authType:v.AuthType.All,url:w["default"].format({protocol:n.protocol,host:n.host,pathname:_+"/"+n.appKey})}),r.next=3,e.execute();case 3:return t=r.sent,r.abrupt("return",t.data);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"client",get:function(){return u.Client.sharedInstance()}},{key:"appVersion",get:function(){return this.client.appVersion},set:function(e){this.client.appVersion=e}}]),e}();x.Acl=h.Acl,x.Aggregation=f.Aggregation,x.AuthorizationGrant=d.AuthorizationGrant,x.CacheRequest=v.CacheRequest,x.DataStoreType=p.DataStoreType,x.Log=c.Log,x.Metadata=h.Metadata,x.NetworkRequest=v.NetworkRequest,x.Query=l.Query,x.SocialIdentity=d.SocialIdentity,t.Kinvey=x}).call(t,r(11))},function(e,t,r){(function(e,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorage=t.LocalStorage=void 0;var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(131),f=r(9),p=o(f),h=r(227),d=o(h),v=r(292),y=o(v),m=r(232),b=o(m),g=r(156),w=o(g),_=r(13),x=o(_),k=r(300),O=o(k),j=e.env.KINVEY_ID_ATTRIBUTE||"_id",E="master",P=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"kinvey":arguments[0];s(this,e),this.name=t}return c(e,[{key:"masterCollectionName",get:function(){return this.name+"_"+E}}]),e}();t.LocalStorage=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.localStorage.setItem(r.masterCollectionName,JSON.stringify([])),r}return u(t,e),c(t,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e){var t;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=n.localStorage.getItem(""+this.name+e),!t){r.next=3;break}return r.abrupt("return",JSON.parse(t));case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var n,o;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(n=r.sent,o=(0,O["default"])(n,function(e){return e[j]===t})){r.next=6;break}throw new l.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" localstorage database."));case 6:return r.abrupt("return",o);case 7:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var o,i,a,u,s;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(this.masterCollectionName);case 2:return o=r.sent,(0,x["default"])(o,e)===-1&&(o.push(e),n.localStorage.setItem(this.masterCollectionName,JSON.stringify(o))),r.next=6,this.find(e);case 6:return i=r.sent,a=(0,d["default"])(i,j),u=(0,d["default"])(t,j),s=Object.keys(a),(0,w["default"])(s,function(e){var t=a[e],r=u[e];r&&(u[e]=(0,y["default"])(t,r))}),n.localStorage.setItem(""+this.name+e,JSON.stringify((0,b["default"])(u))),r.abrupt("return",t);case 13:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var n,o,i;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(n=r.sent,o=(0,d["default"])(n,j),i=o[t]){r.next=7;break}throw new l.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" "+("collection on the "+this.name+" memory database."));case 7:return delete o[t],r.next=10,this.save(e,(0,b["default"])(o));case 10:return r.abrupt("return",i);case 11:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(){var e,t=this;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(this.masterCollectionName);case 2:e=r.sent,(0,w["default"])(e,function(e){n.localStorage.removeItem(""+t.name+e)}),n.localStorage.setItem(this.masterCollectionName,JSON.stringify([]));case 5:case"end":return r.stop()}},r,this)}));return e}()}],[{key:"isSupported",value:function(){if(n.localStorage){var e="testLocalStorageSupport";try{return n.localStorage.setItem(e,e),n.localStorage.removeItem(e),!0}catch(t){return!1}}return!1}}]),t}(P),t.SessionStorage=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.sessionStorage.setItem(r.masterCollectionName,JSON.stringify([])),r}return u(t,e),c(t,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e){var t;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=n.sessionStorage.getItem(""+this.name+e),!t){r.next=3;break}return r.abrupt("return",JSON.parse(t));case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var n,o;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(n=r.sent,o=(0,O["default"])(n,function(e){return e[j]===t})){r.next=6;break}throw new l.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" localstorage database."));case 6:return r.abrupt("return",o);case 7:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var o,i,a,u,s;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(this.masterCollectionName);case 2:return o=r.sent,(0,x["default"])(o,e)===-1&&(o.push(e),n.sessionStorage.setItem(this.masterCollectionName,JSON.stringify(o))),r.next=6,this.find(e);case 6:return i=r.sent,a=(0,d["default"])(i,j),u=(0,d["default"])(t,j),s=Object.keys(a),(0,w["default"])(s,function(e){var t=a[e],r=u[e];r&&(u[e]=(0,y["default"])(t,r))}),n.sessionStorage.setItem(""+this.name+e,JSON.stringify((0,b["default"])(u))),r.abrupt("return",t);case 13:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(e,t){var o,i,a;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(o=r.sent,i=(0,d["default"])(o,j),a=i[t]){r.next=7;break}throw new l.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" "+("collection on the "+this.name+" memory database."));case 7:return delete i[t],n.sessionStorage.setItem(""+this.name+e,JSON.stringify((0,b["default"])(i))),r.abrupt("return",a);case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(p["default"].mark(function r(){var e,t=this;return p["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(this.masterCollectionName);case 2:e=r.sent,(0,w["default"])(e,function(e){n.sessionStorage.removeItem(""+t.name+e)}),n.sessionStorage.setItem(this.masterCollectionName,JSON.stringify([]));case 5:case"end":return r.stop()}},r,this)}));return e}()}],[{key:"isSupported",value:function(){if(n.sessionStorage){var e="testSessionStorageSupport";try{return n.sessionStorage.setItem(e,e),n.sessionStorage.removeItem(e),!0}catch(t){return!1}}return!1}}]),t}(P)}).call(t,r(11),function(){return this}())},function(e,t,r){var n=r(293),o=r(152),i=o(function(e,t,r){n(e,t,r)});e.exports=i},function(e,t,r){function n(e,t,r,p,h){if(e!==t){if(!c(t)&&!f(t))var d=u(t);i(d||t,function(i,u){if(d&&(u=i,i=t[u]),l(i))h||(h=new o),s(e,t,u,r,n,p,h);else{var c=p?p(e[u],i,u+"",e,t,h):void 0;void 0===c&&(c=i),a(e,u,c)}})}}var o=r(18),i=r(157),a=r(294),u=r(295),s=r(297),c=r(80),l=r(36),f=r(92);e.exports=n},function(e,t,r){function n(e,t,r){(void 0===r||o(e[t],r))&&("number"!=typeof t||void 0!==r||t in e)||(e[t]=r)}var o=r(23);e.exports=n},function(e,t,r){function n(e){if(!o(e))return a(e);var t=i(e),r=[];for(var n in e)("constructor"!=n||!t&&s.call(e,n))&&r.push(n);return r}var o=r(36),i=r(83),a=r(296),u=Object.prototype,s=u.hasOwnProperty;e.exports=n},function(e,t){function r(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}e.exports=r},function(e,t,r){function n(e,t,r,n,v,y,m){var b=e[r],g=t[r],w=m.get(g);if(w)return void o(e,r,w);var _=y?y(b,g,r+"",e,t,m):void 0,x=void 0===_;x&&(_=g,s(g)||h(g)?s(b)?_=b:c(b)?_=a(b):(x=!1,_=i(g,!0)):p(g)||u(g)?u(b)?_=d(b):!f(b)||n&&l(b)?(x=!1,_=i(g,!0)):_=b:x=!1),x&&(m.set(g,_),v(_,g,n,y,m),m["delete"](g)),o(e,r,_)}var o=r(294),i=r(241),a=r(244),u=r(75),s=r(80),c=r(76),l=r(35),f=r(36),p=r(160),h=r(92),d=r(298);e.exports=n},function(e,t,r){function n(e){return o(e,i(e))}var o=r(151),i=r(299);e.exports=n},function(e,t,r){function n(e){return a(e)?o(e,!0):i(e)}var o=r(73),i=r(295),a=r(77);e.exports=n},function(e,t,r){var n=r(301),o=r(13),i=n(o);e.exports=i},function(e,t,r){function n(e){return function(t,r,n){var u=Object(t);if(!i(t)){var s=o(r,3);t=a(t),r=function(e){return s(u[e],e,u)}}var c=e(t,r,n);return c>-1?u[s?t[c]:c]:void 0}}var o=r(15),i=r(77),a=r(72);e.exports=n},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new s.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(c){return void r(c)}return a.done?void e(u):s.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDB=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(162),s=r(210),c=r(9),l=n(c),f=r(156),p=n(f),h=r(158),d=n(h),v=r(80),y=n(v),m=r(35),b=n(m),g={},w={ReadWrite:"readwrite",ReadOnly:"readonly"};Object.freeze(w);t.IndexedDB=function(){function t(e){if(i(this,t),!e)throw new u.KinveyError("A name is required to use the IndexedDB adapter.",e);if(!(0,d["default"])(e))throw new u.KinveyError("The name must be a string to use the IndexedDB adapter",e);this.name=e,this.inTransaction=!1,this.queue=[]}return a(t,[{key:"openTransaction",value:function(t){var r=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=arguments[2],o=this,i=arguments[3],a=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],s=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,c=g[this.name];if(c){var l=(0,b["default"])(c.objectStoreNames.contains)?c.objectStoreNames.contains(t):c.objectStoreNames.indexOf(t)!==-1;if(l)try{var f=r?w.ReadWrite:w.ReadOnly,h=c.transaction(t,f);if(h)return n(h);throw new u.KinveyError("Unable to open a transaction for "+t+(" collection on the "+this.name+" IndexedDB database."))}catch(d){return i(d)}else if(!r)return i(new u.NotFoundError("The "+t+" collection was not found on"+(" the "+this.name+" IndexedDB database.")))}if(!a&&this.inTransaction)return this.queue.push(function(){o.openTransaction(t,r,n,i)});this.inTransaction=!0;var v=void 0;if(c){var y=c.version+1;c.close(),v=s.open(this.name,y)}else v=s.open(this.name);return v.onupgradeneeded=function(e){c=e.target.result,g[o.name]=c,r&&c.createObjectStore(t,{keyPath:"_id"})},v.onsuccess=function(e){c=e.target.result,g[o.name]=c,c.onversionchange=function(){c&&(c.close(),c=null,g[o.name]=null)};var a=function(e){var t=function(t){if(e(t),o.inTransaction=!1,o.queue.length>0){var r=o.queue;o.queue=[],(0,p["default"])(r,function(e){e.call(o)})}};return t};return o.openTransaction(t,r,a(n),a(i),!0)},v.onblocked=function(){i(new u.KinveyError("The "+o.name+" IndexedDB database version can't be upgraded because the database is already open."))},v.onerror=function(e){i(new u.KinveyError("Unable to open the "+o.name+" IndexedDB database."+(" "+e.target.error.message+".")))},v}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e){var t=this;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new s.Promise(function(r,n){t.openTransaction(e,!1,function(){var i=o(l["default"].mark(function a(o){var i,u,s;return l["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=o.objectStore(e),u=i.openCursor(),s=[],u.onsuccess=function(e){var t=e.target.result;return t?(s.push(t.value),t["continue"]()):r(s)},u.onerror=function(e){n(e)};case 5:case"end":return t.stop()}},a,t)}));return function(e){return i.apply(this,arguments)}}(),n)}));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n=this;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new s.Promise(function(r,i){n.openTransaction(e,!1,function(){var a=o(l["default"].mark(function s(o){var a,c;return l["default"].wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=o.objectStore(e),c=a.get(t),c.onsuccess=function(o){var a=o.target.result;a?r(a):i(new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+n.name+" IndexedDB database.")))},c.onerror=function(){i(new u.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+n.name+" IndexedDB database.")))};case 4:case"end":return s.stop()}},s,n)}));return function(e){return a.apply(this,arguments)}}(),i)}));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n,i=this;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=!1,(0,y["default"])(t)||(n=!0,t=[t]),0!==t.length){r.next=4;break}return r.abrupt("return",null);case 4:return r.abrupt("return",new s.Promise(function(r,a){i.openTransaction(e,!0,function(){var s=o(l["default"].mark(function c(o){var s;return l["default"].wrap(function(c){for(;;)switch(c.prev=c.next){case 0:s=o.objectStore(e),(0,p["default"])(t,function(e){s.put(e)}),o.oncomplete=function(){r(n?t[0]:t)},o.onerror=function(t){a(new u.KinveyError("An error occurred while saving the entities to the "+e+(" collection on the "+i.name+" IndexedDB database. "+t.target.error.message+".")))};case 4:case"end":return c.stop()}},c,i)}));return function(e){return s.apply(this,arguments)}}(),a)}));case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n=this;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new s.Promise(function(r,i){n.openTransaction(e,!0,function(){var a=o(l["default"].mark(function s(o){var a,c;return l["default"].wrap(function(s){for(;;)switch(s.prev=s.next){case 0:a=o.objectStore(e),c=a.get(t),a["delete"](t),o.oncomplete=function(){var o=c.result;o?r(o):i(new u.NotFoundError("An entity with id = "+t+" was not found in the "+e+(" collection on the "+n.name+" IndexedDB database.")))},o.onerror=function(){i(new u.NotFoundError("An entity with id = "+t+" was not found in the "+e+(" collection on the "+n.name+" IndexedDB database.")))};case 5:case"end":return s.stop()}},s,n)}));return function(e){return a.apply(this,arguments)}}(),i)}));case 1:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function t(){return r.apply(this,arguments)}var r=o(l["default"].mark(function n(){var t=this;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new s.Promise(function(r,n){var o=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,i=o.deleteDatabase(t.name);i.onsuccess=function(){g={},r()},i.onerror=function(e){n(new u.KinveyError("An error occurred while clearing the "+t.name+" IndexedDB database."+(" "+e.target.error.message+".")))}}));case 1:case"end":return r.stop()}},n,this)}));return t}()}],[{key:"isSupported",value:function(){var t=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB;return!!t}}]),t}()}).call(t,function(){return this}())},function(e,t,r){(function(e,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new c.Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):c.Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.WebSQL=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(162),c=r(210),l=r(9),f=o(l),p=r(235),h=o(p),d=r(156),v=o(d),y=r(80),m=o(y),b=r(35),g=o(b),w=r(158),_=o(w),x=e.env.KINVEY_ID_ATTRIBUTE||"_id",k="sqlite_master",O=5e6,j={};t.WebSQL=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"kinvey":arguments[0];a(this,e),this.name=t}return u(e,[{key:"openDatabase",value:function(){var e=j[this.name];return e||(e=n.openDatabase(this.name,1,"",O),j[this.name]=e),e}},{key:"openTransaction",value:function(e,t,r){var n=this,o=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=this.openDatabase(),a='"'+e+'"',u=e===k,l=(0,m["default"])(t);t=l?t:[[t,r]];var f=new c.Promise(function(r,c){var f=o||!(0,g["default"])(i.readTransaction);i[f?"transaction":"readTransaction"](function(e){o&&!u&&e.executeSql("CREATE TABLE IF NOT EXISTS "+a+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)");var n=t.length,i=[];0===n?r(l?i:i.shift()):(0,v["default"])(t,function(t){var o=t[0].replace("#{collection}",a);e.executeSql(o,t[1],function(e,t){var o={rowCount:t.rowsAffected,result:[]};if(t.rows.length)for(var a=0,s=t.rows.length;a<s;a++)try{var c=t.rows.item(a).value,f=u?c:JSON.parse(c);o.result.push(f)}catch(p){}i.push(o),n-=1,0===n&&r(l?i:i.shift())})})},function(t){if(t=(0,_["default"])(t)?t:t.message,t&&t.indexOf("no such table")===-1)return c(new s.NotFoundError("The "+e+" collection was not found on"+(" the "+n.name+" WebSQL database.")));var r="SELECT name AS value from #{collection} WHERE type = ? AND name = ?",o=["table",e];return n.openTransaction(k,r,o).then(function(t){return c(0===t.result.length?new s.NotFoundError("The "+e+" collection was not found on"+(" the "+n.name+" WebSQL database.")):new s.KinveyError("Unable to open a transaction for the "+e+(" collection on the "+n.name+" WebSQL database.")))})["catch"](function(t){c(new s.KinveyError("Unable to open a transaction for the "+e+(" collection on the "+n.name+" WebSQL database."),t))})})});return f}},{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=i(f["default"].mark(function r(e){var t,n;return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t="SELECT value FROM #{collection}",r.next=3,this.openTransaction(e,t,[]);case 3:return n=r.sent,r.abrupt("return",n.result);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(f["default"].mark(function r(e,t){var n,o,i;return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n="SELECT value FROM #{collection} WHERE key = ?",r.next=3,this.openTransaction(e,n,[t]);case 3:if(o=r.sent,i=o.result,0!==i.length){r.next=7;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" WebSQL database."));case 7:return r.abrupt("return",i[0]);case 8:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(f["default"].mark(function r(e,t){var n;return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=[],t=(0,h["default"])(t,function(e){return n.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e[x],JSON.stringify(e)]]),e}),r.next=4,this.openTransaction(e,n,null,!0);case 4:return r.abrupt("return",t);case 5:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(f["default"].mark(function r(e,t){var n,o,i,a;return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=[["SELECT value FROM #{collection} WHERE key = ?",[t]],["DELETE FROM #{collection} WHERE key = ?",[t]]],r.next=3,this.openTransaction(e,n,null,!0);case 3:if(o=r.sent,i=o[0].result,a=o[1].rowCount,a=a?a:i.length,0!==a){r.next=9;break}throw new s.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" WebSQL database."));case 9:return r.abrupt("return",i[0]);case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(f["default"].mark(function r(){var e,t,n;return f["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.openTransaction(k,"SELECT name AS value FROM #{collection} WHERE type = ?",["table"],!1);case 2:if(e=r.sent,t=e.result,0!==t.length){r.next=6;break}return r.abrupt("return",null);case 6:return n=t.filter(function(e){return/^[a-zA-Z0-9\-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]}),r.next=9,this.openTransaction(k,n,null,!0);case 9:return j={},r.abrupt("return",null);case 11:case"end":return r.stop()}},r,this)}));return e}()}],[{key:"isSupported",value:function(){return!!n.openDatabase}}]),e}()}).call(t,r(11),function(){return this;
}())},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Memory=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(305),s=n(u),c=r(9),l=n(c),f=r(227),p=n(f),h=r(156),d=n(h),v=r(232),y=n(v),m=r(300),b=n(m),g=r(158),w=n(g),_=r(80),x=n(_),k=e.env.KINVEY_ID_ATTRIBUTE||"_id",O={};t.Memory=function(){function e(t){if(i(this,e),!t)throw new Error("A name for the collection is required to use the memory persistence adapter.",t);if(!(0,w["default"])(t))throw new Error("The name of the collection must be a string to use the memory persistence adapter",t);this.name=t,this.cache=O[t],this.cache||(this.cache=new s["default"],O[t]=this.cache)}return a(e,[{key:"find",value:function(){function e(e){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e){var t;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.cache.get(e),!t){r.next=3;break}return r.abrupt("return",JSON.parse(t));case 3:return r.abrupt("return",[]);case 4:case"end":return r.stop()}},r,this)}));return e}()},{key:"findById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n,o;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(n=r.sent,o=(0,b["default"])(n,function(e){return e[k]===t})){r.next=6;break}throw new Error("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" memory database."));case 6:return r.abrupt("return",o);case 7:case"end":return r.stop()}},r,this)}));return e}()},{key:"save",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n,o,i;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=!1,(0,x["default"])(t)||(t=[t],n=!0),0!==t.length){r.next=4;break}return r.abrupt("return",t);case 4:return r.next=6,this.find(e);case 6:return o=r.sent,o=(0,p["default"])(o,k),t=(0,p["default"])(t,k),i=Object.keys(t),(0,d["default"])(i,function(e){o[e]=t[e]}),this.cache.set(e,JSON.stringify((0,y["default"])(o))),t=(0,y["default"])(t),r.abrupt("return",n?t[0]:t);case 14:case"end":return r.stop()}},r,this)}));return e}()},{key:"removeById",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(e,t){var n,o;return l["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.find(e);case 2:if(n=r.sent,n=(0,p["default"])(n,k),o=n[t]){r.next=7;break}throw new Error("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+this.name+" memory database."));case 7:return delete n[t],this.cache.set(e,JSON.stringify((0,y["default"])(n))),r.abrupt("return",o);case 10:case"end":return r.stop()}},r,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=o(l["default"].mark(function r(){return l["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.cache.clear(),e.abrupt("return",null);case 2:case"end":return e.stop()}},r,this)}));return e}()}],[{key:"isSupported",value:function(){return!0}}]),e}()}).call(t,r(11))},function(e,t){"use strict";function r(){this._cache=n(),this._timeouts=n()}function n(){return Object.create(null)}r.prototype.get=function(e){return this._cache[e]},r.prototype.set=function(e,t,r){this["delete"](e),this._cache[e]=t,r&&(this._timeouts[e]=setTimeout(this["delete"].bind(this,e),1e3*r))},r.prototype["delete"]=function(e){delete this._cache[e],e in this._timeouts&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},r.prototype.clear=function(){this._cache=n();for(var e in this._timeouts)clearTimeout(this._timeouts[e]);this._timeouts=n()},e.exports=r},function(e,t,r){(function(t){e.exports=r(t.env.PROMISE_QUEUE_COVERAGE?307:308)}).call(t,r(11))},function(e,t){},function(e,t,r){var n,o;!function(i,a){"use strict";"object"==typeof e&&e.exports?e.exports=a():(n=a,o="function"==typeof n?n.call(t,r,t,e):n,!(void 0!==o&&(e.exports=o)))}(this,function(){"use strict";function e(e,t){this.pendingPromises=0,this.maxPendingPromises="undefined"!=typeof e?e:1/0,this.maxQueuedPromises="undefined"!=typeof t?t:1/0,this.queue=[]}var t="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},r=function(){},n=function(e){return e&&"function"==typeof e.then?e:new t(function(t){t(e)})};return e.configure=function(e){t=e},e.prototype.add=function(e){var n=this;return new t(function(t,o,i){return n.queue.length>=n.maxQueuedPromises?void o(new Error("Queue limit reached")):(n.queue.push({promiseGenerator:e,resolve:t,reject:o,notify:i||r}),void n._dequeue())})},e.prototype.getPendingLength=function(){return this.pendingPromises},e.prototype.getQueueLength=function(){return this.queue.length},e.prototype._dequeue=function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var t=this.queue.shift();if(!t)return!1;try{this.pendingPromises++,n(t.promiseGenerator()).then(function(r){e.pendingPromises--,t.resolve(r),e._dequeue()},function(r){e.pendingPromises--,t.reject(r),e._dequeue()},function(e){t.notify(e)})}catch(r){e.pendingPromises--,t.reject(r),e._dequeue()}return!0},e})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.XHRMiddleware=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(6),c=r(210),l=r(310),f=n(l);t.XHRMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Http Middleware":arguments[0];return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),u(t,[{key:"handle",value:function(e){var t=new c.Promise(function(t){var r=e.url,n=e.method,o=e.headers,i=e.body,a=new XMLHttpRequest;a.open(n,r);var u=Object.keys(o),s=!0,c=!1,l=void 0;try{for(var p,h=u[Symbol.iterator]();!(s=(p=h.next()).done);s=!0){var d=p.value;a.setRequestHeader(d,o[d])}}catch(v){c=!0,l=v}finally{try{!s&&h["return"]&&h["return"]()}finally{if(c)throw l}}a.onload=a.ontimeout=a.onabort=a.onerror=function(){var e=a.status,r=a.response||null;return a.response&&(r=a.responseText||null),t({response:{statusCode:e,headers:(0,f["default"])(a.getAllResponseHeaders()),data:r}})},a.send(i)});return t}}]),t}(s.Middleware)},function(e,t,r){var n=r(311),o=r(312),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return o(n(e).split("\n"),function(e){var r=e.indexOf(":"),o=n(e.slice(0,r)).toLowerCase(),a=n(e.slice(r+1));"undefined"==typeof t[o]?t[o]=a:i(t[o])?t[o].push(a):t[o]=[t[o],a]}),t}},function(e,t){function r(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=r,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,r){function n(e,t,r){if(!u(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===s.call(e)?o(e,t,r):"string"==typeof e?i(e,t,r):a(e,t,r)}function o(e,t,r){for(var n=0,o=e.length;n<o;n++)c.call(e,n)&&t.call(r,e[n],n,e)}function i(e,t,r){for(var n=0,o=e.length;n<o;n++)t.call(r,e.charAt(n),n,e)}function a(e,t,r){for(var n in e)c.call(e,n)&&t.call(r,e[n],n,e)}var u=r(313);e.exports=n;var s=Object.prototype.toString,c=Object.prototype.hasOwnProperty},function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=r;var n=Object.prototype.toString},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParseMiddleware=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(6),l=r(9),f=n(l);t.ParseMiddleware=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Parse Middleware":arguments[0];return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),s(t,[{key:"handle",value:function(){function e(e,r){return t.apply(this,arguments)}var t=o(f["default"].mark(function r(e,t){var n;return f["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.data&&(n=t.headers["content-type"]||t.headers["Content-Type"],n&&0===n.indexOf("application/json")))try{t.data=JSON.parse(t.data)}catch(r){}return e.abrupt("return",{response:t});case 2:case"end":return e.stop()}},r,this)}));return e}()}]),t}(c.Middleware)},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeMiddleware=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(6),l=r(9),f=n(l);t.SerializeMiddleware=function(t){function r(){var e=arguments.length<=0||void 0===arguments[0]?"Serialize Middleware":arguments[0];return i(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return u(r,t),s(r,[{key:"handle",value:function(){function t(e){return r.apply(this,arguments)}var r=o(f["default"].mark(function n(t){var r,o,i,a,u,s,c,l,p,h;return f["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t||!t.body){n.next=31;break}if(r=t.headers["content-type"]||t.headers["Content-Type"],!r){n.next=31;break}if(0!==r.indexOf("application/json")){n.next=7;break}t.body=JSON.stringify(t.body),n.next=31;break;case 7:if(0!==r.indexOf("application/x-www-form-urlencoded")){n.next=31;break}for(o=t.body,i=Object.keys(o),a=[],u=!0,s=!1,c=void 0,n.prev=14,l=i[Symbol.iterator]();!(u=(p=l.next()).done);u=!0)h=p.value,a.push(e.encodeURIComponent(h)+"="+e.encodeURIComponent(o[h]));n.next=22;break;case 18:n.prev=18,n.t0=n["catch"](14),s=!0,c=n.t0;case 22:n.prev=22,n.prev=23,!u&&l["return"]&&l["return"]();case 25:if(n.prev=25,!s){n.next=28;break}throw c;case 28:return n.finish(25);case 29:return n.finish(22);case 30:t.body=a.join("&");case 31:return n.abrupt("return",{request:t});case 32:case"end":return n.stop()}},n,this,[[14,18,22,30],[23,,25,29]])}));return t}()}]),r}(c.Middleware)}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRack=t.CacheRack=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function m(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)},l=r(6),f=r(4),p=r(9),h=n(p),d=r(231),v=n(d),y=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),s(t,[{key:"execute",value:function(){function e(e){return r.apply(this,arguments)}var r=o(h["default"].mark(function n(e){var r,o;return h["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,(0,v["default"])(e,"toPlainObject",e));case 2:return r=n.sent,o=r.response,n.abrupt("return",o);case 5:case"end":return n.stop()}},n,this)}));return e}()}]),t}(l.Rack);t.CacheRack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Cache Rack":arguments[0];i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.use(new f.CacheMiddleware),r}return u(t,e),t}(y),t.NetworkRack=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Network Rack":arguments[0];i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.use(new f.SerializeMiddleware),r.use(new f.XHRMiddleware),r.use(new f.ParseMiddleware),r}return u(t,e),t}(y)},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Device=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(318),u=n(a);t.Device=function(){function t(){o(this,t)}return i(t,null,[{key:"toJSON",value:function(){var t=e.navigator.userAgent.toLowerCase(),r=/(chrome)\/([\w]+)/,n=/(firefox)\/([\w.]+)/,o=/(msie) ([\w.]+)/i,i=/(opera)(?:.*version)?[ \/]([\w.]+)/,a=/(safari)\/([\w.]+)/,s=/(applewebkit)\/([\w.]+)/,c=r.exec(t)||n.exec(t)||o.exec(t)||i.exec(t)||a.exec(t)||s.exec(t)||[];return{device:{model:e.navigator.userAgent},platform:{name:"html5"},os:{name:c[1],version:c[2]},kinveySDK:{name:u["default"].name,version:u["default"].version}}}}]),t}()}).call(t,function(){return this}())},function(e,t){e.exports={name:"kinvey-html5-sdk",version:"3.1.0",description:"Kinvey JavaScript SDK for HTML5.",homepage:"http://www.kinvey.com",bugs:{url:"https://github.com/Kinvey/html5-sdk/issues"},license:"Apache-2.0",author:"Kinvey",contributors:["Thomas Conner <thomas@kinvey.com>"],main:"./dist/export.js",repository:{type:"git",url:"git@github.com:Kinvey/html5-sdk"},scripts:{build:"gulp build",bundle:"gulp bundle",clean:"gulp clean",lint:"gulp lint",test:"npm run test:unit","test:unit":"mocha --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit","test:unit:watch":"mocha -w --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit","test:jenkins":"npm run test:unit:jenkins","test:unit:jenkins":"istanbul cover _mocha -- --reporter tap --compilers js:babel-core/register -r babel-polyfill -s 100 --recursive test/unit/setup test/unit > test.tap && istanbul report clover","e2e:server":"webdriver-manager update && webdriver-manager start","e2e:app":"npm run bundle && node ./test/e2e/app","e2e:test":"protractor ./test/e2e/test/protractor.conf.js"},dependencies:{"es6-promise":"^3.2.1","kinvey-javascript-rack":"^1.0.0","kinvey-javascript-sdk-core":"^3.0.0",lodash:"^4.8.2","parse-headers":"^2.0.1","promise-queue":"^2.2.3","regenerator-runtime":"^0.9.5"},peerDependencies:{"kinvey-javascript-rack":"^1.0.0","kinvey-javascript-sdk-core":"^3.0.0"},devDependencies:{"babel-core":"^6.9.0","babel-eslint":"^6.0.0","babel-polyfill":"^6.9.0","babel-preset-es2015":"^6.9.0","babel-preset-stage-2":"^6.0.15","babel-register":"^6.9.0",del:"^2.0.2",eslint:"^2.12.0","eslint-config-airbnb":"^9.0.1","eslint-plugin-import":"^1.8.0","eslint-plugin-jsx-a11y":"^1.2.2","eslint-plugin-react":"^5.1.1",expect:"^1.20.2",express:"^4.14.0",gulp:"^3.9.0","gulp-babel":"^6.1.2","gulp-banner":"^0.1.3","gulp-buffer":"0.0.2","gulp-bump":"^2.1.0","gulp-env":"^0.4.0","gulp-eslint":"^2.0.0","gulp-git":"^1.7.0","gulp-plumber":"^1.0.1","gulp-prompt":"^0.2.0","gulp-rename":"^1.2.2","gulp-s3-upload":"^1.6.0","gulp-sourcemaps":"^1.6.0","gulp-tag-version":"^1.3.0","gulp-uglify":"^1.5.1","gulp-util":"^3.0.6",istanbul:"^0.4.3","json-loader":"^0.5.4",mocha:"^2.5.3",nock:"^8.0.0",protractor:"^4.0.3","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",webpack:"^1.13.0","webpack-stream":"^3.1.0",yargs:"^4.7.1"},engines:{node:">=4.0"},keywords:["Kinvey","JavaScript","HTML5"]}},function(e,t,r){(function(e){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var a=t[o](i),u=a.value}catch(s){return void r(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return n("next",e)},function(e){return n("throw",e)})}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(320),l=r(9),f=n(l);t.Popup=function(t){function r(){return i(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return u(r,t),s(r,[{key:"open",value:function(){function t(e){return r.apply(this,arguments)}var r=o(f["default"].mark(function n(){var t=this,r=arguments.length<=0||void 0===arguments[0]?"/":arguments[0];return f["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.popupWindow=e.open(r,"_blank","toolbar=no,location=no"),!this.popupWindow){n.next=5;break}this.interval=setInterval(function(){if(t.popupWindow.closed)t.exitCallback();else try{t.loadStopCallback({url:t.popupWindow.location.href})}catch(e){}},100),n.next=6;break;case 5:throw new Error("The popup was blocked.");case 6:return n.abrupt("return",this);case 7:case"end":return n.stop()}},n,this)}));return t}()},{key:"close",value:function(){function e(){return t.apply(this,arguments)}var t=o(f["default"].mark(function r(){return f["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.popupWindow&&this.popupWindow.close(),e.abrupt("return",this);case 2:case"end":return e.stop()}},r,this)}));return e}()},{key:"loadStartCallback",value:function(e){this.emit("loadstart",e)}},{key:"loadStopCallback",value:function(e){this.emit("loadstop",e)}},{key:"loadErrorCallback",value:function(e){this.emit("error",e)}},{key:"exitCallback",value:function(){clearInterval(this.interval),this.emit("closed")}}]),r}(c.EventEmitter)}).call(t,function(){return this}())},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,o,u,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],a(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(i(r))for(u=Array.prototype.slice.call(arguments,1),c=r.slice(),o=c.length,s=0;s<o;s++)c[s].apply(this,u);return!0},r.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,o,a,u;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],a=r.length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(u=a;u-- >0;)if(r[u]===t||r[u].listener&&r[u].listener===t){o=u;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}}])});