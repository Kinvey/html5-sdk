/**
 * kinvey-html5-sdk - Kinvey JavaScript SDK for HTML5 applications.
 * @version v3.9.8
 * @author Kinvey, Inc.
 * @link http://www.kinvey.com
 * @license Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Kinvey=t():e.Kinvey=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=133)}([function(e,t,n){"use strict";function r(e,t,n,r){this.name="BaseError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseError=r,(r.prototype=Object.create(Error.prototype)).constructor=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(139);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(140);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(141);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(142);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(143);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(0);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=n(144);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=n(145);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var f=n(146);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var h=n(147);Object.keys(h).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})});var p=n(148);Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})});var d=n(149);Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var y=n(150);Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}})});var v=n(151);Object.keys(v).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})});var b=n(152);Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return b[e]}})});var g=n(153);Object.keys(g).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})});var m=n(154);Object.keys(m).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})});var _=n(155);Object.keys(_).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}})});var w=n(156);Object.keys(w).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return w[e]}})});var O=n(157);Object.keys(O).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return O[e]}})});var E=n(158);Object.keys(E).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return E[e]}})});var k=n(159);Object.keys(k).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return k[e]}})});var P=n(160);Object.keys(P).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return P[e]}})});var j=n(161);Object.keys(j).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return j[e]}})});var S=n(162);Object.keys(S).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return S[e]}})});var x=n(163);Object.keys(x).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return x[e]}})});var T=n(164);Object.keys(T).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return T[e]}})});var A=n(165);Object.keys(A).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return A[e]}})});var M=n(166);Object.keys(M).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return M[e]}})});var C=n(167);Object.keys(C).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return C[e]}})});var R=n(168);Object.keys(R).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return R[e]}})});var I=n(169);Object.keys(I).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return I[e]}})});var q=n(170);Object.keys(q).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return q[e]}})});var D=n(171);Object.keys(D).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return D[e]}})});var N=n(172);Object.keys(N).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return N[e]}})});var U=n(173);Object.keys(U).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return U[e]}})});var K=n(174);Object.keys(K).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return K[e]}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(85);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(177);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(178);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(0,function(){"use strict";function e(e){return"function"==typeof e}function o(){var e=setTimeout;return function(){return e(i,1)}}function i(){for(var e=0;e<k;e+=2){(0,R[e])(R[e+1]),R[e]=void 0,R[e+1]=void 0}k=0}function u(){try{var e=n(138);return void 0!==(P=e.runOnLoop||e.runOnContext)?function(){P(i)}:o()}catch(e){return o()}}function a(e,t){var n=arguments,r=this,o=new this.constructor(c);void 0===o[q]&&_(o);var i=r._state;return i?function(){var e=n[i-1];S(function(){return m(i,o,e,r._result)})}():v(r,o,e,t),o}function s(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(c);return h(t,e),t}function c(){}function l(e){try{return e.then}catch(e){return K.error=e,K}}function f(t,n,r){n.constructor===t.constructor&&r===a&&n.constructor.resolve===s?function(e,t){t._state===N?d(e,t._result):t._state===U?y(e,t._result):v(t,void 0,function(t){return h(e,t)},function(t){return y(e,t)})}(t,n):r===K?(y(t,K.error),K.error=null):void 0===r?d(t,n):e(r)?function(e,t,n){S(function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?h(e,n):d(e,n))},function(t){r||(r=!0,y(e,t))},e._label);!r&&o&&(r=!0,y(e,o))},e)}(t,n,r):d(t,n)}function h(e,t){e===t?y(e,new TypeError("You cannot resolve a promise with itself")):!function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?d(e,t):f(e,t,l(t))}function p(e){e._onerror&&e._onerror(e._result),b(e)}function d(e,t){e._state===D&&(e._result=t,e._state=N,0!==e._subscribers.length&&S(b,e))}function y(e,t){e._state===D&&(e._state=U,e._result=t,S(p,e))}function v(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+N]=n,o[i+U]=r,0===i&&e._state&&S(b,e)}function b(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,u=0;u<t.length;u+=3)r=t[u],o=t[u+n],r?m(n,r,o,i):o(i);e._subscribers.length=0}}function g(){this.error=null}function m(t,n,r,o){var i=e(r),u=void 0,a=void 0,s=void 0,c=void 0;if(i){if((u=function(e,t){try{return e(t)}catch(e){return L.error=e,L}}(r,o))===L?(c=!0,a=u.error,u.error=null):s=!0,n===u)return void y(n,new TypeError("A promises callback cannot return that same promise."))}else u=o,s=!0;n._state!==D||(i&&s?h(n,u):c?y(n,a):t===N?d(n,u):t===U&&y(n,u))}function _(e){e[q]=B++,e._state=void 0,e._result=void 0,e._subscribers=[]}function w(e,t){this._instanceConstructor=e,this.promise=new e(c),this.promise[q]||_(this.promise),E(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?d(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&d(this.promise,this._result))):y(this.promise,new Error("Array Methods must be provided an Array"))}function O(e){this[q]=B++,this._result=this._state=void 0,this._subscribers=[],c!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof O?function(e,t){try{t(function(t){h(e,t)},function(t){y(e,t)})}catch(t){y(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var E=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},k=0,P=void 0,j=void 0,S=function(e,t){R[k]=e,R[k+1]=t,2===(k+=2)&&(j?j(i):I())},x="undefined"!=typeof window?window:void 0,T=x||{},A=T.MutationObserver||T.WebKitMutationObserver,M="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),C="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,R=new Array(1e3),I=void 0;I=M?function(){return t.nextTick(i)}:A?function(){var e=0,t=new A(i),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():C?function(){var e=new MessageChannel;return e.port1.onmessage=i,function(){return e.port2.postMessage(0)}}():void 0===x?u():o();var q=Math.random().toString(36).substring(16),D=void 0,N=1,U=2,K=new g,L=new g,B=0;return w.prototype._enumerate=function(e){for(var t=0;this._state===D&&t<e.length;t++)this._eachEntry(e[t],t)},w.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===s){var o=l(e);if(o===a&&e._state!==D)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===O){var i=new n(c);f(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},w.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===D&&(this._remaining--,e===U?y(r,n):this._result[t]=n),0===this._remaining&&d(r,this._result)},w.prototype._willSettleAt=function(e,t){var n=this;v(e,void 0,function(e){return n._settledAt(N,t,e)},function(e){return n._settledAt(U,t,e)})},O.all=function(e){return new w(this,e).promise},O.race=function(e){var t=this;return E(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},O.resolve=s,O.reject=function(e){var t=new this(c);return y(t,e),t},O._setScheduler=function(e){j=e},O._setAsap=function(e){S=e},O._asap=S,O.prototype={constructor:O,then:a,catch:function(e){return this.then(null,e)}},O.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=O},O.Promise=O,O})}).call(t,n(137),n(9))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(300);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(46);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(118);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(45);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(30);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=n(70);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=n(114);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})})},function(e,t,n){var r=n(17),o=n(3),i=n(15),u="[object String]";e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&r(e)==u}},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&u.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}var i=n(179),u=n(180);t.parse=o,t.resolve=function(e,t){return o(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},t.format=function(e){return u.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)},t.Url=r;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(l),h=["%","/","?",";","#"].concat(f),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=n(181);r.prototype.parse=function(e,t,n){if(!u.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",s=e.split(o);s[0]=s[0].replace(/\\/g,"/");var l=e=s.join(o);if(l=l.trim(),!n&&1===e.split("#").length){var _=c.exec(l);if(_)return this.path=l,this.href=l,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=a.exec(l);if(w){var O=(w=w[0]).toLowerCase();this.protocol=O,l=l.substr(w.length)}if(n||w||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===l.substr(0,2);!E||w&&b[w]||(l=l.substr(2),this.slashes=!0)}if(!b[w]&&(E||w&&!g[w])){for(var k=-1,P=0;P<p.length;P++){-1!==(x=l.indexOf(p[P]))&&(-1===k||x<k)&&(k=x)}var j,S;-1!==(S=-1===k?l.lastIndexOf("@"):l.lastIndexOf("@",k))&&(j=l.slice(0,S),l=l.slice(S+1),this.auth=decodeURIComponent(j)),k=-1;for(P=0;P<h.length;P++){var x;-1!==(x=l.indexOf(h[P]))&&(-1===k||x<k)&&(k=x)}-1===k&&(k=l.length),this.host=l.slice(0,k),l=l.slice(k),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var A=this.hostname.split(/\./),M=(P=0,A.length);P<M;P++){var C=A[P];if(C&&!C.match(d)){for(var R="",I=0,q=C.length;I<q;I++)C.charCodeAt(I)>127?R+="x":R+=C[I];if(!R.match(d)){var D=A.slice(0,P),N=A.slice(P+1),U=C.match(y);U&&(D.push(U[1]),N.unshift(U[2])),N.length&&(l="/"+N.join(".")+l),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=i.toASCII(this.hostname));var K=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+K,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!v[O])for(P=0,M=f.length;P<M;P++){var B=f[P];if(-1!==l.indexOf(B)){var F=encodeURIComponent(B);F===B&&(F=escape(B)),l=l.split(B).join(F)}}var H=l.indexOf("#");-1!==H&&(this.hash=l.substr(H),l=l.slice(0,H));var G=l.indexOf("?");if(-1!==G?(this.search=l.substr(G),this.query=l.substr(G+1),t&&(this.query=m.parse(this.query)),l=l.slice(0,G)):t&&(this.search="",this.query={}),l&&(this.pathname=l),g[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){K=this.pathname||"";var z=this.search||"";this.path=K+z}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(i=m.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+o+n+a+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(u.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var a=o[i];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var l=s[c];"protocol"!==l&&(n[l]=e[l])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!g[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var p=f[h];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||b[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var y=n.pathname||"",v=n.search||"";n.path=y+v}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=_||m||n.host&&e.pathname,O=w,E=n.pathname&&n.pathname.split("/")||[],k=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(k&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),w=w&&(""===d[0]||""===E[0])),_)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,E=d;else if(d.length)E||(E=[]),E.pop(),E=E.concat(d),n.search=e.search,n.query=e.query;else if(!u.isNullOrUndefined(e.search)){if(k){n.hostname=n.host=E.shift();(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return n.search=e.search,n.query=e.query,u.isNull(n.pathname)&&u.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var P=E.slice(-1)[0],j=(n.host||e.host||E.length>1)&&("."===P||".."===P)||""===P,S=0,x=E.length;x>=0;x--)"."===(P=E[x])?E.splice(x,1):".."===P?(E.splice(x,1),S++):S&&(E.splice(x,1),S--);if(!w&&!O)for(;S--;S)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),j&&"/"!==E.join("/").substr(-1)&&E.push("");var T=""===E[0]||E[0]&&"/"===E[0].charAt(0);if(k){n.hostname=n.host=T?"":E.length?E.shift():"";var A;(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=A.shift(),n.host=n.hostname=A.shift())}return(w=w||n.host&&E.length)&&!T&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),u.isNull(n.pathname)&&u.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=r(n(97)),a=r(n(7)),s=r(n(6)),c=r(n(62)),l=n(1),f=n(19),h=n(2),p=6e4,d=null,y=function(){function e(){o(this,e),this.memory=new u.default}return i(e,[{key:"get",value:function(e){if(!(0,s.default)(e))throw new l.KinveyError("ActiveUserStorage key must be a string.");try{return JSON.parse(this.memory.get(e))}catch(e){return null}}},{key:"set",value:function(e,t){if(!(0,s.default)(e))throw new l.KinveyError("ActiveUserStorage key must be a string.");return(0,h.isDefined)(t)?this.memory.set(e,JSON.stringify(t)):this.memory.delete(e),t}}]),e}();t.Client=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=(0,s.default)(t.apiHostname)?t.apiHostname:"https://baas.kinvey.com";!1===/^https?:\/\//i.test(n)&&(n="https://"+n);var r=a.default.parse(n);this.deviceId=(0,h.uuidv4)(),this.apiProtocol=r.protocol,this.apiHost=r.host;var i=(0,s.default)(t.micHostname)?t.micHostname:"https://auth.kinvey.com";!1===/^https?:\/\//i.test(i)&&(i="https://"+i);var u=a.default.parse(i);this.micProtocol=u.protocol,this.micHost=u.host,this.appKey=t.appKey,this.appSecret=t.appSecret,this.masterSecret=t.masterSecret,this.encryptionKey=t.encryptionKey,this.appVersion=t.appVersion,this.defaultTimeout=(0,c.default)(t.defaultTimeout)&&t.defaultTimeout>=0?t.defaultTimeout:p,this.activeUserStorage=new y}return i(e,[{key:"getActiveUser",value:function(){return this.activeUserStorage.get(this.appKey+".active_user")}},{key:"setActiveUser",value:function(e){return this.activeUserStorage.set(this.appKey+".active_user",e)}},{key:"toPlainObject",value:function(){return{deviceId:this.deviceId,apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion}}},{key:"apiHostname",get:function(){return a.default.format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"micHostname",get:function(){return a.default.format({protocol:this.micProtocol,host:this.micHost})}},{key:"appVersion",get:function(){return this._appVersion},set:function(e){e&&!(0,s.default)(e)&&(e=String(e)),this._appVersion=e}},{key:"defaultTimeout",get:function(){return this._defaultTimeout},set:function(e){if(e=parseInt(e,10),!1===(0,c.default)(e)||isNaN(e))throw new l.KinveyError("Invalid timeout. Timeout must be a number.");e<0&&(f.Log.info("Default timeout is less than 0. Setting default timeout to "+defaultTimeout+"ms."),e=defaultTimeout),this._defaultTimeout=e}}],[{key:"initialize",value:function(){throw new l.KinveyError("Please use Client.init().")}},{key:"init",value:function(t){return d=new e(t)}},{key:"sharedInstance",value:function(){if(!1===(0,h.isDefined)(d))throw new l.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return d}}]),e}()},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Query=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(254)),u=r(n(28)),a=n(1),s=n(2),c=n(19),l=["$nearSphere"],f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=Object.assign({fields:[],filter:{},sort:null,limit:null,skip:0},t),this.fields=t.fields,this.filter=t.filter,this.sort=t.sort,this.limit=t.limit,this.skip=t.skip,this._parent=null}return o(e,[{key:"isSupportedOffline",value:function(){var e=this;return Object.keys(this.filter).reduce(function(t,n){if(t){var r=e.filter[n];return l.some(function(e){return!r||!Object.keys(r).some(function(t){return t===e})})}return t},!0)}},{key:"equalTo",value:function(e,t){return this.addFilter(e,t)}},{key:"contains",value:function(e,t){if(!1===(0,s.isDefined)(t))throw new a.QueryError("You must supply a value.");return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){if(!1===(0,s.isDefined)(t))throw new a.QueryError("You must supply a value.");return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$all",t)}},{key:"greaterThan",value:function(e,t){if(!1===(0,s.isNumber)(t)&&"string"!=typeof t)throw new a.QueryError("You must supply a number or string.");return this.addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){if(!1===(0,s.isNumber)(t)&&"string"!=typeof t)throw new a.QueryError("You must supply a number or string.");return this.addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){if(!1===(0,s.isNumber)(t)&&"string"!=typeof t)throw new a.QueryError("You must supply a number or string.");return this.addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){if(!1===(0,s.isNumber)(t)&&"string"!=typeof t)throw new a.QueryError("You must supply a number or string.");return this.addFilter(e,"$lte",t)}},{key:"notEqualTo",value:function(e,t){return this.addFilter(e,"$ne",t)}},{key:"notContainedIn",value:function(e,t){return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$nin",t)}},{key:"and",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.join("$and",t)}},{key:"nor",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if((0,s.isDefined)(this._parent)&&Object.hasOwnProperty.call(this._parent.filter,"$and")){var r;return(r=this._parent).nor.apply(r,t)}return this.join("$nor",t)}},{key:"or",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if((0,s.isDefined)(this._parent)){var r;return(r=this._parent).or.apply(r,t)}return this.join("$or",t)}},{key:"exists",value:function(e,t){return t=void 0===t||(t||!1),this.addFilter(e,"$exists",t)}},{key:"mod",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("string"==typeof t&&(t=parseFloat(t)),"string"==typeof n&&(n=parseFloat(n)),!(0,s.isNumber)(t))throw new a.QueryError("divisor must be a number");if(!(0,s.isNumber)(n))throw new a.QueryError("remainder must be a number");return this.addFilter(e,"$mod",[t,n])}},{key:"matches",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];if(t instanceof RegExp||(t=new RegExp(t)),0!==t.source.indexOf("^"))throw new a.QueryError("regExp must have '^' at the beginning of the expression to make it an anchored expression.");if((t.ignoreCase||n.ignoreCase)&&!1!==n.ignoreCase)throw new a.QueryError("ignoreCase flag is not supported");return(t.multiline||n.multiline)&&!1!==n.multiline&&r.push("m"),!0===n.extended&&r.push("x"),!0===n.dotMatchesAll&&r.push("s"),r.length>0&&this.addFilter(e,"$options",r.join("")),this.addFilter(e,"$regex",t.source)}},{key:"near",value:function(e,t,n){if(!Array.isArray(t)||!(0,s.isNumber)(t[0])||!(0,s.isNumber)(t[1]))throw new a.QueryError("coord must be a [number, number]");var r=this.addFilter(e,"$nearSphere",[t[0],t[1]]);return(0,s.isNumber)(n)&&this.addFilter(e,"$maxDistance",n),r}},{key:"withinBox",value:function(e,t,n){if(!Array.isArray(t)||!(0,s.isNumber)(t[0])||!(0,s.isNumber)(t[1]))throw new a.QueryError("bottomLeftCoord must be a [number, number]");if(!Array.isArray(n)||!(0,s.isNumber)(n[0])||!(0,s.isNumber)(n[1]))throw new a.QueryError("upperRightCoord must be a [number, number]");t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),n[0]=parseFloat(n[0]),n[1]=parseFloat(n[1]);var r=[[t[0],t[1]],[n[0],n[1]]];return this.addFilter(e,"$within",{$box:r})}},{key:"withinPolygon",value:function(e,t){if(!1===Array.isArray(t)||0===t.length||t.length>3)throw new a.QueryError("coords must be a [[number, number]]");return t=t.map(function(e){if(!1===(0,s.isNumber)(e[0])||!1===(0,s.isNumber)(e[1]))throw new a.QueryError("coords argument must be a [number, number]");return[parseFloat(e[0]),parseFloat(e[1])]}),this.addFilter(e,"$within",{$polygon:t})}},{key:"size",value:function(e,t){if("string"==typeof t&&(t=parseFloat(t)),!(0,s.isNumber)(t))throw new a.QueryError("size must be a number");return this.addFilter(e,"$size",t)}},{key:"ascending",value:function(e){return(0,s.isDefined)(this._parent)?this._parent.ascending(e):this.sort[e]=1,this}},{key:"descending",value:function(e){return(0,s.isDefined)(this._parent)?this._parent.descending(e):this.sort[e]=-1,this}},{key:"addFilter",value:function(e,t,n){return(0,s.isDefined)(t)&&((0,s.isDefined)(n)||3===arguments.length)?((0,u.default)(this.filter[e])||(this.filter[e]={}),this.filter[e][t]=n):this.filter[e]=t,this}},{key:"join",value:function(t,n){var r=this,o=this,i={};0===(n=n.map(function(t){if(!(t instanceof e)){if(!(0,u.default)(t))throw new a.QueryError("query argument must be of type: Kinvey.Query[] or Object[].");t=new e(t)}return t.toPlainObject().filter})).length&&(n=[(o=new e).toPlainObject().filter],o._parent=this);return Object.keys(this.filter).forEach(function(e){i[e]=r.filter[e],delete r.filter[e]}),this.filter[t]=[i].concat(n),o}},{key:"process",value:function(e){if(!this.isSupportedOffline()){var t="This query is not able to run locally. The following filters are not supported locally:";throw l.forEach(function(e){t=t+" "+e}),c.Log.error(t),new a.QueryError(t)}if(!Array.isArray(e))throw new a.QueryError("data argument must be of type: Array.");c.Log.debug("Data length before processiong query",e.length);var n=this.toPlainObject();return e=(0,i.default)(n.filter,e),c.Log.debug("Data length after applying query filter",n.filter,e.length),(0,s.isDefined)(n.sort)&&(c.Log.debug("Sorting data",n.sort),e.sort(function(e,t){for(var r in n.sort)if(n.sort.hasOwnProperty(r)){var o=(0,s.nested)(e,r),i=(0,s.nested)(t,r),u=n.sort[r];if((0,s.isDefined)(o)&&!1===(0,s.isDefined)(i))return 1*u;if(!1===(0,s.isDefined)(o)&&(0,s.isDefined)(i))return-1*u;if(void 0===o&&null===i)return 0;if(null===o&&void 0===i)return 0;if(o!==i)return(o<i?-1:1)*u}return 0})),Array.isArray(n.fields)&&n.fields.length>0&&(c.Log.debug("Removing fields from data",n.fields),e=e.map(function(e){return Object.keys(e).forEach(function(t){-1===n.fields.indexOf(t)&&delete e[t]}),e})),(0,s.isNumber)(n.skip)?(0,s.isNumber)(n.limit)&&n.limit>0?(c.Log.debug("Skipping and limiting data",n.skip,n.limit),e.slice(n.skip,n.skip+n.limit)):(c.Log.debug("Skipping data",n.skip),e.slice(n.skip)):e}},{key:"toPlainObject",value:function(){if((0,s.isDefined)(this._parent))return this._parent.toPlainObject();return{fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit}}},{key:"toQueryString",value:function(){var e={};Object.keys(this.filter).length>0&&(e.query=this.filter),this.fields.length>0&&(e.fields=this.fields.join(",")),(0,s.isNumber)(this.limit)&&(e.limit=this.limit),(0,s.isNumber)(this.skip)&&this.skip>0&&(e.skip=this.skip),Object.keys(this.sort).length>0&&(e.sort=this.sort);return Object.keys(e).forEach(function(t){e[t]="string"==typeof e[t]?e[t]:JSON.stringify(e[t])}),e}},{key:"toString",value:function(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function(){return this._fields},set:function(e){if(e=e||[],!Array.isArray(e))throw new a.QueryError("fields must be an Array");(0,s.isDefined)(this._parent)?this._parent.fields=e:this._fields=e}},{key:"filter",get:function(){return this._filter},set:function(e){this._filter=e}},{key:"sort",get:function(){return this._sort},set:function(e){if(e&&!(0,u.default)(e))throw new a.QueryError("sort must an Object");(0,s.isDefined)(this._parent)?this._parent.sort=e:this._sort=e||{}}},{key:"limit",get:function(){return this._limit},set:function(e){if("string"==typeof e&&(e=parseFloat(e)),(0,s.isDefined)(e)&&!1===(0,s.isNumber)(e))throw new a.QueryError("limit must be a number");this._parent?this._parent.limit=e:this._limit=e}},{key:"skip",get:function(){return this._skip},set:function(e){if("string"==typeof e&&(e=parseFloat(e)),!1===(0,s.isNumber)(e))throw new a.QueryError("skip must be a number");(0,s.isDefined)(this._parent)?this._parent.skip=e:this._skip=e}}]),e}();t.Query=f},function(e,t,n){var r=n(89),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var r=n(53),o=n(22),i=n(55),u=n(14),a=n(27),s=n(18),c=Object.prototype.hasOwnProperty,l=i(function(e,t){if(a(t)||u(t))o(t,s(t),e);else for(var n in t)c.call(t,n)&&r(e,n,t[n])});e.exports=l},function(e,t,n){var r=n(16),o=n(57);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(17),o=n(12),i="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";e.exports=function(e){if(!o(e))return!1;var t=r(e);return t==u||t==a||t==i||t==s}},function(e,t,n){var r=n(23),o=n(187),i=n(188),u="[object Null]",a="[object Undefined]",s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:u:s&&s in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(93),o=n(95),i=n(14);e.exports=function(e){return i(e)?r(e):o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(207));r.default.setDefaultLevel(r.default.levels.SILENT);var o=r.default.methodFactory;r.default.methodFactory=function(e,t,n){var r=o(e,t,n);return function(e){e="Kinvey: "+e;for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];n.length>0?r(e,n):r(e)}},t.Log=r.default},function(e,t,n){var r=n(260),o=n(269),i=n(34),u=n(3),a=n(279);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?u(e)?o(e[0],e[1]):r(e):a(e)}},function(e,t,n){var r=n(186),o=n(191);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(53),o=n(54);e.exports=function(e,t,n,i){var u=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],l=i?i(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),u?o(n,c,l):r(n,c,l)}return n}},function(e,t,n){var r=n(11).Symbol;e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregation=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(13)),u=r(n(44)),a=r(n(6)),s=r(n(12)),c=r(n(16)),l=r(n(99)),f=n(1),h=n(2),p=n(10);t.Aggregation=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=(0,i.default)({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t),this.query=t.query,this.initial=t.initial,this.key=t.key,this.reduceFn=t.reduceFn}return o(e,[{key:"by",value:function(e){return this.key[e]=!0,this}},{key:"process",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.toPlainObject(),n=Object.keys(t.key),r=t.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");if(t.reduce=new Function(["doc","out"],r),this.query&&(e=this.query.process(e)),n.length>0){var o=[];return n.forEach(function(n){var r={};e.forEach(function(e){var o=e[n],i=(0,h.isDefined)(r[o])?r[o]:(0,l.default)(t.initial),u=t.reduce(e,i);(0,h.isDefined)(u)&&(i=u),r[o]=i}),Object.keys(r).forEach(function(e){var t={};t[n]=e,t=(0,i.default)({},t,r[e]),o.push(t)})}),o}var a=(0,l.default)(t.initial);return(0,u.default)(e,function(e){var n=t.reduce(e,a);(0,h.isDefined)(n)&&(a=n)}),a}},{key:"toPlainObject",value:function(){return{key:this.key,initial:this.initial,reduce:this.reduceFn,reduceFn:this.reduceFn,condition:this.query?this.query.toPlainObject().filter:{},query:this.query?this.query.toPlainObject():null}}},{key:"initial",get:function(){return(0,l.default)(this._initial)},set:function(e){if(!(0,s.default)(e))throw new f.KinveyError("initial must be an Object.");this._initial=e}},{key:"query",get:function(){return this._query},set:function(e){if((0,h.isDefined)(e)&&!(e instanceof p.Query))throw new f.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"reduceFn",get:function(){return this._reduceFn},set:function(e){if((0,c.default)(e)&&(e=e.toString()),!(0,a.default)(e))throw new f.KinveyError("fn argument must be of type function or string.");this._reduceFn=e}}],[{key:"count",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.by(t),n.initial={count:0},n.reduceFn="function(doc, out) {  out.count += 1;  return out;}",n}},{key:"sum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={sum:0},n.reduceFn='function(doc, out) {  out.sum += doc["'+t+'"];  return out;}',n}},{key:"min",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={min:1/0},n.reduceFn='function(doc, out) {  out.min = Math.min(out.min, doc["'+t+'"]);  return out;}',n}},{key:"max",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={max:-1/0},n.reduceFn='function(doc, out) {  out.max = Math.max(out.max, doc["'+t+'"]);  return out;}',n}},{key:"average",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var n=new e;return n.initial={count:0,average:0},n.reduceFn='function(doc, out) {  out.average = (out.average * out.count + doc["'+t+'"]) / (out.count + 1);  out.count += 1;  return out;}',n}}]),e}()},function(e,t,n){var r=n(48),o=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(17),o=n(59),i=n(15),u="[object Object]",a=Function.prototype,s=Object.prototype,c=a.toString,l=s.hasOwnProperty,f=c.call(Object);e.exports=function(e){if(!i(e)||r(e)!=u)return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==f}},function(e,t,n){var r=n(255),o=n(258)(r);e.exports=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyResponse=t.Response=t.StatusCode=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(13)),u=n(46),a=n(1),s=t.StatusCode={Ok:200,Created:201,Empty:204,MovedPermanently:301,Found:302,NotModified:304,TemporaryRedirect:307,PermanentRedirect:308,Unauthorized:401,Forbidden:403,NotFound:404,ServerError:500};Object.freeze(s);var c=t.Response=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),t=(0,i.default)({statusCode:s.Empty,headers:new u.Headers,data:null},t),this.statusCode=t.statusCode,this.headers=t.headers,this.data=t.data}return o(e,[{key:"isSuccess",value:function(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===s.MovedPermanently||this.statusCode===s.Found||this.statusCode===s.NotModified||this.statusCode===s.TemporaryRedirect||this.statusCode===s.PermanentRedirect}},{key:"isServerError",value:function(){return this.statusCode>=500&&this.statusCode<600}},{key:"isClientError",value:function(){return this.statusCode>=400&&this.statusCode<500}},{key:"toPlainObject",value:function(){return{statusCode:this.statusCode,headers:this.headers.toPlainObject(),data:this.data}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof u.Headers||(e=new u.Headers(e)),this._headers=e}},{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},t=e.message||e.description,n=e.debug,r=this.statusCode,o=this.headers.get("X-Kinvey-Request-ID");return r===s.Unauthorized?new a.InsufficientCredentialsError(t,n,r,o):r===s.NotFound?new a.NotFoundError(t,n,r,o):r===s.ServerError?new a.ServerError(t,n,r,o):new a.KinveyError(t,n,r,o)}}]),e}();t.KinveyResponse=function(e){function t(){return r(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c),o(t,[{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},n=e.name||e.error,r=e.message||e.description,o=e.debug,i=this.statusCode,u=this.headers.get("X-Kinvey-Request-ID"),s=void 0;if("APIVersionNotAvailable"===n)s=new a.APIVersionNotAvailableError(r,o,i,u);else if("APIVersionNotImplemented"===n)s=new a.APIVersionNotImplementedError(r,o,i,u);else if("AppProblem"===n)s=new a.AppProblemError(r,o,i,u);else if("AppProblem"===n)s=new a.AppProblemError(r,o,i,u);else if("BadRequest"===n)s=new a.BadRequestError(r,o,i,u);else if("BLInternalError"===n||"BLRuntimeError"===n||"BLSyntaxError"===n||"BLTimeoutError"===n||"BLViolationError"===n)s=new a.BLError(r,o,i,u);else if("CORSDisabled"===n)s=new a.CORSDisabledError(r,o,i,u);else if("DuplicateEndUsers"===n)s=new a.DuplicateEndUsersError(r,o,i,u);else if("FeatureUnavailable"===n)s=new a.FeatureUnavailableError(r,o,i,u);else if("IncompleteRequestBody"===n)s=new a.IncompleteRequestBodyError(r,o,i,u);else if("IndirectCollectionAccessDisallowed"===n)s=new a.IndirectCollectionAccessDisallowedError(r,o,i,u);else if("InsufficientCredentials"===n)s=new a.InsufficientCredentialsError(r,o,i,u);else if("InvalidCredentials"===n)s=new a.InvalidCredentialsError(r,o,i,u);else if("InvalidIdentifier"===n)s=new a.InvalidIdentifierError(r,o,i,u);else if("InvalidQuerySyntax"===n)s=new a.InvalidQuerySyntaxError(r,o,i,u);else if("JSONParseError"===n)s=new a.JSONParseError(r,o,i,u);else if("KinveyInternalErrorRetry"===n)s=new a.KinveyInternalErrorRetry(r,o,i,u);else if("KinveyInternalErrorStop"===n)s=new a.KinveyInternalErrorStop(r,o,i,u);else if("MissingQuery"===n)s=new a.MissingQueryError(r,o,i,u);else if("MissingRequestHeader"===n)s=new a.MissingRequestHeaderError(r,o,i,u);else if("MissingRequestParameter"===n)s=new a.MissingRequestParameterError(r,o,i,u);else if("EntityNotFound"===n||"CollectionNotFound"===n||"AppNotFound"===n||"UserNotFound"===n||"BlobNotFound"===n||"DocumentNotFound"===n)s=new a.NotFoundError(r,o,i,u);else if("ParameterValueOutOfRange"===n)s=new a.ParameterValueOutOfRangeError(r,o,i,u);else if("ServerError"===n)s=new a.ServerError(r,o,i,u);else if("StaleRequest"===n)s=new a.StaleRequestError(r,o,i,u);else if("UserAlreadyExists"===n)s=new a.UserAlreadyExistsError(r,o,i,u);else{if("WritesToCollectionDisallowed"!==n)return function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this);s=new a.WritesToCollectionDisallowedError(r,o,i,u)}return s}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Middleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(285);t.Middleware=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Middleware";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}return r(e,[{key:"handle",value:function(){return o.default.reject(new Error("A subclass middleware must override the handle function."))}},{key:"cancel",value:function(){return o.default.resolve()}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{value:this.name,level:e,nodes:[]}}},{key:"toString",value:function(){var e=this.generateTree();return i.AsciiTree.generate(e)}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyObservable=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=r(n(4)),l=n(324),f=n(120),h=n(80),p=r(n(16)),d=n(2),y={closed:!0,next:function(){},error:function(e){throw e},complete:function(){},status:function(){},presence:function(){}},v=function(e){function t(e,n,r,u,a,s){o(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),l=void 0,f=c;return c._parentSubscriber=e,(0,p.default)(n)?l=n:n&&(l=n.next,r=n.error,u=n.complete,n!==y&&(f=Object.create(n),(0,p.default)(f.unsubscribe)&&c.add(f.unsubscribe.bind(f)),f.unsubscribe=c.unsubscribe.bind(c))),c._context=f,c._next=l,c._error=r,c._complete=u,c._status=a,c._presence=s,c}return u(t,f.Subscriber),s(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"status",value:function(e){if(!this.isStopped&&this._status){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._status,e)&&this.unsubscribe():this.__tryOrUnsub(this._status,e)}}},{key:"presence",value:function(e){if(!this.isStopped&&this._presence){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._presence,e)&&this.unsubscribe():this.__tryOrUnsub(this._presence,e)}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}}},{key:"__tryOrSetError",value:function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(),b=function(e){function t(e,n,r,u,s){o(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));switch(arguments.length){case 0:c.destination=y;break;case 1:if(!1===(0,d.isDefined)(e)){c.destination=y;break}if("object"===(void 0===e?"undefined":a(e))){e instanceof f.Subscriber?(c.destination=e,c.destination.add(c)):(c.syncErrorThrowable=!0,c.destination=new v(c,e));break}default:c.syncErrorThrowable=!0,c.destination=new v(c,e,n,r,u,s)}return c}return u(t,f.Subscriber),s(t,[{key:"status",value:function(e){this.isStopped||this._status(e)}},{key:"presence",value:function(e){this.isStopped||this._presence(e)}},{key:"_status",value:function(e){this.destination.status(e)}},{key:"_presence",value:function(e){this.destination.presence(e)}}]),t}();t.KinveyObservable=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,l.Observable),s(t,[{key:"subscribe",value:function(e,t,n,r,o){var i=this.operator,u=function(e,t,n,r,o){if(e){if(e instanceof b)return e;if(e[h.rxSubscriber])return e[h.rxSubscriber]()}return e||t||n||r||o?new b(e,t,n,r,o):new b(y)}(e,t,n,r,o);if(i?i.call(u,this.source):u.add(this._trySubscribe(u)),u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u}},{key:"toPromise",value:function(){var e=this;return new c.default(function(t,n){var r=void 0;e.subscribe(function(e){r=e},n,function(){t(r)})})}}],[{key:"create",value:function(e){return new t(e)}}]),t}()},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return e}},function(e,t){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(198),o=n(15),i=Object.prototype,u=i.hasOwnProperty,a=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return o(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t,n){(function(e){var r=n(11),o=n(199),i="object"==typeof t&&t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=u&&u.exports===i?r.Buffer:void 0,s=(a?a.isBuffer:void 0)||o;e.exports=s}).call(t,n(33)(e))},function(e,t,n){var r=n(95),o=n(60),i=n(36),u=n(3),a=n(14),s=n(37),c=n(27),l=n(58),f="[object Map]",h="[object Set]",p=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(u(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||l(e)||i(e)))return!e.length;var t=o(e);if(t==f||t==h)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(p.call(e,n))return!1;return!0}},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(210),i=n(211),u=n(212),a=n(213),s=n(214);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t,n){var r=n(26);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(21)(Object,"create");e.exports=r},function(e,t,n){var r=n(228);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(93),o=n(234),i=n(14);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(100),o=n(29),i=n(259),u=n(3);e.exports=function(e,t){return(u(e)?r:o)(e,i(t))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.RequestMethod=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(52)),a=r(n(13)),s=r(n(6)),c=r(n(62)),l=n(8),f=n(1),h=n(2),p=n(30),d=n(46),y=t.RequestMethod={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(y);t.Request=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=(0,a.default)({followRedirect:!0},t),this.id=(0,h.randomString)(),this.client=t.client,this.method=t.method||y.GET,this.headers=t.headers||new d.Headers,this.url=t.url||"",this.body=t.body||t.data,this.timeout=(0,h.isDefined)(t.timeout)?t.timeout:this.client.defaultTimeout,this.followRedirect=!0===t.followRedirect,this.cache=!0===t.cache}return o(e,[{key:"execute",value:function(){return!1===(0,h.isDefined)(this.rack)?(Log.error("Unable to execute the request. Please provide a rack to execute the request."),i.default.reject(new f.KinveyError("Unable to execute the request. Please provide a rack to execute the request."))):this.rack.execute(this.toPlainObject()).then(function(e){if(!1===(0,h.isDefined)(e))throw new f.NoResponseError;return e instanceof p.Response==!1&&(e=new p.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})),e})}},{key:"cancel",value:function(){return this.rack.cancel()}},{key:"toPlainObject",value:function(){return{id:this.id,method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect,encryptionKey:this.client.encryptionKey}}},{key:"client",get:function(){return this._client||l.Client.sharedInstance()},set:function(e){if(e&&e instanceof l.Client==!1)throw new f.KinveyError("client must be an instance of the Client class.");this._client=e}},{key:"method",get:function(){return this._method},set:function(e){switch((0,s.default)(e)||(e=String(e)),e=e.toUpperCase()){case y.GET:case y.POST:case y.PATCH:case y.PUT:case y.DELETE:this._method=e;break;default:throw new f.KinveyError("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof d.Headers||(e=new d.Headers(e)),this._headers=e}},{key:"url",get:function(){return!0===this.cache?(0,h.appendQuery)(this._url,u.default.stringify({_:Math.random().toString(36).substr(2)})):this._url},set:function(e){this._url=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}},{key:"timeout",get:function(){return this._timeout},set:function(e){if(e=parseInt(e,10),!1===(0,c.default)(e)||isNaN(e))throw new f.KinveyError("Invalid timeout. Timeout must be a number.");this._timeout=e}},{key:"followRedirect",get:function(){return this._followRedirect},set:function(e){this._followRedirect=!!e}},{key:"cache",get:function(){return this._cache},set:function(e){this._cache=!!e}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Headers=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(44)),u=r(n(6)),a=r(n(28)),s=n(2);t.Headers=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.headers={},this.addAll(t)}return o(e,[{key:"get",value:function(e){if(e){!1===(0,u.default)(e)&&(e=String(e));return this.headers[e.toLowerCase()]}}},{key:"set",value:function(e,t){if(!1===(0,s.isDefined)(e)||!1===(0,s.isDefined)(t))throw new Error("A name and value must be provided to set a header.");!1===(0,u.default)(e)&&(e=String(e));var n=this.headers;return e=e.toLowerCase(),!1===(0,u.default)(t)?n[e]=JSON.stringify(t):n[e]=t,this.headers=n,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.set(e.name,e.value)}},{key:"addAll",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n instanceof e&&(n=n.toPlainObject()),!1===(0,a.default)(n))throw new Error("Headers argument must be an object.");var r=Object.keys(n);return(0,i.default)(r,function(e){try{t.set(e,n[e])}catch(e){}}),this}},{key:"remove",value:function(e){if(e){!1===(0,u.default)(e)&&(e=String(e));var t=this.headers;delete t[e.toLowerCase()],this.headers=t}return this}},{key:"clear",value:function(){return this.headers={},this}},{key:"toPlainObject",value:function(){return this.headers}},{key:"toString",value:function(){return JSON.stringify(this.toPlainObject())}}]),e}()},function(e,t,n){var r=n(3),o=n(73),i=n(271),u=n(274);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(u(e))}},function(e,t,n){var r=n(17),o=n(15),i="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||o(e)&&r(e)==i}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(76);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(81);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(127);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(345);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(126);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!e)return!1;var t=e.onMessage,n=e.onError,r=e.onStatus;return(0,s.default)(t)||(0,s.default)(n)||(0,s.default)(r)}function i(e){return(0,p.isNonemptyString)(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LiveService=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.isValidReceiver=o,t.isValidChannelName=i,t.getLiveService=function(e){return v||(v=new y(e)),v};var a=r(n(336)),s=r(n(16)),c=r(n(337)),l=n(8),f=n(5),h=n(1),p=n(2),d=n(124),y=t.LiveService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._client=t||l.Client.sharedInstance(),this._pubnubClient=void 0,this._pubnubListener=void 0,this._userChannelGroup=void 0,this._pubnubConfig=void 0,this._registeredUser=void 0}return u(e,[{key:"fullInitialization",value:function(e){var t=this;return this.registerUser(e).then(function(e){var n=new a.default(e),r=new d.PubNubListener;t.initialize(n,r)})}},{key:"fullUninitialization",value:function(){var e=this;return this.unregisterUser().then(function(t){return e.uninitialize(),t})}},{key:"isInitialized",value:function(){return!!this.__pubnubClient&&!!this.__pubnubListener&&!!this._registeredUser}},{key:"registerUser",value:function(e){var t=this;return e&&e.isActive()?this.isInitialized()?Promise.reject(new h.KinveyError("Live service already initialized")):this._makeRegisterRequest(e._id).then(function(n){t._registeredUser=e,t._userChannelGroup=n.userChannelGroup;return(0,c.default)({ssl:!0,authKey:t._registeredUser._kmd.authtoken},n)}):Promise.reject(new h.ActiveUserError("Missing or invalid active user"))}},{key:"initialize",value:function(e,t){if(this.isInitialized())throw new h.KinveyError("Live service already initialized");this._pubnubListener=t,this._pubnubClient=e,this._pubnubClient.addListener(this._pubnubListener),this._subscribeToUserChannelGroup()}},{key:"uninitialize",value:function(){this._unsubscribeFromAll(),this._pubnubClient=null,this._pubnubListener=null}},{key:"onConnectionStatusUpdates",value:function(e){this._pubnubListener.on(d.PubNubListener.unclassifiedEvents,e),this._pubnubListener.on(this._userChannelGroup,e)}},{key:"offConnectionStatusUpdates",value:function(e){e?(this._pubnubListener.removeListener(d.PubNubListener.unclassifiedEvents,e),this._pubnubListener.removeListener(this._userChannelGroup,e)):(this._pubnubListener.removeAllListeners(d.PubNubListener.unclassifiedEvents),this._pubnubListener.removeAllListeners(this._userChannelGroup))}},{key:"publishToChannel",value:function(e,t){if(!this.isInitialized())return Promise.reject(new h.KinveyError("Live service is not initialized"));var n=this._validatePublishData(e,t);return n?Promise.reject(n):this._pubnubClient.publish({message:t,channel:e}).catch(function(e){e=e.status&&e.status.errorData;var t=new f.Response({data:e,statusCode:e.status,headers:e.response&&e.response.headers});return Promise.reject(t)})}},{key:"subscribeToChannel",value:function(e,t){var n=this._validateSubscribeData(e,t);if(n)throw n;this._subscribeToListener(e,t)}},{key:"unsubscribeFromChannel",value:function(e){this._unsubscribeFromListener(e)}},{key:"unregisterUser",value:function(){var e=this;if(!this._registeredUser){return Promise.reject(new h.KinveyError("Cannot unregister when no user has been registered for live service"))}var t=this._registeredUser._id;return this._makeUnregisterRequst(t).then(function(t){return e._registeredUser=null,t})}},{key:"_unsubscribeFromAll",value:function(){this._pubnubClient.unsubscribeAll(),this._pubnubListener.removeAllListeners()}},{key:"_validatePublishData",value:function(e,t){var n=null;return i(e)||(n=new h.KinveyError("Invalid channel name")),void 0===t&&(n=new h.KinveyError("Missing or invalid message")),n}},{key:"_validateSubscribeData",value:function(e,t){var n=null;return i(e)||(n=new h.KinveyError("Invalid channel name")),t&&o(t)||(n=new h.KinveyError("Missing or invalid receiver")),n}},{key:"_subscribeToUserChannelGroup",value:function(){this._pubnubClient.subscribe({channelGroups:[this._userChannelGroup]})}},{key:"_subscribeToListener",value:function(e,t){(0,s.default)(t.onMessage)&&this._pubnubListener.on(e,t.onMessage),((0,s.default)(t.onError)||(0,s.default)(t.onStatus))&&this._pubnubListener.on(""+d.PubNubListener.statusPrefix+e,function(e){var n=e.error?t.onError:t.onStatus;(0,s.default)(n)&&n.call(t,e)})}},{key:"_unsubscribeFromListener",value:function(e){this._pubnubListener.removeAllListeners(e),this._pubnubListener.removeAllListeners(""+d.PubNubListener.statusPrefix+e)}},{key:"_makeRegisterRequest",value:function(e){return this._makeUserManagementRequest(e,"register-realtime")}},{key:"_makeUnregisterRequst",value:function(e){return this._makeUserManagementRequest(e,"unregister-realtime")}},{key:"_makeUserManagementRequest",value:function(e,t){return f.KinveyRequest.executeShort({method:f.RequestMethod.POST,pathname:"/user/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}},this._client)}},{key:"_throwNotInitializedError",value:function(){throw new h.KinveyError("Live service has not been initialized")}},{key:"_pubnubClient",get:function(){return this.__pubnubClient||this._throwNotInitializedError(),this.__pubnubClient},set:function(e){this.__pubnubClient=e}},{key:"_pubnubListener",set:function(e){this.__pubnubListener=e},get:function(){return this.__pubnubListener||this._throwNotInitializedError(),this.__pubnubListener}}]),e}(),v=void 0},function(e,t,n){"use strict";var r=n(184),o=n(185),i=n(87);e.exports={formats:i,parse:o,stringify:r}},function(e,t,n){var r=n(54),o=n(26),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var u=e[t];i.call(e,t)&&o(u,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(88);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(56),o=n(92);e.exports=function(e){return r(function(t,n){var r=-1,i=n.length,u=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(u=e.length>3&&"function"==typeof u?(i--,u):void 0,a&&o(n[0],n[1],a)&&(u=i<3?void 0:u,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,u)}return t})}},function(e,t,n){var r=n(34),o=n(192),i=n(193);e.exports=function(e,t){return i(o(e,t,r),e+"")}},function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},function(e,t,n){var r=n(200),o=n(94),i=n(201),u=i&&i.isTypedArray,a=u?o(u):r;e.exports=a},function(e,t,n){var r=n(96)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(203),o=n(61),i=n(204),u=n(205),a=n(206),s=n(17),c=n(90),l="[object Promise]",f="[object WeakMap]",h="[object DataView]",p=c(r),d=c(o),y=c(i),v=c(u),b=c(a),g=s;(r&&g(new r(new ArrayBuffer(1)))!=h||o&&"[object Map]"!=g(new o)||i&&g(i.resolve())!=l||u&&"[object Set]"!=g(new u)||a&&g(new a)!=f)&&(g=function(e){var t=s(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case p:return h;case d:return"[object Map]";case y:return l;case v:return"[object Set]";case b:return f}return t}),e.exports=g},function(e,t,n){var r=n(21)(n(11),"Map");e.exports=r},function(e,t,n){var r=n(17),o=n(15),i="[object Number]";e.exports=function(e){return"number"==typeof e||o(e)&&r(e)==i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(208);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){function r(e){var t=this.__data__=new o(e);this.size=t.size}var o=n(39),i=n(215),u=n(216),a=n(217),s=n(218),c=n(219);r.prototype.clear=i,r.prototype.delete=u,r.prototype.get=a,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(220),i=n(227),u=n(229),a=n(230),s=n(231);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t,n){var r=n(239),o=n(101),i=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,a=u?function(e){return null==e?[]:(e=Object(e),r(u(e),function(t){return i.call(e,t)}))}:o;e.exports=a},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(105);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t){e.exports=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRack=t.CacheRack=t.Rack=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},c=r(n(4)),l=r(n(71)),f=r(n(16)),h=r(n(74)),p=n(2),d=n(19),y=n(114),v=t.Rack=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.middlewares=[],n.canceled=!1,n.activeMiddleware=void 0,n}return u(t,y.Middleware),a(t,[{key:"use",value:function(e){if((0,p.isDefined)(e)){if(e instanceof y.Middleware)return void this.middlewares.push(e);throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"reset",value:function(){this.middlewares=[]}},{key:"execute",value:function(e){var t=this;return!1===(0,p.isDefined)(e)?c.default.reject(new Error("Request is undefined. Please provide a valid request.")):(0,l.default)((0,h.default)(this.middlewares),function(n,r){return n.then(function(n){var o=n.request,i=n.response;return t.canceled?c.default.reject(new Error("Cancelled")):(t.activeMiddleware=r,r.handle(o||e,i))})},c.default.resolve({request:e})).then(function(e){var n=e.response;return!0===t.canceled?c.default.reject(new Error("Cancelled")):(t.canceled=!1,t.activeMiddleware=void 0,n)}).catch(function(e){throw t.canceled=!1,t.activeMiddleware=void 0,e})}},{key:"cancel",value:function(){return this.canceled=!0,(0,p.isDefined)(this.activeMiddleware)&&(0,f.default)(this.activeMiddleware.cancel)?this.activeMiddleware.cancel():c.default.resolve()}},{key:"handle",value:function(e){return this.execute(e)}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,e);return(0,h.default)(this.middlewares).forEach(function(t){n.nodes.push(t.generateTree(e+1))}),n}}]),t}(),b=new(function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.use(new y.CacheMiddleware),n}return u(t,v),a(t,[{key:"useCacheMiddleware",value:function(e){this.reset(),this.use(e)}},{key:"execute",value:function(e){return d.Log.debug("Executing cache request",e),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return d.Log.debug("Received response for cache request id: "+e.id,t),t}).catch(function(t){throw d.Log.error("Received error for cache request id: "+e.id,t),t})}}]),t}()),g=new(function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Network Rack";o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.use(new y.SerializeMiddleware),n.use(new y.HttpMiddleware),n.use(new y.ParseMiddleware),n}return u(t,v),a(t,[{key:"useHttpMiddleware",value:function(e){this.reset(),this.use(new y.SerializeMiddleware),this.use(e),this.use(new y.ParseMiddleware)}},{key:"execute",value:function(e){return d.Log.debug("Executing network request",e),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return d.Log.debug("Received response for network request: "+e.id,t),t}).catch(function(t){throw d.Log.error("Received error for network request id: "+e.id,t),t})}}]),t}());t.CacheRack=b,t.NetworkRack=g},function(e,t,n){var r=n(69),o=n(29),i=n(20),u=n(282),a=n(3);e.exports=function(e,t,n){var s=a(e)?r:u,c=arguments.length<3;return s(e,i(t,4),n,c,o)}},function(e,t,n){var r=n(47),o=n(25);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},function(e,t,n){var r=n(3),o=n(48),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||u.test(e)||!i.test(e)||null!=t&&e in Object(t)}},function(e,t,n){var r=n(283),o=n(18);e.exports=function(e){return null==e?[]:r(e,o(e))}},function(e,t,n){var r=n(54),o=n(288)(function(e,t,n){r(e,n,t)});e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheStore=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},u=r(n(4)),a=r(n(308)),s=r(n(13)),c=r(n(75)),l=r(n(318)),f=r(n(3)),h=r(n(71)),p=r(n(77)),d=r(n(7)),y=n(5),v=n(1),b=n(10),g=n(24),m=n(78),_=n(2),w=n(32),O=n(81),E=n(126);t.CacheStore=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.ttl=n.ttl||void 0,r.syncManager=new E.SyncManager(r.collection,n),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,O.NetworkStore),o(t,[{key:"find",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(r=(0,s.default)({syncAutomatically:this.syncAutomatically},r)).syncAutomatically;return w.KinveyObservable.create(function(u){if(e&&!(e instanceof b.Query))return u.error(new v.KinveyError("Invalid query. It must be an instance of the Query class."));return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return u.next(s),!0===o?n.pendingSyncCount(e,r).then(function(t){return t>0?n.push(e,r).then(function(){return n.pendingSyncCount(e,r)}):t}).then(function(o){if(o>0)throw new v.KinveyError("Unable to fetch the entities on the backend. There are "+o+" entities that need to be synced.");return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",n).call(n,e,r).toPromise()}).then(function(e){var t=(0,a.default)(s,e,"_id"),o=Object.keys((0,c.default)(t,"_id")),i=(new b.Query).contains("_id",o);return n.clear(i,r).then(function(){return e})}).then(function(e){return new y.CacheRequest({method:y.RequestMethod.PUT,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,body:e,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data})}):s}).then(function(e){u.next(e)}).then(function(){u.complete()}).catch(function(e){return u.error(e)})})}},{key:"findById",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(r=(0,s.default)({syncAutomatically:this.syncAutomatically},r)).syncAutomatically;return w.KinveyObservable.create(function(u){if(!1===(0,_.isDefined)(e))return u.next(void 0),u.complete();return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/"+e}),properties:r.properties,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data}).catch(function(){}).then(function(a){if(u.next(a),!0===o){var s=new b.Query;return s.equalTo("_id",e),n.pendingSyncCount(s,r).then(function(e){return e>0?n.push(s,r).then(function(){return n.pendingSyncCount(s,r)}):e}).then(function(e){if(e>0)throw new v.KinveyError("Unable to find the entity on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",n).call(n,e,r).toPromise()}).then(function(e){return new y.CacheRequest({method:y.RequestMethod.PUT,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,body:e,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data})})}return a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)})})}},{key:"group",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(r=(0,s.default)({syncAutomatically:this.syncAutomatically},r)).syncAutomatically;return w.KinveyObservable.create(function(u){if(!(e instanceof g.Aggregation))return u.error(new v.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."));return new y.CacheRequest({method:y.RequestMethod.POST,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/_group"}),properties:r.properties,aggregation:e,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return u.next(a),!0===o?n.pendingSyncCount(null,r).then(function(e){return e>0?n.push(null,r).then(function(){return n.pendingSyncCount(null,r)}):e}).then(function(o){if(o>0)throw new v.KinveyError("Unable to group entities on the backend. There are "+o+" entities that need to be synced.");return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"group",n).call(n,e,r).toPromise()}):a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)})})}},{key:"count",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(r=(0,s.default)({syncAutomatically:this.syncAutomatically},r)).syncAutomatically;return w.KinveyObservable.create(function(u){if(e&&!(e instanceof b.Query))return u.error(new v.KinveyError("Invalid query. It must be an instance of the Query class."));return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:n.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).length}).then(function(a){return u.next(a),!0===o?n.pendingSyncCount(e,r).then(function(t){return t>0?n.push(e,r).then(function(){return n.pendingSyncCount(e,r)}):t}).then(function(e){if(e>0)throw new v.KinveyError("Unable to count entities on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"count",n).call(n,e,r).toPromise()}):a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)})})}},{key:"create",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w.KinveyObservable.create(function(r){if(!1===(0,_.isDefined)(e))return r.next(null),r.complete();if((0,f.default)(e))return r.error(new v.KinveyError("Unable to create an array of entities.","Please create entities one by one."));return new y.CacheRequest({method:y.RequestMethod.POST,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,body:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addCreateOperation(e,n).then(function(){return e})}).then(function(e){if(!0===t.syncAutomatically){var r=(new b.Query).equalTo("_id",e._id);return t.push(r,n).then(function(e){var t=e[0];if((0,_.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w.KinveyObservable.create(function(r){if(!1===(0,_.isDefined)(e))return r.next(null),r.complete();if((0,f.default)(e))return r.error(new v.KinveyError("Unable to update an array of entities.","Please update entities one by one."));if(!1===(0,_.isDefined)(e._id))return r.error(new v.KinveyError("The entity provided does not contain an _id. An _id is required to update the entity.",e));return new y.CacheRequest({method:y.RequestMethod.PUT,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,body:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addUpdateOperation(e,n).then(function(){return e})}).then(function(e){if(!0===t.syncAutomatically){var r=(new b.Query).equalTo("_id",e._id);return t.push(r,n).then(function(e){var t=e[0];if((0,_.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w.KinveyObservable.create(function(r){if(e&&!(e instanceof b.Query))return r.error(new v.KinveyError("Invalid query. It must be an instance of the Query class."));return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length>0?u.default.all((0,p.default)(e,function(e){if(new m.Metadata(e).isLocal()){var r=new b.Query;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return t.syncManager.addDeleteOperation(e,n).then(function(){return e})})).then(function(){return e}):e}).then(function(e){if(e.length>0&&!0===t.syncAutomatically){var r=(0,l.default)(e,function(e){return new m.Metadata(e).isLocal()}),o=Object.keys((0,c.default)(e,"_id")),i=(new b.Query).contains("_id",o);return t.push(i,n).then(function(e){return e.concat(r)})}return e}).then(function(e){return u.default.all((0,p.default)(e,function(e){if(!1===(0,_.isDefined)(e.error)){return new y.CacheRequest({method:y.RequestMethod.DELETE,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:y.AuthType.Default,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data})}return{count:0}}))}).then(function(e){return(0,h.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then().then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w.KinveyObservable.create(function(r){if(!1===(0,_.isDefined)(e))return r.next({count:0}),r.complete();return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,authType:y.AuthType.Default,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).catch(function(e){if(e instanceof v.NotFoundError)return null;throw e}).then(function(e){if((0,_.isDefined)(e)){if(new m.Metadata(e).isLocal()){var r=new b.Query;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return t.syncManager.addDeleteOperation(e,n).then(function(){return e})}return e}).then(function(e){if(!0===t.syncAutomatically){var r=(new b.Query).equalTo("_id",e._id);return t.push(r,n).then(function(){return e})}return e}).then(function(e){return new y.CacheRequest({method:y.RequestMethod.DELETE,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:y.AuthType.Default,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data})}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"clear",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w.KinveyObservable.create(function(r){if(e&&!(e instanceof b.Query))return r.error(new v.KinveyError("Invalid query. It must be an instance of the Query class."));return new y.CacheRequest({method:y.RequestMethod.GET,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return u.default.all((0,p.default)(e,function(e){return u.default.resolve(e).then(function(e){if(new m.Metadata(e).isLocal()){var r=new b.Query;return r.equalTo("_id",e._id),t.clearSync(r,n).then(function(){return e})}return e}).then(function(e){return new y.CacheRequest({method:y.RequestMethod.DELETE,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,authType:y.AuthType.Default,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data})})}))}).then(function(e){return(0,h.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"pendingSyncCount",value:function(e,t){return this.syncManager.count(e,t)}},{key:"pendingSyncEntities",value:function(e,t){return this.syncManager.find(e,t)}},{key:"push",value:function(e,t){return this.syncManager.push(e,t)}},{key:"pull",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=(0,s.default)({useDeltaFetch:this.useDeltaFetch},n),this.syncManager.pull(e,n).then(function(r){return t.clear(e,n).then(function(){return new y.CacheRequest({method:y.RequestMethod.PUT,url:d.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,body:r,timeout:n.timeout,tag:t.tag}).execute()}).then(function(){return r})})}},{key:"sync",value:function(e,t){var n=this;return t=(0,s.default)({useDeltaFetch:this.useDeltaFetch},t),this.push(e,t).then(function(r){return n.pull(e,t).then(function(e){return{push:r,pull:e}})})}},{key:"clearSync",value:function(e,t){return this.syncManager.clear(e,t)}},{key:"syncAutomatically",get:function(){return!0}}]),t}()},function(e,t,n){var r=n(49),o=n(20),i=n(323),u=n(3);e.exports=function(e,t){return(u(e)?r:i)(e,o(t,3))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(28)),i=n(1),u=n(2);t.Metadata=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!1===(0,o.default)(t))throw new i.KinveyError("entity argument must be an object");t._kmd=t._kmd||{},this.entity=t}return r(e,[{key:"isLocal",value:function(){return!0===this.entity._kmd.local}},{key:"toPlainObject",value:function(){return this.entity._kmd}},{key:"createdAt",get:function(){if((0,u.isDefined)(this.entity._kmd.ect))return new Date(this.entity._kmd.ect)}},{key:"ect",get:function(){return this.createdAt}},{key:"emailVerification",get:function(){if((0,u.isDefined)(this.entity._kmd.emailVerification))return this.entity._kmd.emailVerification.status}},{key:"lastModified",get:function(){if((0,u.isDefined)(this.entity._kmd.lmt))return new Date(this.entity._kmd.lmt)}},{key:"lmt",get:function(){return this.lastModified}},{key:"authtoken",get:function(){return this.entity._kmd.authtoken}}]),e}()},function(e,t,n){"use strict";(function(e){var n="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=n||void 0!==e&&e||r;t.root=o,function(){if(!o)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(t,n(9))},function(e,t,n){"use strict";var r=n(79).root.Symbol;t.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkStore=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(6)),u=r(n(3)),a=r(n(7)),s=n(5),c=n(1),l=n(10),f=n(8),h=n(2),p=n(32),d=n(24),y=n(82);t.NetworkStore=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&!(0,i.default)(t))throw new c.KinveyError("Collection must be a string.");if(this.collection=t,n.tag){var r=n.tag;if(!(0,i.default)(r))throw new c.KinveyError("A tag must be a string.");if(!/^[a-zA-Z0-9-]+$/.test(r))throw new c.KinveyError('A tag can only contain letters, numbers, and "-".');this.tag=r}this.client=n.client,this.useDeltaFetch=!0===n.useDeltaFetch}return o(e,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!0===n.useDeltaFetch||this.useDeltaFetch;return p.KinveyObservable.create(function(o){if((0,h.isDefined)(e)&&!(e instanceof l.Query))return o.error(new c.KinveyError("Invalid query. It must be an instance of the Query class."));var i={method:s.RequestMethod.GET,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client,tag:t.tag},u=new s.KinveyRequest(i);return!0===r&&(u=new s.DeltaFetchRequest(i)),u.execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})})}},{key:"findById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.useDeltaFetch||this.useDeltaFetch;return p.KinveyObservable.create(function(o){if(!e)return o.next(void 0),o.complete();var i={method:s.RequestMethod.GET,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout,client:t.client,tag:t.tag},u=new s.KinveyRequest(i);return!0===r&&(u=new s.DeltaFetchRequest(i)),u.execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})})}},{key:"group",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){if(!(e instanceof d.Aggregation))return r.error(new c.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."));return new s.KinveyRequest({method:s.RequestMethod.POST,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:n.properties,aggregation:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})})}},{key:"count",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){try{if(e&&!(e instanceof l.Query))throw new c.KinveyError("Invalid query. It must be an instance of the Query class.");return new s.KinveyRequest({method:s.RequestMethod.GET,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_count"}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e?e.count:0)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"create",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){if(!1===(0,h.isDefined)(e))return r.next(null),r.complete();if((0,u.default)(e))return r.error(new c.KinveyError("Unable to create an array of entities.","Please create entities one by one."));return new s.KinveyRequest({method:s.RequestMethod.POST,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){if(!1===(0,h.isDefined)(e))return r.next(null),r.complete();if((0,u.default)(e))return r.error(new c.KinveyError("Unable to update an array of entities.","Please update entities one by one."));if(!1===(0,h.isDefined)(e._id))return r.error(new c.KinveyError("Unable to update entity.","Entity must contain an _id to be updated."));return new s.KinveyRequest({method:s.RequestMethod.PUT,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,data:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"save",value:function(e,t){return e._id?this.update(e,t):this.create(e,t)}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){try{if(e&&!(e instanceof l.Query))throw new c.KinveyError("Invalid query. It must be an instance of the Query class.");return new s.KinveyRequest({method:s.RequestMethod.DELETE,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}}).toPromise()}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.KinveyObservable.create(function(r){try{if(!1===(0,h.isDefined)(e))return r.next(void 0),r.complete();return new s.KinveyRequest({method:s.RequestMethod.DELETE,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}}).toPromise()}},{key:"subscribe",value:function(e){return(0,y.getLiveCollectionManager)().subscribeCollection(this.collection,e)}},{key:"unsubscribe",value:function(){return(0,y.getLiveCollectionManager)().unsubscribeCollection(this.collection)}},{key:"client",get:function(){return(0,h.isDefined)(this._client)?this._client:f.Client.sharedInstance()},set:function(e){e instanceof f.Client?this._client=e:this._client=null}},{key:"pathname",get:function(){var e="/appdata/"+this.client.appKey;return this.collection&&(e=e+"/"+this.collection),e}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(334);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(339);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(51);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(124);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(344);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,u,a,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],i(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),u=(c=n.slice()).length,s=0;s<u;s++)c[s].apply(this,a);return!0},n.prototype.addListener=function(e,t){var u;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(u=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&u>0&&this._events[e].length>u&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,u,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],u=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=u;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(128);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(346);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return!1===(0,a.default)(e)&&!1===(0,u.default)(e)}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isDefined=o,t.isNumber=function(e){return!Number.isNaN(parseFloat(e))&&Number.isFinite(e)},t.nested=function(e,t,n){if(!1===o(t))return e=n||e;for(var r=t.split("."),i=r.shift();i&&e;)e=e[i],i=r.shift();return n||e},t.keyBy=function(e,t){return e?e.reduce(function(e,n){return e[t]=n[t],e},{}):{}},t.isEmpty=function(e){return!o(e)||!(e.length>0)&&(0===e.length||"object"!==(void 0===e?"undefined":i(e))||Object.keys(e).reduce(function(t,n){return!!t&&!Object.hasOwnProperty.call(e,n)},!0))};var u=r(n(175)),a=r(n(176))},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,o){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];(o.plainObjects||o.allowPrototypes||!r.call(Object.prototype,n))&&(e[n]=!0)}return e}if("object"!=typeof e)return[e].concat(n);var i=e;return Array.isArray(e)&&!Array.isArray(n)&&(i=t.arrayToObject(e,o)),Array.isArray(e)&&Array.isArray(n)?(n.forEach(function(n,i){r.call(e,i)?e[i]&&"object"==typeof e[i]?e[i]=t.merge(e[i],n,o):e.push(n):e[i]=n}),e):Object.keys(n).reduce(function(e,i){var u=n[i];return r.call(e,i)?e[i]=t.merge(e[i],u,o):e[i]=u,e},i)},t.assign=function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",r=0;r<t.length;++r){var i=t.charCodeAt(r);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(r):i<128?n+=o[i]:i<2048?n+=o[192|i>>6]+o[128|63&i]:i<55296||i>=57344?n+=o[224|i>>12]+o[128|i>>6&63]+o[128|63&i]:(r+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(r)),n+=o[240|i>>18]+o[128|i>>12&63]+o[128|i>>6&63]+o[128|63&i])}return n},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],u=Object.keys(i),a=0;a<u.length;++a){var s=u[a],c=i[s];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:s}),n.push(c))}return function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var r=[],o=0;o<t.length;++o)void 0!==t[o]&&r.push(t[o]);n.obj[n.prop]=r}}return t}(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";var r=String.prototype.replace,o=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return r.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){var r=n(21),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,n(9))},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(26),o=n(14),i=n(35),u=n(12);e.exports=function(e,t,n){if(!u(n))return!1;var a=typeof t;return!!("number"==a?o(n)&&i(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(197),o=n(36),i=n(3),u=n(37),a=n(35),s=n(58),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),l=!n&&o(e),f=!n&&!l&&u(e),h=!n&&!l&&!f&&s(e),p=n||l||f||h,d=p?r(e.length,String):[],y=d.length;for(var v in e)!t&&!c.call(e,v)||p&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,y))||d.push(v);return d}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){var r=n(27),o=n(202),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){"use strict";function r(){this._cache=o(),this._timeouts=o()}function o(){return Object.create(null)}r.prototype.get=function(e){return this._cache[e]},r.prototype.set=function(e,t,n){this.delete(e),this._cache[e]=t,n&&(this._timeouts[e]=setTimeout(this.delete.bind(this,e),1e3*n))},r.prototype.delete=function(e){delete this._cache[e],e in this._timeouts&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},r.prototype.clear=function(){this._cache=o();for(var e in this._timeouts)clearTimeout(this._timeouts[e]);this._timeouts=o()},e.exports=r},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CacheRequest=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},u=r(n(7)),a=r(n(99)),s=n(1),c=n(10),l=n(24),f=n(2),h=n(45),p=n(30),d=n(70);t.CacheRequest=function(t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.aggregation=e.aggregation,t.query=e.query,t.rack=d.CacheRack,t.tag=e.tag,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,h.Request),o(n,[{key:"execute",value:function(){var e=this;return i(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"execute",this).call(this).then(function(t){if(t instanceof p.KinveyResponse||(t=new p.KinveyResponse({statusCode:t.statusCode,headers:t.headers,data:t.data})),!t.isSuccess())throw t.error;return(0,f.isDefined)(e.query)&&(0,f.isDefined)(t.data)&&(t.data=e.query.process(t.data)),(0,f.isDefined)(e.aggregation)&&(0,f.isDefined)(t.data)&&(t.data=e.aggregation.process(t.data)),t})}},{key:"toPlainObject",value:function(){var e=i(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toPlainObject",this).call(this);return e.appKey=this.appKey,e.collection=this.collection,e.entityId=this.entityId,e.encryptionKey=this.client?this.client.encryptionKey:void 0,e}},{key:"body",get:function(){return this._body},set:function(e){this._body=(0,a.default)(e)}},{key:"query",get:function(){return this._query},set:function(e){if((0,f.isDefined)(e)&&!(e instanceof c.Query))throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,f.isDefined)(e)&&!(e instanceof l.Aggregation))throw new s.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");this._aggregation=e}},{key:"collection",get:function(){return(0,f.isDefined)(this.tag)?this._collection+"."+this.tag:this._collection},set:function(e){this._collection=e}},{key:"url",get:function(){return i(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"url",this)},set:function(t){!function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"url",t,this);var r=e.decodeURIComponent(u.default.parse(t).pathname).replace(/^\//,"").split("/");this.appKey=r[1],this.collection=r[2],this.entityId=r[3]}}]),n}()}).call(t,n(9))},function(e,t,n){var r=n(209),o=1,i=4;e.exports=function(e){return r(e,o|i)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(67),o=n(59),i=n(66),u=n(101),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:u;e.exports=a},function(e,t,n){var r=n(104),o=n(66),i=n(18);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(67),o=n(3);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},function(e,t,n){var r=n(11).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},function(e,t,n){function r(e,t,n,u,a){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!=e&&t!=t:o(e,t,n,u,r,a))}var o=n(262),i=n(15);e.exports=r},function(e,t,n){var r=n(110),o=n(265),i=n(111),u=1,a=2;e.exports=function(e,t,n,s,c,l){var f=n&u,h=e.length,p=t.length;if(h!=p&&!(f&&p>h))return!1;var d=l.get(e);if(d&&l.get(t))return d==t;var y=-1,v=!0,b=n&a?new r:void 0;for(l.set(e,t),l.set(t,e);++y<h;){var g=e[y],m=t[y];if(s)var _=f?s(m,g,y,t,e,l):s(g,m,y,e,t,l);if(void 0!==_){if(_)continue;v=!1;break}if(b){if(!o(t,function(e,t){if(!i(b,t)&&(g===e||c(g,e,n,s,l)))return b.push(t)})){v=!1;break}}else if(g!==m&&!c(g,m,n,s,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new o;++t<n;)this.add(e[t])}var o=n(65),i=n(263),u=n(264);r.prototype.add=r.prototype.push=i,r.prototype.has=u,e.exports=r},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(12);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(284);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(297);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(31);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var u=n(298);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=n(299);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(115);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryAdapter=t.Storage=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(6)),a=r(n(3)),s=n(2),c=n(286),l=n(19),f=n(1),h=n(287),p=new c.Queue(1,1/0);t.Storage=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new f.KinveyError("Unable to create a Storage instance without a name.");if(!(0,u.default)(t))throw new f.KinveyError("The name is not a string. A name must be a string to create a Storage instance.");this.name=t}return o(e,[{key:"loadAdapter",value:function(){return h.MemoryAdapter.load(this.name).then(function(e){return(0,s.isDefined)(e)?e:i.default.reject(new f.KinveyError("Unable to load a storage adapter."))})}},{key:"generateObjectId",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t="abcdef0123456789",n="",r=0,o=t.length;r<e;r+=1){var i=Math.floor(Math.random()*o);n+=t.substring(i,i+1)}return n}},{key:"find",value:function(e){return this.loadAdapter().then(function(t){return l.Log.debug("Find all the entities stored in the "+e+" collection.",t),t.find(e)}).catch(function(t){return l.Log.error("Unable to find all the entities stored in the "+e+" collection.",t),t instanceof f.NotFoundError||404===t.code?[]:i.default.reject(t)}).then(function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]})}},{key:"findById",value:function(e,t){if(!(0,u.default)(t)){var n=new f.KinveyError("id must be a string",t);return l.Log.error("Unable to find an entity with id "+t+" stored in the "+e+" collection.",n.message),i.default.reject(n)}return this.loadAdapter().then(function(n){return l.Log.debug("Find an entity with id "+t+" stored in the "+e+" collection.",n),n.findById(e,t)})}},{key:"save",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return p.add(function(){var r=!1;return(0,s.isDefined)(n)?((0,a.default)(n)||(r=!0,n=[n]),n=n.map(function(e){if(!(0,s.isDefined)(e._id)){var n=e._kmd||{};n.local=!0,e._kmd=n,e._id=t.generateObjectId()}return e}),t.loadAdapter().then(function(t){return t.save(e,n)}).then(function(e){return r&&e.length>0?e[0]:e})):i.default.resolve(null)})}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.default.all(n.map(function(n){return(0,s.isDefined)(n._id)?t.removeById(e,n._id):i.default.reject(new f.KinveyError("Unable to remove this entity because it does not have _id."))})).then(function(e){return e.reduce(function(e,t){return e.count+=t.count,e},{count:0})})}},{key:"removeById",value:function(e,t){var n=this;return p.add(function(){return(0,u.default)(t)?n.loadAdapter().then(function(n){return n.removeById(e,t)}):i.default.reject(new f.KinveyError("id must be a string",t))})}},{key:"clear",value:function(){var e=this;return p.add(function(){return e.loadAdapter().then(function(e){return e.clear()})})}}]),e}();t.MemoryAdapter=h.MemoryAdapter},function(e,t){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},function(e,t,n){var r=n(47),o=n(16),i=n(25);e.exports=function(e,t,n){var u=-1,a=(t=r(t,e)).length;for(a||(a=1,e=void 0);++u<a;){var s=null==e?void 0:e[i(t[u])];void 0===s&&(u=a,s=n),e=o(s)?s.call(e):s}return e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyRequest=t.Properties=t.AuthType=t.NetworkRequest=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r},c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},l=r(n(4)),f=n(301),h=r(n(52)),p=r(n(13)),d=r(n(305)),y=r(n(38)),v=r(n(7)),b=r(n(6)),g=n(8),m=n(10),_=n(24),w=n(2),O=n(1),E=n(45),k=n(46),P=n(70),j=n(30),S=t.NetworkRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.rack=P.NetworkRack,n}return u(t,E.Request),t}(),x=t.AuthType={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(x);var T={all:function(e){return T.session(e).catch(function(){return T.basic(e)})},app:function(e){return e.appKey&&e.appSecret?l.default.resolve({scheme:"Basic",username:e.appKey,password:e.appSecret}):l.default.reject(new Error("Missing client appKey and/or appSecret. Use Kinvey.initialize() to set the appKey and appSecret for the client."))},basic:function(e){return T.master(e).catch(function(){return T.app(e)})},master:function(e){return e.appKey&&e.masterSecret?l.default.resolve({scheme:"Basic",username:e.appKey,password:e.masterSecret}):l.default.reject(new Error("Missing client appKey and/or masterSecret. Use Kinvey.initialize() to set the appKey and masterSecret for the client."))},none:function(){return l.default.resolve(null)},session:function(e){var t=e.getActiveUser();return(0,w.isDefined)(t)?l.default.resolve({scheme:"Kinvey",credentials:t._kmd.authtoken}):l.default.reject(new O.NoActiveUserError("There is not an active user. Please login a user and retry the request."))}},A=t.Properties=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,k.Headers),t}();t.KinveyRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e=(0,p.default)({skipBL:!1,trace:!1},e),n.authType=e.authType||x.None,n.query=e.query,n.aggregation=e.aggregation,n.properties=e.properties||new A,n.skipBL=!0===e.skipBL,n.trace=!0===e.trace,n}return u(t,S),a(t,[{key:"getAuthorizationHeader",value:function(){var e=this,t=l.default.resolve(void 0);if(this.authType)switch(this.authType){case x.All:t=T.all(this.client);break;case x.App:t=T.app(this.client);break;case x.Basic:t=T.basic(this.client);break;case x.Master:t=T.master(this.client);break;case x.None:t=T.none(this.client);break;case x.Session:t=T.session(this.client);break;default:t=T.session(this.client).catch(function(t){return T.master(e.client).catch(function(){throw t})})}return t.then(function(e){if((0,w.isDefined)(e)){var t=e.credentials;return e.username&&(t=new f.Buffer(e.username+":"+e.password).toString("base64")),e.scheme+" "+t}})}},{key:"execute",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getAuthorizationHeader().then(function(t){(0,w.isDefined)(t)?e.headers.set("Authorization",t):e.headers.remove("Authorization")}).then(function(){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",e).call(e)}).then(function(e){if(e instanceof j.KinveyResponse==!1&&(e=new j.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})),!1===n&&!1===e.isSuccess())throw e.error;return e}).catch(function(o){if(r&&o instanceof O.InvalidCredentialsError){var i=e.client.getActiveUser();if((0,w.isDefined)(i)){var u=(0,w.isDefined)(i._socialIdentity)?i._socialIdentity:{},a=Object.keys(u).find(function(e){return"kinveyAuth"===u[e].identity}),s=u[a];if((0,w.isDefined)(s)){return new t({method:E.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:x.App,url:v.default.format({protocol:e.client.micProtocol,host:e.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:s.client_id,redirect_uri:s.redirect_uri,refresh_token:s.refresh_token},properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data}).then(function(t){return t.identity=s.identity,t.client_id=s.client_id,t.redirect_uri=s.redirect_uri,t.protocol=e.client.micProtocol,t.host=e.client.micHost,t}).then(function(n){var r={};u[n.identity]=n,r._socialIdentity=u;return new t({method:E.RequestMethod.POST,authType:x.App,url:v.default.format({protocol:e.client.apiProtocol,host:e.client.apiHost,pathname:"/user/"+e.client.appKey+"/login"}),properties:e.properties,body:r,timeout:e.timeout,client:e.client}).execute().then(function(e){return e.data}).then(function(t){return t._socialIdentity[n.identity]=(0,d.default)(t._socialIdentity[n.identity],n),e.client.setActiveUser(t)})}).then(function(){return e.execute(n,!1)}).catch(function(){return l.default.reject(o)})}}}return l.default.reject(o)})}},{key:"appVersion",get:function(){return this.client.appVersion}},{key:"query",get:function(){return this._query},set:function(e){if((0,w.isDefined)(e)&&!(e instanceof m.Query))throw new O.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,w.isDefined)(e)&&!(e instanceof _.Aggregation))throw new O.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");(0,w.isDefined)(e)&&(this.body=e.toPlainObject()),this._aggregation=e}},{key:"headers",get:function(){var e=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(e.has("Accept")||e.set("Accept","application/json; charset=utf-8"),e.has("Content-Type")||e.set("Content-Type","application/json; charset=utf-8"),e.has("X-Kinvey-Api-Version")||e.set("X-Kinvey-Api-Version",4),!0===this.skipBL?e.set("X-Kinvey-Skip-Business-Logic",!0):e.remove("X-Kinvey-Skip-Business-Logic"),!0===this.trace?(e.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id"),e.set("X-Kinvey-ResponseWrapper",!0)):(e.remove("X-Kinvey-Include-Headers-In-Response"),e.remove("X-Kinvey-ResponseWrapper")),this.appVersion?e.set("X-Kinvey-Client-App-Version",this.appVersion):e.remove("X-Kinvey-Client-App-Version"),this.properties){var n=this.properties.toString();if((0,y.default)(n))e.remove("X-Kinvey-Custom-Request-Properties");else{var r=function(e){if(e){var t=0,n=e.length;e=String(e||"");for(var r=0;r<n;r+=1){var o=encodeURI(e[r]).split("%").length;t+=1===o?1:o-1}return t}return 0}(n);if(r>=2e3)throw new Error("The custom properties are "+r+" bytes.It must be less then 2000 bytes.","Please remove some custom properties.");e.set("X-Kinvey-Custom-Request-Properties",n)}}else e.remove("X-Kinvey-Custom-Request-Properties");return e},set:function(e){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",e,this)}},{key:"url",get:function(){var e=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this),n=this.query?this.query.toQueryString():{};return(0,y.default)(n)?e:(0,w.appendQuery)(e,h.default.stringify(n))},set:function(e){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",e,this)}},{key:"properties",get:function(){return this._properties},set:function(e){e&&e instanceof A==!1&&(e=new A(e)),this._properties=e}}],[{key:"executeShort",value:function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=(0,p.default)({method:E.RequestMethod.GET,authType:x.Session},e);n=n||g.Client.sharedInstance(),!o.url&&(0,b.default)(o.pathname)&&n&&(o.url=v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:o.pathname}));var i=t.execute(o);return r&&(i=i.then(function(e){return e.data})),i}},{key:"execute",value:function(e){return new t(e).execute()}}]),t}()},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(121),i=n(326),u=n(123),a=n(80),s=function(e){function t(n,r,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=u.empty;break;case 1:if(!n){this.destination=u.empty;break}if("object"==typeof n){n instanceof t?(this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,n,r,o)}}return r(t,e),t.prototype[a.rxSubscriber]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this},t}(i.Subscription);t.Subscriber=s;var c=function(e){function t(t,n,r,i){e.call(this),this._parentSubscriber=t;var a,s=this;o.isFunction(n)?a=n:n&&(a=n.next,r=n.error,i=n.complete,n!==u.empty&&(s=Object.create(n),o.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=a,this._error=r,this._complete=i}return r(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(s)},function(e,t,n){"use strict";t.isFunction=function(e){return"function"==typeof e}},function(e,t,n){"use strict";t.errorObject={e:{}}},function(e,t,n){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PubNubListener=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(83);t.PubNubListener=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.EventEmitter),r(t,[{key:"message",value:function(e){this.emit(e.channel,e.message)}},{key:"status",value:function(e){var n=this,r=this._getEventNamesFromStatus(e.affectedChannels,e.affectedChannelGroups);r.length?r.forEach(function(r){n.emit(""+t.statusPrefix+r,e)}):this.emit(t.unclassifiedEvents,e)}},{key:"_getEventNamesFromStatus",value:function(e,t){return(e||[]).concat(t||[])}}],[{key:"statusPrefix",get:function(){return"status:"}},{key:"unclassifiedEvents",get:function(){return"pubNubEventsNotRouted"}}]),t}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StreamACL=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(3)),u=r(n(341)),a=n(1),s=n(2),c="Invalid ACL object value";t.StreamACL=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.publishers=[],this.subscribers=[],this.publisherGroups=[],this.subscriberGroups=[],t&&(t instanceof e&&(t=t.toPlainObject()),this._parsePlainObject(t))}return o(e,[{key:"addPublishers",value:function(e){return this._addToAcl(this.publishers,e),this}},{key:"addSubscribers",value:function(e){return this._addToAcl(this.subscribers,e),this}},{key:"addPublisherGroups",value:function(e){return this._addToAcl(this.publisherGroups,e),this}},{key:"addSubscriberGroups",value:function(e){return this._addToAcl(this.subscriberGroups,e),this}},{key:"removePublishers",value:function(e){return this._removeFromAcl(this.publishers,e),this}},{key:"removeSubscribers",value:function(e){return this._removeFromAcl(this.subscribers,e),this}},{key:"removePublisherGroups",value:function(e){return this._removeFromAcl(this.publisherGroups,e),this}},{key:"removeSubscriberGroups",value:function(e){return this._removeFromAcl(this.subscriberGroups,e),this}},{key:"isNotEmpty",value:function(){return this.publishers.length||this.subscribers.length||this.publisherGroups.length||this.subscriberGroups.length}},{key:"toPlainObject",value:function(){var e={};return this.subscribers.length&&(e.subscribe=this.subscribers.slice(0)),this.publishers.length&&(e.publish=this.publishers.slice(0)),this.subscriberGroups.length&&(e.groups=e.groups||{},e.groups.subscribe=this.addSubscriberGroups.slice(0)),this.publisherGroups.length&&(e.groups=e.groups||{},e.groups.publish=this.publisherGroups.slice(0)),e}},{key:"_parsePlainObject",value:function(e){e.subscribe&&(this.subscribers=this._ensureValidIdArray(e.subscribe)),e.publish&&(this.publishers=this._ensureValidIdArray(e.publish)),e.groups&&(e.groups.publish&&(this.publisherGroups=this._ensureValidIdArray(e.groups.publish)),e.groups.subscribe&&(this.subscriberGroups=this._ensureValidIdArray(e.groups.subscribe)))}},{key:"_ensureValidIdArray",value:function(e){if(!this._isValidIdArray(e))throw new a.KinveyError(c);return e}},{key:"_isValidIdArray",value:function(e){var t=this;return(0,i.default)(e)&&(0,u.default)(e,function(e){var n=t._getAsId(e);return(0,s.isNonemptyString)(n)})}},{key:"_addToAcl",value:function(e,t){var n=this,r=(0,i.default)(t)?t:[t];if(!this._isValidIdArray(r))throw new a.KinveyError(c);r.forEach(function(t){var r=n._getAsId(t);e.push(r)})}},{key:"_removeFromAcl",value:function(e,t){var n=this;((0,i.default)(t)?t:[t]).forEach(function(t){var r=n._getAsId(t),o=e.indexOf(r);o>=0&&e.splice(o,1)})}},{key:"_getAsId",value:function(e){return e&&e._id?e._id:e}}],[{key:"isValidACLObject",value:function(t){try{return new e(t).isNotEmpty()}catch(e){return!1}}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncManager=t.SyncOperation=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(77)),a=r(n(117)),s=r(n(3)),c=r(n(6)),l=r(n(7)),f=n(5),h=n(1),p=n(2),d=n(8),y=n(10),v=new Map,b=t.SyncOperation={Create:f.RequestMethod.POST,Update:f.RequestMethod.PUT,Delete:f.RequestMethod.DELETE};Object.freeze(b);t.SyncManager=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new h.SyncError("A collection is required.");if(!(0,c.default)(t))throw new h.SyncError("Collection must be a string.");this.collection=t,this.tag=n.tag||void 0,this.client=n.client||d.Client.sharedInstance()}return o(e,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,p.isDefined)(e)&&e instanceof y.Query==!1&&(e=new y.Query((0,a.default)(e,"toJSON",e)));return new f.CacheRequest({method:f.RequestMethod.GET,url:l.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.backendPathname}),query:e,properties:n.properties,timeout:n.timeout,client:this.client,tag:this.tag}).execute().then(function(e){return e.data}).then(function(r){var o=new y.Query;o.equalTo("collection",t.collection),(0,p.isDefined)(e)&&o.contains("entityId",(0,u.default)(r,function(e){return e._id}));return new f.CacheRequest({method:f.RequestMethod.GET,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:o,timeout:n.timeout,client:t.client,tag:t.tag}).execute().then(function(e){return e.data})})}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,t).then(function(e){return e.length})}},{key:"addCreateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Create,e,t)}},{key:"addUpdateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Update,e,t)}},{key:"addDeleteOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Delete,e,t)}},{key:"addOperation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.Create,t=this,n=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!1;return(0,s.default)(n)||(o=!0,n=[n]),i.default.all((0,u.default)(n,function(n){if(!n)return i.default.resolve(null);var o=n._id;if(!o)return i.default.reject(new h.SyncError("An entity is missing an _id. All entities must have an _id in order to be added to the sync table.",n));var u=(new y.Query).equalTo("entityId",o);return new f.CacheRequest({method:f.RequestMethod.GET,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:u,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(n){var i=1===n.length?n[0]:{collection:t.collection,state:{},entityId:o};i.state=i.state||{},i.state.operation=e;return new f.CacheRequest({method:f.RequestMethod.PUT,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,body:i,timeout:r.timeout,tag:t.tag}).execute()})})).then(function(){return!0===o?n[0]:n})}},{key:"pull",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e||e instanceof y.Query?this.count(e).then(function(n){return n>0?t.push(e).then(function(){return t.count(e)}):n}).then(function(r){if(r>0)throw new h.SyncError("Unable to pull data from the network. There are "+r+" entities that need to be synced before data is loaded from the network.");var o={method:f.RequestMethod.GET,authType:f.AuthType.Default,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname}),properties:n.properties,query:e,timeout:n.timeout,client:t.client,tag:t.tag},i=new f.KinveyRequest(o);return!0===n.useDeltaFetch&&(i=new f.DeltaFetchRequest(o)),i.execute()}).then(function(e){return e.data}):i.default.reject(new h.SyncError("Invalid query. It must be an instance of the Query class."))}},{key:"push",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=0;return!0===v.get(this.collection)?i.default.reject(new h.SyncError("Data is already being pushed to the backend. Please wait for it to complete before pushing new data to the backend.")):(v.set(this.collection,!0),this.find(e).then(function(e){if(e.length>0){return function o(a){return new i.default(function(s){var c=e.slice(r,r+100);return r+=100,i.default.all((0,u.default)(c,function(e){var r=e.entityId,o=e.state,i=void 0===o?{}:o,u=i.operation||i.method;if(u===b.Delete)return new f.KinveyRequest({method:f.RequestMethod.DELETE,authType:f.AuthType.Default,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,client:t.client,tag:t.tag}).execute().then(function(){return new f.CacheRequest({method:f.RequestMethod.DELETE,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute()}).then(function(){return{_id:r,operation:u}}).catch(function(e){return{_id:r,operation:u,error:e}});if(u===b.Create||u===b.Update){var a=!1;return new f.CacheRequest({method:f.RequestMethod.GET,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(o){var i=new f.KinveyRequest({method:f.RequestMethod.PUT,authType:f.AuthType.Default,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,body:o,client:t.client});return u===b.Create&&((0,p.isDefined)(o._kmd)&&!0===o._kmd.local&&(a=!0,delete o._id),i.method=f.RequestMethod.POST,i.url=l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname})),i.execute().then(function(e){return e.data}).then(function(o){return new f.CacheRequest({method:f.RequestMethod.DELETE,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute().then(function(){return new f.CacheRequest({method:f.RequestMethod.PUT,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+o._id}),properties:n.properties,timeout:n.timeout,body:o,tag:t.tag}).execute().then(function(e){return e.data})}).then(function(e){return a?new f.CacheRequest({method:f.RequestMethod.DELETE,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+r}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute().then(function(){return e}):e}).then(function(e){return{_id:r,operation:u,entity:e}})}).catch(function(e){return o._id=r,{_id:r,operation:u,entity:o,error:e}})}).catch(function(e){return{_id:r,operation:u,entity:void 0,error:e}})}return{_id:r,operation:u,entity:void 0,error:new h.SyncError("Unable to sync the entity since the operation was not recognized.",e)}})).then(function(t){return a=a.concat(t),r<e.length?s(o(a)):s(a)})})}([])}return[]}).then(function(e){return v.set(t.collection,!1),e}).catch(function(e){throw v.set(t.collection,!1),e}))}},{key:"clear",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,n).then(function(e){return i.default.all((0,u.default)(e,function(e){return new f.CacheRequest({method:f.RequestMethod.DELETE,url:l.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data})}))})}},{key:"pathname",get:function(){return"/appdata/"+this.client.appKey+"/kinvey_sync"}},{key:"backendPathname",get:function(){return"/appdata/"+this.client.appKey+"/"+this.collection}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncStore=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(7)),i=n(5),u=n(1),a=n(10),s=n(24),c=n(2),l=n(32),f=n(76);t.SyncStore=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f.CacheStore),r(t,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(r){if(e&&!(e instanceof a.Query))return r.error(new u.KinveyError("Invalid query. It must be an instance of the Query class."));return new i.CacheRequest({method:i.RequestMethod.GET,url:o.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})})}},{key:"findById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(r){try{if(!1===(0,c.isDefined)(e))return r.next(void 0),r.complete();return new i.CacheRequest({method:i.RequestMethod.GET,url:o.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:n.properties,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"group",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(r){if(!(e instanceof s.Aggregation))return r.error(new u.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."));return new i.CacheRequest({method:i.RequestMethod.POST,url:o.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:n.properties,aggregation:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})})}},{key:"count",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(r){try{if(e&&!(e instanceof a.Query))throw new u.KinveyError("Invalid query. It must be an instance of the Query class.");return new i.CacheRequest({method:i.RequestMethod.GET,url:o.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return r.next(e?e.length:0)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}catch(e){return r.error(e)}})}},{key:"syncAutomatically",get:function(){return!1}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.SocialIdentity={Kinvey:"kinvey",MobileIdentityConnect:"kinveyAuth"};Object.freeze(r)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Acl=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(28)),u=r(n(3)),a=r(n(13)),s=n(1),c=n(2);t.Acl=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!1===(0,i.default)(t))throw new s.KinveyError("entity argument must be an object");t._acl=t._acl||{},this.entity=t}return o(e,[{key:"addReader",value:function(e){var t=this.readers;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.r=t,this}},{key:"addReaderGroup",value:function(e){var t=this.readerGroups;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.groups=(0,a.default)({},this.entity._acl.groups,{r:t}),this}},{key:"addWriter",value:function(e){var t=this.writers;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.w=t,this}},{key:"addWriterGroup",value:function(e){var t=this.writerGroups;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.groups=(0,a.default)({},this.entity._acl.groups,{w:t}),this}},{key:"isGloballyReadable",value:function(){return!0===this.entity._acl.gr&&this.entity._acl.gr}},{key:"isGloballyWritable",value:function(){return!0===this.entity._acl.gw&&this.entity._acl.gw}},{key:"removeReader",value:function(e){var t=this.readers,n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.entity._acl.r=t,this}},{key:"removeReaderGroup",value:function(e){var t=this.readerGroups,n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.entity._acl.groups=(0,a.default)({},this.entity._acl.groups,{r:t}),this}},{key:"removeWriter",value:function(e){var t=this.writers,n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.entity._acl.w=t,this}},{key:"removeWriterGroup",value:function(e){var t=this.writerGroups,n=t.indexOf(e);return-1!==n&&t.splice(n,1),this.entity._acl.groups=(0,a.default)({},this.entity._acl.groups,{w:t}),this}},{key:"toPlainObject",value:function(){return this.entity._acl}},{key:"creator",get:function(){return this.entity._acl.creator}},{key:"readers",get:function(){return(0,u.default)(this.entity._acl.r)?this.entity._acl.r:[]}},{key:"writers",get:function(){return(0,u.default)(this.entity._acl.w)?this.entity._acl.w:[]}},{key:"readerGroups",get:function(){return(0,c.isDefined)(this.entity._acl.groups)&&(0,u.default)(this.entity._acl.groups.r)?this.entity._acl.groups.r:[]}},{key:"writerGroups",get:function(){return(0,c.isDefined)(this.entity._acl.groups)&&(0,u.default)(this.entity._acl.groups.w)?this.entity._acl.groups.w:[]}},{key:"globallyReadable",set:function(e){this.entity._acl.gr=!0===e&&e}},{key:"globallyWritable",set:function(e){this.entity._acl.gw=!0===e&&e}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.hasCookies=function(){var e=new u;try{e.setItem("__test","1");var t=e.getItem("__test");return e.removeItem("__test"),"1"===t}catch(e){return!1}};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(358)),i="lS_",u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cookieOptions=Object.assign({path:"/"},t),i=t.prefix||i}return r(e,[{key:"getItem",value:function(e){var t=o.default.parse(document.cookie);return t&&t.hasOwnProperty(i+e)?t[i+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=o.default.serialize(i+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=Object.assign({},this.cookieOptions,{maxAge:-1});return document.cookie=o.default.serialize(i+e,"",t),null}},{key:"clear",value:function(){var e=o.default.parse(document.cookie);for(var t in e)0===t.indexOf(i)&&this.removeItem(t.substr(i.length));return null}}]),e}();t.default=u},function(e,t){e.exports=function(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.WebStorage=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kinvey";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}return r(e,[{key:"masterCollectionName",get:function(){return this.name+"master"}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Kinvey=void 0;var r=n(134);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(r);t.Kinvey=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WritesToCollectionDisallowedError=t.UserAlreadyExistsError=t.TimeoutError=t.SyncError=t.StaleRequestError=t.ServerError=t.QueryError=t.PopupError=t.ParameterValueOutOfRangeError=t.NotFoundError=t.NoResponseError=t.NetworkConnectionError=t.NoActiveUserError=t.MobileIdentityConnectError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.KinveyInternalErrorStop=t.KinveyInternalErrorRetry=t.KinveyError=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IndirectCollectionAccessDisallowedError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.DuplicateEndUsersError=t.CORSDisabledError=t.BLError=t.BadRequestError=t.AppProblemError=t.APIVersionNotImplementedError=t.APIVersionNotAvailableError=t.ActiveUserError=t.User=t.Query=t.Metadata=t.Log=t.Files=t.LiveService=t.SyncOperation=t.DataStoreType=t.DataStore=t.CustomEndpoint=t.AuthorizationGrant=t.Aggregation=t.Acl=t.ping=t.setAppVersion=t.getAppVersion=t.client=void 0;var r=n(135);Object.defineProperty(t,"client",{enumerable:!0,get:function(){return r.client}}),Object.defineProperty(t,"getAppVersion",{enumerable:!0,get:function(){return r.getAppVersion}}),Object.defineProperty(t,"setAppVersion",{enumerable:!0,get:function(){return r.setAppVersion}}),Object.defineProperty(t,"ping",{enumerable:!0,get:function(){return r.ping}}),Object.defineProperty(t,"Acl",{enumerable:!0,get:function(){return r.Acl}}),Object.defineProperty(t,"Aggregation",{enumerable:!0,get:function(){return r.Aggregation}}),Object.defineProperty(t,"AuthorizationGrant",{enumerable:!0,get:function(){return r.AuthorizationGrant}}),Object.defineProperty(t,"CustomEndpoint",{enumerable:!0,get:function(){return r.CustomEndpoint}}),Object.defineProperty(t,"DataStore",{enumerable:!0,get:function(){return r.DataStore}}),Object.defineProperty(t,"DataStoreType",{enumerable:!0,get:function(){return r.DataStoreType}}),Object.defineProperty(t,"SyncOperation",{enumerable:!0,get:function(){return r.SyncOperation}}),Object.defineProperty(t,"LiveService",{enumerable:!0,get:function(){return r.LiveService}}),Object.defineProperty(t,"Files",{enumerable:!0,get:function(){return r.Files}}),Object.defineProperty(t,"Log",{enumerable:!0,get:function(){return r.Log}}),Object.defineProperty(t,"Metadata",{enumerable:!0,get:function(){return r.Metadata}}),Object.defineProperty(t,"Query",{enumerable:!0,get:function(){return r.Query}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return r.User}}),Object.defineProperty(t,"ActiveUserError",{enumerable:!0,get:function(){return r.ActiveUserError}}),Object.defineProperty(t,"APIVersionNotAvailableError",{enumerable:!0,get:function(){return r.APIVersionNotAvailableError}}),Object.defineProperty(t,"APIVersionNotImplementedError",{enumerable:!0,get:function(){return r.APIVersionNotImplementedError}}),Object.defineProperty(t,"AppProblemError",{enumerable:!0,get:function(){return r.AppProblemError}}),Object.defineProperty(t,"BadRequestError",{enumerable:!0,get:function(){return r.BadRequestError}}),Object.defineProperty(t,"BLError",{enumerable:!0,get:function(){return r.BLError}}),Object.defineProperty(t,"CORSDisabledError",{enumerable:!0,get:function(){return r.CORSDisabledError}}),Object.defineProperty(t,"DuplicateEndUsersError",{enumerable:!0,get:function(){return r.DuplicateEndUsersError}}),Object.defineProperty(t,"FeatureUnavailableError",{enumerable:!0,get:function(){return r.FeatureUnavailableError}}),Object.defineProperty(t,"IncompleteRequestBodyError",{enumerable:!0,get:function(){return r.IncompleteRequestBodyError}}),Object.defineProperty(t,"IndirectCollectionAccessDisallowedError",{enumerable:!0,get:function(){return r.IndirectCollectionAccessDisallowedError}}),Object.defineProperty(t,"InsufficientCredentialsError",{enumerable:!0,get:function(){return r.InsufficientCredentialsError}}),Object.defineProperty(t,"InvalidCredentialsError",{enumerable:!0,get:function(){return r.InvalidCredentialsError}}),Object.defineProperty(t,"InvalidIdentifierError",{enumerable:!0,get:function(){return r.InvalidIdentifierError}}),Object.defineProperty(t,"InvalidQuerySyntaxError",{enumerable:!0,get:function(){return r.InvalidQuerySyntaxError}}),Object.defineProperty(t,"JSONParseError",{enumerable:!0,get:function(){return r.JSONParseError}}),Object.defineProperty(t,"KinveyError",{enumerable:!0,get:function(){return r.KinveyError}}),Object.defineProperty(t,"KinveyInternalErrorRetry",{enumerable:!0,get:function(){return r.KinveyInternalErrorRetry}}),Object.defineProperty(t,"KinveyInternalErrorStop",{enumerable:!0,get:function(){return r.KinveyInternalErrorStop}}),Object.defineProperty(t,"MissingQueryError",{enumerable:!0,get:function(){return r.MissingQueryError}}),Object.defineProperty(t,"MissingRequestHeaderError",{enumerable:!0,get:function(){return r.MissingRequestHeaderError}}),Object.defineProperty(t,"MissingRequestParameterError",{enumerable:!0,get:function(){return r.MissingRequestParameterError}}),Object.defineProperty(t,"MobileIdentityConnectError",{enumerable:!0,get:function(){return r.MobileIdentityConnectError}}),Object.defineProperty(t,"NoActiveUserError",{enumerable:!0,get:function(){return r.NoActiveUserError}}),Object.defineProperty(t,"NetworkConnectionError",{enumerable:!0,get:function(){return r.NetworkConnectionError}}),Object.defineProperty(t,"NoResponseError",{enumerable:!0,get:function(){return r.NoResponseError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return r.NotFoundError}}),Object.defineProperty(t,"ParameterValueOutOfRangeError",{enumerable:!0,get:function(){return r.ParameterValueOutOfRangeError}}),Object.defineProperty(t,"PopupError",{enumerable:!0,get:function(){return r.PopupError}}),Object.defineProperty(t,"QueryError",{enumerable:!0,get:function(){return r.QueryError}}),Object.defineProperty(t,"ServerError",{enumerable:!0,get:function(){return r.ServerError}}),Object.defineProperty(t,"StaleRequestError",{enumerable:!0,get:function(){return r.StaleRequestError}}),Object.defineProperty(t,"SyncError",{enumerable:!0,get:function(){return r.SyncError}}),Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return r.TimeoutError}}),Object.defineProperty(t,"UserAlreadyExistsError",{enumerable:!0,get:function(){return r.UserAlreadyExistsError}}),Object.defineProperty(t,"WritesToCollectionDisallowedError",{enumerable:!0,get:function(){return r.WritesToCollectionDisallowedError}});var o=n(353);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(5),u=n(360),a=n(367),s=n(84),c=n(374),l=function(e){return e&&e.__esModule?e:{default:e}}(n(375));i.CacheRack.useCacheMiddleware(new a.Html5CacheMiddleware),i.NetworkRack.useHttpMiddleware(new u.Html5HttpMiddleware(l.default)),s.MobileIdentityConnect.usePopupClass(c.Popup)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(136);Object.defineProperty(t,"client",{enumerable:!0,get:function(){return r.client}}),Object.defineProperty(t,"getAppVersion",{enumerable:!0,get:function(){return r.getAppVersion}}),Object.defineProperty(t,"setAppVersion",{enumerable:!0,get:function(){return r.setAppVersion}}),Object.defineProperty(t,"init",{enumerable:!0,get:function(){return r.init}}),Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return r.initialize}}),Object.defineProperty(t,"ping",{enumerable:!0,get:function(){return r.ping}});var o=n(129);Object.defineProperty(t,"Acl",{enumerable:!0,get:function(){return o.Acl}});var i=n(24);Object.defineProperty(t,"Aggregation",{enumerable:!0,get:function(){return i.Aggregation}});var u=n(84);Object.defineProperty(t,"AuthorizationGrant",{enumerable:!0,get:function(){return u.AuthorizationGrant}});var a=n(8);Object.defineProperty(t,"Client",{enumerable:!0,get:function(){return a.Client}});var s=n(351);Object.defineProperty(t,"CustomEndpoint",{enumerable:!0,get:function(){return s.CustomEndpoint}});var c=n(50);Object.defineProperty(t,"DataStore",{enumerable:!0,get:function(){return c.DataStore}}),Object.defineProperty(t,"DataStoreType",{enumerable:!0,get:function(){return c.DataStoreType}}),Object.defineProperty(t,"SyncOperation",{enumerable:!0,get:function(){return c.SyncOperation}});var l=n(82);Object.defineProperty(t,"LiveService",{enumerable:!0,get:function(){return l.LiveService}});var f=n(352);Object.defineProperty(t,"Files",{enumerable:!0,get:function(){return f.Files}});var h=n(19);Object.defineProperty(t,"Log",{enumerable:!0,get:function(){return h.Log}});var p=n(78);Object.defineProperty(t,"Metadata",{enumerable:!0,get:function(){return p.Metadata}});var d=n(10);Object.defineProperty(t,"Query",{enumerable:!0,get:function(){return d.Query}});var y=n(5);Object.defineProperty(t,"Properties",{enumerable:!0,get:function(){return y.Properties}});var v=n(63);Object.defineProperty(t,"User",{enumerable:!0,get:function(){return v.User}});var b=n(1);Object.defineProperty(t,"ActiveUserError",{enumerable:!0,get:function(){return b.ActiveUserError}}),Object.defineProperty(t,"APIVersionNotAvailableError",{enumerable:!0,get:function(){return b.APIVersionNotAvailableError}}),Object.defineProperty(t,"APIVersionNotImplementedError",{enumerable:!0,get:function(){return b.APIVersionNotImplementedError}}),Object.defineProperty(t,"AppProblemError",{enumerable:!0,get:function(){return b.AppProblemError}}),Object.defineProperty(t,"BadRequestError",{enumerable:!0,get:function(){return b.BadRequestError}}),Object.defineProperty(t,"BLError",{enumerable:!0,get:function(){return b.BLError}}),Object.defineProperty(t,"CORSDisabledError",{enumerable:!0,get:function(){return b.CORSDisabledError}}),Object.defineProperty(t,"DuplicateEndUsersError",{enumerable:!0,get:function(){return b.DuplicateEndUsersError}}),Object.defineProperty(t,"FeatureUnavailableError",{enumerable:!0,get:function(){return b.FeatureUnavailableError}}),Object.defineProperty(t,"IncompleteRequestBodyError",{enumerable:!0,get:function(){return b.IncompleteRequestBodyError}}),Object.defineProperty(t,"IndirectCollectionAccessDisallowedError",{enumerable:!0,get:function(){return b.IndirectCollectionAccessDisallowedError}}),Object.defineProperty(t,"InsufficientCredentialsError",{enumerable:!0,get:function(){return b.InsufficientCredentialsError}}),Object.defineProperty(t,"InvalidCredentialsError",{enumerable:!0,get:function(){return b.InvalidCredentialsError}}),Object.defineProperty(t,"InvalidIdentifierError",{enumerable:!0,get:function(){return b.InvalidIdentifierError}}),Object.defineProperty(t,"InvalidQuerySyntaxError",{enumerable:!0,get:function(){return b.InvalidQuerySyntaxError}}),Object.defineProperty(t,"JSONParseError",{enumerable:!0,get:function(){return b.JSONParseError}}),Object.defineProperty(t,"KinveyError",{enumerable:!0,get:function(){return b.KinveyError}}),Object.defineProperty(t,"KinveyInternalErrorRetry",{enumerable:!0,get:function(){return b.KinveyInternalErrorRetry}}),Object.defineProperty(t,"KinveyInternalErrorStop",{enumerable:!0,get:function(){return b.KinveyInternalErrorStop}}),Object.defineProperty(t,"MissingQueryError",{enumerable:!0,get:function(){return b.MissingQueryError}}),Object.defineProperty(t,"MissingRequestHeaderError",{enumerable:!0,get:function(){return b.MissingRequestHeaderError}}),Object.defineProperty(t,"MissingRequestParameterError",{enumerable:!0,get:function(){return b.MissingRequestParameterError}}),Object.defineProperty(t,"MobileIdentityConnectError",{enumerable:!0,get:function(){return b.MobileIdentityConnectError}}),Object.defineProperty(t,"NoActiveUserError",{enumerable:!0,get:function(){return b.NoActiveUserError}}),Object.defineProperty(t,"NetworkConnectionError",{enumerable:!0,get:function(){return b.NetworkConnectionError}}),Object.defineProperty(t,"NoResponseError",{enumerable:!0,get:function(){return b.NoResponseError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return b.NotFoundError}}),Object.defineProperty(t,"ParameterValueOutOfRangeError",{enumerable:!0,get:function(){return b.ParameterValueOutOfRangeError}}),Object.defineProperty(t,"PopupError",{enumerable:!0,get:function(){return b.PopupError}}),Object.defineProperty(t,"QueryError",{enumerable:!0,get:function(){return b.QueryError}}),Object.defineProperty(t,"ServerError",{enumerable:!0,get:function(){return b.ServerError}}),Object.defineProperty(t,"StaleRequestError",{enumerable:!0,get:function(){return b.StaleRequestError}}),Object.defineProperty(t,"SyncError",{enumerable:!0,get:function(){return b.SyncError}}),Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return b.TimeoutError}}),Object.defineProperty(t,"UserAlreadyExistsError",{enumerable:!0,get:function(){return b.UserAlreadyExistsError}}),Object.defineProperty(t,"WritesToCollectionDisallowedError",{enumerable:!0,get:function(){return b.WritesToCollectionDisallowedError}})},function(e,t,n){"use strict";function r(){return s.Client.sharedInstance()}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===(0,a.isDefined)(e.appKey))throw new u.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!1===(0,a.isDefined)(e.appSecret)&&!1===(0,a.isDefined)(e.masterSecret))throw new u.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return s.Client.init(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0,t.getAppVersion=function(){var e=r();if(e)return e.appVersion},t.setAppVersion=function(e){var t=r();t&&(t.appVersion=e)},t.init=o,t.initialize=function(e){try{var t=o(e);return i.default.resolve(c.User.getActiveUser(t))}catch(e){return i.default.reject(e)}},t.ping=function(){var e=r();return new l.KinveyRequest({method:l.RequestMethod.GET,authType:l.AuthType.All,url:e.apiHostname+"/appdata/"+e.appKey}).execute().then(function(e){return e.data})};var i=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),u=n(1),a=n(2),s=n(8),c=n(63),l=n(5);t.client=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(){d&&h&&(d=!1,h.length?p=h.concat(p):y=-1,p.length&&u())}function u(){if(!d){var e=o(i);d=!0;for(var t=p.length;t;){for(h=p,p=[];++y<t;)h&&h[y].run();y=-1,t=p.length}h=null,d=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function s(){}var c,l,f=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var h,p=[],d=!1,y=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new a(e,t)),1!==p.length||d||o(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=s,f.addListener=s,f.once=s,f.off=s,f.removeListener=s,f.removeAllListeners=s,f.emit=s,f.prependListener=s,f.prependOnceListener=s,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t){},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ActiveUserError",this.message=e||"An active user already exists.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveUserError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="APIVersionNotAvailableError",this.message=e||"This API version is not available for your app.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.APIVersionNotAvailableError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="APIVersionNotImplementedError",this.message=e||"This API version is not implemented.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.APIVersionNotImplementedError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="AppProblemError",this.message=e||"There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.AppProblemError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="BadRequestError",this.message=e||"Unable to understand request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.BadRequestError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="BLError",this.message=e||"The Business Logic script did not complete.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.BLError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="CORSDisabledError",this.message=e||"Cross Origin Support is disabled for this application.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.CORSDisabledError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="DuplicateEndUsersError",this.message=e||"More than one user registered with this username for this application.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.DuplicateEndUsersError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="FeatureUnavailableError",this.message=e||"Requested functionality is unavailable in this API version.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureUnavailableError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="IncompleteRequestBodyError",this.message=e||"The request body is either missing or incomplete.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.IncompleteRequestBodyError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="IndirectCollectionAccessDisallowedError",this.message=e||"Please use the appropriate API to access this collection for this app backend.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.IndirectCollectionAccessDisallowedError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InsufficientCredentialsError",this.message=e||"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.InsufficientCredentialsError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidCredentialsError",this.message=e||"Invalid credentials. Please retry your request with correct credentials.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidCredentialsError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidIdentifierError",this.message=e||"One of more identifier names in the request has an invalid format.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidIdentifierError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="InvalidQuerySyntaxError",this.message=e||"The query string in the request has an invalid syntax.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidQuerySyntaxError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="JSONParseError",this.message=e||"Unable to parse the JSON in the request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.JSONParseError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyInternalErrorRetry",this.message=e||"The Kinvey server encountered an unexpected error. Please retry your request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyInternalErrorRetry=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyInternalErrorStop",this.message=e||"The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyInternalErrorStop=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="KinveyError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingQueryError",this.message=e||"The request is missing a query string.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.MissingQueryError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingRequestHeaderError",this.message=e||"The request is missing a required header.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRequestHeaderError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MissingRequestParameterError",this.message=e||"A required parameter is missing from the request.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRequestParameterError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="MobileIdentityConnectError",this.message=e||"An error has occurred with Mobile Identity Connect.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnectError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NetworkConnectionError",this.message=e||"There was an error connecting to the network.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkConnectionError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NoActiveUserError",this.message=e||"There is not an active user.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.NoActiveUserError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NoResponseError",this.message=e||"No response was provided.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.NoResponseError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="NotFoundError",this.message=e||"The entity was not found.",this.debug=t||void 0,this.code=n||404,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ParameterValueOutOfRangeError",this.message=e||"The value specified for one of the request parameters is out of range.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.ParameterValueOutOfRangeError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="PopupError",this.message=e||"Unable to open a popup on this platform.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.PopupError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="QueryError",this.message=e||"An error occurred with the query.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.QueryError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="ServerError",this.message=e||"An error occurred on the server.",this.debug=t||void 0,this.code=n||500,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.ServerError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="StaleRequestError",this.message=e||"The time window for this request has expired.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.StaleRequestError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="SyncError",this.message=e||"An error occurred during sync.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.SyncError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="TimeoutError",this.message=e||"The request timed out.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.TimeoutError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="UserAlreadyExistsError",this.message=e||"This username is already taken. Please retry your request with a different username.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.UserAlreadyExistsError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t,n){"use strict";function r(e,t,n,r){this.name="WritesToCollectionDisallowedError",this.message=e||"This collection is configured to disallow any modifications to an existing entity or creation of new entities.",this.debug=t||void 0,this.code=n||void 0,this.kinveyRequestId=r||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.WritesToCollectionDisallowedError=r;var o=n(0);(r.prototype=Object.create(o.BaseError.prototype)).constructor=r},function(e,t){e.exports=function(e){return null===e}},function(e,t){e.exports=function(e){return void 0===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return""+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")+function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r+=1)t+=n.charAt(Math.floor(Math.random()*n.length));return t}(e)},t.isNonemptyString=function(e){return"string"==typeof e&&""!==e},t.uuidv4=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=[],i=!1;return(0,s.default)(e)&&(0,h.isDefined)(n)&&(i=!0),Object.keys(e).forEach(function(u){var a=void 0,s=e[u],l=n?n+"["+(i?"":u)+"]":u;if(!1===(0,h.isDefined)(s)){if(!0===t.removeNull)return;a=!0===t.encodeComponents?encodeURIComponent(l):l}else a=(0,c.default)(s)?o(s,t,l):t.encodeComponents?encodeURIComponent(l)+"="+encodeURIComponent(s):l+"="+s;r.push(a)}),r.join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t.appendQuery=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.default.parse(e,!0),s=(0,l.default)(t)?u.default.parse(t):t,c=(0,a.default)({},r.query,s);n=(0,a.default)({encodeComponents:!0,removeNull:!1},n),r.query=null;var p=o(c,n);return r.search=(0,h.isDefined)(p)&&!1===(0,f.default)(p)?"?"+p:null,i.default.format(r)};var i=r(n(7)),u=r(n(52)),a=r(n(13)),s=r(n(3)),c=r(n(28)),l=r(n(6)),f=r(n(38)),h=n(85)},function(e,t,n){(function(e,r){var o;!function(i){function u(e){throw new RangeError(A[e])}function a(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function s(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]);return r+a((e=e.replace(T,".")).split("."),t).join(".")}function c(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function l(e){return a(e,function(e){var t="";return e>65535&&(t+=R((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=R(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:m}function h(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,n){var r=0;for(e=n?C(e/E):e>>1,e+=C(e/t);e>M*w>>1;r+=m)e=C(e/M);return C(r+(M+1)*e/(e+O))}function d(e){var t,n,r,o,i,a,s,c,h,d,y=[],v=e.length,b=0,O=P,E=k;for((n=e.lastIndexOf(j))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&u("not-basic"),y.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<v;){for(i=b,a=1,s=m;o>=v&&u("invalid-input"),((c=f(e.charCodeAt(o++)))>=m||c>C((g-b)/a))&&u("overflow"),b+=c*a,h=s<=E?_:s>=E+w?w:s-E,!(c<h);s+=m)a>C(g/(d=m-h))&&u("overflow"),a*=d;E=p(b-i,t=y.length+1,0==i),C(b/t)>g-O&&u("overflow"),O+=C(b/t),b%=t,y.splice(b++,0,O)}return l(y)}function y(e){var t,n,r,o,i,a,s,l,f,d,y,v,b,O,E,S=[];for(v=(e=c(e)).length,t=P,n=0,i=k,a=0;a<v;++a)(y=e[a])<128&&S.push(R(y));for(r=o=S.length,o&&S.push(j);r<v;){for(s=g,a=0;a<v;++a)(y=e[a])>=t&&y<s&&(s=y);for(s-t>C((g-n)/(b=r+1))&&u("overflow"),n+=(s-t)*b,t=s,a=0;a<v;++a)if((y=e[a])<t&&++n>g&&u("overflow"),y==t){for(l=n,f=m;d=f<=i?_:f>=i+w?w:f-i,!(l<d);f+=m)E=l-d,O=m-d,S.push(R(h(d+E%O,0))),l=C(E/O);S.push(R(h(l,0))),i=p(n,b,r==o),n=0,++r}++n,++t}return S.join("")}"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var v="object"==typeof r&&r;var b,g=2147483647,m=36,_=1,w=26,O=38,E=700,k=72,P=128,j="-",S=/^xn--/,x=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=m-_,C=Math.floor,R=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:c,encode:l},decode:d,encode:y,toASCII:function(e){return s(e,function(e){return x.test(e)?"xn--"+y(e):e})},toUnicode:function(e){return s(e,function(e){return S.test(e)?d(e.slice(4).toLowerCase()):e})}},void 0===(o=function(){return b}.call(t,n,t,e))||(e.exports=o)}()}).call(t,n(33)(e),n(9))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(182),t.encode=t.stringify=n(183)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var u={};if("string"!=typeof e||0===e.length)return u;var a=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var c=e.length;s>0&&c>s&&(c=s);for(var l=0;l<c;++l){var f,h,p,d,y=e[l].replace(a,"%20"),v=y.indexOf(n);v>=0?(f=y.substr(0,v),h=y.substr(v+1)):(f=y,h=""),p=decodeURIComponent(f),d=decodeURIComponent(h),r(u,p)?o(u[p])?u[p].push(d):u[p]=[u[p],d]:u[p]=d}return u};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(u(e),function(u){var a=encodeURIComponent(o(u))+n;return i(e[u])?r(e[u],function(e){return a+encodeURIComponent(o(e))}).join(t):a+encodeURIComponent(o(e[u]))}).join(t):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";var r=n(86),o=n(87),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Date.prototype.toISOString,a={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},s=function e(t,n,o,i,u,s,c,l,f,h,p,d){var y=t;if("function"==typeof c)y=c(n,y);else if(y instanceof Date)y=h(y);else if(null===y){if(i)return s&&!d?s(n,a.encoder):n;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||r.isBuffer(y)){if(s){return[p(d?n:s(n,a.encoder))+"="+p(s(y,a.encoder))]}return[p(n)+"="+p(String(y))]}var v=[];if(void 0===y)return v;var b;if(Array.isArray(c))b=c;else{var g=Object.keys(y);b=l?g.sort(l):g}for(var m=0;m<b.length;++m){var _=b[m];u&&null===y[_]||(v=Array.isArray(y)?v.concat(e(y[_],o(n,_),o,i,u,s,c,l,f,h,p,d)):v.concat(e(y[_],n+(f?"."+_:"["+_+"]"),o,i,u,s,c,l,f,h,p,d)))}return v};e.exports=function(e,t){var n=e,u=t?r.assign({},t):{};if(null!==u.encoder&&void 0!==u.encoder&&"function"!=typeof u.encoder)throw new TypeError("Encoder has to be a function.");var c=void 0===u.delimiter?a.delimiter:u.delimiter,l="boolean"==typeof u.strictNullHandling?u.strictNullHandling:a.strictNullHandling,f="boolean"==typeof u.skipNulls?u.skipNulls:a.skipNulls,h="boolean"==typeof u.encode?u.encode:a.encode,p="function"==typeof u.encoder?u.encoder:a.encoder,d="function"==typeof u.sort?u.sort:null,y=void 0!==u.allowDots&&u.allowDots,v="function"==typeof u.serializeDate?u.serializeDate:a.serializeDate,b="boolean"==typeof u.encodeValuesOnly?u.encodeValuesOnly:a.encodeValuesOnly;if(void 0===u.format)u.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,u.format))throw new TypeError("Unknown format option provided.");var g,m,_=o.formatters[u.format];"function"==typeof u.filter?n=(m=u.filter)("",n):Array.isArray(u.filter)&&(g=m=u.filter);var w=[];if("object"!=typeof n||null===n)return"";var O;O=u.arrayFormat in i?u.arrayFormat:"indices"in u?u.indices?"indices":"repeat":"indices";var E=i[O];g||(g=Object.keys(n)),d&&g.sort(d);for(var k=0;k<g.length;++k){var P=g[k];f&&null===n[P]||(w=w.concat(s(n[P],P,E,l,f,h?p:null,m,d,y,v,_,b)))}var j=w.join(c),S=!0===u.addQueryPrefix?"?":"";return j.length>0?S+j:""}},function(e,t,n){"use strict";var r=n(86),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},u=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,u=/(\[[^[\]]*])/.exec(r),a=u?r.slice(0,u.index):r,s=[];if(a){if(!n.plainObjects&&o.call(Object.prototype,a)&&!n.allowPrototypes)return;s.push(a)}for(var c=0;null!==(u=i.exec(r))&&c<n.depth;){if(c+=1,!n.plainObjects&&o.call(Object.prototype,u[1].slice(1,-1))&&!n.allowPrototypes)return;s.push(u[1])}return u&&s.push("["+r.slice(u.index)+"]"),function(e,t,n){for(var r=t,o=e.length-1;o>=0;--o){var i,u=e[o];if("[]"===u)i=(i=[]).concat(r);else{i=n.plainObjects?Object.create(null):{};var a="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,s=parseInt(a,10);!isNaN(s)&&u!==a&&String(s)===a&&s>=0&&n.parseArrays&&s<=n.arrayLimit?(i=[])[s]=r:i[a]=r}r=i}return r}(s,t,n)}};e.exports=function(e,t){var n=t?r.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:i.delimiter,n.depth="number"==typeof n.depth?n.depth:i.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:i.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:i.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:i.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:i.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:i.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:i.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:i.strictNullHandling,""===e||null===e||void 0===e)return n.plainObjects?Object.create(null):{};for(var a="string"==typeof e?function(e,t){for(var n={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=t.parameterLimit===1/0?void 0:t.parameterLimit,a=r.split(t.delimiter,u),s=0;s<a.length;++s){var c,l,f=a[s],h=f.indexOf("]="),p=-1===h?f.indexOf("="):h+1;-1===p?(c=t.decoder(f,i.decoder),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,p),i.decoder),l=t.decoder(f.slice(p+1),i.decoder)),o.call(n,c)?n[c]=[].concat(n[c]).concat(l):n[c]=l}return n}(e,n):e,s=n.plainObjects?Object.create(null):{},c=Object.keys(a),l=0;l<c.length;++l){var f=c[l],h=u(f,a[f],n);s=r.merge(s,h,n)}return r.compact(s)}},function(e,t,n){var r=n(16),o=n(189),i=n(12),u=n(90),a=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:a).test(u(e))}},function(e,t,n){var r=n(23),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=u.call(e);return r&&(t?e[a]=n:delete e[a]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(190),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(11)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(91),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,u=-1,a=o(i.length-t,0),s=Array(a);++u<a;)s[u]=i[t+u];u=-1;for(var c=Array(t+1);++u<t;)c[u]=i[u];return c[t]=n(s),r(e,this,c)}}},function(e,t,n){var r=n(194),o=n(196)(r);e.exports=o},function(e,t,n){var r=n(195),o=n(88),i=n(34),u=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=u},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var n=800,r=16,o=Date.now;e.exports=function(e){var t=0,i=0;return function(){var u=o(),a=r-(u-i);if(i=u,a>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(17),o=n(15),i="[object Arguments]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(17),o=n(57),i=n(15),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!u[r(e)]}},function(e,t,n){(function(e){var r=n(89),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o&&r.process,a=function(){try{return u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=a}).call(t,n(33)(e))},function(e,t,n){var r=n(96)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(21)(n(11),"DataView");e.exports=r},function(e,t,n){var r=n(21)(n(11),"Promise");e.exports=r},function(e,t,n){var r=n(21)(n(11),"Set");e.exports=r},function(e,t,n){var r=n(21)(n(11),"WeakMap");e.exports=r},function(e,t,n){var r,o;!function(i,u){"use strict";void 0===(o="function"==typeof(r=u)?r.call(t,n,t,e):r)||(e.exports=o)}(0,function(){"use strict";function e(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function t(e,t){for(var n=0;n<u.length;n++){var r=u[n];this[r]=n<e?o:this.methodFactory(r,e,t)}this.log=this.debug}function n(n,r,u){return function(t){return"debug"===t&&(t="log"),typeof console!==i&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):o)}(n)||function(e,n,r){return function(){typeof console!==i&&(t.call(this,n,r),this[e].apply(this,arguments))}}.apply(this,arguments)}function r(e,r,o){function a(){var e;if(typeof window!==i){try{e=window.localStorage[l]}catch(e){}if(typeof e===i)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(l)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===c.levels[e]&&(e=void 0),e}}var s,c=this,l="loglevel";e&&(l+=":"+e),c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=o||n,c.getLevel=function(){return s},c.setLevel=function(n,r){if("string"==typeof n&&void 0!==c.levels[n.toUpperCase()]&&(n=c.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(s=n,!1!==r&&function(e){var t=(u[e]||"silent").toUpperCase();if(typeof window!==i){try{return void(window.localStorage[l]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+t+";"}catch(e){}}}(n),t.call(c,n,e),typeof console===i&&n<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(e){a()||c.setLevel(e,!1)},c.enableAll=function(e){c.setLevel(c.levels.TRACE,e)},c.disableAll=function(e){c.setLevel(c.levels.SILENT,e)};var f=a();null==f&&(f=null==r?"WARN":r),c.setLevel(f,!1)}var o=function(){},i="undefined",u=["trace","debug","info","warn","error"],a=new r,s={};a.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=s[e];return t||(t=s[e]=new r(e,a.getLevel(),a.methodFactory)),t};var c=typeof window!==i?window.log:void 0;return a.noConflict=function(){return typeof window!==i&&window.log===a&&(window.log=c),a},a})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(13)),a=r(n(6)),s=r(n(12)),c=r(n(38)),l=r(n(7)),f=n(8),h=n(5),p=n(1),d=n(50),y=n(84),v=n(19),b=n(2),g=n(129),m=n(78),_=n(82),w=n(350);t.User=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.client=n.client||f.Client.sharedInstance()}return o(e,[{key:"isActive",value:function(){var t=e.getActiveUser(this.client);return!(!(0,b.isDefined)(t)||t._id!==this._id)}},{key:"isEmailVerified",value:function(){return"confirmed"===this.metadata.emailVerification}},{key:"login",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=t,c=this.isActive(),f=e.getActiveUser(this.client);if(!0===c)return i.default.reject(new p.ActiveUserError("This user is already the active user."));if((0,b.isDefined)(f))return i.default.reject(new p.ActiveUserError("An active user already exists. Please logout the active user before you login."));if((0,s.default)(a)?o=n||{}:a={username:t,password:n},(0,b.isDefined)(a.username)&&(a.username=String(a.username).trim()),(0,b.isDefined)(a.password)&&(a.password=String(a.password).trim()),!((0,b.isDefined)(a.username)&&""!==a.username&&(0,b.isDefined)(a.password)&&""!==a.password||(0,b.isDefined)(a._socialIdentity)))return i.default.reject(new p.KinveyError("Username and/or password missing. Please provide both a username and password to login."));return new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.App,url:l.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:a,properties:o.properties,timeout:o.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){if((0,b.isDefined)(a._socialIdentity)&&(0,b.isDefined)(e._socialIdentity)){Object.keys(e._socialIdentity).forEach(function(t){e._socialIdentity[t]=(0,u.default)({},a._socialIdentity[t],e._socialIdentity[t])}),e._socialIdentity=(0,u.default)({},a._socialIdentity,e._socialIdentity)}return delete e.password,r.client.setActiveUser(e)}).then(function(e){return r.data=e,r})}},{key:"loginWithMIC",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=this.isActive(),a=e.getActiveUser(this.client);if(u)return i.default.reject(new p.ActiveUserError("This user is already the active user."));if((0,b.isDefined)(a))return i.default.reject(new p.ActiveUserError("An active user already exists. Please logout the active user before you login."));return new y.MobileIdentityConnect({client:this.client}).login(t,n,o).then(function(e){return r.connectIdentity(y.MobileIdentityConnect.identity,e,o)})}},{key:"connectIdentity",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.isActive(),i={},u=i._socialIdentity||{};return u[e]=t,i._socialIdentity=u,o?this.update(i,r):this.login(i,r).catch(function(o){if(o instanceof p.NotFoundError)return n.signup(i,r).then(function(){return n.connectIdentity(e,t,r)});throw o})}},{key:"disconnectIdentity",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.default.resolve();return e===y.MobileIdentityConnect.identity&&(r=y.MobileIdentityConnect.logout(this,n)),r.catch(function(e){v.Log.error(e)}).then(function(){var r=t.data,o=r._socialIdentity||{};return delete o[e],r._socialIdentity=o,t.data=r,t._id?t.update(r,n):t}).then(function(){return t})}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.Session,url:l.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:t.properties,timeout:t.timeout,client:this.client});return this.unregisterFromLiveService().then(function(){return n.execute()}).catch(function(e){return v.Log.error(e),null}).then(function(){return e.client.setActiveUser(null)}).catch(function(e){return v.Log.error(e),null}).then(function(){return d.DataStore.clearCache({client:e.client})}).catch(function(e){return v.Log.error(e),null}).then(function(){return e})}},{key:"signup",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.getActiveUser(this.client);if(!0===(r=(0,u.default)({state:!0},r)).state&&(0,b.isDefined)(o))throw new p.ActiveUserError("An active user already exists. Please logout the active user before you login.");t instanceof e&&(t=t.data),t=(0,u.default)(this.data,t);return new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.App,url:l.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname}),body:(0,c.default)(t)?null:t,properties:r.properties,timeout:r.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){return!0===r.state?n.client.setActiveUser(e):e}).then(function(e){return n.data=e,n})}},{key:"signupWithIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return r._socialIdentity={},r._socialIdentity[e]=t,this.signup(r,n)}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=(0,u.default)(this.data,e);return(new w.UserStore).update(e,n).then(function(e){return t.isActive()?t.client.setActiveUser(e):e}).then(function(e){return t.data=e,t})}},{key:"me",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new h.KinveyRequest({method:h.RequestMethod.GET,authType:h.AuthType.Session,url:l.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_me"}),properties:t.properties,timeout:t.timeout}).execute().then(function(e){return e.data}).then(function(t){return t=(0,u.default)(e.data,t),delete t.password,e.isActive()?e.client.setActiveUser(t):t}).then(function(t){return e.data=t,e})}},{key:"registerForLiveService",value:function(){var e=(0,_.getLiveService)(this.client),t=i.default.resolve();return e.isInitialized()||(t=e.fullInitialization(this)),t}},{key:"unregisterFromLiveService",value:function(){var e=(0,_.getLiveService)(this.client),t=i.default.resolve();return e.isInitialized()&&(t=e.fullUninitialization()),t}},{key:"_id",get:function(){return this.data._id}},{key:"_acl",get:function(){return new g.Acl(this.data)}},{key:"metadata",get:function(){return new m.Metadata(this.data)}},{key:"_kmd",get:function(){return this.metadata}},{key:"_socialIdentity",get:function(){return this.data._socialIdentity}},{key:"authtoken",get:function(){return this.metadata.authtoken}},{key:"username",get:function(){return this.data.username}},{key:"email",get:function(){return this.data.email}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}],[{key:"login",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new e({},r).login(t,n,r)}},{key:"loginWithMIC",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).loginWithMIC(e,t,n)}},{key:"connectIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).connectIdentity(e,t,n)}},{key:"logout",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getActiveUser(t.client);return(0,b.isDefined)(n)?n.logout(t):i.default.resolve(null)}},{key:"signup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this({},t).signup(e,t)}},{key:"signupWithIdentity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},n).signupWithIdentity(e,t,n)}},{key:"update",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.getActiveUser(n.client);return(0,b.isDefined)(r)?r.update(t,n):i.default.resolve(null)}},{key:"registerForLiveService",value:function(){var t=e.getActiveUser();return t?t.registerForLiveService():i.default.reject(new p.ActiveUserError("There is no active user"))}},{key:"unregisterFromLiveService",value:function(){var t=e.getActiveUser();return t?t.unregisterFromLiveService():i.default.reject(new p.ActiveUserError("There is no active user"))}},{key:"me",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getActiveUser(t.client);return n?n.me(t):i.default.resolve(null)}},{key:"getActiveUser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.Client.sharedInstance(),t=e.getActiveUser();return(0,b.isDefined)(t)?new this(t,{client:e}):null}},{key:"verifyEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new p.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,a.default)(e))return i.default.reject(new p.KinveyError("The provided username is not a string."));var n=t.client||f.Client.sharedInstance();return new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.App,url:l.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+e+"/user-email-verification-initiate"}),properties:t.properties,timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"forgotUsername",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new p.KinveyError("An email was not provided.","Please provide an email for the user that you would like to retrieve their username."));if(!(0,a.default)(e))return i.default.reject(new p.KinveyError("The provided email is not a string."));var n=t.client||f.Client.sharedInstance();return new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.App,url:l.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/user-forgot-username"}),properties:t.properties,data:{email:e},timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"resetPassword",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new p.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,a.default)(e))return i.default.reject(new p.KinveyError("The provided username is not a string."));var n=t.client||f.Client.sharedInstance();return new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.App,url:l.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+e+"/user-password-reset-initiate"}),properties:t.properties,timeout:t.timeout,client:n}).execute().then(function(e){return e.data})}},{key:"lookup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new w.UserStore).lookup(e,t)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new w.UserStore).exists(e,t)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new w.UserStore).removeById(e,t)}},{key:"restore",value:function(){return i.default.reject(new p.KinveyError("This function requires a master secret to be provided for your application. We strongly advise not to do this."))}}]),e}()},function(e,t,n){function r(e,t,n,M,C,R){var I,q=t&E,D=t&k,N=t&P;if(n&&(I=C?n(e,M,C,R):n(e)),void 0!==I)return I;if(!w(e))return e;var U=m(e);if(U){if(I=v(e),!q)return l(e,I)}else{var K=y(e),L=K==S||K==x;if(_(e))return c(e,q);if(K==T||K==j||L&&!C){if(I=D||L?{}:g(e),!q)return D?h(e,s(I,e)):f(e,a(I,e))}else{if(!A[K])return C?e:{};I=b(e,K,r,q)}}R||(R=new o);var B=R.get(e);if(B)return B;R.set(e,I);var F=N?D?d:p:D?keysIn:O,H=U?void 0:F(e);return i(H||e,function(o,i){H&&(o=e[i=o]),u(I,i,r(o,t,n,i,e,R))}),I}var o=n(64),i=n(100),u=n(53),a=n(232),s=n(233),c=n(236),l=n(237),f=n(238),h=n(240),p=n(103),d=n(241),y=n(60),v=n(242),b=n(243),g=n(252),m=n(3),_=n(37),w=n(12),O=n(18),E=1,k=2,P=4,j="[object Arguments]",S="[object Function]",x="[object GeneratorFunction]",T="[object Object]",A={};A[j]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A[T]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A[S]=A["[object WeakMap]"]=!1,e.exports=r},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(40),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(40);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(40);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(40);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(39);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(39),o=n(61),i=n(65),u=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<u-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(221),o=n(39),i=n(61);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(222),i=n(223),u=n(224),a=n(225),s=n(226);r.prototype.clear=o,r.prototype.delete=i,r.prototype.get=u,r.prototype.has=a,r.prototype.set=s,e.exports=r},function(e,t,n){var r=n(41);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(41),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===o?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(41),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(41),o="__lodash_hash_undefined__";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?o:t,this}},function(e,t,n){var r=n(42);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(42);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(42);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(42);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(22),o=n(18);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(22),o=n(43);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(12),o=n(27),i=n(235),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&u.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){(function(e){var r=n(11),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o?r.Buffer:void 0,a=u?u.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(t,n(33)(e))},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(22),o=n(66);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var u=e[n];t(u,n,e)&&(i[o++]=u)}return i}},function(e,t,n){var r=n(22),o=n(102);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(104),o=n(102),i=n(43);e.exports=function(e){return r(e,i,o)}},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(68),o=n(244),i=n(245),u=n(247),a=n(248),s=n(250),c=n(251),l="[object Boolean]",f="[object Date]",h="[object Map]",p="[object Number]",d="[object RegExp]",y="[object Set]",v="[object String]",b="[object Symbol]",g="[object ArrayBuffer]",m="[object DataView]",_="[object Float32Array]",w="[object Float64Array]",O="[object Int8Array]",E="[object Int16Array]",k="[object Int32Array]",P="[object Uint8Array]",j="[object Uint8ClampedArray]",S="[object Uint16Array]",x="[object Uint32Array]";e.exports=function(e,t,n,T){var A=e.constructor;switch(t){case g:return r(e);case l:case f:return new A(+e);case m:return o(e,T);case _:case w:case O:case E:case k:case P:case j:case S:case x:return c(e,T);case h:return i(e,T,n);case p:case v:return new A(e);case d:return u(e);case y:return a(e,T,n);case b:return s(e)}}},function(e,t,n){var r=n(68);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t,n){var r=n(246),o=n(69),i=n(106),u=1;e.exports=function(e,t,n){var a=t?n(i(e),u):i(e);return o(a,r,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.set(t[0],t[1]),e}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(249),o=n(69),i=n(107),u=1;e.exports=function(e,t,n){var a=t?n(i(e),u):i(e);return o(a,r,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.add(t),e}},function(e,t,n){var r=n(23),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},function(e,t,n){var r=n(68);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(253),o=n(59),i=n(27);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},function(e,t,n){var r=n(12),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},function(e,t){!function(){"use strict";function n(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return e instanceof Date?e.getTime():r(e)?e.map(o):e&&"function"==typeof e.toJSON?e.toJSON():e}function i(e,t){return n(e.get)?e.get(t):e[t]}function u(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var o=0,u=n.length;o<u;o++)if(e(t,i(n,o)))return!0;return!1}}function a(e,t,n,r){return e.v(e.a,t,n,r)}function s(e,t){for(var n=0;n<e.length;n++){i(e,n);if(a(t,i(e,n)))return n}return-1}function c(e,t){return{a:e,v:t}}function l(e,t){var n=[];if(f(t,e.k,0,t,n),1===n.length){var r=n[0];return a(e.nv,r[0],r[1],r[2])}for(var o=0;o<n.length;o++){var i=n[o];if(a(e.nv,i[0],i[1],i[2]))return!0}return!1}function f(e,t,n,o,u){if(n!==t.length&&void 0!=e){var a=i(t,n);if(r(e)&&isNaN(Number(a)))for(var s=0,c=e.length;s<c;s++)f(i(e,s),t,n,e,u);else f(i(e,a),t,n+1,e,u)}else u.push([e,t[n-1],o])}function h(e,t){return{a:{k:e,nv:t},v:l}}function p(e){(e=o(e))&&function(e){return e&&e.constructor===Object}(e)||(e={$eq:e});var t=[];for(var n in e){var r=e[n];if("$options"!==n)if(v[n])b[n]&&(r=b[n](r,e)),t.push(c(o(r),v[n]));else{if(36===n.charCodeAt(0))throw new Error("Unknown operation "+n);t.push(h(n.split("."),p(r)))}}return 1===t.length?t[0]:c(t,v.$and)}function d(e,t){var n=p(e);return t&&(n={a:n,v:function(e,n,r,o){return a(e,t(n),r,o)}}),n}function y(e,t,r){function o(e,t,n){return a(i,e,t,n)}n(t)&&(r=t,t=void 0);var i=d(e,r);return t?t.filter(o):o}var v={$eq:u(function(e,t){return e(t)}),$ne:function(e){return function(t,n){if(!r(n)||!n.length)return e(t,n);for(var o=0,u=n.length;o<u;o++)if(!e(t,i(n,o)))return!1;return!0}}(function(e,t){return!e(t)}),$gt:u(function(e,t){return y.compare(o(t),e)>0}),$gte:u(function(e,t){return y.compare(o(t),e)>=0}),$lt:u(function(e,t){return y.compare(o(t),e)<0}),$lte:u(function(e,t){return y.compare(o(t),e)<=0}),$mod:u(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(!(t instanceof Array)){var n=o(t);if(n===t&&"object"==typeof t)for(u=e.length;u--;)if(String(e[u])===String(t)&&"[object Object]"!==String(t))return!0;if(void 0===n)for(u=e.length;u--;)if(null==e[u])return!0;for(u=e.length;u--;){var r=a(d(i(e,u),void 0),t,u,e);if(r&&"[object Object]"!==String(r)&&"[object Object]"!==String(t))return!0}return!!~e.indexOf(n)}for(var u=t.length;u--;)if(~e.indexOf(o(i(t,u))))return!0;return!1},$nin:function(e,t,n,r){return!v.$in(e,t,n,r)},$not:function(e,t,n,r){return!a(e,t,n,r)},$type:function(e,t){return void 0!=t&&(t instanceof e||t.constructor==e)},$all:function(e,t,n,r){return v.$and(e,t,n,r)},$size:function(e,t){return!!t&&e===t.length},$or:function(e,t,n,r){for(var o=0,u=e.length;o<u;o++)if(a(i(e,o),t,n,r))return!0;return!1},$nor:function(e,t,n,r){return!v.$or(e,t,n,r)},$and:function(e,t,n,r){for(var o=0,u=e.length;o<u;o++)if(!a(i(e,o),t,n,r))return!1;return!0},$regex:u(function(e,t){return"string"==typeof t&&e.test(t)}),$where:function(e,t,n,r){return e.call(t,t,n,r)},$elemMatch:function(e,t,n,o){return r(t)?!!~s(t,e):a(e,t,n,o)},$exists:function(e,t,n,r){return r.hasOwnProperty(n)===e}},b={$eq:function(e){return e instanceof RegExp?function(t){return"string"==typeof t&&e.test(t)}:e instanceof Function?e:r(e)&&!e.length?function(e){return r(e)&&!e.length}:null===e?function(e){return null==e}:function(t){return 0===y.compare(o(t),e)}},$ne:function(e){return b.$eq(e)},$and:function(e){return e.map(p)},$all:function(e){return b.$and(e)},$or:function(e){return e.map(p)},$nor:function(e){return e.map(p)},$not:function(e){return p(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return"string"==typeof e?new Function("obj","return "+e):e},$elemMatch:function(e){return p(e)},$exists:function(e){return!!e}};y.use=function(e){if(n(e))return e(y);for(var t in e)36===t.charCodeAt(0)&&(v[t]=e[t])},y.indexOf=function(e,t,n){return s(t,d(e,n))},y.compare=function(e,t){if(e===t)return 0;if(typeof e==typeof t){if(e>t)return 1;if(e<t)return-1}},void 0!==e&&void 0!==e.exports&&(Object.defineProperty(t,"__esModule",{value:!0}),e.exports=y,t.default=e.exports.default=y),"undefined"!=typeof window&&(window.sift=y)}()},function(e,t,n){var r=n(256),o=n(18);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t,n){var r=n(257)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),u=r(t),a=u.length;a--;){var s=u[e?a:++o];if(!1===n(i[s],s,i))break}return t}}},function(e,t,n){var r=n(14);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,u=t?i:-1,a=Object(n);(t?u--:++u<i)&&!1!==o(a[u],u,a););return n}}},function(e,t,n){var r=n(34);e.exports=function(e){return"function"==typeof e?e:r}},function(e,t,n){var r=n(261),o=n(268),i=n(113);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(64),o=n(108),i=1,u=2;e.exports=function(e,t,n,a){var s=n.length,c=s,l=!a;if(null==e)return!c;for(e=Object(e);s--;){var f=n[s];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++s<c;){var h=(f=n[s])[0],p=e[h],d=f[1];if(l&&f[2]){if(void 0===p&&!(h in e))return!1}else{var y=new r;if(a)var v=a(p,d,h,e,t,y);if(!(void 0===v?o(d,p,i|u,a,y):v))return!1}}return!0}},function(e,t,n){var r=n(64),o=n(109),i=n(266),u=n(267),a=n(60),s=n(3),c=n(37),l=n(58),f=1,h="[object Arguments]",p="[object Array]",d="[object Object]",y=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,b,g){var m=s(e),_=s(t),w=m?p:a(e),O=_?p:a(t),E=(w=w==h?d:w)==d,k=(O=O==h?d:O)==d,P=w==O;if(P&&c(e)){if(!c(t))return!1;m=!0,E=!1}if(P&&!E)return g||(g=new r),m||l(e)?o(e,t,n,v,b,g):i(e,t,w,n,v,b,g);if(!(n&f)){var j=E&&y.call(e,"__wrapped__"),S=k&&y.call(t,"__wrapped__");if(j||S){var x=j?e.value():e,T=S?t.value():t;return g||(g=new r),b(x,T,n,v,g)}}return!!P&&(g||(g=new r),u(e,t,n,v,b,g))}},function(e,t){var n="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,n),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t,n){var r=n(23),o=n(105),i=n(26),u=n(109),a=n(106),s=n(107),c=1,l=2,f="[object Boolean]",h="[object Date]",p="[object Error]",d="[object Map]",y="[object Number]",v="[object RegExp]",b="[object Set]",g="[object String]",m="[object Symbol]",_="[object ArrayBuffer]",w="[object DataView]",O=r?r.prototype:void 0,E=O?O.valueOf:void 0;e.exports=function(e,t,n,r,O,k,P){switch(n){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!k(new o(e),new o(t)));case f:case h:case y:return i(+e,+t);case p:return e.name==t.name&&e.message==t.message;case v:case g:return e==t+"";case d:var j=a;case b:var S=r&c;if(j||(j=s),e.size!=t.size&&!S)return!1;var x=P.get(e);if(x)return x==t;r|=l,P.set(e,t);var T=u(j(e),j(t),r,O,k,P);return P.delete(e),T;case m:if(E)return E.call(e)==E.call(t)}return!1}},function(e,t,n){var r=n(103),o=1,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,u,a,s){var c=n&o,l=r(e),f=l.length;if(f!=r(t).length&&!c)return!1;for(var h=f;h--;){var p=l[h];if(!(c?p in t:i.call(t,p)))return!1}var d=s.get(e);if(d&&s.get(t))return d==t;var y=!0;s.set(e,t),s.set(t,e);for(var v=c;++h<f;){var b=e[p=l[h]],g=t[p];if(u)var m=c?u(g,b,p,t,e,s):u(b,g,p,e,t,s);if(!(void 0===m?b===g||a(b,g,n,u,s):m)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w)&&(y=!1)}return s.delete(e),s.delete(t),y}},function(e,t,n){var r=n(112),o=n(18);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],u=e[i];t[n]=[i,u,r(u)]}return t}},function(e,t,n){var r=n(108),o=n(270),i=n(276),u=n(73),a=n(112),s=n(113),c=n(25),l=1,f=2;e.exports=function(e,t){return u(e)&&a(t)?s(c(e),t):function(n){var u=o(n,e);return void 0===u&&u===t?i(n,e):r(t,u,l|f)}}},function(e,t,n){var r=n(72);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},function(e,t,n){var r=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,u=n(272)(function(e){var t=[];return r.test(e)&&t.push(""),e.replace(o,function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)}),t});e.exports=u},function(e,t,n){var r=n(273),o=500;e.exports=function(e){var t=r(e,function(e){return n.size===o&&n.clear(),e}),n=t.cache;return t}},function(e,t,n){function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=e.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(r.Cache||o),n}var o=n(65),i="Expected a function";r.Cache=o,e.exports=r},function(e,t,n){var r=n(275);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){function r(e){if("string"==typeof e)return e;if(u(e))return i(e,r)+"";if(a(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}var o=n(23),i=n(49),u=n(3),a=n(48),s=1/0,c=o?o.prototype:void 0,l=c?c.toString:void 0;e.exports=r},function(e,t,n){var r=n(277),o=n(278);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(47),o=n(36),i=n(3),u=n(35),a=n(57),s=n(25);e.exports=function(e,t,n){for(var c=-1,l=(t=r(t,e)).length,f=!1;++c<l;){var h=s(t[c]);if(!(f=null!=e&&n(e,h)))break;e=e[h]}return f||++c!=l?f:!!(l=null==e?0:e.length)&&a(l)&&u(h,l)&&(i(e)||o(e))}},function(e,t,n){var r=n(280),o=n(281),i=n(73),u=n(25);e.exports=function(e){return i(e)?r(u(e)):o(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(72);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t){e.exports=function(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}},function(e,t,n){var r=n(49);e.exports=function(e,t){return r(t,function(t){return e[t]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheMiddleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(38)),i=n(2),u=n(31),a=n(115);t.CacheMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Middleware),r(t,[{key:"loadStorage",value:function(e){return new a.Storage(e)}},{key:"handle",value:function(e){var t=e.method,n=e.body,r=e.appKey,u=e.collection,a=e.entityId,s=e.encryptionKey,c=this.loadStorage(r,s),l=void 0;return"GET"===t?l=(0,i.isDefined)(a)?c.findById(u,a):c.find(u):"POST"===t||"PUT"===t?l="_group"===a?c.find(u):c.save(u,n):"DELETE"===t&&(l=!1===(0,i.isDefined)(u)?c.clear():c.removeById(u,a)),l.then(function(e){var n={statusCode:"POST"===t?201:200,data:e};return"POST"===t&&"_group"===a&&(n.statusCode=200),(!1===(0,i.isDefined)(e)||(0,o.default)(e))&&(n.statusCode=204),n}).catch(function(e){return{statusCode:e.code}}).then(function(e){return{response:e}})}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=[],i=String.fromCharCode(9500),u=String.fromCharCode(9472),a=String.fromCharCode(9492),s=String.fromCharCode(9474);t.AsciiTree=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function(e,t){if(0===e.level)return e.value;for(var n="\r\n",r=t?a:i,c=1;c<e.level;c+=1)n=""+n+(o[c]?" ":s),n+="  ";return""+n+r+u+" "+e.value}(t,arguments[1]);if(t.nodes.length>0){var r=t.nodes.length-1;t.nodes.forEach(function(t,i){o[t.level]=i===r,n+=e.generate(t,i===r)})}return n}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4));t.Queue=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pendingPromises=0,this.maxPendingPromises=void 0!==t?t:1/0,this.maxQueuedPromises=void 0!==n?n:1/0,this.queue=[]}return r(e,[{key:"add",value:function(e){var t=this;return new o.default(function(n,r,o){t.queue.length>=t.maxQueuedPromises?r(new Error("Queue limit reached")):(t.queue.push({promiseGenerator:e,resolve:n,reject:r,notify:o||function(){}}),t._dequeue())})}},{key:"getPendingLength",value:function(){return this.pendingPromises}},{key:"getQueueLength",value:function(){return this.queue.length}},{key:"_dequeue",value:function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var t=this.queue.shift();if(!t)return!1;try{this.pendingPromises+=1,function(e){return e&&"function"==typeof e.then?e:o.default.resolve(e)}(t.promiseGenerator()).then(function(n){e.pendingPromises-=1,t.resolve(n),e._dequeue()},function(n){e.pendingPromises-=1,t.reject(n),e._dequeue()},function(e){t.notify(e)})}catch(e){this.pendingPromises-=1,t.reject(e),this._dequeue()}return!0}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryAdapter=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(97)),a=r(n(75)),s=r(n(44)),c=r(n(74)),l=r(n(291)),f=r(n(6)),h=r(n(3)),p=n(2),d=n(1),y={},v=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(0,p.isDefined)(t))throw new Error("A name for the collection is required to use the memory persistence adapter.",t);if(!(0,f.default)(t))throw new Error("The name of the collection must be a string to use the memory persistence adapter",t);this.name=t,this.cache=y[t],(0,p.isDefined)(this.cache)||(this.cache=new u.default,y[t]=this.cache)}return o(e,[{key:"find",value:function(e){try{var t=this.cache.get(e);return t?i.default.resolve(JSON.parse(t)):i.default.resolve([])}catch(e){return i.default.reject(e)}}},{key:"findById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(0,l.default)(r,function(e){return e._id===t});return o||i.default.reject(new d.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database."))})}},{key:"save",value:function(e,t){var n=this,r=!1;return(0,h.default)(t)||(t=[t],r=!0),0===t.length?i.default.resolve(t):this.find(e).then(function(o){o=(0,a.default)(o,"_id"),t=(0,a.default)(t,"_id");var i=Object.keys(t);return(0,s.default)(i,function(e){o[e]=t[e]}),n.cache.set(e,JSON.stringify((0,c.default)(o))),t=(0,c.default)(t),r?t[0]:t})}},{key:"removeById",value:function(e,t){var n=this;return this.find(e).then(function(r){var o=(r=(0,a.default)(r,"_id"))[t];return(0,p.isDefined)(o)?(delete r[t],n.cache.set(e,JSON.stringify((0,c.default)(r))),{count:1}):i.default.reject(new d.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" memory database."))})}},{key:"clear",value:function(){return this.cache.clear(),i.default.resolve(null)}}]),e}();t.MemoryAdapter={load:function(e){return i.default.resolve(new v(e))}}},function(e,t,n){var r=n(289),o=n(290),i=n(20),u=n(3);e.exports=function(e,t){return function(n,a){var s=u(n)?r:o,c=t?t():{};return s(n,e,i(a,2),c)}}},function(e,t){e.exports=function(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var u=e[o];t(r,u,n(u),e)}return r}},function(e,t,n){var r=n(29);e.exports=function(e,t,n,o){return r(e,function(e,r,i){t(o,e,n(e),i)}),o}},function(e,t,n){var r=n(292)(n(293));e.exports=r},function(e,t,n){var r=n(20),o=n(14),i=n(18);e.exports=function(e){return function(t,n,u){var a=Object(t);if(!o(t)){var s=r(n,3);t=i(t),n=function(e){return s(a[e],e,a)}}var c=e(t,n,u);return c>-1?a[s?t[c]:c]:void 0}}},function(e,t,n){var r=n(116),o=n(20),i=n(294),u=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var s=null==n?0:i(n);return s<0&&(s=u(a+s,0)),r(e,o(t,3),s)}},function(e,t,n){var r=n(295);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(296),o=1/0,i=1.7976931348623157e308;e.exports=function(e){if(!e)return 0===e?e:0;if((e=r(e))===o||e===-o)return(e<0?-1:1)*i;return e==e?e:0}},function(e,t,n){var r=n(12),o=n(48),i=NaN,u=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return i;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):a.test(e)?i:+e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMiddleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(1),u=n(31);t.HttpMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Http Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Middleware),r(t,[{key:"handle",value:function(){return o.default.reject(new i.KinveyError("Unable to send network request.","Please override the core HttpMiddleware."))}},{key:"cancel",value:function(){return o.default.resolve()}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseMiddleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(2),u=n(31);t.ParseMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Parse Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Middleware),r(t,[{key:"handle",value:function(e,t){if((0,i.isDefined)(t)&&(0,i.isDefined)(t.data)){var n=t.headers["content-type"]||t.headers["Content-Type"];if(n&&0===n.indexOf("application/json"))try{t.data=JSON.parse(t.data)}catch(e){}}return o.default.resolve({response:t})}}]),t}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeMiddleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(2),u=n(31);t.SerializeMiddleware=function(t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Serialize Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,u.Middleware),r(n,[{key:"handle",value:function(t){if((0,i.isDefined)(t)&&(0,i.isDefined)(t.body)){var n=t.headers["content-type"]||t.headers["Content-Type"];if((0,i.isDefined)(n))if(0===n.indexOf("application/json"))t.body=JSON.stringify(t.body);else if(0===n.indexOf("application/x-www-form-urlencoded")){var r=t.body,u=[];Object.keys(r).forEach(function(t){u.push(e.encodeURIComponent(t)+"="+e.encodeURIComponent(r[t]))}),t.body=u.join("&")}}return o.default.resolve({request:t})}}]),n}()}).call(t,n(9))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFetchRequest=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(75)),a=r(n(71)),s=r(n(117)),c=r(n(74)),l=r(n(44)),f=r(n(3)),h=r(n(6)),p=n(1),d=n(2),y=n(10),v=n(45),b=n(118),g=n(98),m=n(30);t.DeltaFetchRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.tag=e.tag,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.KinveyRequest),o(t,[{key:"execute",value:function(){var e=this;return new g.CacheRequest({method:v.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client,tag:this.tag}).execute().then(function(e){return e.data}).catch(function(e){if(!(e instanceof p.NotFoundError))throw e;return[]}).then(function(t){if((0,f.default)(t)&&t.length>0){var n=(0,u.default)(t,"_id"),r=new y.Query((0,s.default)(e.query,"toJSON",e.query));r.fields=["_id","_kmd.lmt"];return new b.KinveyRequest({method:v.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:r,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute().then(function(e){return e.data}).then(function(t){var r=(0,u.default)(t,"_id"),o=r,a=Object.keys(n);(0,l.default)(a,function(e){var t=n[e],i=r[e];i&&(0,d.isDefined)(i._kmd)&&(0,d.isDefined)(t._kmd)&&i._kmd.lmt===t._kmd.lmt?delete o[e]:delete n[e]});for(var c=Object.keys(o),f=[],h=0;h<c.length;){var p=new y.Query((0,s.default)(e.query,"toJSON",e.query)),g=c.slice(h,c.length>200+h?200:c.length);p.contains("_id",g);var m=new b.KinveyRequest({method:v.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:p,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute();f.push(m),h+=200}return i.default.all(f)}).then(function(t){var r=(0,a.default)(t,function(e,t){if(t.isSuccess()){var n=e.headers;n.addAll(t.headers),e.headers=n,e.data=e.data.concat(t.data)}return e},new m.Response({statusCode:m.StatusCode.Ok,data:[]}));if(r.data=r.data.concat((0,c.default)(n)),e.query){var o=new y.Query((0,s.default)(e.query,"toJSON",e.query));o.skip=0,o.limit=0,r.data=o.process(r.data)}return r})}return new b.KinveyRequest({method:v.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:e.query,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute()})}},{key:"method",get:function(){return function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",this)},set:function(e){switch((0,h.default)(e)||(e=String(e)),e=e.toUpperCase()){case v.RequestMethod.GET:!function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var u=Object.getPrototypeOf(t);null!==u&&e(u,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var a=i.set;void 0!==a&&a.call(o,r)}return r}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",e,this);break;case v.RequestMethod.POST:case v.RequestMethod.PATCH:case v.RequestMethod.PUT:case v.RequestMethod.DELETE:default:throw new p.KinveyError("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]),t}()},function(e,t,n){"use strict";(function(e){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=i.prototype:(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return s(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);i.TYPED_ARRAY_SUPPORT?(e=t).__proto__=i.prototype:e=c(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),u=(e=o(e,r)).write(t,n);u!==r&&(e=e.slice(0,u));return e}(e,t,n):function(e,t){if(i.isBuffer(t)){var n=0|l(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?o(e,0):c(e,t);if("Buffer"===t.type&&q(t.data))return c(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function s(e,t){if(a(t),e=o(e,t<0?0:0|l(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t){var n=t.length<0?0:0|l(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function l(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function f(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return A(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return M(e).length;default:if(r)return A(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0);(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[i]);return o}(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}(this,t,n);case"base64":return function(e,t,n){return 0===t&&n===e.length?R.fromByteArray(e):R.fromByteArray(e.slice(t,n))}(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,o){function i(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}var u=1,a=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;u=2,a/=2,s/=2,n/=2}var c;if(o){var l=-1;for(c=n;c<a;c++)if(i(e,c)===i(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*u}else-1!==l&&(c-=c-l),l=-1}else for(n+s>a&&(n=a-s),c=n;c>=0;c--){for(var f=!0,h=0;h<s;h++)if(i(e,c+h)!==i(t,h)){f=!1;break}if(f)return c}return-1}function v(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var u=0;u<r;++u){var a=parseInt(t.substr(2*u,2),16);if(isNaN(a))return u;e[n+u]=a}return u}function b(e,t,n,r){return C(A(t,e.length-n),e,n,r)}function g(e,t,n,r){return C(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return g(e,t,n,r)}function _(e,t,n,r){return C(M(t),e,n,r)}function w(e,t,n,r){return C(function(e,t){for(var n,r,o,i=[],u=0;u<e.length&&!((t-=2)<0);++u)n=e.charCodeAt(u),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],u=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=n){var s,c,l,f;switch(a){case 1:i<128&&(u=i);break;case 2:128==(192&(s=e[o+1]))&&(f=(31&i)<<6|63&s)>127&&(u=f);break;case 3:s=e[o+1],c=e[o+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(u=f);break;case 4:s=e[o+1],c=e[o+2],l=e[o+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(u=f)}}null===u?(u=65533,a=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=a}return function(e){var t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}(r)}function E(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,o,u){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<u)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function S(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function x(e,t,n,r,o){return o||S(e,0,n,4),I.write(e,t,n,r,23,4),n+4}function T(e,t,n,r,o){return o||S(e,0,n,8),I.write(e,t,n,r,52,8),n+8}function A(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],u=0;u<r;++u){if((n=e.charCodeAt(u))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(u+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function M(e){return R.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function C(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}var R=n(302),I=n(303),q=n(304);t.Buffer=i,t.SlowBuffer=function(e){return+e!=e&&(e=0),i.alloc(+e)},t.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return u(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return function(e,t,n,r){return a(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}(null,e,t,n)},i.allocUnsafe=function(e){return s(null,e)},i.allocUnsafeSlow=function(e){return s(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,u=Math.min(n,r);o<u;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var u=e[n];if(!i.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(r,o),o+=u.length}return r},i.byteLength=f,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):h.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var u=o-r,a=n-t,s=Math.min(u,a),c=this.slice(r,o),l=e.slice(t,n),f=0;f<s;++f)if(c[f]!==l[f]){u=c[f],a=l[f];break}return u<a?-1:a<u?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return d(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return d(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return g(this,e,t,n);case"latin1":case"binary":return m(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=i.prototype;else{var o=t-e;r=new i(o,void 0);for(var u=0;u<o;++u)r[u]=this[u+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},i.prototype.readUInt8=function(e,t){return t||E(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||E(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||E(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||E(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||E(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||E(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||E(e,4,this.length),I.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||E(e,4,this.length),I.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||E(e,8,this.length),I.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||E(e,8,this.length),I.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){k(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){k(this,e,t,n,Math.pow(2,8*n)-1,0)}var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);k(this,e,t,n,o-1,-o)}var i=0,u=1,a=0;for(this[t]=255&e;++i<n&&(u*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);k(this,e,t,n,o-1,-o)}var i=n-1,u=1,a=0;for(this[t+i]=255&e;--i>=0&&(u*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/u>>0)-a&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return x(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return x(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return T(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return T(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,u=r-n;if(this===e&&n<t&&t<r)for(o=u-1;o>=0;--o)e[o+t]=this[o+n];else if(u<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<u;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+u),t);return u},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var u;if("number"==typeof e)for(u=t;u<n;++u)this[u]=e;else{var a=i.isBuffer(e)?e:A(new i(e,r).toString()),s=a.length;for(u=0;u<n-t;++u)this[u+t]=a[u%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g}).call(t,n(9))},function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function i(e,t,n){for(var r,i=[],u=t;u<n;u+=3)r=(e[u]<<16)+(e[u+1]<<8)+e[u+2],i.push(o(r));return i.join("")}t.byteLength=function(e){return 3*e.length/4-r(e)},t.toByteArray=function(e){var t,n,o,i,u,c=e.length;i=r(e),u=new s(3*c/4-i),n=i>0?c-4:c;var l=0;for(t=0;t<n;t+=4)o=a[e.charCodeAt(t)]<<18|a[e.charCodeAt(t+1)]<<12|a[e.charCodeAt(t+2)]<<6|a[e.charCodeAt(t+3)],u[l++]=o>>16&255,u[l++]=o>>8&255,u[l++]=255&o;return 2===i?(o=a[e.charCodeAt(t)]<<2|a[e.charCodeAt(t+1)]>>4,u[l++]=255&o):1===i&&(o=a[e.charCodeAt(t)]<<10|a[e.charCodeAt(t+1)]<<4|a[e.charCodeAt(t+2)]>>2,u[l++]=o>>8&255,u[l++]=255&o),u},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",a=[],s=0,c=n-r;s<c;s+=16383)a.push(i(e,s,s+16383>c?c:s+16383));return 1===r?(t=e[n-1],o+=u[t>>2],o+=u[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=u[t>>10],o+=u[t>>4&63],o+=u[t<<2&63],o+="="),a.push(o),a.join("")};for(var u=[],a=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)u[l]=c[l],a[c.charCodeAt(l)]=l;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,u,a=8*o-r-1,s=(1<<a)-1,c=s>>1,l=-7,f=n?o-1:0,h=n?-1:1,p=e[t+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=a;l>0;i=256*i+e[t+f],f+=h,l-=8);for(u=i&(1<<-l)-1,i>>=-l,l+=r;l>0;u=256*u+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===s)return u?NaN:1/0*(p?-1:1);u+=Math.pow(2,r),i-=c}return(p?-1:1)*u*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var u,a,s,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=l):(u=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-u))<1&&(u--,s*=2),(t+=u+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(u++,s/=2),u+f>=l?(a=0,u=l):u+f>=1?(a=(t*s-1)*Math.pow(2,o),u+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),u=0));o>=8;e[n+p]=255&a,p+=d,a/=256,o-=8);for(u=u<<o|a,c+=o;c>0;e[n+p]=255&u,p+=d,u/=256,c-=8);e[n+p-d]|=128*y}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(91),o=n(306),i=n(56),u=n(307),a=i(function(e){return e.push(void 0,u),r(o,void 0,e)});e.exports=a},function(e,t,n){var r=n(22),o=n(55),i=n(43),u=o(function(e,t,n,o){r(t,i(t),e,o)});e.exports=u},function(e,t,n){var r=n(26),o=Object.prototype,i=o.hasOwnProperty;e.exports=function(e,t,n,u){return void 0===e||r(e,o[n])&&!i.call(u,n)?t:e}},function(e,t,n){var r=n(309),o=n(315),i=n(20),u=n(56),a=n(317),s=n(119),c=u(function(e,t){var n=s(t);return a(n)&&(n=void 0),a(e)?r(e,o(t,1,a,!0),i(n,2)):[]});e.exports=c},function(e,t,n){var r=n(110),o=n(310),i=n(314),u=n(49),a=n(94),s=n(111),c=200;e.exports=function(e,t,n,l){var f=-1,h=o,p=!0,d=e.length,y=[],v=t.length;if(!d)return y;n&&(t=u(t,a(n))),l?(h=i,p=!1):t.length>=c&&(h=s,p=!1,t=new r(t));e:for(;++f<d;){var b=e[f],g=null==n?b:n(b);if(b=l||0!==b?b:0,p&&g==g){for(var m=v;m--;)if(t[m]===g)continue e;y.push(b)}else h(t,g,l)||y.push(b)}return y}},function(e,t,n){var r=n(311);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(116),o=n(312),i=n(313);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,o,n)}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},function(e,t){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},function(e,t,n){function r(e,t,n,u,a){var s=-1,c=e.length;for(n||(n=i),a||(a=[]);++s<c;){var l=e[s];t>0&&n(l)?t>1?r(l,t-1,n,u,a):o(a,l):u||(a[a.length]=l)}return a}var o=n(67),i=n(316);e.exports=r},function(e,t,n){var r=n(23),o=n(36),i=n(3),u=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(u&&e&&e[u])}},function(e,t,n){var r=n(14),o=n(15);e.exports=function(e){return o(e)&&r(e)}},function(e,t,n){var r=n(20),o=n(319);e.exports=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,u=[],a=e.length;for(t=r(t,3);++i<a;){var s=e[i];t(s,i,e)&&(n.push(s),u.push(i))}return o(e,u),n}},function(e,t,n){var r=n(320),o=n(35),i=Array.prototype.splice;e.exports=function(e,t){for(var n=e?t.length:0,u=n-1;n--;){var a=t[n];if(n==u||a!==s){var s=a;o(a)?i.call(e,a,1):r(e,a)}}return e}},function(e,t,n){var r=n(47),o=n(119),i=n(321),u=n(25);e.exports=function(e,t){return t=r(t,e),null==(e=i(e,t))||delete e[u(o(t))]}},function(e,t,n){var r=n(72),o=n(322);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},function(e,t){e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}},function(e,t,n){var r=n(29),o=n(14);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,function(e,r,o){i[++n]=t(e,r,o)}),i}},function(e,t,n){"use strict";var r=n(79),o=n(325),i=n(331),u=n(332),a=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=o.toSubscriber(e,t,n);if(r?r.call(i,this.source):i.add(this.source?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var n=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var o;o=n.subscribe(function(t){if(o)try{e(t)}catch(e){r(e),o.unsubscribe()}else e(t)},r,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[i.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 0===e.length?this:u.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();t.Observable=a},function(e,t,n){"use strict";var r=n(120),o=n(80),i=n(123);t.toSubscriber=function(e,t,n){if(e){if(e instanceof r.Subscriber)return e;if(e[o.rxSubscriber])return e[o.rxSubscriber]()}return e||t||n?new r.Subscriber(e,t,n):new r.Subscriber(i.empty)}},function(e,t,n){"use strict";function r(e){return e.reduce(function(e,t){return e.concat(t instanceof c.UnsubscriptionError?t.errors:t)},[])}var o=n(327),i=n(328),u=n(121),a=n(329),s=n(122),c=n(330),l=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var n=this._parent,l=this._parents,f=this._unsubscribe,h=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,d=l?l.length:0;n;)n.remove(this),n=++p<d&&l[p]||null;if(u.isFunction(f)){a.tryCatch(f).call(this)===s.errorObject&&(t=!0,e=e||(s.errorObject.e instanceof c.UnsubscriptionError?r(s.errorObject.e.errors):[s.errorObject.e]))}if(o.isArray(h))for(p=-1,d=h.length;++p<d;){var y=h[p];if(i.isObject(y)){if(a.tryCatch(y.unsubscribe).call(y)===s.errorObject){t=!0,e=e||[];var v=s.errorObject.e;v instanceof c.UnsubscriptionError?e=e.concat(r(v.errors)):e.push(v)}}}if(t)throw new c.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.prototype._addParent=function(e){var t=this._parent,n=this._parents;t&&t!==e?n?-1===n.indexOf(e)&&n.push(e):this._parents=[e]:this._parent=e},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();t.Subscription=l},function(e,t,n){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t,n){"use strict";t.isObject=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";function r(){try{return o.apply(this,arguments)}catch(e){return i.errorObject.e=e,i.errorObject}}var o,i=n(122);t.tryCatch=function(e){return o=e,r}},function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=function(e){function t(t){e.call(this),this.errors=t;var n=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return r(t,e),t}(Error);t.UnsubscriptionError=o},function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}var o=n(79);t.getSymbolObservable=r,t.observable=r(o.root),t.$$observable=t.observable},function(e,t,n){"use strict";function r(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:o.noop}var o=n(333);t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r(e)},t.pipeFromArray=r},function(e,t,n){"use strict";t.noop=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(335);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveCollectionManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getLiveCollectionManager=function(e){return c||(c=new s(e)),c};var o=n(8),i=n(1),u=n(5),a=n(51),s=t.LiveCollectionManager=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._client=t||o.Client.sharedInstance()}return r(e,[{key:"subscribeCollection",value:function(e,t){var n=this;return(0,a.isValidChannelName)(e)?(0,a.isValidReceiver)(t)?this._makeSubscriptionRequest(e,"_subscribe").then(function(){var r=n._buildChannelName(e),o=n._buildPersonalChannelName(e),i=(0,a.getLiveService)();i.subscribeToChannel(r,t),i.subscribeToChannel(o,t)}):Promise.reject(new i.KinveyError("Invalid or missing receiver")):Promise.reject(new i.KinveyError("Invalid or missing collection name"))}},{key:"unsubscribeCollection",value:function(e){var t=this;return(0,a.isValidChannelName)(e)?this._makeSubscriptionRequest(e,"_unsubscribe").then(function(){var n=t._buildChannelName(e),r=t._buildPersonalChannelName(e),o=(0,a.getLiveService)();o.unsubscribeFromChannel(n),o.unsubscribeFromChannel(r)}):Promise.reject(new i.KinveyError("Invalid or missing collection name"))}},{key:"_buildChannelName",value:function(e){return this._client.appKey+".c-"+e}},{key:"_buildPersonalChannelName",value:function(e){return this._buildChannelName(e)+".u-"+this._client.getActiveUser()._id}},{key:"_makeSubscriptionRequest",value:function(e,t){return u.KinveyRequest.executeShort({method:u.RequestMethod.POST,pathname:"/appdata/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}})}}]),e}(),c=void 0},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1)),u=r(n(39)),a=r(n(40)),s=n(41),c=(n(5),function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.listenToBrowserNetworkEvents,r=void 0===n||n;e.db=a.default,e.sdkFamily="Web",e.networking=new u.default({del:s.del,get:s.get,post:s.post,sendBeacon:o});var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r&&(window.addEventListener("offline",function(){i.networkDownDetected()}),window.addEventListener("online",function(){i.networkUpDetected()})),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}());t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=o(n(2)),a=o(n(6)),s=o(n(8)),c=o(n(9)),l=o(n(16)),f=r(n(17)),h=r(n(18)),p=r(n(19)),d=r(n(20)),y=r(n(21)),v=r(n(22)),b=r(n(23)),g=r(n(24)),m=r(n(25)),_=r(n(26)),w=r(n(27)),O=r(n(28)),E=r(n(29)),k=r(n(30)),P=r(n(31)),j=r(n(32)),S=r(n(33)),x=r(n(34)),T=r(n(35)),A=r(n(36)),M=r(n(37)),C=r(n(12)),R=r(n(38)),I=o(n(13)),q=o(n(10)),D=o((n(5),n(3))),N=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t.db,o=t.networking,i=this._config=new u.default({setup:t,db:r}),I=new a.default({config:i});o.init(i);var q={config:i,networking:o,crypto:I},D=l.default.bind(this,q,C),N=l.default.bind(this,q,_),U=l.default.bind(this,q,O),K=l.default.bind(this,q,k),L=l.default.bind(this,q,R),B=this._listenerManager=new c.default,F=new s.default({timeEndpoint:D,leaveEndpoint:N,heartbeatEndpoint:U,setStateEndpoint:K,subscribeEndpoint:L,crypto:q.crypto,config:q.config,listenerManager:B});this.addListener=B.addListener.bind(B),this.removeListener=B.removeListener.bind(B),this.removeAllListeners=B.removeAllListeners.bind(B),this.channelGroups={listGroups:l.default.bind(this,q,d),listChannels:l.default.bind(this,q,y),addChannels:l.default.bind(this,q,f),removeChannels:l.default.bind(this,q,h),deleteGroup:l.default.bind(this,q,p)},this.push={addChannels:l.default.bind(this,q,v),removeChannels:l.default.bind(this,q,b),deleteDevice:l.default.bind(this,q,m),listChannels:l.default.bind(this,q,g)},this.hereNow=l.default.bind(this,q,P),this.whereNow=l.default.bind(this,q,w),this.getState=l.default.bind(this,q,E),this.setState=F.adaptStateChange.bind(F),this.grant=l.default.bind(this,q,S),this.audit=l.default.bind(this,q,j),this.publish=l.default.bind(this,q,x),this.fire=function(e,t){return e.replicate=!1,e.storeInHistory=!1,n.publish(e,t)},this.history=l.default.bind(this,q,T),this.deleteMessages=l.default.bind(this,q,A),this.fetchMessages=l.default.bind(this,q,M),this.time=D,this.subscribe=F.adaptSubscribeChange.bind(F),this.unsubscribe=F.adaptUnsubscribeChange.bind(F),this.disconnect=F.disconnect.bind(F),this.reconnect=F.reconnect.bind(F),this.destroy=function(e){F.unsubscribeAll(e),F.disconnect()},this.stop=this.destroy,this.unsubscribeAll=F.unsubscribeAll.bind(F),this.getSubscribedChannels=F.getSubscribedChannels.bind(F),this.getSubscribedChannelGroups=F.getSubscribedChannelGroups.bind(F),this.encrypt=I.encrypt.bind(I),this.decrypt=I.decrypt.bind(I),this.getAuthKey=q.config.getAuthKey.bind(q.config),this.setAuthKey=q.config.setAuthKey.bind(q.config),this.setCipherKey=q.config.setCipherKey.bind(q.config),this.getUUID=q.config.getUUID.bind(q.config),this.setUUID=q.config.setUUID.bind(q.config),this.getFilterExpression=q.config.getFilterExpression.bind(q.config),this.setFilterExpression=q.config.setFilterExpression.bind(q.config),this.setHeartbeatInterval=q.config.setHeartbeatInterval.bind(q.config)}return i(e,[{key:"getVersion",value:function(){return this._config.getVersion()}},{key:"networkDownDetected",value:function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)}},{key:"networkUpDetected",value:function(){this._listenerManager.announceNetworkUp(),this.reconnect()}}],[{key:"generateUUID",value:function(){return D.default.createUUID()}}]),e}();N.OPERATIONS=I.default,N.CATEGORIES=q.default,t.default=N,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(3)),i=(n(5),function(){function e(t){var n=t.setup,r=t.db;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._db=r,this.instanceId="pn-"+o.default.createUUID(),this.secretKey=n.secretKey||n.secret_key,this.subscribeKey=n.subscribeKey||n.subscribe_key,this.publishKey=n.publishKey||n.publish_key,this.sdkName=n.sdkName,this.sdkFamily=n.sdkFamily,this.partnerId=n.partnerId,this.setAuthKey(n.authKey),this.setCipherKey(n.cipherKey),this.setFilterExpression(n.filterExpression),this.origin=n.origin||"pubsub.pndsn.com",this.secure=n.ssl||!1,this.restore=n.restore||!1,this.proxy=n.proxy,this.keepAlive=n.keepAlive,this.keepAliveSettings=n.keepAliveSettings,this.autoNetworkDetection=n.autoNetworkDetection||!1,this.dedupeOnSubscribe=n.dedupeOnSubscribe||!1,this.maximumCacheSize=n.maximumCacheSize||100,this.customEncrypt=n.customEncrypt,this.customDecrypt=n.customDecrypt,"undefined"!=typeof location&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=n.logVerbosity||!1,this.suppressLeaveEvents=n.suppressLeaveEvents||!1,this.announceFailedHeartbeats=n.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=n.announceSuccessfulHeartbeats||!1,this.useInstanceId=n.useInstanceId||!1,this.useRequestId=n.useRequestId||!1,this.requestMessageCountThreshold=n.requestMessageCountThreshold,this.setTransactionTimeout(n.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(n.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(n.useSendBeacon||!0),this.setPresenceTimeout(n.presenceTimeout||300),null!=n.heartbeatInterval&&this.setHeartbeatInterval(n.heartbeatInterval),this.setUUID(this._decideUUID(n.uuid))}return r(e,[{key:"getAuthKey",value:function(){return this.authKey}},{key:"setAuthKey",value:function(e){return this.authKey=e,this}},{key:"setCipherKey",value:function(e){return this.cipherKey=e,this}},{key:"getUUID",value:function(){return this.UUID}},{key:"setUUID",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+"uuid",e),this.UUID=e,this}},{key:"getFilterExpression",value:function(){return this.filterExpression}},{key:"setFilterExpression",value:function(e){return this.filterExpression=e,this}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"getSubscribeTimeout",value:function(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:"getTransactionTimeout",value:function(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:"isSendBeaconEnabled",value:function(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function(e){return this._useSendBeacon=e,this}},{key:"getVersion",value:function(){return"4.19.0"}},{key:"_decideUUID",value:function(e){return e||(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")?this._db.get(this.subscribeKey+"uuid"):"pn-"+o.default.createUUID())}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(4));t.default={createUUID:function(){return r.default.uuid?r.default.uuid():(0,r.default)()}},e.exports=t.default},function(e,t,n){var r,o,i;o=[t],void 0!==(i="function"==typeof(r=function(e){function t(){var e,t,n="";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+="-"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function n(e,t){var n=r[t||"all"];return n&&n.test(e)||!1}var r={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};t.isUUID=n,t.VERSION="0.1.0",e.uuid=t,e.isUUID=n})?r.apply(t,o):r)&&(e.exports=i)},function(e,t){"use strict";e.exports={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r((r(n(2)),n(7))),u=function(){function e(t){var n=t.config;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._config=n,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return o(e,[{key:"HMACSHA256",value:function(e){return i.default.HmacSHA256(e,this._config.secretKey).toString(i.default.enc.Base64)}},{key:"SHA256",value:function(e){return i.default.SHA256(e).toString(i.default.enc.Hex)}},{key:"_parseOptions",value:function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t}},{key:"_decodeKey",value:function(e,t){return"base64"===t.keyEncoding?i.default.enc.Base64.parse(e):"hex"===t.keyEncoding?i.default.enc.Hex.parse(e):e}},{key:"_getPaddedKey",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?i.default.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:"_getMode",value:function(e){return"ecb"===e.mode?i.default.mode.ECB:i.default.mode.CBC}},{key:"_getIV",value:function(e){return"cbc"===e.mode?i.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)}},{key:"decrypt",value:function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)}},{key:"pnEncrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),o=this._getMode(n),u=this._getPaddedKey(t||this._config.cipherKey,n);return i.default.AES.encrypt(e,u,{iv:r,mode:o}).ciphertext.toString(i.default.enc.Base64)||e}},{key:"pnDecrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),o=this._getMode(n),u=this._getPaddedKey(t||this._config.cipherKey,n);try{var a=i.default.enc.Base64.parse(e),s=i.default.AES.decrypt({ciphertext:a},u,{iv:r,mode:o}).toString(i.default.enc.Utf8);return JSON.parse(s)}catch(e){return null}}}]),e}();t.default=u,e.exports=t.default},function(e,t){"use strict";var n=n||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new u.init(n,t)}}),a=n.enc={},s=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var s=0;s<t;s+=i)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=o}return new u.init(s,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=n,r=(i=t.lib).WordArray,o=i.Hasher,i=t.algo,u=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var f;e:{f=c;for(var h=e.sqrt(f),p=2;p<=h;p++)if(!(f%p)){f=!1;break e}f=!0}f&&(8>l&&(u[l]=s(e.pow(c,.5))),a[l]=s(e.pow(c,1/3)),l++),c++}var d=[];i=i.SHA256=o.extend({_doReset:function(){this._hash=new r.init(u.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],u=n[3],s=n[4],c=n[5],l=n[6],f=n[7],h=0;64>h;h++){if(16>h)d[h]=0|e[t+h];else{var p=d[h-15],y=d[h-2];d[h]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+d[h-16]}p=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&l)+a[h]+d[h],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),f=l,l=c,c=s,s=u+p|0,u=i,i=o,o=r,r=p+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+u|0,n[4]=n[4]+s|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(i),t.HmacSHA256=o._createHmacHelper(i)}(Math),function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,o=4*r;n.sigBytes>o&&(n=e.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),u=this._iKey=n.clone(),a=i.words,s=u.words,c=0;c<r;c++)a[c]^=1549556828,s[c]^=909522486;i.sigBytes=u.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,u=0;4>u&&o+.75*u<n;u++)e.push(r.charAt(i>>>6*(3-u)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map;(o=r.charAt(64))&&-1!=(o=e.indexOf(o))&&(n=o);for(var o=[],i=0,u=0;u<n;u++)if(u%4){var a=r.indexOf(e.charAt(u-1))<<u%4*2,s=r.indexOf(e.charAt(u))>>>6-u%4*2;o[i>>>2]|=(a|s)<<24-i%4*8,i++}return t.create(o,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,o,i,u){return((e=e+(t&n|~t&r)+o+u)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,u){return((e=e+(t&r|n&~r)+o+u)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,u){return((e=e+(t^n^r)+o+u)<<i|e>>>32-i)+t}function i(e,t,n,r,o,i,u){return((e=e+(n^(t|~r))+o+u)<<i|e>>>32-i)+t}for(var u=n,a=(c=u.lib).WordArray,s=c.Hasher,c=u.algo,l=[],f=0;64>f;f++)l[f]=4294967296*e.abs(e.sin(f+1))|0;c=c.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,n){for(var u=0;16>u;u++){var a=e[f=n+u];e[f]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}u=this._hash.words;var s,c,f=e[n+0],h=(a=e[n+1],e[n+2]),p=e[n+3],d=e[n+4],y=e[n+5],v=e[n+6],b=e[n+7],g=e[n+8],m=e[n+9],_=e[n+10],w=e[n+11],O=e[n+12],E=e[n+13],k=e[n+14],P=e[n+15],j=u[0],S=i(S=i(S=i(S=i(S=o(S=o(S=o(S=o(S=r(S=r(S=r(S=r(S=t(S=t(S=t(S=t(S=u[1],c=t(c=u[2],s=t(s=u[3],j=t(j,S,c,s,f,7,l[0]),S,c,a,12,l[1]),j,S,h,17,l[2]),s,j,p,22,l[3]),c=t(c,s=t(s,j=t(j,S,c,s,d,7,l[4]),S,c,y,12,l[5]),j,S,v,17,l[6]),s,j,b,22,l[7]),c=t(c,s=t(s,j=t(j,S,c,s,g,7,l[8]),S,c,m,12,l[9]),j,S,_,17,l[10]),s,j,w,22,l[11]),c=t(c,s=t(s,j=t(j,S,c,s,O,7,l[12]),S,c,E,12,l[13]),j,S,k,17,l[14]),s,j,P,22,l[15]),c=r(c,s=r(s,j=r(j,S,c,s,a,5,l[16]),S,c,v,9,l[17]),j,S,w,14,l[18]),s,j,f,20,l[19]),c=r(c,s=r(s,j=r(j,S,c,s,y,5,l[20]),S,c,_,9,l[21]),j,S,P,14,l[22]),s,j,d,20,l[23]),c=r(c,s=r(s,j=r(j,S,c,s,m,5,l[24]),S,c,k,9,l[25]),j,S,p,14,l[26]),s,j,g,20,l[27]),c=r(c,s=r(s,j=r(j,S,c,s,E,5,l[28]),S,c,h,9,l[29]),j,S,b,14,l[30]),s,j,O,20,l[31]),c=o(c,s=o(s,j=o(j,S,c,s,y,4,l[32]),S,c,g,11,l[33]),j,S,w,16,l[34]),s,j,k,23,l[35]),c=o(c,s=o(s,j=o(j,S,c,s,a,4,l[36]),S,c,d,11,l[37]),j,S,b,16,l[38]),s,j,_,23,l[39]),c=o(c,s=o(s,j=o(j,S,c,s,E,4,l[40]),S,c,f,11,l[41]),j,S,p,16,l[42]),s,j,v,23,l[43]),c=o(c,s=o(s,j=o(j,S,c,s,m,4,l[44]),S,c,O,11,l[45]),j,S,P,16,l[46]),s,j,h,23,l[47]),c=i(c,s=i(s,j=i(j,S,c,s,f,6,l[48]),S,c,b,10,l[49]),j,S,k,15,l[50]),s,j,y,21,l[51]),c=i(c,s=i(s,j=i(j,S,c,s,O,6,l[52]),S,c,p,10,l[53]),j,S,_,15,l[54]),s,j,a,21,l[55]),c=i(c,s=i(s,j=i(j,S,c,s,g,6,l[56]),S,c,P,10,l[57]),j,S,v,15,l[58]),s,j,E,21,l[59]),c=i(c,s=i(s,j=i(j,S,c,s,d,6,l[60]),S,c,w,10,l[61]),j,S,h,15,l[62]),s,j,m,21,l[63]);u[0]=u[0]+j|0,u[1]=u[1]+S|0,u[2]=u[2]+c|0,u[3]=u[3]+s|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),u.MD5=s._createHelper(c),u.HmacMD5=s._createHmacHelper(c)}(Math),function(){var e,t=n,r=(e=t.lib).Base,o=e.WordArray,i=(e=t.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),r=o.create(),i=r.words,u=a.keySize,a=a.iterations;i.length<u;){s&&n.update(s);var s=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)s=n.finalize(s),n.reset();r.concat(s)}return r.sigBytes=4*u,r}});t.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),n.lib.Cipher||function(e){var t=(d=n).lib,r=t.Base,o=t.WordArray,i=t.BufferedBlockAlgorithm,u=d.enc.Base64,a=d.algo.EvpKDF,s=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?y:p).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?y:p).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},l=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},f=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();f.Encryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;l.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),f.Decryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),l.call(this,e,t,r),this._prevBlock=o}}),c=c.CBC=f,f=(d.pad={}).Pkcs7={pad:function(e,t){for(var n,r=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],u=0;u<n;u+=4)i.push(r);n=o.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:c,padding:f}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),p=(c=(d.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?o.create([1398893684,1701076831]).concat(e).concat(t):t).toString(u)},parse:function(e){var t=(e=u.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=o.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:n})}},t.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,h.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),d=(d.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=o.random(8)),e=a.create({keySize:t+n}).compute(e,r),n=o.create(e.words.slice(t),4*n),e.sigBytes=4*t,h.create({key:e,iv:n,salt:r})}},y=t.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:d}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=p.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,p.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,o=[],i=[],u=[],a=[],s=[],c=[],l=[],f=[],h=[],p=[],d=[],y=0;256>y;y++)d[y]=128>y?y<<1:y<<1^283;var v=0,b=0;for(y=0;256>y;y++){var g=(g=b^b<<1^b<<2^b<<3^b<<4)>>>8^255&g^99;o[v]=g,i[g]=v;var m=d[v],_=d[m],w=d[_],O=257*d[g]^16843008*g;u[v]=O<<24|O>>>8,a[v]=O<<16|O>>>16,s[v]=O<<8|O>>>24,c[v]=O,O=16843009*w^65537*_^257*m^16843008*v,l[g]=O<<24|O>>>8,f[g]=O<<16|O>>>16,h[g]=O<<8|O>>>24,p[g]=O,v?(v=m^d[d[d[w^m]]],b^=d[d[b]]):v=b=1}var E=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),r=this._keySchedule=[],i=0;i<n;i++)if(i<t)r[i]=e[i];else{var u=r[i-1];i%t?6<t&&4==i%t&&(u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u]):(u=u<<8|u>>>24,u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u],u^=E[i/t|0]<<24),r[i]=r[i-t]^u}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,u=t%4?r[i]:r[i-4],e[t]=4>t||4>=i?u:l[o[u>>>24]]^f[o[u>>>16&255]]^h[o[u>>>8&255]]^p[o[255&u]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,u,a,s,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,f,h,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,u,a){for(var s=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],f=e[t+2]^n[2],h=e[t+3]^n[3],p=4,d=1;d<s;d++){var y=r[c>>>24]^o[l>>>16&255]^i[f>>>8&255]^u[255&h]^n[p++],v=r[l>>>24]^o[f>>>16&255]^i[h>>>8&255]^u[255&c]^n[p++],b=r[f>>>24]^o[h>>>16&255]^i[c>>>8&255]^u[255&l]^n[p++];h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^u[255&f]^n[p++],c=y,l=v,f=b}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[f>>>8&255]<<8|a[255&h])^n[p++],v=(a[l>>>24]<<24|a[f>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[p++],b=(a[f>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[p++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&f])^n[p++],e[t]=y,e[t+1]=v,e[t+2]=b,e[t+3]=h},keySize:8});e.AES=t._createHelper(r)}(),n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r((r((r((r(n(6)),n(2))),n(9))),n(11))),u=r(n(14)),a=r(n(15)),s=r((n(5),n(10))),c=function(){function e(t){var n=t.subscribeEndpoint,r=t.leaveEndpoint,o=t.heartbeatEndpoint,a=t.setStateEndpoint,s=t.timeEndpoint,c=t.config,l=t.crypto,f=t.listenerManager;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._listenerManager=f,this._config=c,this._leaveEndpoint=r,this._heartbeatEndpoint=o,this._setStateEndpoint=a,this._subscribeEndpoint=n,this._crypto=l,this._channels={},this._presenceChannels={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new i.default({timeEndpoint:s}),this._dedupingManager=new u.default({config:c})}return o(e,[{key:"adaptStateChange",value:function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,u=e.channelGroups,a=void 0===u?[]:u;return i.forEach(function(e){e in n._channels&&(n._channels[e].state=r)}),a.forEach(function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)}),this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)}},{key:"adaptSubscribeChange",value:function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,u=void 0===i?[]:i,a=e.withPresence,s=void 0!==a&&a;this._config.subscribeKey&&""!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),"0"!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach(function(e){t._channels[e]={state:{}},s&&(t._presenceChannels[e]={}),t._pendingChannelSubscriptions.push(e)}),u.forEach(function(e){t._channelGroups[e]={state:{}},s&&(t._presenceChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)}),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log("subscribe key missing; aborting subscribe")}},{key:"adaptUnsubscribeChange",value:function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,u=void 0===i?[]:i,a=[],s=[];o.forEach(function(e){e in n._channels&&(delete n._channels[e],a.push(e)),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))}),u.forEach(function(e){e in n._channelGroups&&(delete n._channelGroups[e],s.push(e)),e in n._presenceChannelGroups&&(delete n._channelGroups[e],s.push(e))}),0===a.length&&0===s.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:s},function(e){e.affectedChannels=a,e.affectedChannelGroups=s,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())}},{key:"unsubscribeAll",value:function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)}},{key:"getSubscribedChannels",value:function(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:"disconnect",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))}},{key:"_stopHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_performHeartbeatLoop",value:function(){var e=this,t=Object.keys(this._channels),n=Object.keys(this._channelGroups),r={};if(0!==t.length||0!==n.length){t.forEach(function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)}),n.forEach(function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)});this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}}},{key:"_startSubscribeLoop",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+"-pnpres")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+"-pnpres")}),0!==e.length||0!==t.length){var n={channels:e,channelGroups:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}}},{key:"_processSubscribeResponse",value:function(e,t){var n=this;if(e.error)e.category===s.default.PNTimeoutCategory?this._startSubscribeLoop():e.category===s.default.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:s.default.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===s.default.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e);else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=s.default.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,u=i.requestMessageCountThreshold,c=i.dedupeOnSubscribe;if(u&&o.length>=u){var l={};l.category=s.default.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}o.forEach(function(e){var t=e.channel,r=e.subscriptionMatch,o=e.publishMetaData;if(t===r&&(r=null),c){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}if(a.default.endsWith(e.channel,"-pnpres")){var i={};i.channel=null,i.subscription=null,i.actualChannel=null!=r?t:null,i.subscribedChannel=null!=r?r:t,t&&(i.channel=t.substring(0,t.lastIndexOf("-pnpres"))),r&&(i.subscription=r.substring(0,r.lastIndexOf("-pnpres"))),i.action=e.payload.action,i.state=e.payload.data,i.timetoken=o.publishTimetoken,i.occupancy=e.payload.occupancy,i.uuid=e.payload.uuid,i.timestamp=e.payload.timestamp,e.payload.join&&(i.join=e.payload.join),e.payload.leave&&(i.leave=e.payload.leave),e.payload.timeout&&(i.timeout=e.payload.timeout),n._listenerManager.announcePresence(i)}else{var u={};u.channel=null,u.subscription=null,u.actualChannel=null!=r?t:null,u.subscribedChannel=null!=r?r:t,u.channel=t,u.subscription=r,u.timetoken=o.publishTimetoken,u.publisher=e.issuingClientId,e.userMetadata&&(u.userMetadata=e.userMetadata),n._config.cipherKey?u.message=n._crypto.decrypt(e.payload):u.message=e.payload,n._listenerManager.announceMessage(u)}}),this._region=t.metadata.region,this._startSubscribeLoop()}}},{key:"_stopSubscribeLoop",value:function(){this._subscribeCall&&("function"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(10))),i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._listeners=[]}return r(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"removeListener",value:function(e){var t=[];this._listeners.forEach(function(n){n!==e&&t.push(n)}),this._listeners=t}},{key:"removeAllListeners",value:function(){this._listeners=[]}},{key:"announcePresence",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:"announceStatus",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:"announceMessage",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}},{key:"announceNetworkUp",value:function(){var e={};e.category=o.default.PNNetworkUpCategory,this.announceStatus(e)}},{key:"announceNetworkDown",value:function(){var e={};e.category=o.default.PNNetworkDownCategory,this.announceStatus(e)}}]),e}();t.default=i,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(12),i=(o&&o.__esModule,n(5),function(){function e(t){var n=t.timeEndpoint;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._timeEndpoint=n}return r(e,[{key:"onReconnection",value:function(e){this._reconnectionCallback=e}},{key:"startPolling",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNTimeOperation},t.getURL=function(){return"/time/0"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.isAuthSupported=function(){return!1},t.handleResponse=function(e,t){return{timetoken:t[0]}},t.validateParams=function(){};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=(o&&o.__esModule,n(5),function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}),u=function(){function e(t){var n=t.config;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.hashHistory=[],this._config=n}return r(e,[{key:"getKey",value:function(e){var t=i(JSON.stringify(e.payload)).toString();return e.publishMetaData.publishTimetoken+"-"+t}},{key:"isDuplicate",value:function(e){return this.hashHistory.includes(this.getKey(e))}},{key:"addEntry",value:function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))}},{key:"clearHistory",value:function(){this.hashHistory=[]}}]),e}();t.default=u,e.exports=t.default},function(e,t){"use strict";function n(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function r(e){return function(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}(e).sort()}e.exports={signPamFromParams:function(e){return r(e).map(function(t){return t+"="+n(e[t])}).join("&")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e=void 0,t=void 0;return{promise:new Promise(function(n,r){e=n,t=r}),reject:t,fulfill:e}},encodeString:n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(e,t){return e.type=t,e.error=!0,e}({message:e},"validationError")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.networking,r=e.config,c=null,l=null,f={};t.getOperation()===a.default.PNTimeOperation||t.getOperation()===a.default.PNChannelGroupsOperation?c=arguments.length<=2?void 0:arguments[2]:(f=arguments.length<=2?void 0:arguments[2],c=arguments.length<=3?void 0:arguments[3]),"undefined"==typeof Promise||c||(l=u.default.createPromise());var h=t.validateParams(e,f);if(!h){var p=t.prepareParams(e,f),d=function(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.getURL(t,n)}(t,e,f),y=void 0,v={url:d,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};p.uuid=r.UUID,p.pnsdk=function(e){if(e.sdkName)return e.sdkName;var t="PubNub-JS-"+e.sdkFamily;return e.partnerId&&(t+="-"+e.partnerId),t+="/"+e.getVersion()}(r),r.useInstanceId&&(p.instanceid=r.instanceId),r.useRequestId&&(p.requestid=i.default.createUUID()),t.isAuthSupported()&&r.getAuthKey()&&(p.auth=r.getAuthKey()),r.secretKey&&function(e,t,n){var r=e.config,o=e.crypto;n.timestamp=Math.floor((new Date).getTime()/1e3);var i=r.subscribeKey+"\n"+r.publishKey+"\n"+t+"\n";i+=u.default.signPamFromParams(n);var a=o.HMACSHA256(i);a=(a=a.replace(/\+/g,"-")).replace(/\//g,"_"),n.signature=a}(e,d,p);var b=function(n,r){if(n.error)c?c(n):l&&l.reject(new s("PubNub call failed, check status for details",n));else{var o=t.handleResponse(e,r,f);c?c(n,o):l&&l.fulfill(o)}};if(t.usePost&&t.usePost(e,f)){var g=t.postPayload(e,f);y=n.POST(p,g,v,b)}else y=t.useDelete&&t.useDelete()?n.DELETE(p,v,b):n.GET(p,v,b);return t.getOperation()===a.default.PNSubscribeOperation?y:l?l.promise:void 0}return c?c(o(h)):l?(l.reject(new s("Validation failed, check status for details",o(h))),l.promise):void 0};var i=r(n(3)),u=r((n(5),n(15))),a=r((r(n(2)),n(13))),s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.name=r.constructor.name,r.status=n,r.message=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNAddChannelsToGroupOperation},t.validateParams=function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},t.getURL=function(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(",")}},t.handleResponse=function(){return{}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNRemoveChannelsFromGroupOperation},t.validateParams=function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},t.getURL=function(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(",")}},t.handleResponse=function(){return{}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNRemoveGroupOperation},t.validateParams=function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},t.getURL=function(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(n)+"/remove"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.handleResponse=function(){return{}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNChannelGroupsOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e){return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{groups:t.payload.groups}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNChannelsForGroupOperation},t.validateParams=function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},t.getURL=function(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{channels:t.payload.channels}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=e.config;return n?r?o&&0!==o.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"},t.getURL=function(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.pushGateway,r=t.channels;return{type:n,add:(void 0===r?[]:r).join(",")}},t.handleResponse=function(){return{}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=e.config;return n?r?o&&0!==o.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"},t.getURL=function(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.pushGateway,r=t.channels;return{type:n,remove:(void 0===r?[]:r).join(",")}},t.handleResponse=function(){return{}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return n?r?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"},t.getURL=function(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(e,t){return{channels:t}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNRemoveAllPushNotificationsOperation},t.validateParams=function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return n?r?o.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"},t.getURL=function(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n+"/remove"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(){return{}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNUnsubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+i.default.encodeString(u)+"/leave"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o["channel-group"]=r.join(",")),o},t.handleResponse=function(){return{}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNWhereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return"/v2/presence/sub-key/"+n.subscribeKey+"/uuid/"+o},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNHeartbeatOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+i.default.encodeString(u)+"/heartbeat"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,u=e.config,a={};return r.length>0&&(a["channel-group"]=r.join(",")),a.state=JSON.stringify(i),a.heartbeat=u.getPresenceTimeout(),a},t.handleResponse=function(){return{}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNGetStateOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,u=t.channels,a=void 0===u?[]:u,s=a.length>0?a.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+i.default.encodeString(s)+"/uuid/"+o},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o["channel-group"]=r.join(",")),o},t.handleResponse=function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,u=void 0===i?[]:i,a={};return 1===o.length&&0===u.length?a[o[0]]=t.payload:a=t.payload,{channels:a}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNSetStateOperation},t.validateParams=function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,u=t.channelGroups,a=void 0===u?[]:u;return r?n.subscribeKey?0===i.length&&0===a.length?"Please provide a list of channels and/or channel-groups":void 0:"Missing Subscribe Key":"Missing State"},t.getURL=function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+i.default.encodeString(u)+"/uuid/"+n.UUID+"/data"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i["channel-group"]=o.join(",")),i},t.handleResponse=function(e,t){return{state:t.payload}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNHereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,u=t.channelGroups,a=void 0===u?[]:u,s="/v2/presence/sub-key/"+n.subscribeKey;if(o.length>0||a.length>0){var c=o.length>0?o.join(","):",";s+="/channel/"+i.default.encodeString(c)}return s},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.includeUUIDs,i=void 0===o||o,u=t.includeState,a=void 0!==u&&u,s={};return i||(s.disable_uuids=1),a&&(s.state=1),r.length>0&&(s["channel-group"]=r.join(",")),s},t.handleResponse=function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,u=void 0===i?[]:i,a=n.includeUUIDs,s=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||u.length>0||0===u.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach(function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},s&&r.uuids.forEach(function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})}),e}),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},s&&t.uuids&&t.uuids.forEach(function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})}),e}()};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNAccessManagerAudit},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e){return"/v2/auth/audit/sub-key/"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,u={};return n&&(u.channel=n),r&&(u["channel-group"]=r),i.length>0&&(u.auth=i.join(",")),u},t.handleResponse=function(e,t){return t.payload};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return r.default.PNAccessManagerGrant},t.validateParams=function(e){var t=e.config;return t.subscribeKey?t.publishKey?t.secretKey?void 0:"Missing Secret Key":"Missing Publish Key":"Missing Subscribe Key"},t.getURL=function(e){return"/v2/auth/grant/sub-key/"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,u=t.ttl,a=t.read,s=void 0!==a&&a,c=t.write,l=void 0!==c&&c,f=t.manage,h=void 0!==f&&f,p=t.authKeys,d=void 0===p?[]:p,y={};return y.r=s?"1":"0",y.w=l?"1":"0",y.m=h?"1":"0",r.length>0&&(y.channel=r.join(",")),i.length>0&&(y["channel-group"]=i.join(",")),d.length>0&&(y.auth=d.join(",")),(u||0===u)&&(y.ttl=u),y},t.handleResponse=function(){return{}};var r=function(e){return e&&e.__esModule?e:{default:e}}((n(5),n(13)))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e.crypto,r=e.config,o=JSON.stringify(t);return r.cipherKey&&(o=n.encrypt(o),o=JSON.stringify(o)),o}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=function(){return u.default.PNPublishOperation},t.validateParams=function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"},t.usePost=function(e,t){var n=t.sendByPost;return void 0!==n&&n},t.getURL=function(e,t){var n=e.config,r=t.channel,i=o(e,t.message);return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+a.default.encodeString(r)+"/0/"+a.default.encodeString(i)},t.postURL=function(e,t){var n=e.config,r=t.channel;return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+a.default.encodeString(r)+"/0"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.postPayload=function(e,t){return o(e,t.message)},t.prepareParams=function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,u=t.storeInHistory,a=t.ttl,s={};return null!=u&&(s.store=u?"1":"0"),a&&(s.ttl=a),!1===o&&(s.norep="true"),n&&"object"===(void 0===n?"undefined":i(n))&&(s.meta=JSON.stringify(n)),s},t.handleResponse=function(e,t){return{timetoken:t[2]}};var u=r((n(5),n(13))),a=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNHistoryOperation},t.validateParams=function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},t.getURL=function(e,t){var n=t.channel;return"/v2/history/sub-key/"+e.config.subscribeKey+"/channel/"+i.default.encodeString(n)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,u=void 0===i?100:i,a=t.stringifiedTimeToken,s=void 0!==a&&a,c={include_token:"true"};return c.count=u,n&&(c.start=n),r&&(c.end=r),s&&(c.string_message_token="true"),null!=o&&(c.reverse=o.toString()),c},t.handleResponse=function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return t[0].forEach(function(t){var r={timetoken:t.timetoken,entry:function(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}(e,t.message)};n.messages.push(r)}),n};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNDeleteMessagesOperation},t.validateParams=function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},t.useDelete=function(){return!0},t.getURL=function(e,t){var n=t.channel,r=t.start,o=t.end,u=e.config,a="";return r&&(a="?start="+r),o&&(a+=(""!==a?"&":"?")+"end="+o),"/v3/history/sub-key/"+u.subscribeKey+"/channel/"+i.default.encodeString(n)+a},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),{}},t.handleResponse=function(e,t){return t.payload};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNFetchMessagesOperation},t.validateParams=function(e,t){var n=t.channels,r=e.config;return n&&0!==n.length?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channels"},t.getURL=function(e,t){var n=t.channels,r=void 0===n?[]:n,o=e.config,u=r.length>0?r.join(","):",";return"/v3/history/sub-key/"+o.subscribeKey+"/channel/"+i.default.encodeString(u)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=t.start,r=t.end,o=t.count,i={};return o&&(i.max=o),n&&(i.start=n),r&&(i.end=r),i},t.handleResponse=function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach(function(r){n.channels[r]=[],(t.channels[r]||[]).forEach(function(t){var o={};o.channel=r,o.subscription=null,o.timetoken=t.timetoken,o.message=function(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}(e,t.message),n.channels[r].push(o)})}),n};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNSubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,u=o.length>0?o.join(","):",";return"/v2/subscribe/"+n.subscribeKey+"/"+i.default.encodeString(u)+"/0"},t.getRequestTimeout=function(e){return e.config.getSubscribeTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var n=e.config,r=t.channelGroups,o=void 0===r?[]:r,i=t.timetoken,u=t.filterExpression,a=t.region,s={heartbeat:n.getPresenceTimeout()};return o.length>0&&(s["channel-group"]=o.join(",")),u&&u.length>0&&(s["filter-expr"]=u),i&&(s.tt=i),a&&(s.tr=a),s},t.handleResponse=function(e,t){var n=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)});var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}};var o=r((n(5),n(13))),i=r(n(15))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r((r(n(2)),n(10))),u=(n(5),function(){function e(t){var n=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._modules={},Object.keys(t).forEach(function(e){n._modules[e]=t[e].bind(n)})}return o(e,[{key:"init",value:function(e){this._config=e,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}},{key:"nextOrigin",value:function(){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var e=void 0;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace("pubsub","ps"+e)}},{key:"shiftStandardOrigin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"POST",value:function(e,t,n,r){return this._modules.post(e,t,n,r)}},{key:"GET",value:function(e,t,n){return this._modules.get(e,t,n)}},{key:"DELETE",value:function(e,t,n){return this._modules.del(e,t,n)}},{key:"_detectErrorCategory",value:function(e){if("ENOTFOUND"===e.code)return i.default.PNNetworkIssuesCategory;if("ECONNREFUSED"===e.code)return i.default.PNNetworkIssuesCategory;if("ECONNRESET"===e.code)return i.default.PNNetworkIssuesCategory;if("EAI_AGAIN"===e.code)return i.default.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty("status")&&void 0===e.status)return i.default.PNNetworkIssuesCategory;if(e.timeout)return i.default.PNTimeoutCategory;if(e.response){if(e.response.badRequest)return i.default.PNBadRequestCategory;if(e.response.forbidden)return i.default.PNAccessDeniedCategory}return i.default.PNUnknownCategory}}]),e}());t.default=u,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){try{return localStorage.getItem(e)}catch(e){return null}},set:function(e,t){try{return localStorage.setItem(e,t)}catch(e){return null}}},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log("<<<<<"),r.log("["+n+"]","\n",e.url,"\n",e.qs),r.log("-----"),e.on("response",function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(">>>>>>"),r.log("["+i+" / "+o+"]","\n",e.url,"\n",e.qs,"\n",n.text),r.log("-----")})}function o(e,t,n){var o=this;return this._config.logVerbosity&&(e=e.use(r)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e)),e.timeout(t.timeout).end(function(e,r){var i={};if(i.error=null!==e,i.operation=t.operation,r&&r.status&&(i.statusCode=r.status),e)return i.errorData=e,i.category=o._detectErrorCategory(e),n(i,null);var u=JSON.parse(r.text);return u.error&&1===u.error&&u.status&&u.message&&u.service?(i.errorData=u,i.statusCode=u.status,i.error=!0,i.category=o._detectErrorCategory(i),n(i,null)):n(i,u)})}Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(e,t,n){var r=i.default.get(this.getStandardOrigin()+t.url).query(e);return o.call(this,r,t,n)},t.post=function(e,t,n,r){var u=i.default.post(this.getStandardOrigin()+n.url).query(e).send(t);return o.call(this,u,n,r)},t.del=function(e,t,n){var r=i.default.delete(this.getStandardOrigin()+t.url).query(e);return o.call(this,r,t,n)};var i=function(e){return e&&e.__esModule?e:{default:e}}(n(42));n(5)},function(e,t,n){function r(e){if(!p(e))return e;var t=[];for(var n in e)o(t,n,e[n]);return t.join("&")}function o(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){o(e,t,n)});else if(p(n))for(var r in n)o(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function i(e){for(var t,n,r={},o=e.split("&"),i=0,u=o.length;i<u;++i)t=o[i],-1==(n=t.indexOf("="))?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function u(e){return/[\/+]json\b/.test(e)}function a(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=function(e){var t,n,r,o,i=e.split(/\r?\n/),u={};i.pop();for(var a=0,s=i.length;a<s;++a)n=i[a],t=n.indexOf(":"),r=n.slice(0,t).toLowerCase(),o=y(n.slice(t+1)),u[r]=o;return u}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function s(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new a(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}n.emit("response",t);var r;try{(t.status<200||t.status>=300)&&(r=new Error(t.statusText||"Unsuccessful HTTP response"),r.original=e,r.response=t,r.status=t.status)}catch(e){r=e}r?n.callback(r,t):n.callback(null,t)})}function c(e,t){var n=d("DELETE",e);return t&&n.end(t),n}var l;"undefined"!=typeof window?l=window:"undefined"!=typeof self?l=self:(console.warn("Using browser-only version of superagent in non-browser environment"),l=this);var f=n(43),h=n(44),p=n(45),d=e.exports=n(46).bind(null,s);d.getXHR=function(){if(!(!l.XMLHttpRequest||l.location&&"file:"==l.location.protocol&&l.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only verison of superagent could not find XHR")};var y="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};d.serializeObject=r,d.parseString=i,d.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},d.serialize={"application/x-www-form-urlencoded":r,"application/json":JSON.stringify},d.parse={"application/x-www-form-urlencoded":i,"application/json":JSON.parse},a.prototype.get=function(e){return this.header[e.toLowerCase()]},a.prototype._setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=function(e){return e.split(/ *; */).shift()}(t);var n=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(e[r]=o),e},{})}(t);for(var r in n)this[r]=n[r]},a.prototype._parseBody=function(e){var t=d.parse[this.type];return!t&&u(this.type)&&(t=d.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},a.prototype._setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},a.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},d.Response=a,f(s.prototype);for(var v in h)s.prototype[v]=h[v];s.prototype.type=function(e){return this.set("Content-Type",d.types[e]||e),this},s.prototype.responseType=function(e){return this._responseType=e,this},s.prototype.accept=function(e){return this.set("Accept",d.types[e]||e),this},s.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(e+":"+t);this.set("Authorization","Basic "+r);break;case"auto":this.username=e,this.password=t}return this},s.prototype.query=function(e){return"string"!=typeof e&&(e=r(e)),e&&this._query.push(e),this},s.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},s.prototype._getFormData=function(){return this._formData||(this._formData=new l.FormData),this._formData},s.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},s.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},s.prototype._timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},s.prototype._appendQueryString=function(){var e=this._query.join("&");e&&(this.url+=~this.url.indexOf("?")?"&"+e:"?"+e)},s.prototype.end=function(e){var t=this,n=this.xhr=d.getXHR(),r=this._timeout,o=this._formData||this._data;this._callback=e||function(){},n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(t){e=0}if(0==e){if(t.timedout)return t._timeoutError();if(t._aborted)return;return t.crossDomainError()}t.emit("end")}};var i=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{n.onprogress=i.bind(null,"download"),n.upload&&(n.upload.onprogress=i.bind(null,"upload"))}catch(e){}if(r&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},r)),this._appendQueryString(),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof o&&!this._isHost(o)){var a=this._header["content-type"],s=this._serializer||d.serialize[a?a.split(";")[0]:""];!s&&u(a)&&(s=d.serialize["application/json"]),s&&(o=s(o))}for(var c in this.header)null!=this.header[c]&&n.setRequestHeader(c,this.header[c]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send(void 0!==o?o:null),this},d.Request=s,d.get=function(e,t,n){var r=d("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},d.head=function(e,t,n){var r=d("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},d.options=function(e,t,n){var r=d("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},d.del=c,d.delete=c,d.patch=function(e,t,n){var r=d("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},d.post=function(e,t,n){var r=d("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},d.put=function(e,t,n){var r=d("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(45);t.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},t.parse=function(e){return this._parser=e,this},t.serialize=function(e){return this._serializer=e,this},t.timeout=function(e){return this._timeout=e,this},t.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},t.catch=function(e){return this.then(void 0,e)},t.use=function(e){return e(this),this},t.get=function(e){return this._header[e.toLowerCase()]},t.getHeader=t.get,t.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},t.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},t.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(r(e)){for(var n in e)this.field(n,e[n]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return this._getFormData().append(e,t),this},t.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},t.withCredentials=function(){return this._withCredentials=!0,this},t.redirects=function(e){return this._maxRedirects=e,this},t.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},t._isHost=function(e){switch({}.toString.call(e)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},t.send=function(e){var t=r(e),n=this._header["content-type"];if(t&&r(this._data))for(var o in e)this._data[o]=e[o];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)}},function(e,t){e.exports=function(e){return null!==e&&"object"==typeof e}},function(e,t){e.exports=function(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}}])})},function(e,t,n){e.exports=n(338)},function(e,t,n){var r=n(22),o=n(55),i=n(43),u=o(function(e,t){r(t,i(t),e)});e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(340);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(125);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),i=n(8),u=n(2),a=n(51),s=n(5),c=n(125);t.Stream=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this._client=i.Client.sharedInstance(),this._liveService=(0,a.getLiveService)(this._client),this._subscribeChannels={},this._publishChannels={}}return r(e,[{key:"getSubstreams",value:function(){return this._makeStreamRequest("_substreams",s.RequestMethod.GET)}},{key:"getACL",value:function(e){return(0,u.isNonemptyString)(e)?this._makeStreamRequest(e,s.RequestMethod.GET):Promise.reject(new o.KinveyError("Invalid or missing id"))}},{key:"setACL",value:function(e,t){return(0,u.isNonemptyString)(e)?c.StreamACL.isValidACLObject(t)?(t instanceof c.StreamACL||(t=new c.StreamACL(t)),this._makeStreamRequest(e,s.RequestMethod.PUT,t.toPlainObject())):Promise.reject(new o.KinveyError("Invalid or missing ACL object")):Promise.reject(new o.KinveyError("Invalid or missing id"))}},{key:"follow",value:function(e,t){return this._subscribe(e,t)}},{key:"unfollow",value:function(e){return this._unsubscribe(e)}},{key:"post",value:function(e){var t=this._client.getActiveUser()._id;return this._publish(t,e)}},{key:"listen",value:function(e){var t=this._client.getActiveUser()._id;return this._subscribe(t,e)}},{key:"stopListening",value:function(){var e=this._client.getActiveUser()._id;return this._unsubscribe(e)}},{key:"send",value:function(e,t){return this._publish(e,t)}},{key:"_unsubscribeFromSubstream",value:function(e){var t=e+"/unsubscribe";return this._makeStreamRequest(t,s.RequestMethod.POST,{deviceId:this._client.deviceId})}},{key:"_subscribe",value:function(e,t){var n=this;return this._requestSubscribeAccess(e).then(function(){var r=n._subscribeChannels[e];n._liveService.subscribeToChannel(r,t)})}},{key:"_unsubscribe",value:function(e){var t=this;return this._unsubscribeFromSubstream(e).then(function(){var n=t._subscribeChannels[e];t._liveService.unsubscribeFromChannel(n),delete t._subscribeChannels[e]})}},{key:"_publish",value:function(e,t){return this._publishChannels[e]?this._retriablePublish(e,t):this._publishWithAccessRequest(e,t)}},{key:"_publishWithAccessRequest",value:function(e,t){var n=this;return this._requestPublishAccess(e).then(function(){var r=n._publishChannels[e];return n._liveService.publishToChannel(r,t)})}},{key:"_retriablePublish",value:function(e,t){var n=this,r=this._publishChannels[e];return this._liveService.publishToChannel(r,t).catch(function(r){var o=Promise.reject(r);return r.statusCode===s.StatusCode.Forbidden&&(o=n._publishWithAccessRequest(e,t)),o})}},{key:"_requestPublishAccess",value:function(e){var t=this;return this._makeStreamRequest(e+"/publish",s.RequestMethod.POST).then(function(n){return n.substreamChannelName&&(t._publishChannels[e]=n.substreamChannelName),n})}},{key:"_requestSubscribeAccess",value:function(e){var t=this,n={deviceId:this._client.deviceId};return this._makeStreamRequest(e+"/subscribe",s.RequestMethod.POST,n).then(function(n){return t._subscribeChannels[e]=n.substreamChannelName,n})}},{key:"_makeStreamRequest",value:function(e,t,n){return s.KinveyRequest.executeShort({method:t,pathname:"/stream/"+this._client.appKey+"/"+this.name+"/"+e,body:n},this._client)}}],[{key:"StreamACL",get:function(){return c.StreamACL}}]),e}()},function(e,t,n){var r=n(342),o=n(343),i=n(20),u=n(3),a=n(92);e.exports=function(e,t,n){var s=u(e)?r:o;return n&&a(e,t,n)&&(t=void 0),s(e,i(t,3))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}},function(e,t,n){var r=n(29);e.exports=function(e,t){var n=!0;return r(e,function(e,r,o){return n=!!t(e,r,o)}),n}},function(e,t,n){"use strict";function r(){var e=o.Client.sharedInstance();return(0,i.getLiveService)(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.onConnectionStatusUpdates=function(e){r().onConnectionStatusUpdates(e)},t.offConnectionStatusUpdates=function(e){r().offConnectionStatusUpdates(e)},t.isInitialized=function(){return r().isInitialized()};var o=n(8),i=n(51)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DataStore=t.DataStoreType=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(6)),u=r(n(7)),a=n(5),s=n(1),c=n(2),l=n(8),f=n(81),h=n(76),p=n(127),d=t.DataStoreType={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(d);var y=function(){function e(){throw function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),new s.KinveyError("Not allowed to construct a DataStore instance. Please use the collection() function to get an instance of a DataStore instance.")}return o(e,null,[{key:"collection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.Cache,n=arguments[2],r=void 0;if(!1===(0,c.isDefined)(e)||!1===(0,i.default)(e))throw new s.KinveyError("A collection is required and must be a string.");switch(t){case d.Network:r=new f.NetworkStore(e,n);break;case d.Sync:r=new p.SyncStore(e,n);break;case d.Cache:default:r=new h.CacheStore(e,n)}return r}},{key:"getInstance",value:function(e,t,n){return this.collection(e,t,n)}},{key:"clearCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.client||l.Client.sharedInstance(),n="/appdata/"+t.appKey;return new a.CacheRequest({method:a.RequestMethod.DELETE,url:u.default.format({protocol:t.apiProtocol,host:t.apiHost,pathname:n}),properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data})}}]),e}();t.DataStore=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnect=t.AuthorizationGrant=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(6)),a=r(n(7)),s=r(n(347)),c=n(5),l=n(1),f=n(2),h=n(348),p=n(349),d=n(128),y=h.Popup,v=t.AuthorizationGrant={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(v);t.MobileIdentityConnect=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.Identity),o(t,[{key:"isSupported",value:function(){return!0}},{key:"login",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.AuthorizationCodeLoginPage,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this.client.appKey;(0,u.default)(o.micId)&&(a=a+"."+o.micId);return i.default.resolve().then(function(){if(r===v.AuthorizationCodeLoginPage)return n.requestCodeWithPopup(a,e,o);if(r===v.AuthorizationCodeAPI)return n.requestTempLoginUrl(a,e,o).then(function(t){return n.requestCodeWithUrl(t,a,e,o)});throw new l.KinveyError("The authorization grant "+r+" is unsupported. Please use a supported authorization grant.")}).then(function(t){return n.requestToken(t,a,e,o)}).then(function(r){return r.identity=t.identity,r.client_id=a,r.redirect_uri=e,r.protocol=n.client.micProtocol,r.host=n.client.micHost,r})}},{key:"refresh",value:function(e,n,r){var o=this,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i.default.resolve().then(function(){return o.refreshToken(e,n,r,u)}).then(function(e){return e.identity=t.identity,e.client_id=n,e.redirect_uri=r,e.protocol=o.client.micProtocol,e.host=o.client.micHost,e})}},{key:"requestTempLoginUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="/oauth/auth";if(n.version){var o=n.version;!1===(0,u.default)(o)&&(o=String(o)),r=(0,s.default)(0===o.indexOf("v")?o:"v"+o,r)}return new c.KinveyRequest({method:c.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:a.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:r}),properties:n.properties,body:{client_id:e,redirect_uri:t,response_type:"code"}}).execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.default.resolve().then(function(){var o="/oauth/auth",i=new y;if(r.version){var c=r.version;(0,u.default)(c)||(c=String(c)),o=(0,s.default)(0===c.indexOf("v")?c:"v"+c,o)}return i.open(a.default.format({protocol:n.client.micProtocol,host:n.client.micHost,pathname:o,query:{client_id:e,redirect_uri:t,response_type:"code"}}))}).then(function(e){return new i.default(function(n,r){function o(r){try{r.url&&0===r.url.indexOf(t)&&!1===i&&(i=!0,e.removeAllListeners(),e.close(),n(a.default.parse(r.url,!0).query.code))}catch(e){}}var i=!1;e.on("loadstart",o),e.on("loadstop",o),e.on("error",function(o){try{o.url&&0===o.url.indexOf(t)&&!1===i?(i=!0,e.removeAllListeners(),e.close(),n(a.default.parse(o.url,!0).query.code)):!1===i&&(e.removeAllListeners(),e.close(),r(new l.KinveyError(o.message,"",o.code)))}catch(e){}}),e.on("exit",function(){!1===i&&(e.removeAllListeners(),r(new l.KinveyError("Login has been cancelled.")))})})})}},{key:"requestCodeWithUrl",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i.default.resolve().then(function(){return new c.KinveyRequest({method:c.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:e,properties:r.properties,body:{client_id:t,redirect_uri:n,response_type:"code",username:r.username,password:r.password},followRedirect:!1}).execute()}).then(function(e){var t=e.headers.get("location");if(t)return a.default.parse(t,!0).query.code;throw new l.MobileIdentityConnectError("Unable to authorize user with username "+r.username+".","A location header was not provided with a code to exchange for an auth token.")})}},{key:"requestToken",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new c.KinveyRequest({method:c.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:c.AuthType.App,url:a.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),properties:r.properties,body:{grant_type:"authorization_code",client_id:t,redirect_uri:n,code:e}}).execute().then(function(e){return e.data})}},{key:"refreshToken",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new c.KinveyRequest({method:c.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:c.AuthType.App,url:a.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:t,redirect_uri:n,refresh_token:e},properties:r.properties,timeout:r.timeout}).execute().then(function(e){return e.data})}},{key:"logout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new c.KinveyRequest({method:c.RequestMethod.GET,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:c.AuthType.App,url:a.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/invalidate",query:{user:e._id}}),properties:t.properties}).execute().then(function(e){return e.data})}},{key:"identity",get:function(){return d.SocialIdentity.MobileIdentityConnect}}],[{key:"isSupported",value:function(){return!0}},{key:"usePopupClass",value:function(e){(0,f.isDefined)(e)&&(y=e)}},{key:"identity",get:function(){return d.SocialIdentity.MobileIdentityConnect}}]),t}()},function(e,t,n){var r,o;!function(i,u,a){void 0!==e&&e.exports?e.exports=a():void 0===(o="function"==typeof(r=a)?r.call(t,n,t,e):r)||(e.exports=o)}(0,0,function(){return function(){var e=arguments;"object"==typeof arguments[0]&&(e=arguments[0],arguments[1]);return function(e,t){return e=function(e,t){return e.substr(0,t.length)===t}(e,"file://")?e.replace(/(\/{0,3})\/*/g,"$1"):(e=e.replace(/:\//g,"://")).replace(/([^:\s\%\3\A])\/+/g,"$1/"),e=e.replace(/\/(\?|&|#[^!])/g,"$1"),e=e.replace(/(\?.+)\?/g,"$1&")}([].slice.call(e,0).join("/"))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(83),i=n(1);t.Popup=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.EventEmitter),r(t,[{key:"open",value:function(){throw new i.PopupError("Unable to open a popup on this platform.")}},{key:"close",value:function(){return this}}],[{key:"isSupported",value:function(){return!1}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Identity=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),i=n(1);t.Identity=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t.client||o.Client.sharedInstance()}return r(e,[{key:"isSupported",value:function(){return!1}},{key:"isOnline",value:function(e){var t=(new Date).getTime()/1e3;return e&&e.access_token&&e.expires>t}},{key:"identity",get:function(){throw new i.KinveyError("A subclass must override this property.")}}],[{key:"isSupported",value:function(){return!1}},{key:"identity",get:function(){throw new i.KinveyError("A subclass must override this property.")}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(3)),a=r(n(6)),s=r(n(7)),c=n(5),l=n(1),f=n(32),h=n(2),p=n(10),d=n(50);t.UserStore=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d.NetworkStore),o(t,[{key:"lookup",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f.KinveyObservable.create(function(r){if((0,h.isDefined)(e)&&!(e instanceof p.Query))return r.error(new l.KinveyError("Invalid query. It must be an instance of the Query class."));return new c.KinveyRequest({method:c.RequestMethod.POST,authType:c.AuthType.Default,url:s.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_lookup"}),properties:n.properties,body:(0,h.isDefined)(e)?e.toPlainObject().filter:null,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})})}},{key:"create",value:function(){return i.default.reject(new l.KinveyError("Please use `User.signup()` to create a user."))}},{key:"update",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?(0,u.default)(e)?i.default.reject(new l.KinveyError("Only one user can be updated at one time.",e)):e._id?function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,n):i.default.reject(new l.KinveyError("User must have an _id.")):i.default.reject(new l.KinveyError("No user was provided to be updated."))}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new c.KinveyRequest({method:c.RequestMethod.POST,authType:c.AuthType.App,url:s.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:"/rpc/"+this.client.appKey+"/check-username-exists"}),properties:t.properties,data:{username:e},timeout:t.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(){return!0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).usernameExists})}},{key:"removeById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f.KinveyObservable.create(function(r){if(!1===(0,h.isDefined)(e))return r.error(new l.KinveyError("An id was not provided.","Please provide a valid id for a user that you would like to remove."));if(!1===(0,a.default)(e))return r.error(new l.KinveyError("The id provided is not a string.","Please provide a valid id for a user that you would like to remove."));return new c.KinveyRequest({method:c.RequestMethod.DELETE,authType:c.AuthType.Default,url:s.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:!0===n.hard?{hard:!0}:void 0}),properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data}).then(function(e){return r.next(e)}).then(function(){return r.complete()}).catch(function(e){return r.error(e)})}).toPromise()}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}]),t}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEndpoint=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(4)),u=r(n(6)),a=r(n(7)),s=n(1),c=n(8),l=n(5);t.CustomEndpoint=function(){function e(){throw function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),new s.KinveyError("Not allowed to create an instance of the `CustomEndpoint` class.","Please use `CustomEndpoint.execute()` function.")}return o(e,null,[{key:"execute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.client||c.Client.sharedInstance();if(!e)return i.default.reject(new s.KinveyError("An endpoint argument is required."));if(!(0,u.default)(e))return i.default.reject(new s.KinveyError("The endpoint argument must be a string."));return new l.KinveyRequest({method:l.RequestMethod.POST,authType:l.AuthType.Default,url:a.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:"/rpc/"+r.appKey+"/custom/"+e}),properties:n.properties,body:t,timeout:n.timeout,client:r}).execute().then(function(e){return e.data})}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=e?parseInt(e.split("-")[1],10)+1:0;return n>=t?t-1:n}Object.defineProperty(t,"__esModule",{value:!0}),t.Files=t.FileStore=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=r(n(4)),a=r(n(77)),s=r(n(13)),c=r(n(16)),l=r(n(62)),f=r(n(7)),h=n(5),p=n(1),d=n(32),y=n(19),v=n(2),b=n(10),g=n(50),m=t.FileStore=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,g.NetworkStore),i(t,[{key:"find",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={tls:!0===(n=(0,s.default)({tls:!0},n)).tls};(0,l.default)(n.ttl)&&(r.ttl_in_seconds=parseInt(n.ttl,10));return d.KinveyObservable.create(function(o){if((0,v.isDefined)(e)&&!(e instanceof b.Query))return o.error(new p.KinveyError("Invalid query. It must be an instance of the Query class."));return new h.KinveyRequest({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname,query:r}),properties:n.properties,query:e,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})}).toPromise().then(function(e){return!0===n.download?u.default.all((0,a.default)(e,function(e){return t.downloadByUrl(e._downloadURL,n)})):e})}},{key:"findById",value:function(e,t){return this.download(e,t)}},{key:"download",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={tls:!0===(n=(0,s.default)({tls:!0},n)).tls};(0,l.default)(n.ttl)&&(r.ttl_in_seconds=parseInt(n.ttl,10));return d.KinveyObservable.create(function(o){if(!1===(0,v.isDefined)(e))return o.next(void 0),o.complete();return new h.KinveyRequest({method:h.RequestMethod.GET,authType:h.AuthType.Default,url:f.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:r}),properties:n.properties,timeout:n.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return o.next(e)}).then(function(){return o.complete()}).catch(function(e){return o.error(e)})}).toPromise().then(function(e){return!0===n.stream?e:(n.mimeType=e.mimeType,t.downloadByUrl(e._downloadURL,n))})}},{key:"downloadByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new h.NetworkRequest({method:h.RequestMethod.GET,url:e,timeout:t.timeout}).execute().then(function(e){return e.data})}},{key:"stream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.stream=!0,this.download(e,t)}},{key:"upload",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=this.transformMetadata(e,n);var i=null;return this.saveFileMetadata(r,n).then(function(e){return i=e.data,t.makeStatusCheckRequest(e.data._uploadURL,e.data._requiredHeaders,n,r.timeout)}).then(function(a){if(y.Log.debug("File upload status check response",a),!a.isSuccess())return u.default.reject(a.error);if(200===a.statusCode||201===a.statusCode)return a;if(308!==a.statusCode){var s=new p.KinveyError("Unexpected response for upload file status check request.",!1,a.statusCode,a.headers.get("X-Kinvey-Request-ID"));return u.default.reject(s)}var c={start:o(a.headers.get("range"),n.size),timeout:r.timeout,maxBackoff:r.maxBackoff,headers:i._requiredHeaders};return t.retriableUpload(i._uploadURL,e,n,c)}).then(function(){return delete i._expiresAt,delete i._requiredHeaders,delete i._uploadURL,i._data=e,i})}},{key:"transformMetadata",value:function(e,t){var n=(0,s.default)({filename:e._filename||e.name,public:!1,size:e.size||e.length,mimeType:e.mimeType||e.type||"application/octet-stream"},t);return n._filename=t.filename,delete n.filename,n._public=t.public,delete n.public,n}},{key:"saveFileMetadata",value:function(e,t){var n=(0,v.isDefined)(t._id);return new h.KinveyRequest({method:n?h.RequestMethod.PUT:h.RequestMethod.POST,authType:h.AuthType.Default,headers:{"X-Kinvey-Content-Type":t.mimeType},url:f.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:n?this.pathname+"/"+t._id:this.pathname}),properties:e.properties,timeout:e.timeout,body:t,client:this.client}).execute()}},{key:"makeStatusCheckRequest",value:function(e,t,n,r){var o=new h.Headers(t);o.set("content-type",n.mimeType),o.set("content-range","bytes */"+n.size);return new h.NetworkRequest({method:h.RequestMethod.PUT,url:e,timeout:r,headers:o}).execute()}},{key:"retriableUpload",value:function(e,t,n,r){var i=this;return r=(0,s.default)({count:0,start:0,maxBackoff:32e3},r),y.Log.debug("Start file upload"),y.Log.debug("File upload headers",r.headers),y.Log.debug("File upload upload url",f.default),y.Log.debug("File upload file",t),y.Log.debug("File upload metadata",n),y.Log.debug("File upload options",r),this.makeUploadRequest(e,t,n,r).then(function(e){if(y.Log.debug("File upload response",e),e.isClientError())return u.default.reject(e.error);if(!e.isSuccess()&&!e.isServerError()&&308!==e.statusCode){var t=new p.KinveyError("Unexpected response for upload file request.",!1,e.statusCode,e.headers.get("X-Kinvey-Request-ID"));return u.default.reject(t)}return e}).then(function(e){var t=0;return e.isServerError()?(y.Log.debug("File upload server error. Probably network congestion.",e.statusCode,e.data),(t=Math.pow(2,r.count)+function(e,t){return Math.floor(Math.random()*(t-e))+e}(1,1001))>=r.maxBackoff?u.default.reject(e.error):(y.Log.debug("File upload will try again in "+t+" seconds."),new u.default(function(e){setTimeout(function(){r.count+=1,e(!0)},t)}))):308===e.statusCode?(y.Log.debug("File upload was incomplete (statusCode 308). Trying to upload the remainder of file."),r.start=o(e.headers.get("range"),n.size),new u.default(function(e){setTimeout(function(){r.count=0,e(!0)},t)})):new u.default(function(e){setTimeout(function(){e(!1)},t)})}).then(function(o){return o?i.retriableUpload(e,t,n,r):null})}},{key:"makeUploadRequest",value:function(e,t,n,r){var o=new h.Headers(r.headers);o.set("content-type",n.mimeType),o.set("content-range","bytes "+r.start+"-"+(n.size-1)+"/"+n.size);return new h.NetworkRequest({method:h.RequestMethod.PUT,url:e,headers:o,body:(0,c.default)(t.slice)?t.slice(r.start):t,timeout:r.timeout}).execute()}},{key:"create",value:function(e,t,n){return this.upload(e,t,n)}},{key:"update",value:function(e,t,n){return this.upload(e,t,n)}},{key:"remove",value:function(){throw new p.KinveyError("Please use removeById() to remove files one by one.")}},{key:"pathname",get:function(){return"/blob/"+this.client.appKey}}]),t}();t.Files=new m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(354);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!(0,a.isDefined)(e.appKey))throw new s.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!(0,a.isDefined)(e.appSecret)&&!(0,a.isDefined)(e.masterSecret))throw new s.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return f.Html5Client.init(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.init=o,t.initialize=function(e){try{var t=o(e),n=l.User.getActiveUser(t);return(0,a.isDefined)(n)?u.default.resolve(n):new c.CacheRequest({method:c.RequestMethod.GET,url:i.default.format({protocol:t.apiProtocol,host:t.apiHost,pathname:"/"+h+"/"+t.appKey+"/"+p})}).execute().then(function(e){return e.data}).then(function(e){return e.length>0?e[0]:null}).then(function(e){return(0,a.isDefined)(e)?(0,a.isDefined)(e.data)?t.setActiveUser(e.data):t.setActiveUser(e):e}).then(function(){return l.User.getActiveUser(t)})}catch(e){return u.default.reject(e)}};var i=r(n(7)),u=r(n(4)),a=n(2),s=n(1),c=n(5),l=n(63),f=n(355),h="user",p="kinvey_active_user"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Html5Client=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(356),u=n(8),a=n(1),s=n(19),c=n(2),l=function(){function e(){r(this,e)}return o(e,[{key:"get",value:function(e){if("string"!=typeof e)throw new a.KinveyError("ActiveUserStorage key must be a string.");try{return JSON.parse(i.storage.getItem(e))}catch(e){return s.Log.debug("Unable to parse stored active user.",e),null}}},{key:"set",value:function(e,t){if("string"!=typeof e)throw new a.KinveyError("ActiveUserStorage key must be a string.");return(0,c.isDefined)(t)?i.storage.setItem(e,JSON.stringify(t)):i.storage.removeItem(e),t}}]),e}();t.Html5Client=function(e){function t(){return r(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.Client),o(t,null,[{key:"init",value:function(e){var t=u.Client.init(e);return t.activeUserStorage=new l,t}}]),t}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=t.CookieStorage=t.isSupported=t.storage=void 0;var o=r(n(357)),i=r(n(130)),u=r(n(359)),a=null;(0,o.default)("localStorage")?t.storage=a=window.localStorage:(0,o.default)("sessionStorage")?t.storage=a=window.sessionStorage:(0,o.default)("cookieStorage")?t.storage=a=new i.default:t.storage=a=new u.default,t.default=a,t.storage=a,t.isSupported=o.default,t.CookieStorage=i.default,t.MemoryStorage=u.default},function(e,t,n){"use strict";function r(e){try{var t=window[e];return t.setItem(i,"1"),t.removeItem(i),!0}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return r("localStorage");if("session"===t)return r("sessionStorage");if("cookie"===t)return(0,o.hasCookies)();if("memory"===t)return!0;throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.")};var o=n(130),i="__test"},function(e,t,n){"use strict";t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},o=t||{},u=e.split(i),a=o.decode||r,s=0;s<u.length;s++){var c=u[s],l=c.indexOf("=");if(!(l<0)){var f=c.substr(0,l).trim(),h=c.substr(++l,c.length).trim();'"'==h[0]&&(h=h.slice(1,-1)),void 0==n[f]&&(n[f]=function(e,t){try{return t(e)}catch(t){return e}}(h,a))}}return n},t.serialize=function(e,t,n){var r=n||{},i=r.encode||o;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!u.test(e))throw new TypeError("argument name is invalid");var a=i(t);if(a&&!u.test(a))throw new TypeError("argument val is invalid");var s=e+"="+a;if(null!=r.maxAge){var c=r.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(c)}if(r.domain){if(!u.test(r.domain))throw new TypeError("option domain is invalid");s+="; Domain="+r.domain}if(r.path){if(!u.test(r.path))throw new TypeError("option path is invalid");s+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}return s};var r=decodeURIComponent,o=encodeURIComponent,i=/; */,u=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return r(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=o},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Html5HttpMiddleware=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=r(n(361)),u=r(n(4)),a=n(5),s=n(2),c=n(1);t.Html5HttpMiddleware=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.pkg=e,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a.Middleware),o(n,[{key:"handle",value:function(t){var n=this;return new u.default(function(r,o){var u=t.url,a=t.method,l=t.headers,f=t.body,h=t.timeout,p=t.followRedirect;l["X-Kinvey-Device-Information"]=function(t){var n=[],r=void 0,o=void 0,i=void 0,u=void 0;null!==o&&void 0!==o||!e.navigator||(o=(r=function(e){return e=e.toLowerCase(),/(chrome)\/([\w]+)/.exec(e)||/(firefox)\/([\w.]+)/.exec(e)||/(msie) ([\w.]+)/i.exec(e)||/(opera)(?:.*version)?[ /]([\w.]+)/.exec(e)||/(safari)\/([\w.]+)/.exec(e)||[]}(e.navigator.userAgent))[1],i=r[2],u=e.navigator.platform),void 0!==e.angular&&n.push("angularjs/"+e.angular.version.full),void 0!==e.Backbone&&n.push("backbonejs/"+e.Backbone.VERSION),void 0!==e.Ember&&n.push("emberjs/"+e.Ember.VERSION),void 0!==e.jQuery&&n.push("jquery/"+e.jQuery.fn.jquery),void 0!==e.ko&&n.push("knockout/"+e.ko.version),void 0!==e.Zepto&&n.push("zeptojs");var a=["js-kinvey-html5-sdk/"+t.version];return 0!==n.length&&a.push("("+n.sort().join(", ")+")"),a.concat([o,i,u]).map(function(e){return e?e.toString().replace(/\s/g,"_").toLowerCase():"unknown"}).join(" ")}(n.pkg),n.xhrRequest=(0,i.default)({method:a,url:u,headers:l,body:f,followRedirect:p,timeout:h},function(e,t,n){return(0,s.isDefined)(e)?"ESOCKETTIMEDOUT"===e.code||"ETIMEDOUT"===e.code?o(new c.TimeoutError("The network request timed out.")):o(new c.NetworkConnectionError("There was an error connecting to the network.",e)):r({response:{statusCode:t.statusCode,headers:t.headers,data:n}})})})}},{key:"cancel",value:function(){return(0,s.isDefined)(this.xhrRequest)&&"function"==typeof this.xhrRequest.abort&&this.xhrRequest.abort(),u.default.resolve()}}]),n}()}).call(t,n(9))},function(e,t,n){"use strict";function r(e,t,n){var r=e;return a(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=c(t,{uri:e}),r.callback=n,r}function o(e,t,n){return t=r(e,t,n),i(t)}function i(e){function t(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,i(e,b)}function n(){if(!c){var t;clearTimeout(l),t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var n=b,r=null;return 0!==t?(n={body:function(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(u),v)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:h,headers:{},url:f,rawRequest:u},u.getAllResponseHeaders&&(n.headers=s(u.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),i(r,n,n.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var r=!1,i=function(t,n,o){r||(r=!0,e.callback(t,n,o))},u=e.xhr||null;u||(u=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var a,c,l,f=u.url=e.uri||e.url,h=u.method=e.method||"GET",p=e.body||e.data,d=u.headers=e.headers||{},y=!!e.sync,v=!1,b={body:void 0,headers:{},statusCode:0,method:h,url:f,rawRequest:u};if("json"in e&&!1!==e.json&&(v=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),p=JSON.stringify(!0===e.json?p:e.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(n,0)},u.onload=n,u.onerror=t,u.onprogress=function(){},u.onabort=function(){c=!0},u.ontimeout=t,u.open(h,f,!y,e.username,e.password),y||(u.withCredentials=!!e.withCredentials),!y&&e.timeout>0&&(l=setTimeout(function(){if(!c){c=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},e.timeout)),u.setRequestHeader)for(a in d)d.hasOwnProperty(a)&&u.setRequestHeader(a,d[a]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(p||null),u}var u=n(362),a=n(131),s=n(363),c=n(366);e.exports=o,o.XMLHttpRequest=u.XMLHttpRequest||function(){},o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:u.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,n,o){return n=r(t,n,o),n.method=e.toUpperCase(),i(n)}})},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(t,n(9))},function(e,t,n){var r=n(364),o=n(365);e.exports=function(e){if(!e)return{};var t={};return o(r(e).split("\n"),function(e){var n=e.indexOf(":"),o=r(e.slice(0,n)).toLowerCase(),i=r(e.slice(n+1));void 0===t[o]?t[o]=i:!function(e){return"[object Array]"===Object.prototype.toString.call(e)}(t[o])?t[o]=[t[o],i]:t[o].push(i)}),t}},function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){var r=n(131);e.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===o.call(e)?function(e,t,n){for(var r=0,o=e.length;r<o;r++)i.call(e,r)&&t.call(n,e[r],r,e)}(e,t,n):"string"==typeof e?function(e,t,n){for(var r=0,o=e.length;r<o;r++)t.call(n,e.charAt(r),r,e)}(e,t,n):function(e,t,n){for(var r in e)i.call(e,r)&&t.call(n,e[r],r,e)}(e,t,n)};var o=Object.prototype.toString,i=Object.prototype.hasOwnProperty},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var o in r)n.call(r,o)&&(e[o]=r[o])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Html5CacheMiddleware=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(5),i=n(368);t.Html5CacheMiddleware=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.CacheMiddleware),r(t,[{key:"loadStorage",value:function(e){return new i.Html5Storage(e)}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Html5Storage=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(5),i=n(369),u=n(370),a=n(371);t.Html5Storage=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Storage),r(t,[{key:"loadAdapter",value:function(){var e=this;return u.WebSQLAdapter.load(this.name).then(function(t){return t||i.IndexedDBAdapter.load(e.name)}).then(function(t){return t||a.LocalStorageAdapter.load(e.name)}).then(function(t){return t||a.SessionStorageAdapter.load(e.name)}).then(function(n){return n||function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"loadAdapter",e).call(e)})}}]),t}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDBAdapter=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(1),u=n(2),a={},s=void 0,c={ReadWrite:"readwrite",ReadOnly:"readonly"};Object.freeze(c);var l=function(){function t(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!1===(0,u.isDefined)(e))throw new Error("A name is required to use the IndexedDB adapter.",e);if("string"!=typeof e)throw new Error("The name must be a string to use the IndexedDB adapter",e);this.name=e,this.inTransaction=!1,this.queue=[]}return r(t,[{key:"openTransaction",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2],o=this,s=arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,h=a[this.name];if((0,u.isDefined)(h)){if("function"==typeof h.objectStoreNames.contains?h.objectStoreNames.contains(t):-1!==h.objectStoreNames.indexOf(t))try{var p=n?c.ReadWrite:c.ReadOnly,d=h.transaction(t,p);if((0,u.isDefined)(d))return r(d);throw new i.KinveyError("Unable to open a transaction for "+t+" collection on the "+this.name+" IndexedDB database.")}catch(e){return s(e)}else if(!1===n)return s(new i.NotFoundError("The "+t+" collection was not found on the "+this.name+" IndexedDB database."))}if(!1===l&&this.inTransaction)return this.queue.push(function(){o.openTransaction(t,n,r,s)});this.inTransaction=!0;var y=void 0;try{if((0,u.isDefined)(h)){var v=h.version+1;h.close(),y=f.open(this.name,v)}else y=f.open(this.name)}catch(e){s(e)}return y.onupgradeneeded=function(e){h=e.target.result,a[o.name]=h,!0===n&&h.createObjectStore(t,{keyPath:"_id"})},y.onsuccess=function(e){h=e.target.result,a[o.name]=h,h.onversionchange=function(){(0,u.isDefined)(h)&&(h.close(),h=null,a[o.name]=null)};var i=function(e){return function(t){if(e(t),o.inTransaction=!1,o.queue.length>0){var n=o.queue;o.queue=[],n.forEach(function(e){e.call(o)})}}};return o.openTransaction(t,n,i(r),i(s),!0)},y.onblocked=function(){},y.onerror=function(e){s(new Error("Unable to open the "+o.name+" IndexedDB database. "+e.target.error.message+"."))},y}},{key:"close",value:function(){var e=a[this.name];(0,u.isDefined)(e)&&e.close()}},{key:"find",value:function(e){var t=this;return new o.default(function(n,r){t.openTransaction(e,!1,function(t){var o=t.objectStore(e).openCursor(),i=[];o.onsuccess=function(e){var t=e.target.result;return(0,u.isDefined)(t)?(i.push(t.value),t.continue()):n(i)},o.onerror=function(e){r(e)}},function(e){e instanceof i.NotFoundError&&n([]),r(e)})})}},{key:"findById",value:function(e,t){var n=this;return new o.default(function(r,o){n.openTransaction(e,!1,function(a){var s=a.objectStore(e).get(t);s.onsuccess=function(e){var t=e.target.result;(0,u.isDefined)(t)?r(t):r(void 0)},s.onerror=function(){o(new i.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))}},o)})}},{key:"save",value:function(e,t){var n=this,r=!1;return Array.isArray(t)||(r=!0,t=[t]),0===t.length?o.default.resolve(null):new o.default(function(o,u){n.openTransaction(e,!0,function(a){var s=a.objectStore(e);t.forEach(function(e){s.put(e)}),a.oncomplete=function(){o(r?t[0]:t)},a.onerror=function(t){u(new i.KinveyError("An error occurred while saving the entities to the "+e+" collection on the "+n.name+" IndexedDB database. "+t.target.error.message+"."))}},u)})}},{key:"removeById",value:function(e,t){var n=this;return new o.default(function(r,o){n.openTransaction(e,!0,function(a){var s=a.objectStore(e),c=s.get(t);s.delete(t),a.oncomplete=function(){var e=c.result;(0,u.isDefined)(e)?r({count:1}):r({count:0})},a.onerror=function(){o(new i.NotFoundError("An entity with id = "+t+" was not found in the "+e+" collection on the "+n.name+" IndexedDB database."))}},o)})}},{key:"clear",value:function(){var t=this;return this.close(),new o.default(function(n,r){var o=(e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB).deleteDatabase(t.name);o.onsuccess=function(){a={},n(null)},o.onerror=function(e){r(new i.KinveyError("An error occurred while clearing the "+t.name+" IndexedDB database. "+e.target.error.message+"."))},o.onblocked=function(){r(new i.KinveyError("The "+t.name+" IndexedDB database could not be cleared due to the operation being blocked."))}})}}]),t}();t.IndexedDBAdapter={load:function(t){var n=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB,r=new l(t);return!1===(0,u.isDefined)(n)?o.default.resolve(void 0):(0,u.isDefined)(s)?s?o.default.resolve(r):o.default.resolve(void 0):r.save("__testSupport__",{_id:"1"}).then(function(){return s=!0,r}).catch(function(){s=!1})}}}).call(t,n(9))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WebSQLAdapter=t.WebSQL=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(1),u=n(2),a="sqlite_master",s=void 0,c=t.WebSQL=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kinvey";if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!1===(0,u.isDefined)(e))throw new i.KinveyError("A name is required to use the WebSQL adapter.",e);if("string"!=typeof e)throw new i.KinveyError("The name must be a string to use the WebSQL adapter",e);this.name=e}return r(t,[{key:"openTransaction",value:function(t,n,r){var u=this,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c='"'+t+'"',l=t===a,f=Array.isArray(n);return n=f?n:[[n,r]],new o.default(function(r,o){try{var h=e.openDatabase(u.name,1,"Kinvey Cache",2097152);h[s||"function"!=typeof h.readTransaction?"transaction":"readTransaction"](function(e){s&&!l&&e.executeSql("CREATE TABLE IF NOT EXISTS "+c+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)");var t=n.length,o=[];0===t?r(f?o:o.shift()):n.forEach(function(n){var i=n[0].replace("#{collection}",c);e.executeSql(i,n[1],function(e,n){var i={rowCount:n.rowsAffected,result:[]};if(n.rows.length>0)for(var u=0,a=n.rows.length;u<a;u+=1)try{var s=n.rows.item(u).value,c=l?s:JSON.parse(s);i.result.push(c)}catch(e){}o.push(i),0===(t-=1)&&r(f?o:o.shift())})})},function(e){if((e="string"==typeof e?e:e.message)&&-1===e.indexOf("no such table"))return r({result:[]});var n=["table",t];return u.openTransaction(a,"SELECT name AS value from #{collection} WHERE type = ? AND name = ?",n).then(function(e){return 0===e.result.length?r({result:[]}):o(new i.KinveyError("Unable to open a transaction for the "+t+" collection on the "+u.name+" WebSQL database."))}).catch(o)})}catch(e){o(e)}})}},{key:"find",value:function(e){return this.openTransaction(e,"SELECT value FROM #{collection}",[]).then(function(e){return e.result})}},{key:"findById",value:function(e,t){var n=this;return this.openTransaction(e,"SELECT value FROM #{collection} WHERE key = ?",[t]).then(function(e){return e.result}).then(function(r){if(0===r.length)throw new i.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+n.name+" WebSQL database.");return r[0]})}},{key:"save",value:function(e,t){var n=[],r=!1;return Array.isArray(t)||(r=!0,t=[t]),0===t.length?o.default.resolve(null):(t=t.map(function(e){return n.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e._id,JSON.stringify(e)]]),e}),this.openTransaction(e,n,null,!0).then(function(){return r?t[0]:t}))}},{key:"removeById",value:function(e,t){return this.openTransaction(e,"DELETE FROM #{collection} WHERE key = ?",[t],!0).then(function(e){return{count:e.rowCount}})}},{key:"clear",value:function(){var e=this;return this.openTransaction(a,"SELECT name AS value FROM #{collection} WHERE type = ?",["table"],!1).then(function(e){return e.result}).then(function(t){if(0===t.length)return null;var n=t.filter(function(e){return/^[a-zA-Z0-9-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]});return e.openTransaction(a,n,null,!0)}).then(function(){return null})}}]),t}();t.WebSQLAdapter={load:function(t){var n=new c(t);return!1===(0,u.isDefined)(e.openDatabase)?o.default.resolve(void 0):(0,u.isDefined)(s)?!0===s?o.default.resolve(n):o.default.resolve(void 0):n.save("__testSupport__",{_id:"1"}).then(function(){return s=!0,n}).catch(function(){s=!1})}}}).call(t,n(9))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(372);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(373);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageAdapter=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(132),u="__master__",a=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.WebStorage),r(n,[{key:"find",value:function(t){try{var n=JSON.parse(e.localStorage.getItem(this.name+"."+t));return o.default.resolve(n||[])}catch(e){return o.default.reject(e)}}},{key:"findById",value:function(e,t){return this.find(e).then(function(e){return e.find(function(e){return e._id===t})})}},{key:"save",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=!1;return Array.isArray(r)||(r=[r],o=!0),this.find(u).then(function(r){return-1===r.indexOf(t)&&(r.push(t),e.localStorage.setItem(n.name+"."+u,JSON.stringify(r))),n.find(t)}).then(function(i){return r.forEach(function(e){var t=i.findIndex(function(t){return t._id===e._id});-1===t?i.push(e):i[t]=e}),e.localStorage.setItem(n.name+"."+t,JSON.stringify(i)),o?r[0]:r})}},{key:"removeById",value:function(t,n){var r=this;return this.find(t).then(function(o){var i=o.findIndex(function(e){return e._id===n});return-1===i?{count:0}:(o.splice(i,1),e.localStorage.setItem(r.name+"."+t,JSON.stringify(o)),{count:1})})}},{key:"clear",value:function(){var t=this;return this.find(u).then(function(n){return n.forEach(function(n){e.localStorage.removeItem(t.name+"."+n)}),e.localStorage.removeItem(t.name+"."+u),null})}}]),n}();t.LocalStorageAdapter={load:function(t){if(e.localStorage){var n="__testSupport__";try{return e.localStorage.setItem(n,n),e.localStorage.getItem(n),e.localStorage.removeItem(n),o.default.resolve(new a(t))}catch(e){return o.default.resolve(void 0)}}return o.default.resolve(void 0)}}}).call(t,n(9))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorageAdapter=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(4)),i=n(132),u="__master__",a=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,i.WebStorage),r(n,[{key:"find",value:function(t){try{var n=JSON.parse(e.sessionStorage.getItem(this.name+"."+t));return o.default.resolve(n||[])}catch(e){return o.default.reject(e)}}},{key:"findById",value:function(e,t){return this.find(e).then(function(e){return e.find(function(e){return e._id===t})})}},{key:"save",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=!1;return Array.isArray(r)||(r=[r],o=!0),this.find(u).then(function(r){return-1===r.indexOf(t)&&(r.push(t),e.sessionStorage.setItem(n.name+"."+u,JSON.stringify(r))),n.find(t)}).then(function(i){return r.forEach(function(e){var t=i.findIndex(function(t){return t._id===e._id});-1===t?i.push(e):i[t]=e}),e.sessionStorage.setItem(n.name+"."+t,JSON.stringify(i)),o?r[0]:r})}},{key:"removeById",value:function(t,n){var r=this;return this.find(t).then(function(o){var i=o.findIndex(function(e){return e._id===n});return-1===i?{count:0}:(o.splice(i,1),e.sessionStorage.setItem(r.name+"."+t,JSON.stringify(o)),{count:1})})}},{key:"clear",value:function(){var t=this;return this.find(u).then(function(n){return n.forEach(function(n){e.sessionStorage.removeItem(t.name+"."+n)}),e.sessionStorage.removeItem(t.name+"."+u),null})}}]),n}();t.SessionStorageAdapter={load:function(t){if(e.sessionStorage){var n="__testSupport__";try{return e.sessionStorage.setItem(n,n),e.sessionStorage.getItem(n),e.sessionStorage.removeItem(n),o.default.resolve(new a(t))}catch(e){return o.default.resolve(void 0)}}return o.default.resolve(void 0)}}}).call(t,n(9))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(83);t.Popup=function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,o.EventEmitter),r(n,[{key:"open",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",r=this,o=e.open(n,"_blank","toolbar=no,location=no");if(!o)throw new Error("The popup was blocked.");var i=e.setInterval(function(){if(o.closed)e.clearInterval(i),t.emit("exit");else try{var n={url:o.location.href};t.emit("loadstart",n),t.emit("load",n)}catch(n){n.code!==e.DOMException.SECURITY_ERR&&t.emit("error",n)}},100);return{on:function(){return r.on.apply(r,arguments)},close:function(){return o&&!o.closed&&o.close(),this},removeAllListeners:function(){return r.removeAllListeners.apply(r,arguments)}}}}],[{key:"open",value:function(e){return(new n).open(e)}}]),n}()}).call(t,n(9))},function(e,t){e.exports={private:!0,version:"3.9.8",name:"kinvey-html5-sdk",description:"Kinvey JavaScript SDK for HTML5 applications.",author:"Kinvey, Inc.",homepage:"http://www.kinvey.com",license:"Apache-2.0",main:"kinvey-html5-sdk.min.js",scripts:{prebuild:"rm -rf dist",build:"webpack --config webpack.config.js",release:"npm run build -- --env.uglify && ./scripts/push.sh",postrelease:"rm -rf tmp",s3:"npm run build -- --env.uglify --env.s3"},files:["kinvey-html5-sdk.min.js","kinvey-html5-sdk.min.js.map"]}}])});
//# sourceMappingURL=kinvey-html5-sdk.min.js.map